<?php
include "../connection.php";
session_start();
$susername = $_SESSION['staffsess'];
?>

<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Staff Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="robots" content="index, follow" />
<meta name="rating" content="General" />
<meta name="distribution" content="Global" />
<meta name="resource-type" content="document">
<meta name="revisit-after" content="20 days">
<meta name="language" content="English, Hindi">

<link href="../css/bootstrap.css" rel="stylesheet">
<link href="../css/custom.css" rel="stylesheet">

<link href="../css/font-awesome.css" rel="stylesheet" media="screen">
<link rel="stylesheet" href="../styles.css">
<script src="../js/counterup.min.js" type="text/javascript"></script>
<script src="../js/jquery.min.js" type="text/javascript"></script>
<script src="../script.js"></script>
<!--<script src="../js/jquery.min.js"></script>-->
<script type="text/javascript" src="../js/bootstrap.js"></script>
<!--Horizontal Tabs-->
<link type="text/css" rel="stylesheet" href="../css/responsive-tabs.css" />
<link type="text/css" rel="stylesheet" href="../css/tab.css" />
<!-- Responsive Tabs JS -->
<script src="../js/jquery.responsiveTabs.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function () {

$('#horizontalTab').responsiveTabs({

rotate: false,

startCollapsed: 'accordion',

collapsible: 'accordion',

setHash: true,              

});
});
</script>
<script type="text/javascript">

$(document).ready(function(){

$("#myModal").modal('show');

});

</script>

<!-- Owl Carousel Assets -->

<link href="../css/owl.carousel.css" rel="stylesheet">

<script src="../js/owl.carousel.js"></script>

<script>

$(document).ready(function() {



$("#owl-demo").owlCarousel({

items : 4,
lazyLoad : true,
autoPlay : true,
navigation : true,
navigationText : ["", ""],
rewindNav : true,
scrollPerPage : true,
pagination : false,
paginationNumbers : false,

});
});

</script>


<!-- //Owl Carousel Assets -->

<script src="../js/marquee-scroller.js"></script>

<style>
body {
font-family: Arial, Helvetica, sans-serif;
font-size: 17px;
}

#myBtn {
display: none;
position: fixed;
bottom: 20px;
right: 30px;
z-index: 99;
font-size: 16px;
border: none;
outline: none;
background-color: red;
color: white;
cursor: pointer;
padding: 15px;
border-radius: 4px;
}

#myBtn:hover {
background-color: #555;
}
</style>

</head>

<body>
<button onClick="topFunction()" id="myBtn" title="Go to top">Top</button>
<div class="container-fluid">
<div class="row top-header" style="border-top:2px solid #FF0000;">
<?php require_once "logo.php"; ?>
</div>

<div class="row menubar" style="border-top:2px solid #FF0000; background-color:#D8211D;">
<div class="container">
<div id='cssmenu'>
<?php require_once "menu.php"; ?>
</div>
</div>
</div>
<div class="row page-top" style="margin-top:1px;">
<div class="container">
<div class="col-md-12">
<ul class="breadcrumb">
<li><a href="index.php" style="color:#FFFFFF;">Home</a> </li>
<li class="active" style="color:#FFFFFF;">Upload Audio</li>
</ul>
<h2 style="color:#FFFFFF;">Upload Audio</h2>
</div>
</div>
</div>

<div class="row page-content">
<div class="container" style="background-color:#FFFFFF;">
<div class="row" style="margin-top:20px;">
<div class="col-md-12">
<div class="col-md-12">
<div class="col-md-12  col-left text-justify">

<form action="" method="post" enctype="multipart/form-data" class="myform">
<div class="col-md-12">
<div class="col-md-4">
<label>कोर्स का नाम</label>
</div>
<div class="col-md-6">
<select name="course" id="course" class="form-control">
<option>-- Choose --</option>
<?php
$q = "select DISTINCT class from fees";
$query = $con->prepare($q);
$query->execute();
$results=$query->fetchAll(PDO::FETCH_ASSOC);
foreach($results as $res)
{
?>
<option value="<?php echo $res['class']; ?>">
<?php echo $res['class']; ?>
</option>
<?php
}
?>
</select>
</div>
</div>
<div class="col-md-12">
<div class="col-md-4">
<br />
<label>विषय</label>
</div>
<div class="col-md-4">
<br />
<div id="dynamic">--</div>
</div>
</div>
<div class="col-md-12">
<div class="col-md-4">
<br />
<label> प्रश्न पत्र  </label>
</div>
<div class="col-md-6">
<br />
<input type="text" name="semester" class="form-control" placeholder="Qustion Paper">
</div>
</div>


<div class="col-md-12">
<div class="col-md-4">
<br />
<label>Topic</label>
</div>
<div class="col-md-6">
<br />
<input type="text" name="topic" class="form-control" placeholder="Topic">
</div>
</div>

<div class="col-md-12">
<div class="col-md-4">
<br />
<label>Teacher Name</label>
</div>
<div class="col-md-6">
<br />
<input type="text" name="tname" class="form-control" placeholder="Teacher Name">
</div>
</div>


<div class="col-md-12">
<div class="col-md-4">
<br />
<label>Audio Upload</label>
</div>
<div class="col-md-6">
<br />
<input type="file" name="audio" class="form-control" required="">
</div>
</div>
<div class="col-md-12">
<div class="col-md-4"></div>
<div class="col-md-6">
<br />
<input type="submit" name="sbtbtn" class="btn btn-primary">
</div>
</div>
</form>
<?php
if(isset($_POST["sbtbtn"]))
{
function test_input($data) 
{
$data = trim($data);
$data = stripslashes($data);
$data = htmlspecialchars($data, ENT_QUOTES, 'UTF-8');
return $data;
}

$sclass = test_input($_POST['course']);
$subject = test_input($_POST['subject']);
$semester = test_input($_POST['semester']);
$topic = test_input($_POST['topic']);
$tname = test_input($_POST['tname']);
// file
// upload files 
$updir = "../uploads/audio/";
$audio = $_FILES['audio']['name'];
$tmpaudio = $_FILES['audio']['tmp_name'];
$fileSize = $_FILES['audio']['size'];
$fileType = $_FILES['audio']['type'];
$filepath = $updir . $audio; 
move_uploaded_file($tmpaudio, $filepath);
$result = $con->prepare("insert into audio(class,subject,semester,topic,tname,audio) VALUES(:class,:subject,:semester,:topic,:tname,:audio)");
$result->bindParam(':class', $sclass);
$result->bindParam(':subject',$subject);
$result->bindParam(':semester',$semester);
$result->bindParam(':topic',$topic);
$result->bindParam(':tname',$tname);
$result->bindParam(':audio',$audio);
$result->execute();
echo "<script>alert('Success! audio has been uploaded.')</script>";
}
?>
</div>

</div>
</div>
</div>
</div>
</div>

<div class="row footer" style="border-top:5px dashed; color:#D500D5;">
<div class="container">
<?php require_once "footer.php"; ?>
</div>
</div>
<script type="text/javascript" src="http://arrow.scrolltotop.com/arrow13.js"></script> 
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">
$(function(){
$("#course").change(function(){
var course = $(this).val();
$.ajax({
type : "GET",
url : "fetch-subject.php",
data : {"course":course},
success : function(output){
$("#dynamic").html(output);
}
});
});
});
</script>
</body>
</html>