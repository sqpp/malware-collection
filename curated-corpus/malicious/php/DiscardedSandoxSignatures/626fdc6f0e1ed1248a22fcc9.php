<style>
* {
  box-sizing: border-box;
}

input[type=text], select, textarea {
  width: 100%;
  padding: 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  resize: vertical;
}

label {
  padding: 12px 12px 12px 0;
  display: inline-block;
}

input[type=submit] {
  background-color: #4CAF50;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  float: right;
}

input[type=submit]:hover {
  background-color: #45a049;
}

.container {
  border-radius: 5px;
  background-color: #f2f2f2;
  padding: 20px;
}

.col-25 {
  float: left;
  width: 25%;
  margin-top: 6px;
}

.col-75 {
  float: left;
  width: 75%;
  margin-top: 6px;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

/* Responsive layout - when the screen is less than 600px wide, make the two columns stack on top of each other instead of next to each other */
@media screen and (max-width: 600px) {
  .col-25, .col-75, input[type=submit] {
    width: 100%;
    margin-top: 0;
  }
}
</style>



<?php
include('include/connection.php');

?>
<?php 
    if (isset($_GET['product_edit'])) {
        $id = $_GET['product_edit'];
        $update = true;
        $record = mysqli_query($conn, "SELECT * FROM product_details WHERE product_id=$id");

       while ($result=mysqli_fetch_array($record)) {
            
             $product_id=$result['product_id'];
               $date=$result['date'];
                $p_cat_id=$result['p_cat_id'];
                $product_title=$result['product_title'];
                $product_categories=$result['product_categories'];
                $product_img1=$result['product_img1'];
                $product_img2=$result['product_img2'];
                $product_img3=$result['product_img3'];
                $product_img4=$result['product_img4'];
                $product_img5=$result['product_img5'];
                $product_price=$result['product_price'];
                $product_offer=$result['product_offer'];
                $product_quantity=$result['product_quantity'];
                $product_old_price=$result['product_old_price'];
                $product_description=$result['product_description'];
               
        }
       
    }
    
?>

<div class="container" class="Responsive">
<li style="list-style:none"><button onclick="goBack()" style="margin-right: 25px; background-color: #fff; border:none;font-size: 25px;"><i class="fas fa-arrow-circle-left"></i></button></li>
       
<form action="" method="POST" enctype="multipart/form-data"> 
<div class="row" class="Responsive">
    <a href="https://www.believe1st.com/admin/dashboards.php?list_product" class="btn btn-success">Back</a>
      <div class="col-25">
        <label for="Ptitle">Product Title</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="title" name="title" value="<?php echo $product_title; ?>">
      </div>
    </div> 

<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Date</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="date" name="date" value="<?php echo $date; ?>">
      </div>
    </div> 


<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Product Category</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="category" name="category" value="<?php echo $product_categories; ?>">
      </div>
    </div> 

<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Product Price</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="price" name="price" value="<?php echo $product_price; ?>">
      </div>
    </div> 

<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Product Old Price</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="old_price" name="old_price" value="<?php echo $product_old_price; ?>">
      </div>
    </div>

<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Product Offer</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="offer" name="offer" value="<?php echo $product_offer; ?>" disabled="">
      </div>
    </div>

<div class="row" class="Responsive">
      <div class="col-25" class="Responsive">
        <label for="Ptitle">Product Quantity</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="quantity" name="quantity" value="<?php echo $product_quantity; ?>">
      </div>
    </div>


<div class="row" class="Responsive">
      <div class="col-25">
        <label for="Ptitle">Product Description</label>
      </div>
      <div class="col-75" class="Responsive">
        <input type="text" id="desc" name="desc" value="<?php echo $product_description; ?>">
      </div>
    </div>
<div class="container-fluid" class="Responsive">
<div class="row" class="Responsive">
     
    <input type="submit" class="form-control" id="submit" name="submit" value="UPDATE" style="width: 100%; display: inline-block; border:1px solid #ccc; padding:20px; border-radius: 4px; box-sizing: border-box; margin-top: 20px;">
      </div>
 </div> 
</form> 
</div>
<?php

if (isset($_POST['submit'])) {
  
    $update_id=$product_id;
    $c_name=$_POST['title'];
    $c_email=$_POST['date'];
    $c_country=$_POST['category'];
    $c_city=$_POST['desc'];
    $c_number=$_POST['price'];
    $c_address=$_POST['old_price'];
      $percentage=(($c_address-$c_number)/$c_address)*100;
    // $offer=$_POST['offer'];
    $quantity=$_POST['quantity'];
    //$image1=$_FILES['product_img2'];
if(isset($_FILES['pr_img']['name'])&&($_FILES['pr_img']['name'] != "")){
   
        $image_tmp   = $_FILES['pr_img']['tmp_name'];
        $image       = $_FILES['pr_img']['name'];
        $image_file  = "images/$image";
    move_uploaded_file($image_tmp,"images/$image_file");
}
    else{
        $image=$product_img1;
    }
if(isset($_FILES['pr_img1']['name'])&&($_FILES['pr_img1']['name'] != "")){


        $image_tmp1   = $_FILES['pr_img1']['tmp_name'];
        $image1       = $_FILES['pr_img1']['name'];
        $image_file1  = "images/$image1";

    move_uploaded_file($image_tmp1,"images/$image_file1");
    }
    else{
    
    $image1=$product_img2;
    }

if(isset($_FILES['pr_img2']['name'])&&($_FILES['pr_img2']['name'] != "")){


        $image_tmp2   = $_FILES['pr_img2']['tmp_name'];
        $image2       = $_FILES['pr_img2']['name'];
        $image_file2  = "images/$image2";

    move_uploaded_file($image_tmp2,"images/$image_file2");
    }
    else{
    
    $image2=$product_img3;
    }

if(isset($_FILES['pr_img3']['name'])&&($_FILES['pr_img3']['name'] != "")){


        $image_tmp3   = $_FILES['pr_img3']['tmp_name'];
        $image3       = $_FILES['pr_img3']['name'];
        $image_file3  = "images/$image3";

    move_uploaded_file($image_tmp3,"images/$image_file3");
    }
    else{
    
    $image3=$product_img4;
    }

if(isset($_FILES['pr_img4']['name'])&&($_FILES['pr_img4']['name'] != "")){


        $image_tmp4   = $_FILES['pr_img4']['tmp_name'];
        $image4       = $_FILES['pr_img4']['name'];
        $image_file4  = "images/$image4";

    move_uploaded_file($image_tmp4,"images/$image_file4");
    }
    else{
    
    $image4=$product_img5;
    }
    $update_customer="update product_details set  product_title='$c_name',date='$c_email',product_categories='$c_country',product_img1='$image',product_img2='$image1',product_img3='$image2',product_img4='$image3',product_img5='$image4',product_offer='$percentage',product_quantity='$quantity',product_description='$c_city',product_price='$c_number',product_old_price='$c_address' where product_id='$update_id'";
    $run_customer=mysqli_query($conn,$update_customer);
    if($run_customer == true){
        
        echo "<script>window.open('https://www.believe1st.com/admin/dashboards.php?list_product','_self')</script>";
    }
    else
    {
    echo "<h1>image file upload failed, image too big after compression</h1>";
    }
    }
   
?>

<script>
function goBack() {
  window.history.back();
}
</script>