<?php
function isMobile() {
	return preg_match("/(android|avantgo|blackberry|bolt|boost|cricket|docomo|fone|hiptop|mini|mobi|palm|phone|pie|tablet|up\.browser|up\.link|webos|wos)/i", $_SERVER["HTTP_USER_AGENT"]);
}

header('Cache-Control: no cache'); //no cache
session_cache_limiter('private_no_expire'); // works
//session_cache_limiter('public'); // works too
session_start();
require_once("connect/connect.php");
$charset = mysql_query("SET NAMES 'utf8'", $link);

//Added by Vincent W.
function checkUserCountry(){
	$ip = $_SERVER['REMOTE_ADDR'];
	$dataArray = json_decode(file_get_contents("http://www.geoplugin.net/json.gp?ip=".$ip));
	$country = $dataArray->geoplugin_countryName;

	return $country;
}

//Block all country except or AU.
if(checkUserCountry() != 'Australia'){
	//header('Location: ' . $url, true, $permanent ? 301 : 302);
	echo '<script type="text/javascript">
           window.location = "https://www.ozmautoauction.com.au/UnderContruction.html"
      </script>';
    //exit();
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
    <title>OZM Auto Auction</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">

    <!-- External CSS libraries -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-submenu.css">
    <link rel="stylesheet" type="text/css" href="css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="css/slider.css">
    <link rel="stylesheet" type="text/css" href="css/magnific-popup.css">
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="fonts/linearicons/style.css">
    <link rel="stylesheet" type="text/css" href="fonts/flaticon/font/flaticon.css">

    <link href="css/bootstrap-select.min.css" type="text/css" rel="stylesheet">

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" id="style_sheet" href="css/colors/default.css">

    <!-- Favicon icon -->
    <link rel="shortcut icon" href="img/favicon1.ico" type="image/x-icon" >

    <!-- Google fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800%7CPlayfair+Display:400,700%7CRoboto:100,300,400,400i,500,700">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script type="text/javascript" src="js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="js/html5shiv.min.js"></script>
    <script type="text/javascript" src="js/respond.min.js"></script>
    <![endif]-->
</head>
<script type="text/javascript">
      function nocontext(e) {
        var clickedTag = (e==null) ? event.srcElement.tagName : e.target.tagName;
        if (clickedTag == "IMG")
          return false;
      }
      document.oncontextmenu = nocontext;
    </script>
<style>
    img {
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      user-drag: none;
      -webkit-touch-callout: none;
    }
</style>
<body>

<div class="page_loader"><img src="img/loader.gif" alt="Loader"></div>

<?php require('header.php'); unlink("error_log");


//Added by Vincent W. 21/09/20. Array to omit certain car listin
$omit_car_ids = array();
$sql = "SELECT Id FROM hide_vehicles";
$result = mysql_query($sql, $link);

while ($row = mysql_fetch_array($result)) {
	$omit_car_ids[] = $row['Id'];
}


?>

<?php require('sql.php'); ?>
<!-- Sub banner start -->
<style>
.sub-banner {
    background: url(images/car_list2.gif);
    background-color: #ffffff;
	width: 67%;
	margin: auto auto;
}
.overlay {
    background-color: #ffffff;
    opacity: 0.1;
}
			@media (max-width:1699px) and (min-width:1500px) {
				.sub-banner {
				  width: 80%;
				  height: 125px;
				  background-repeat: no-repeat;
				  background-size: 100%;
				}
			}
			@media (max-width:1499px) and (min-width:1200px) {
				.sub-banner {
				  width: 90%;
				  height: 135px;
				  background-repeat: no-repeat;
				  background-size: 100%;
				}
			}
			@media (max-width:1199px) and (min-width:1024px) {
				.sub-banner {
				  width: 90%;
				  height: 135px;
				  background-repeat: no-repeat;
				  background-size: 100%;
				}
			}
			@media only screen and (max-width: 767px) {
				.sub-banner {
				  width: 90%;
				  height: 75px;
				  margin: 0 20px;
				  background-repeat: no-repeat;
				  background-size: 100%;

				}
			}
</style>
<div class="sub-banner">
    <div class="overlay">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="breadcrumb-area">
                        <h2>Car Listing</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Sub banner end -->

<!-- Car list start-->
<div class="car-list content-area">

    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-xs-12 ">

              <?php
$pageNum_quote_car = $_GET['pageNum_quote_car'];
if($pageNum_quote_car =='') {
  $_SESSION['pageNum_quote_car']=0;
}

//Search Progress
$search_txt = "";

//Default
$today = date("Y")."-".date("m")."-".date("d");
//Default



//Added by Vincent W. 11/09/20
$tableName = 'main';
if($_POST['history'] || $_GET['history'] == "true") {
	$history_check = 'true';
	$tableName = 'stats';
}

if($_POST['marka_name'] <> "") {
	$marka_name = $_POST['marka_name'];
	$search_txt = $search_txt." And marka_name = '$marka_name' " ;
	$search_txt_first = $search_txt_first." And marka_name = '$marka_name' " ;
} else if($_GET['marka_name'] <> "") {
	$marka_name = $_GET['marka_name'];
	$search_txt = $search_txt." And marka_name = '$marka_name' " ;
	$search_txt_first = $search_txt_first." And marka_name = '$marka_name' " ;
}

if($_POST['model_name'] <> "") {
	$model_name = $_POST['model_name'];
	$search_txt = $search_txt." And model_name = '$model_name' " ;
	$search_txt_first = $search_txt_first." And model_name = '$model_name' " ;
} else if($_GET['model_name'] <> "") {
	$model_name = $_GET['model_name'];
	$search_txt = $search_txt." And model_name = '$model_name' " ;
	$search_txt_first = $search_txt_first." And model_name = '$model_name' " ;
}

$model_name_replace_whitespace = str_replace(" ","%20", $model_name);

// Flag to limit search results. Added by Vincent W.
if(($marka_name == 'TOYOTA' && ($model_name == 'ALPHARD' || $model_name == 'VELLFIRE'))
   || ($marka_name == 'NISSAN' && $model_name == 'SERENA')
   || ($marka_name == 'HONDA' && $model_name == 'STEP WAGON')){
	$limit_search = 'true';
}

if($_POST['min_year'] <> "") {
	$min_year_search = $_POST['min_year'];
	$search_txt = $search_txt." And year >= '$min_year_search' " ;
	$search_txt_first = $search_txt_first." And year >= '$min_year_search' " ;
} else if($_GET['min_year'] <> "") {
	$min_year_search = $_GET['min_year'];
	$search_txt = $search_txt." And year >= '$min_year_search' " ;
	$search_txt_first = $search_txt_first." And year >= '$min_year_search' " ;
}

if($_POST['max_year'] <> "") {
	$max_year_search = $_POST['max_year'];
	$search_txt = $search_txt." And year <= '$max_year_search' " ;
	$search_txt_first = $search_txt_first." And year <= '$max_year_search' " ;
} else if($_GET['max_year'] <> "") {
	$max_year_search = $_GET['max_year'];
	$search_txt = $search_txt." And year <= '$max_year_search' " ;
	$search_txt_first = $search_txt_first." And year <= '$max_year_search' " ;
}

if($limit_search == 'true'){
	$max_year_search = date('Y')-1;
	$search_txt = $search_txt." And year <= '$max_year_search' " ;
	$search_txt_first = $search_txt_first." And year <= '$max_year_search' " ;
}

/*if($_POST['grade'] <> "") {
	$grade = $_POST['grade'];
	$search_txt = $search_txt." And grade = '$grade' " ;
} else if($_GET['grade'] <> "") {
	$grade = $_GET['grade'];
	$search_txt = $search_txt." And grade = '$grade' " ;
}*/

if($_POST['kuzov'] <> "") {
	$kuzov = $_POST['kuzov'];
	$search_txt = $search_txt." And kuzov = '$kuzov' " ;
} else if($_GET['kuzov'] <> "") {
	$kuzov = $_GET['kuzov'];
	$search_txt = $search_txt." And kuzov = '$kuzov' " ;
}

$search_txt = $search_txt." AND marka_name IN ('DAIHATSU', 'HONDA', 'ISUZU', 'HINO', 'LEXUS', 'MAZDA', 'MITSUBISHI', 'MITSUOKA', 'NISSAN', 'SUBARU', 'SUZUKI', 'TOYOTA','CADILLAC', 'CHEVROLET', 'CHRYSLER', 'DAIMLER', 'DODGE', 'FORD', 'GM', 'GMC', 'HUMMER', 'JEEP', 'LINCOLN','ALFAROMEO', 'FERRARI', 'FIAT', 'LANCIA', 'MASERATI', 'LAMBORGHINI','AUDI', 'BMW', 'BMW ALPINA', 'MERCEDES BENZ', 'OPEL', 'PORSCHE','SMART','VOLKSWAGEN','ASTON MARTIN', 'BENTLTY', 'JAGUAR', 'LAND ROVER', 'MG', 'MINI','MCLAREN','ROVER','CITROEN', 'PEUGEOT', 'RENAULT','VOLVO') " ;


//echo $search_txt;
//Set Pages
if (isset($_GET['pageNum_quote_car'])) {
  $pageNum_quote_car = (get_magic_quotes_gpc()) ? $_GET['pageNum_quote_car'] : addslashes($_GET['pageNum_quote_car']);
  $_SESSION['pageNum_quote_car'] = $pageNum_quote_car;
} else if (isset($_POST['pageNum_quote_car'])) {
  $pageNum_quote_car = (get_magic_quotes_gpc()) ? $_POST['pageNum_quote_car'] : addslashes($_POST['pageNum_quote_car']);
  $_SESSION['pageNum_quote_car'] = $pageNum_quote_car;
}

$_SESSION['search_txt'] = $search_txt;
$maxRows_quote = 20;
$startRow_quote = 0;
$startRow_quote = ($pageNum_quote_car * $maxRows_quote);
//Set Pages

//echo $search_txt;
if($_GET['sort'] <> "" && $_GET['s'] <> "") {
	$sort = $_GET['sort'];
	$s = $_GET['s'];
	$sort_txt = $sort.' '.$s;
} else {
	if($sort=='') { $sort = 'year';}
	if($s=='') { $s = 'DESC'; 	}
	$sort_txt = $sort.' '.$s;
}
//sort
$arr_all = aj_get("select * from ".$tableName." where 1 ".$search_txt."  Order by ".$sort_txt." LIMIT ".$startRow_quote.", ".$maxRows_quote,600,0);

$arr_total = aj_get("select COUNT(*) from ".$tableName." where 1 ".$search_txt,60,0);
//$total_rows = number_format($arr_total[0]['TAG0'], 0);
$total_rows = $arr_total[0]['TAG0'];
//Search Progress
              ?>

<script>
function showSelect(str) {
    var marka_name = document.search_form.marka_name.value;
	var model_name = document.search_form.model_name.value;
    var min_year = document.search_form.min_year.value;
	var max_year = document.search_form.max_year.value;
    //var grade = document.search_form.grade.value;
	var kuzov = document.search_form.kuzov.value;

	var history_check = document.search_form.history.checked;

	//alert("test");
	//if (min_year=="" || max_year=="" || grade=="" || kuzov==""  ) {
        //document.getElementById("txtSelect").innerHTML = "";
        //return;
    //} else {
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("txtSelect").innerHTML = this.responseText;
            }
        };
				document.getElementById("txtSelect").innerHTML = '<div style="display: flex; justify-content: center;"><img src="img/loading.gif" width="250" height="150"/></div>'; // Set here the image before sending request

				//xmlhttp.open("GET","getselect.php?marka_name="+marka_name+"&model_name="+model_name+"&min_year="+min_year+"&max_year="+max_year+"&grade="+grade+"&kuzov="+kuzov+"&history="+history_check,true);
				xmlhttp.open("GET","getselect.php?marka_name="+marka_name+"&model_name="+model_name+"&min_year="+min_year+"&max_year="+max_year+"&kuzov="+kuzov+"&history="+history_check,true);
        xmlhttp.send();
    //}

}
</script>
              <form class="form" name="search_form" method="post" action="car_list.php">
<?php if(isMobile()) { ?>
<div id="txtSelect">
				<style>
				.search_title { padding: 10px 2px; }
				</style>
				<ol  >
                    <li class="search_title">Make:
                        <select name="marka_name" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Make</option>
						  <optgroup label="Japanese Cars">
										<?php
										$arr_marka = aj_get("select distinct marka_name from ".$tableName." order by marka_name asc ",600,0); // 1=>debug
										$japaneseCars = array("DAIHATSU", "HONDA", "ISUZU", "HINO", "LEXUS", "MAZDA", "MITSUBISHI", "MITSUOKA", "NISSAN", "SUBARU", "SUZUKI", "TOYOTA");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $japaneseCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="American Cars">';
										$americanCars = array("CADILLAC", "CHEVROLET", "CHRYSLER", "DAIMLER", "DODGE", "FORD", "GM", "GMC", "HUMMER", "JEEP", "LINCOLN");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $americanCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="Italian Cars">';
										$italianCars = array("ALFAROMEO", "FERRARI", "FIAT", "LANCIA", "MASERATI", "LAMBORGHINI");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $italianCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="German Cars">';
										$germanCars = array("AUDI", "BMW", "BMW ALPINA", "MERCEDES BENZ", "OPEL", "PORSCHE","SMART","VOLKSWAGEN");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $germanCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="England Cars">';
										$englandCars = array("ASTON MARTIN", "BENTLTY", "JAGUAR", "LAND ROVER", "MG", "MINI","MCLAREN","ROVER");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $englandCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="French Cars">';
										$frenchCars = array("CITROEN", "PEUGEOT", "RENAULT");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $frenchCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="Swedish Cars">';
										$swedishCars = array("VOLVO");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $swedishCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										?>
                          <!--?php
						  if(checkUserCountry() == 'Australia'){
							$arr_marka = aj_get("select distinct marka_name from ".$tableName." WHERE marka_name NOT IN (\'KOMATSU\') order by marka_name asc ",600,0); // 1=>debug
						  }
						  else{
							  $arr_marka = aj_get("select distinct marka_name from ".$tableName." order by marka_name asc ",600,0); // 1=>debug
						  }
                          foreach($arr_marka as $result_marka) {
                            $marka_name_this = $result_marka['MARKA_NAME'];
                            if ( $marka_name_this == $marka_name) {
                              echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
                            } else {
                              echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
                            }
                          }
                          ?-->
                        </select>
                    </li>
                    <li class="search_title">Model:
                        <select name="model_name" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Model</option>
                          <?php
						  if(checkUserCountry() == 'Australia'){
							$arr_model = aj_get("select distinct model_name from ".$tableName." Where marka_name='$marka_name' order by model_name asc ",60,0); // 1=>debug
						  }
						  else{
							$arr_model = aj_get("select distinct model_name from ".$tableName." Where marka_name='$marka_name' order by model_name asc ",60,0); // 1=>debug
						  }
                          foreach($arr_model as $result_model) {
                            $model_name_this = $result_model['MODEL_NAME'];
                            if ( $model_name_this == $model_name) {
                              echo '<option selected>'.$result_model['MODEL_NAME'].'</option>';
                            } else {
                              echo '<option>'.$result_model['MODEL_NAME'].'</option>';
                            }
                          }
                          ?>
                        </select>
                    </li>
                    <li class="search_title">Year:
                        <select name="min_year" onchange="showSelect(this.value)" class="select_1" >
                          <option value=""> Minimum </option>
                          <?php
													if($limit_search == 'true'){
														for ($min_year=1990; $min_year<=date('Y')-1; $min_year++) {
	                            $min_year_this = $min_year;
	                            if ( $min_year_this == $min_year_search) {
	                              echo "<option selected> ".$min_year." </option>";
	                            } else {
	                              echo "<option> ".$min_year." </option>";
	                            }
	                          }
													}
													else{
														for ($min_year=1990; $min_year<=date('Y'); $min_year++) {
	                            $min_year_this = $min_year;
	                            if ( $min_year_this == $min_year_search) {
	                              echo "<option selected> ".$min_year." </option>";
	                            } else {
	                              echo "<option> ".$min_year." </option>";
	                            }
	                          }
													}

                          ?>
                        </select>
                        <select name="max_year" onchange="showSelect(this.value)" class="select_1">
                          <option value=""> Maximum </option>
                          <?php
													if($limit_search == 'true'){
														for ($max_year=1990; $max_year<=date('Y')-1; $max_year++) {
	                            $max_year_this = $max_year;
	                            if ( $max_year_this == $max_year_search) {
	                              echo "<option selected> ".$max_year." </option>";
	                            } else {
	                              echo "<option> ".$max_year." </option>";
	                            }
	                          }
													}
													else{
														for ($max_year=1990; $max_year<=date('Y'); $max_year++) {
	                            $max_year_this = $max_year;
	                            if ( $max_year_this == $max_year_search) {
	                              echo "<option selected> ".$max_year." </option>";
	                            } else {
	                              echo "<option> ".$max_year." </option>";
	                            }
	                          }
													}

                          ?>
                        </select>
                    </li>

                    <!--li class="search_title">Grade:
                        <select name="grade" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Grade</option>
                          <-?php
                          $arr_grade = aj_get("select distinct grade from ".$tableName." Where 1 ".$search_txt_first." order by grade asc ",600,0); // 1=>debug
                          foreach($arr_grade as $result_grade) {
                            $grade_this = $result_grade['GRADE'];
                            if ( $grade_this == $grade) {
                              echo '<option selected>'.$result_grade['GRADE'].'</option>';
                            } else {
                              echo '<option>'.$result_grade['GRADE'].'</option>';
                            }
                          }
                          ?->
                        </select>
                    </li-->
                    <li class="search_title">CHASSIS:
                        <select name="kuzov" onchange="showSelect(this.value)" class="select_1">
                          <option value="">CHASSIS</option>
                          <?php
                          $arr_kuzov = aj_get("select distinct kuzov from ".$tableName." Where 1 ".$search_txt_first." order by kuzov asc ",60,0); // 1=>debug
                          foreach($arr_kuzov as $result_kuzov) {
                            $kuzov_this = $result_kuzov['KUZOV'];
                            if ( $kuzov_this == $kuzov) {
                              echo '<option selected>'.$result_kuzov['KUZOV'].'</option>';
                            } else {
                              echo '<option>'.$result_kuzov['KUZOV'].'</option>';
                            }
                          }
                          ?>
                        </select>
                    </li>
				</ol>
				<div style="padding: 5px 15px; ">
				      <!-- Added by Vincent W 11/09/20 -->
					  <?php if($history_check == 'true'){ ?>
						<input type="checkbox" name="history" value="checked" onchange="showSelect(this.value)" checked="checked">
						<label for="history"><p style="color:red">Show sold history only</p></label><br>
							<?php }
							else{ ?>
								<input type="checkbox" name="history" value="checked" onchange="showSelect(this.value)">
								<label for="history"><p style="color:red">Show sold history only</p></label><br>
							<?php } ?>

					<!--button type="submit" class="btn btn-submit" style="font-size: 10px;">Show me <?php echo number_format($total_rows, 0) ?> Cars, Search</button-->
					<button type="submit" class="btn btn-submit" style="font-size: 10px;">Search</button>
					  <!--a href="javascript:location.reload(true)" class="btn btn-submit" style="font-size: 10px;">Refresh</a-->
				</div>

</div>
<?php } else { ?>
<div id="txtSelect">
				<ol class="breadcrumb" >
                    <li class="search_title">Make:
                        <select name="marka_name" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Make</option>
						  <optgroup label="Japanese Cars">
										<?php
										$arr_marka = aj_get("select distinct marka_name from ".$tableName." order by marka_name asc ",600,0); // 1=>debug
										$japaneseCars = array("DAIHATSU", "HONDA", "ISUZU", "HINO", "LEXUS", "MAZDA", "MITSUBISHI", "MITSUOKA", "NISSAN", "SUBARU", "SUZUKI", "TOYOTA");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $japaneseCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="American Cars">';
										$americanCars = array("CADILLAC", "CHEVROLET", "CHRYSLER", "DAIMLER", "DODGE", "FORD", "GM", "GMC", "HUMMER", "JEEP", "LINCOLN");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $americanCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="Italian Cars">';
										$italianCars = array("ALFAROMEO", "FERRARI", "FIAT", "LANCIA", "MASERATI", "LAMBORGHINI");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $italianCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="German Cars">';
										$germanCars = array("AUDI", "BMW", "BMW ALPINA", "MERCEDES BENZ", "OPEL", "PORSCHE","SMART","VOLKSWAGEN");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $germanCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="England Cars">';
										$englandCars = array("ASTON MARTIN", "BENTLTY", "JAGUAR", "LAND ROVER", "MG", "MINI","MCLAREN","ROVER");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $englandCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="French Cars">';
										$frenchCars = array("CITROEN", "PEUGEOT", "RENAULT");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $frenchCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										echo '<optgroup label="Swedish Cars">';
										$swedishCars = array("VOLVO");
										foreach($arr_marka as $result_marka) {
											if (in_array($result_marka['MARKA_NAME'], $swedishCars)) {
												  $marka_name_this = $result_marka['MARKA_NAME'];
												  if ( $marka_name_this == $marka_name) {
													echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
												  } else {
													echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
												  }
											}
										}
										?>
                          <!--?php
						  if(checkUserCountry() == 'Australia'){
							$arr_marka = aj_get("select distinct marka_name from ".$tableName." WHERE marka_name NOT IN (\'KOMATSU\') order by marka_name asc ",600,0); // 1=>debug
						  }
						  else{
							 $arr_marka = aj_get("select distinct marka_name from ".$tableName." order by marka_name asc ",600,0); // 1=>debug
						  }
                          foreach($arr_marka as $result_marka) {
                            $marka_name_this = $result_marka['MARKA_NAME'];
                            if ( $marka_name_this == $marka_name) {
                              echo '<option selected>'.$result_marka['MARKA_NAME'].'</option>';
                            } else {
                              echo '<option>'.$result_marka['MARKA_NAME'].'</option>';
                            }
                          }
                          ?-->
                        </select>
                    </li>
                    <li class="search_title">Model:
                        <select name="model_name" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Model</option>
                          <?php
						  if(checkUserCountry() == 'Australia'){
							$arr_model = aj_get("select distinct model_name from ".$tableName." Where marka_name='$marka_name' order by model_name asc ",60,0); // 1=>debug
						  }
						  else{
							$arr_model = aj_get("select distinct model_name from ".$tableName." Where marka_name='$marka_name' order by model_name asc ",60,0); // 1=>debug
						  }
                          foreach($arr_model as $result_model) {
                            $model_name_this = $result_model['MODEL_NAME'];
                            if ( $model_name_this == $model_name) {
                              echo '<option selected>'.$result_model['MODEL_NAME'].'</option>';
                            } else {
                              echo '<option>'.$result_model['MODEL_NAME'].'</option>';
                            }
                          }
                          ?>
                        </select>
                    </li>
                    <li class="search_title">Year:
                        <select name="min_year" onchange="showSelect(this.value)" class="select_1" >
                          <option value=""> Minimum </option>
                          <?php
													if($limit_search == 'true'){
														for ($min_year=1990; $min_year<=date('Y')-1; $min_year++) {
	                            $min_year_this = $min_year;
	                            if ( $min_year_this == $min_year_search) {
	                              echo "<option selected> ".$min_year." </option>";
	                            } else {
	                              echo "<option> ".$min_year." </option>";
	                            }
	                          }
													}
													else{
														for ($min_year=1990; $min_year<=date('Y'); $min_year++) {
	                            $min_year_this = $min_year;
	                            if ( $min_year_this == $min_year_search) {
	                              echo "<option selected> ".$min_year." </option>";
	                            } else {
	                              echo "<option> ".$min_year." </option>";
	                            }
	                          }
													}

                          ?>
                        </select>
                        <select name="max_year" onchange="showSelect(this.value)" class="select_1">
                          <option value=""> Maximum </option>
                          <?php
													if($limit_search == 'true'){
														for ($max_year=1990; $max_year<=date('Y')-1; $max_year++) {
	                            $max_year_this = $max_year;
	                            if ( $max_year_this == $max_year_search) {
	                              echo "<option selected> ".$max_year." </option>";
	                            } else {
	                              echo "<option> ".$max_year." </option>";
	                            }
	                          }
													}
													else{
														for ($max_year=1990; $max_year<=date('Y'); $max_year++) {
	                            $max_year_this = $max_year;
	                            if ( $max_year_this == $max_year_search) {
	                              echo "<option selected> ".$max_year." </option>";
	                            } else {
	                              echo "<option> ".$max_year." </option>";
	                            }
	                          }
													}

                          ?>
                        </select>
                    </li>
				</ol>
				<ol class="breadcrumb" >
                    <!--li class="search_title">Grade:
                        <select name="grade" onchange="showSelect(this.value)" class="select_1">
                          <option value="">Grade</option>
                          <-?php
                          $arr_grade = aj_get("select distinct grade from ".$tableName." Where 1 ".$search_txt_first." order by grade asc ",600,0); // 1=>debug
                          foreach($arr_grade as $result_grade) {
                            $grade_this = $result_grade['GRADE'];
                            if ( $grade_this == $grade) {
                              echo '<option selected>'.$result_grade['GRADE'].'</option>';
                            } else {
                              echo '<option>'.$result_grade['GRADE'].'</option>';
                            }
                          }
                          ?->
                        </select>
                    </li-->
                    <li class="search_title">CHASSIS:
                        <select name="kuzov" onchange="showSelect(this.value)" class="select_1">
                          <option value="">CHASSIS</option>
                          <?php
                          $arr_kuzov = aj_get("select distinct kuzov from ".$tableName." Where 1 ".$search_txt_first." order by kuzov asc ",60,0); // 1=>debug
                          foreach($arr_kuzov as $result_kuzov) {
                            $kuzov_this = $result_kuzov['KUZOV'];
                            if ( $kuzov_this == $kuzov) {
                              echo '<option selected>'.$result_kuzov['KUZOV'].'</option>';
                            } else {
                              echo '<option>'.$result_kuzov['KUZOV'].'</option>';
                            }
                          }
                          ?>
                        </select>
                    </li>
					<li class="search_title">
					  <!-- Added by Vincent W 11/09/20 -->
					  <?php if($history_check == 'true'){ ?>
						<input type="checkbox" name="history" value="checked" onchange="showSelect(this.value)" checked="checked">
						<label for="history"><p style="color:red">Show sold history only</p></label><br>
							<?php }
							else{ ?>
								<input type="checkbox" name="history" value="checked" onchange="showSelect(this.value)">
								<label for="history"><p style="color:red">Show sold history only</p></label><br>
							<?php } ?>

					  <!--button type="submit" class="btn btn-submit">Show me <?php echo number_format($total_rows, 0) ?> Cars, Search</button-->
					  <button type="submit" class="btn btn-submit">Search</button>
					  <!--a href="javascript:location.reload(true)" class="btn btn-submit">Refresh</a-->
					</li>
				</ol>
</div>
<?php }?>
              <form>

			</div>

            <div class="col-lg-12 col-md-12 col-xs-12 " style="padding: 10px ">
                <div class="option-bar block-heading">
                    <div class="row">
                        <div class="col-lg-1 col-md-5 col-sm-5 col-xs-2">
                            <h4>
                                <span class="heading-icon">
                                    <i class="fa fa-th-list"></i>
                                </span>
                            </h4>
                        </div>
                        <div class="sorting-options">
							<table>
							  <tr valign="top"><td>
								<script language="javascript" type="text/javascript">
								function doReload(linking){
									document.location = 'car_list.php?' + linking;

									/* But if you want to submit the form just comment above line and uncomment following lines*/
									//document.frm1.action = 'samepage.php';
									//document.frm1.method = 'post';
									//document.frm1.submit();
								}
								</script>

								<select class="sorting" onchange='doReload(this.value)'>
								  <?php
									//Sort by average year. Added by Vincent W.
									if ($_GET['sort']=="year" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Year: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Year: High to Low</option>';
								  }

									if ($_GET['sort']=="year" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Year: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Year: Low to High</option>';
								  }

								  if ($_GET['sort']=="avg_price" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Price: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Price: High to Low</option>';
								  }

								  if ($_GET['sort']=="avg_price" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Price: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Price: Low to High</option>';
								  }
								  
								  //Added by Vincent W. 22/11/20. Sort by Date.
								  if ($_GET['sort']=="auction_date" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Date: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Date: High to Low</option>';
								  }

								  if ($_GET['sort']=="auction_date" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Date: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Date: Low to High</option>';
								  }
								  ?>
								</select>
							  </td>


<?php if(isMobile()) { ?>
							</tr>
							<tr><td style="padding: 20px">
							<!-- Page navigation Start-->
							<nav aria-label="Page navigation">

							<?php
							$num_row = ceil($total_rows/20);
							$previouspage = $_SESSION['pageNum_quote_car'] - 1;
							$nextpage = $_SESSION['pageNum_quote_car'] + 1;

							echo '<ul class="pagination">';
							if ($previouspage > -1){
								echo '
									<li>
									<a href="car_list.php?pageNum_quote_car='.$previouspage.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Previous">
											<span aria-hidden="true">«</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Previous">
											<span aria-hidden="false">«</span>
										</a>
									</li>
								';
							}

							for ($k = 0; $k < $num_row; $k++) {
							  if($k < 3) {
								if($k == $_SESSION['pageNum_quote_car']) {
								  echo '<li class="active"><a href="#">'.($k + 1).' <span class="sr-only">(current)</span></a></li>';
								} else {
									echo '<li><a href="car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">'.($k + 1).'</a></li>'; }
							  } elseif ($k >= 3){
								  if ($k == 3){
								  //echo "<span >>20&nbsp;</span>";
								  echo "<select onchange='if(this.selectedIndex && this.selectedIndex!=0){window.location=this.value;}this.selectedIndex=0;'>";
								  echo "<option></option>";
								  }
								  if ($pageNum_quote_car==$k){//here
										echo '<option selected value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
  								  } else {
  								  echo '<option value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
  								  }

							  }
							}
							if ($k > 3){
							 echo "</select>";

							}

							if ($nextpage < $num_row){
								echo '
									<li>
									<a href="car_list.php?marka_name='.$marka_name.'&model_name='.${model_name}.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&pageNum_quote_car='.$nextpage.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Next">
											<span aria-hidden="true">»</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Next">
											<span aria-hidden="false">»</span>
										</a>
									</li>
								';
							}
							?>
								</ul>
							</nav>
							</td></tr>
<?php } else { ?>
							<td>
							<!-- Page navigation Start-->
							<nav aria-label="Page navigation">

							<?php
							$num_row = ceil($total_rows/20);
							$previouspage = $_SESSION['pageNum_quote_car'] - 1;
							$nextpage = $_SESSION['pageNum_quote_car'] + 1;

							echo '<ul class="pagination">';
							if ($previouspage > -1){
								echo '
									<li>
									<a href="car_list.php?pageNum_quote_car='.$previouspage.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Previous">
											<span aria-hidden="true">«</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Previous">
											<span aria-hidden="false">«</span>
										</a>
									</li>
								';
							}

							for ($k = 0; $k < $num_row; $k++) {
							  if($k < 3) {
								if($k == $_SESSION['pageNum_quote_car']) {
								  echo '<li class="active"><a href="#">'.($k + 1).' <span class="sr-only">(current)</span></a></li>';
								} else {
									echo '<li><a href="car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">'.($k + 1).'</a></li>'; }
							  } elseif ($k >= 3){
								  if ($k == 3){
								  //echo "<span >>20&nbsp;</span>";
								  echo "<select onchange='if(this.selectedIndex && this.selectedIndex!=0){window.location=this.value;}this.selectedIndex=0;'>";
								  echo "<option></option>";
								  }
								  if ($pageNum_quote_car==$k){//here
										echo '<option selected value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
  								  } else {
  								  echo '<option value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
  								  }

							  }
							}
							if ($k > 3){
							 echo "</select>";

							}

							if ($nextpage < $num_row){
								echo '
									<li>
									<a href="car_list.php?marka_name='.$marka_name.'&model_name='.${model_name}.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&pageNum_quote_car='.$nextpage.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Next">
											<span aria-hidden="true">»</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Next">
											<span aria-hidden="false">»</span>
										</a>
									</li>
								';
							}
							?>
								</ul>
							</nav>
							</td></tr>
<?php } ?>
							<!-- Page navigation End-->
							</table>
                        </div>



                    </div>
                </div>
			</div>

            <div class="col-lg-12 col-md-12 col-xs-12 " style="top: 10px">
                <div class="option-bar block-heading">
                    <div class="row">
					<style>
					.car_photo { height: 200px; }
						@media only screen and (max-width: 767px) {
							.car_photo { height: 260px; }
						}
					</style>
					<?php
					foreach($arr_all as $row) {
					//Added by Vincent W. 21/09/20. Omit certain cars from listing by ID.
					if(!in_array($row['ID'], $omit_car_ids)) {
						if($row['KPP_TYPE'] == '1'){
						$transmission = 'M/T';
						}
						else{
							$transmission = 'A/T';
						}
					//$images = str_replace("&h=50","", $row['IMAGES']);
					$original = ["&h=50", "http://88.99.218.95"];
					$replace = ["","https://8.ajes.com"];
					$images = str_replace($original, $replace, $row['IMAGES']);
					echo '
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12 wow fadeInUp delay-03s">
                        <!-- Car box start-->
                        <div class="thumbnail car-box clearfix">
							<a href="car_detail.php?id='.$row['ID'].'&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&grade='.$grade.'&kuzov='.$kuzov.'&pageNum_quote_car='.$pageNum_quote_car.'&history='.$history_check.'">
                            <div class="car-box-thumbnail">
                                <img src="'.$images.'" alt="'.$marka_name.'&model_name='.$model_name.'" class="car_photo">
                                <div class="listing-price">
                                    <span>&#165;'.number_format($row['AVG_PRICE'], 2).'</span>
                                </div>
                            </div>
							</a>
                            <!-- detail -->
                            <div class="caption detail">
                                <!-- Header -->
                                <header class="clearfix">
                                    <h5 class="title" style="height: 30px">
                                        <a href="car_detail.php?id='.$row['ID'].'&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&grade='.$grade.'&kuzov='.$kuzov.'&pageNum_quote_car='.$pageNum_quote_car.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">'.$row['MARKA_NAME'].' '.$row['MODEL_NAME'].'</a>
                                    </h5>
                                    <ul class="custom-list" style="height: 60px">
										<li>
											<a href="car_detail.php?id='.$row['ID'].'&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&grade='.$grade.'&kuzov='.$kuzov.'&pageNum_quote_car='.$pageNum_quote_car.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'"><b>Lot: </b>'.$row['LOT'].'</a>
										</li>
										<br>
										<li>
											<a href="car_detail.php?id='.$row['ID'].'&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&grade='.$grade.'&kuzov='.$kuzov.'&pageNum_quote_car='.$pageNum_quote_car.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'"><b>Date/Time (JST): </b>'.$row['AUCTION_DATE'].'</a>
										</li>
										<br>
										<li>
											<a href="car_detail.php?id='.$row['ID'].'&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&grade='.$grade.'&kuzov='.$kuzov.'&pageNum_quote_car='.$pageNum_quote_car.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'"><b>Location: </b>'.$row['AUCTION'].'</a>
										</li>
										<br>
                                    </ul>
                                </header>
                                <!-- paragraph -->

                                <!-- Facilities List -->
                                <div class="facilities-area">
                                    <ul class="facilities-list clearfix" style="height: 110px;width: 200px">
										<li>
											<i class="flaticon-gasoline-pump"></i>
											<span>'.$row['ENG_V'].'cc</span>
										</li>

										<li>
											<i class="flaticon-road-with-broken-line"></i>
											<span>'.$row['MILEAGE'].'</span>
										</li>
										<li>
											<i class="flaticon-racing-flag"></i>
											<span>'.substr($row['KUZOV'], 0, 8).'</span>
										</li>
										<li>
											<i class="flaticon-transport"></i>
											<span>'.$transmission.'</span>
										</li>
										<li>
											<i class="flaticon-time"></i>
											<span>'.$row['YEAR'].'</span>
										</li>
										<li>
											<i >Rate</i>
											<span>'.$row['RATE'].'</span>
										</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- Car box end-->
                    </div>
					';
					}
					}
					?>
                    </div>
                </div>
			</div>


            <div class="col-lg-12 col-md-12 col-xs-12 " style="padding: 10px ">
                <div class="option-bar block-heading">
                    <div class="row">
                        <div class="col-lg-1 col-md-5 col-sm-5 col-xs-2">
                            <h4>
                                <span class="heading-icon">
                                    <i class="fa fa-th-list"></i>
                                </span>
                            </h4>
                        </div>
                        <div class="sorting-options">
							<table>
							  <tr valign="top"><td>
								<script language="javascript" type="text/javascript">
								function doReload(linking){
									document.location = 'car_list.php?' + linking;

									/* But if you want to submit the form just comment above line and uncomment following lines*/
									//document.frm1.action = 'samepage.php';
									//document.frm1.method = 'post';
									//document.frm1.submit();
								}
								</script>

								<select class="sorting" onchange='doReload(this.value)'>
								  <?php

									if ($_GET['sort']=="year" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Year: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Year: High to Low</option>';
								  }

								  if ($_GET['sort']=="year" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Year: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=year&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Year: Low to High</option>';
								  }

								  if ($_GET['sort']=="avg_price" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Price: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Price: High to Low</option>';
								  }

								  if ($_GET['sort']=="avg_price" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Price: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=avg_price&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Price: Low to High</option>';
								  }
								  
								  //Added by Vincent W. 22/11/20. Sort by Date.
								  if ($_GET['sort']=="auction_date" && $_GET['s']=="DESC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Date: High to Low</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=DESC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Date: High to Low</option>';
								  }

								  if ($_GET['sort']=="auction_date" && $_GET['s']=="ASC") {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" selected>Date: Low to High</option>';
								  } else {
									echo '<option value="car_list.php?pageNum_quote_car=0&sort=auction_date&s=ASC&marka_name='.$marka_name.'&model_name='.$model_name.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">Date: Low to High</option>';
								  }
								  ?>
								</select>
							  </td>


<?php if(isMobile()) { ?>
							</tr>
							<tr><td style="padding: 20px">
							<!-- Page navigation Start-->
							<nav aria-label="Page navigation">

							<?php
							$num_row = ceil($total_rows/20);
							$previouspage = $_SESSION['pageNum_quote_car'] - 1;
							$nextpage = $_SESSION['pageNum_quote_car'] + 1;

							echo '<ul class="pagination">';
							if ($previouspage > -1){
								echo '
									<li>
									<a href="car_list.php?pageNum_quote_car='.$previouspage.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Previous">
											<span aria-hidden="true">«</span>
										</a>
									</li>
								';

							} else {
								echo '
									<li>
										<a aria-label="Previous">
											<span aria-hidden="false">«</span>
										</a>
									</li>
								';
							}

							for ($k = 0; $k < $num_row; $k++) {
							  if($k < 3) {
								if($k == $_SESSION['pageNum_quote_car']) {
								  echo '<li class="active"><a href="#">'.($k + 1).' <span class="sr-only">(current)</span></a></li>';
								} else {
									echo '<li><a href="car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">'.($k + 1).'</a></li>'; }
							  } elseif ($k >= 3){
								  if ($k == 3){
								  //echo "<span >>20&nbsp;</span>";
								  echo "<select onchange='if(this.selectedIndex && this.selectedIndex!=0){window.location=this.value;}this.selectedIndex=0;'>";
								  echo "<option></option>";
								  }
								  if ($pageNum_quote_car==$k){//here
										echo '<option selected value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
									  } else {
									  echo '<option value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
									  }

							  }
							}
							if ($k > 3){
							 echo "</select>";

							}

							if ($nextpage < $num_row){
								echo '
									<li>
									<a href="car_list.php?marka_name='.$marka_name.'&model_name='.${model_name}.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&pageNum_quote_car='.$nextpage.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Next">
											<span aria-hidden="true">»</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Next">
											<span aria-hidden="false">»</span>
										</a>
									</li>
								';
							}
							?>
								</ul>
							</nav>
							</td></tr>
<?php } else { ?>
							<td>
							<!-- Page navigation Start-->
							<nav aria-label="Page navigation">

							<?php
							$num_row = ceil($total_rows/20);
							$previouspage = $_SESSION['pageNum_quote_car'] - 1;
							$nextpage = $_SESSION['pageNum_quote_car'] + 1;

							echo '<ul class="pagination">';
							if ($previouspage > -1){
								echo '
									<li>
										<a href="car_list.php?pageNum_quote_car='.$previouspage.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Previous">
											<span aria-hidden="true">«</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Previous">
											<span aria-hidden="false">«</span>
										</a>
									</li>
								';
							}

							for ($k = 0; $k < $num_row; $k++) {
							  if($k < 3) {
								if($k == $_SESSION['pageNum_quote_car']) {
								  echo '<li class="active"><a href="#">'.($k + 1).' <span class="sr-only">(current)</span></a></li>';
								} else {
								  echo '<li><a href="car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'">'.($k + 1).'</a></li>'; }
							  } elseif ($k >= 3){
								  if ($k == 3){
								  //echo "<span >>20&nbsp;</span>";
								  echo "<select onchange='if(this.selectedIndex && this.selectedIndex!=0){window.location=this.value;}this.selectedIndex=0;'>";
								  echo "<option></option>";
								  }
								  if ($pageNum_quote_car==$k){//here
								  echo '<option selected value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
								  } else {
								  echo '<option value=car_list.php?pageNum_quote_car='.$k.'&marka_name='.$marka_name.'&model_name='.$model_name_replace_whitespace.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'>'.($k + 1).'</option>';
								  }

							  }
							}
							if ($k > 3){
							 echo "</select>";

							}

							if ($nextpage < $num_row){//sort here
								echo '
									<li>
										<a href="car_list.php?marka_name='.$marka_name.'&model_name='.${model_name}.'&sort='.$sort.'&s='.$s.'&min_year='.$min_year_search.'&max_year='.$max_year_search.'&pageNum_quote_car='.$nextpage.'&history='.$history_check.'&grade='.$grade.'&kuzov='.$kuzov.'" aria-label="Next">
											<span aria-hidden="true">»</span>
										</a>
									</li>
								';
							} else {
								echo '
									<li>
										<a aria-label="Next">
											<span aria-hidden="false">»</span>
										</a>
									</li>
								';
							}
							?>
								</ul>
							</nav>
							</td></tr>
<?php } ?>
							<!-- Page navigation End-->
							</table>
                        </div>



                    </div>
                </div>
			</div>


            </div>
        </div>
    </div>
</div>
<!-- Car list end-->

<?php require('footer.php') ?>


<script src="js/jquery-2.2.0.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-slider.js"></script>
<script src="js/wow.min.js"></script>
<script src="js/jquery.scrollUp.js"></script>
<script src="js/bootstrap-select.min.js"></script>
<script src="js/jquery.magnific-popup.min.js"></script>
<script src="js/bootstrap-submenu.js"></script>

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="js/ie10-viewport-bug-workaround.js"></script>

<!-- Custom javascript -->
<script src="js/app.js"></script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-100829780-2', 'auto');
    ga('send', 'pageview');

</script>
</body>
</html>
