<?php
ini_set('display_errors',false);
ini_set('safe_mode',false);
ini_set('allow_url_fopen',true);
ini_set('allow_url_include',true);
require_once 'AAEncoder.php';
//require_once 'packer/class.JavaScriptPacker.php';
require_once 'packers.php';
$domain = $_SERVER['HTTP_HOST'];
$domainx  =$_SERVER['HTTP_REFERER'];
/*
if ( $domainx  == null ){
	header ("location:https://svr.nextsite.me");
	die();
}
*/
function curl($url){	
	$ch = @curl_init();
	curl_setopt($ch, CURLOPT_URL, $url);
	$ip=rand(0,255).'.'.rand(0,255).'.'.rand(0,255).'.'.rand(0,255);
	curl_setopt($ch, CURLOPT_HTTPHEADER, array("REMOTE_ADDR: $ip", "HTTP_X_FORWARDED_FOR: $ip"));
	curl_setopt($ch,CURLOPT_USERAGENT,$_SERVER['HTTP_USER_AGENT']);
	curl_setopt($ch, CURLOPT_COOKIEJAR, '/cookie_xvideos.txt');
   	curl_setopt($ch, CURLOPT_COOKIEFILE, '/cookie_xvideos.txt'); 
	curl_setopt($ch, CURLOPT_HEADER, 0);
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	curl_setopt($ch, CURLOPT_REFERER, $url);
	curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
	curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
	curl_setopt($ch, CURLOPT_TIMEOUT, 120);
	curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 60);
	curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);
	$page = curl_exec($ch);
	curl_close($ch);
	return $page;
}
//echo $domain ;
$urlidx = $_GET['v'];
if(strpos($urlidx,'jkt')){}else{ die(); }
$idx = explode('*',$urlidx);
function XTUBEIDdecodeX($en){
	$en=str_replace("bdg","=",$en);
	$en=str_replace("sby","2",$en);
	$en=str_replace("jkt","a",$en);
	$en =base64_decode($en);
	return $en;
}
$urlid = XTUBEIDdecodeX($idx[1]);
$ambilhtml= curl ("http://localhost/wp-content/plugins/xtubeid-plugins/playLoadADS.php?v=".$urlidx);
function minifyJavascriptCode($javascript){
$blocks = array('for', 'while', 'if', 'else');
$javascript = preg_replace('/([-\+])\s+\+([^\s;]*)/', '$1 (+$2)', $javascript);
// remove new line in statements
$javascript = preg_replace('/\s+\|\|\s+/', ' || ', $javascript);
$javascript = preg_replace('/\s+\&\&\s+/', ' && ', $javascript);
$javascript = preg_replace('/\s*([=+-\/\*:?])\s*/', '$1 ', $javascript);
// handle missing brackets {}
foreach ($blocks as $block){
$javascript = preg_replace('/(\s*\b' . $block . '\b[^{\n]*)\n([^{\n]+)\n/i', '$1{$2}', $javascript);
}
// handle spaces
$javascript = preg_replace(array("/\s*\n\s*/", "/\h+/"), array("\n", " "), $javascript); // \h+ horizontal white space
$javascript = preg_replace(array('/([^a-z0-9\_])\h+/i', '/\h+([^a-z0-9\$\_])/i'), '$1', $javascript);
$javascript = preg_replace('/\n?([[;{(\.+-\/\*:?&|])\n?/', '$1', $javascript);
$javascript = preg_replace('/\n?([})\]])/', '$1', $javascript);
$javascript = str_replace("\nelse", "else", $javascript);
$javascript = preg_replace("/([^}])\n/", "$1;", $javascript);
$javascript = preg_replace("/;?\n/", ";", $javascript);
return $javascript;
}

$filter=explode('jwplayer("player").setup({',$ambilhtml);
$filterakhir=explode('<',$filter[1]);
$script ='jwplayer("player").setup({'.$filterakhir[0];
$script = minifyJavascriptCode ($script);
$packer = new Packer($script ,'Normal',true,false);
$packed = $packer->pack();

?>
<!DOCTYPE html>
<html lang="en">
<head>
<title>video</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta content="utf-8" http-equiv="encoding">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<meta name="robots" content="noindex,nofollow">
<?php
if(strpos($urlid,"google") || strpos($urlid,"videos.files.wordpress.com")) {echo'<script type="text/javascript" src="//content.jwplatform.com/libraries/0P4vdmeO.js"></script>
<script type="text/javascript">jwplayer.key="ypdL3Acgwp4Uh2/LDE9dYh3W/EPwDMuA2yid4ytssfI=";</script>
';}else{echo'<script type="text/javascript" src="//content.jwplatform.com/libraries/0P4vdmeO.js"></script>
<script type="text/javascript">jwplayer.key="ypdL3Acgwp4Uh2/LDE9dYh3W/EPwDMuA2yid4ytssfI=";</script>
';} 
?>
<?php 
if (strpos($domainx,"111.90.150") || strpos($domainx,"128.199.102.136") || strpos($domainx,"164.68") || strpos($domainx,"185.63.253.200") || strpos($domainx,"185.63.253.20")){
	}else{
	 $array = array(
   'key' => '<script data-cfasync="false" type="text/javascript" src="//terrapsps.com/t/9/fret/meow4/641841/brt.js"></script>',
	'key2' => "<script type='text/javascript' onerror='absda()' src='//padsecz.com/0f/f2/85/0ff28534dd3a0ba2e80f108efe678a06.js'></script>",
);
$randomKey = array_rand($array); // get a random key
echo $array[$randomKey]; // get the corresponding value
}
?>
<style type="text/css">
  * {
        margin: 0;
        padding: 0
    }

    #player {
        position: absolute;
        width: 100%!important;
        height: 100%!important
    }
#overlay{
   position: absolute; 
   background: transparent; 
   opacity:1; 
   z-index:2; 
   text-align: center; 
  width: 620px; 
   height: 250px;
   padding-top: 5px;
   display:block;
   top:50%;
   left:50%;
   margin-top: -175px;
   margin-left: -310px;
}
#overlay2{
   position: absolute; 
   background: transparent; 
   opacity:1; 
   z-index:2; 
   text-align: center; 
   width: 300px; 
   height: 250px;
   padding-top: 5px;
   display:block;
   top:50%;
   left:50%;
   margin-top: -175px;
   margin-left: -150px;
}
.btn{
  color:#fff;
  border:1px solid #fff;
  font-family: Arial, Helvetica, sans-serif;
  font-size:20px;
  font-weight: bold;
  background: #1a1a1a none repeat scroll 0 0;
  width:200px;
  height: 45px;
  margin:6px -100px 0;
  border-radius:5px;
  cursor:pointer;
  position:absolute;
  top: 100%;
  left: 50%;
  opacity: 0.75;
}
.btn:hover{
  opacity: 1;
}
</style>
</head>
<body>
<div id="player" class="player"></div>
<script type="text/javascript"><?php echo $packed ; ?></script>
<?php include './plugins/analyticstracking.php'; ?>
<?php if(strpos($urlid,"google") || strpos($urlid,"videos.files.wordpress.com")) {  include './plugins/histats.php'; } else {  include './plugins/histats2.php'; } ?>
</body>
</html>