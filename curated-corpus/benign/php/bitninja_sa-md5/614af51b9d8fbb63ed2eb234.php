<?php
	require_once('../database/connect.php');

	$corporatecode = trim(strtoupper($_POST['corporatecode']));
	
	if ($corporatecode!="") {
		$sql = "SELECT * FROM corporate WHERE c_id='$corporatecode'";
		$result = $conn->query($sql);

		if ($result->num_rows > 0) {
			$row = $result->fetch_assoc();
			
			$sqlmax = "SELECT COUNT(*) AS total FROM participant WHERE corporatecode='$corporatecode' AND access='0'";
			$resultmax = $conn->query($sqlmax);
			$rowmax = $resultmax->fetch_assoc();

			if ($rowmax['total'] < $row['c_max']) {
				$response = true;
			} else {
				$response = false;
			}
		} else {
			$response = FALSE;
		}
		$conn->close();
	} else {
		$response = TRUE;
	}

	echo json_encode(array(
		'valid' => $response,
	));
?>