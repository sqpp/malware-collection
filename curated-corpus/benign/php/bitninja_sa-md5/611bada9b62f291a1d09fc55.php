<?php
session_start();
##================================================================
require_once("./_sql_handling2.php");
require_once("./_java.php");
require_once("./_bizonylat2.php");
##================================================================
require_once("./_0.php");
if($_SESSION['path_0']!=""){
  require_once($_SESSION['path_0']);		
}
//================================================================
$tabla="termekek";
//================================================================
//combohoz feltöltés: ============================================
//================================================================

sql_parancs($dbf,"UPDATE focsop SET kod='1' WHERE kod LIKE '01'");
sql_parancs($dbf,"UPDATE focsop SET kod='2' WHERE kod LIKE '02'");
sql_parancs($dbf,"UPDATE focsop SET kod='3' WHERE kod LIKE '03'");
sql_parancs($dbf,"UPDATE focsop SET kod='4' WHERE kod LIKE '04'");
sql_parancs($dbf,"UPDATE focsop SET kod='5' WHERE kod LIKE '05'");
sql_parancs($dbf,"UPDATE focsop SET kod='6' WHERE kod LIKE '06'");
sql_parancs($dbf,"UPDATE focsop SET kod='7' WHERE kod LIKE '07'");
sql_parancs($dbf,"UPDATE focsop SET kod='8' WHERE kod LIKE '08'");
sql_parancs($dbf,"UPDATE focsop SET kod='9' WHERE kod LIKE '09'");

if(isset($_SESSION['tombok']['focsop'])){
  $focsop=dbf2string($dbf,"focsop","WHERE 1 ORDER BY focsop","focsop");
//  $focsop=$_SESSION['tombok']['focsop'];	
  $alcsop=dbf2string($dbf,"alcsop","WHERE 1 ORDER BY focsop","alcsop");
//  $alcsop=$_SESSION['tombok']['alcsop'];
}else{
  $focsop=dbf2string($dbf,"focsop","WHERE 1 ORDER BY focsop","focsop");
  $_SESSION['tombok']['focsop']=$focsop;
  $alcsop=dbf2string($dbf,"alcsop","WHERE 1 ORDER BY focsop","alcsop");
  $_SESSION['tombok']['alcsop']=$alcsop;
}

sql_parancs($dbf,"DELETE FROM `aremlekezes` WHERE ceg LIKE ''");

//van ármodosítás? ----------------------------------------------------------
$beallitas=array("mi"=>"",  "beallitas"=>"",  "megj"=>"",);  
sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'armodositas'");
$armodositas=$beallitas['beallitas'];
sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'aremlekezes'");
$van_aremlekezes=$beallitas['beallitas'];
sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'gep_azonosito'");
$gep_azonosito=$beallitas['beallitas'];
sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'aktualis_ar'");
$aktualis_ar=$beallitas['beallitas'];

//print "tabBizTetel:".$_POST['tabBizTetel'];

if(isset($_POST['tabBizTetel']) AND ($_POST['tabBizTetel']!="")){
  $tabBizTetel=$_POST['tabBizTetel'];
  sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'tabBizTetel'");
  $beallitas['beallitas']=$tabBizTetel;
  sql_edit($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'tabBizTetel'");
}else{
  sql_read($dbf,"_beallitas",$beallitas,$beallitas,"WHERE mi LIKE 'tabBizTetel'");
  $tabBizTetel=$beallitas['beallitas'];
  $_POST['tabBizTetel']=$tabBizTetel;
}

$tabBizTetel=50;
//---------------------------------------------------------------------------  	  	

if(isset($_SESSION['xfejid'])){
  $xfejid=$_SESSION['xfejid'];	

}else{
  $xfejid=$_GET['xfejid'];	
  $_SESSION['xfejid']=$xfejid;

}

$back_link=$_GET['back_link'];

$vevok=array(
"vevokod"=>"",  "cegnev"=>"",  "osszek"=>"",  "cim"=>"",  "banksz"=>"",  
"tel"=>"",  "fax"=>"",  "megj1"=>"",  "megj2"=>"",  "arkat"=>"",  "kedv"=>"",  
"kontkod"=>"",  "adosz"=>"",  "fcs1"=>"",  "kedv1"=>"",  "ark1"=>"",  "fcs2"=>"",  
"kedv2"=>"",  "ark2"=>"",  "fcs3"=>"",  "kedv3"=>"",  "ark3"=>"",  "fcs4"=>"",  
"kedv4"=>"",  "ark4"=>"",  "fcs5"=>"",  "kedv5"=>"",  "ark5"=>"",  "utalasnap"=>"",  
"fizetesimod"=>"",  "vevocsop"=>"",  "x1"=>"",  "x2"=>"",  "x3"=>"",  "x4"=>"",  "x5"=>"",
);
   
sql_read($dbf,"vevok",$vevok,$vevok,"WHERE cegnev LIKE '".utf8_decode($_SESSION['fej']['nev'])."%'");
if(sql_count($dbf,"vevok","WHERE cegnev LIKE '".utf8_decode($_SESSION['fej']['nev'])."%'")==0){
  //debug(utf8_decode($_SESSION['fej']['nev']));
} 

$termekek=array("id"=>"",  "azonosito"=>"",  "szallitoazon"=>"",  "vonalkod"=>"",  "megnevezes"=>"",  "megjegyzes"=>"",  
"egyseg"=>"",  "gyujtoazon"=>"",  "gyujtomennyiseg"=>"",  "gyujtoegyseg"=>"",  "afa"=>"",    "ksh"=>"",  "szam"=>"",  
"mennyiseg"=>"",  "minimum"=>"",  "vetelar"=>"",  "utcsobesz"=>"",  "elad1"=>"",  "elad2"=>"",  "elad3"=>"",  "elad4"=>"",  "elad100"=>"",  
"focsop"=>"",  "alcsop"=>"",  "foglalt"=>"",  "eladdeviza"=>"",  "deviza"=>"",  "gyariszam"=>"",  "kep"=>"",  "s1"=>"",  
"s2"=>"",  "s3"=>"",  "het"=>"",  "x1"=>"",  "x2"=>"",  "x3"=>"",  "x4"=>"",  "x5"=>"","leiras"=>"","noweb"=>"");

$tetel=array(
"gepissz"=>"",  "azon"=>"",  "nev"=>"",  "kshjel"=>"",  "kshsz"=>"",  "egyseg"=>"",  "afak"=>"",  
"menny"=>"",  "eladar"=>"",  "devarf"=>"",  "devnem"=>"",  "kedv"=>"",  "megj"=>"",  "vear"=>"",  "rakt"=>"",  
"kontir"=>"",  "gyszam"=>"",  "x1"=>"",  "x2"=>"",  "x3"=>"",  "x4"=>"",  "x5"=>"",
);

$aremlekezes=array(
"cikkID"=>"",  "ceg"=>"",  "ar"=>"",  "raktar"=>"",
);

$xfocsop=array(
"focsop"=>"",  "kod"=>"",
);

$xalcsop=array(
"focsop"=>"",  "alcsop"=>"",  "kod"=>"",
);
  
$keszlet=array(
  "raktar"=>"","cikk"=>"","db"=>"",
);
  
  
$feltetel="WHERE megnevezes LIKE '%".$_POST['keres']."%' AND megnevezes NOT LIKE '*%' AND noweb NOT LIKE '1' AND ";  
//if(isset($_POST['keres'])){
if(sql_count($dbf,"focsop","WHERE focsop LIKE '".utf8_decode($_POST['focsop'])."'")>0 AND $_POST['focsop']!=""){
  sql_read($dbf,"focsop",$xfocsop,$xfocsop,"WHERE focsop LIKE '".utf8_decode($_POST['focsop'])."'");	
  $feltetel.="focsop LIKE '".$xfocsop['kod']."' AND ";
}else{
  $feltetel.="focsop LIKE '%' AND ";
}
if(sql_count($dbf,"alcsop","WHERE alcsop LIKE '".utf8_decode($_POST['alcsop'])."'")>0 AND $_POST['alcsop']!=""){
  sql_read($dbf,"alcsop",$xalcsop,$xalcsop,"WHERE alcsop LIKE '".utf8_decode($_POST['alcsop'])."'");	
  $feltetel.="alcsop LIKE '".$xalcsop['kod']."' ";
}else{
  $feltetel.="alcsop LIKE '%' ";  
}

//  $feltetel="WHERE megnevezes LIKE '%".$_POST['keres']."%' AND focsop LIKE '".$xfocsop['kod']."' AND alcsop LIKE '".$xalcsop['kod']."'";	

//}


$feltetel=$feltetel." ORDER BY megnevezes";
//$feltetel=$feltetel." ORDER BY id DESC";

//print $feltetel;

$rec=sql_count($dbf,"termekek",$feltetel);

if(!isset($_SESSION['lap'])){
  $lap=1;
  $_SESSION['lap']=$lap;

}else{
  $lap=$_SESSION['lap'];	

}

$maxsor=$tabBizTetel;
// ToDO H426
$maxsor=50; 
$maxoldal=(int)($rec/$maxsor);

$sum_neto="";
$sum_bruto="";

if(isset($_POST['mode'])){
  foreach($_POST as $kulcs=>$adat){
    if(substr($kulcs,0,2)=="id"){
      $id=substr($kulcs,3);
      if($_POST['menny_'.$id]!=""){
	$feltetel_x="WHERE gepissz LIKE '".$xfejid."' AND azon LIKE '".$id."'";
	if(sql_count($dbf,"tetel",$feltetel_x)>0){
	  sql_read($dbf,"tetel",$tetel,$tetel,$feltetel_x);	
          $tetel['gepissz']=$xfejid;
          $tetel['azon']=$id;
	  $tetel['nev']=$_POST['megnevezes_'.$id];
	  $tetel['kshjel']=$_POST['kshjel_'.$id];
	  $tetel['kshsz']=$_POST['kshsz_'.$id];
	  $tetel['egyseg']=$_POST['egyseg_'.$id];
	  $tetel['afak']=$_POST['afa_'.$id];
	  $tetel['menny']=$_POST['menny_'.$id];
	  $tetel['eladar']=$_POST['ar_'.$id];
	  $tetel['rakt']=$gep_azonosito;
	  $tetel['x1']=kerekites($_POST['netto_'.$id],0.01);
	  $tetel['x2']=kerekites($_POST['netto_'.$id]*($_POST['afa_'.$id])/100,0.01);
	  $tetel['x3']=kerekites($_POST['brutto_'.$id],0.01);
	  $tetel['x4']="";
	  $tetel['x5']=date('Y-m-d');
	  if($_POST['menny_'.$id]=="0"){
	    sql_del($dbf,"tetel",$feltetel_x);  

	  }else{
	    sql_edit($dbf,"tetel",$tetel,$tetel,$feltetel_x);			  

	  }
	}else{
          $tetel['gepissz']=$xfejid;
          $tetel['azon']=$id;
	  $tetel['nev']=$_POST['megnevezes_'.$id];
	  $tetel['kshjel']=$_POST['kshjel_'.$id];
	  $tetel['kshsz']=$_POST['kshsz_'.$id];
	  $tetel['egyseg']=$_POST['egyseg_'.$id];
	  $tetel['afak']=$_POST['afa_'.$id];
	  $tetel['menny']=$_POST['menny_'.$id];
	  $tetel['eladar']=$_POST['ar_'.$id];
	  $tetel['rakt']=$gep_azonosito;
	  $tetel['x1']=kerekites($_POST['netto_'.$id],0.01);
	  $tetel['x2']=kerekites($_POST['netto_'.$id]*($_POST['afa_'.$id])/100,0.01);
	  $tetel['x3']=kerekites($_POST['brutto_'.$id],0.01);
	  $tetel['x4']="";
	  $tetel['x5']=date('Y-m-d');
	  sql_new($dbf,"tetel",$tetel,$tetel);	

	}
      }
    }

  }
}
//-----------------------------------------------------
$sum_neto=$_POST['s_netto'];
$sum_bruto=$_POST['s_brutto'];

if($_POST['mode']=="first"){
  $lap=1;
  $_SESSION['lap']=$lap;	

}elseif($_POST['mode']=="prev"){
  if($lap>1){
    $lap--;
    $_SESSION['lap']=$lap;	  

  }		

}elseif($_POST['mode']=="next"){
  if($lap<$maxoldal+1){
    $lap++;
    $_SESSION['lap']=$lap;	  
  }		
}elseif($_POST['mode']=="last"){
  $lap=$maxoldal+1;
  $_SESSION['lap']=$lap;	
}elseif($_POST['mode']=="done"){

print "Visszalépés";

  print "<SCRIPT language='JavaScript'>location.href='".$back_link."';</SCRIPT>";
}
##===============================================================================================================================================================================================================================
?>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tételek</title>
    <script>
    // Set the horizontal and vertical position for the popup
PositionX = 100;
PositionY = 100;

// Set these value approximately 20 pixels greater than the
// size of the largest image to be used (needed for Netscape)
defaultWidth = 300;
defaultHeight = 300;

// Set autoclose true to have the window close automatically
// Set autoclose false to allow multiple popup windows
var AutoClose = true;

// Do not edit below this line...
// ================================
if (parseInt(navigator.appVersion.charAt(0))>=4){
var isNN=(navigator.appName=="Netscape")?1:0;
var isIE=(navigator.appName.indexOf("Microsoft")!=-1)?1:0;}
var optNN='scrollbars=no,width='+defaultWidth+',height='+defaultHeight+',left='+PositionX+',top='+PositionY;
var optIE='scrollbars=no,width=150,height=100,left='+PositionX+',top='+PositionY;

function popImage(imageURL,imageTitle){
  if (isNN){imgWin=window.open('about:blank','',optNN);}
  if (isIE){imgWin=window.open('about:blank','',optIE);}
  with (imgWin.document){
  writeln('<html><head><title>Loading...</title><style>body{margin:0px;}</style>');writeln('<sc'+'ript>');
  writeln('var isNN,isIE;');writeln('if (parseInt(navigator.appVersion.charAt(0))>=4){');
  writeln('isNN=(navigator.appName=="Netscape")?1:0;');writeln('isIE=(navigator.appName.indexOf("Microsoft")!=-1)?1:0;}');
  writeln('function reSizeToImage(){');writeln('if (isIE){');writeln('window.resizeTo(100,100);');
  writeln('width=100-(document.body.clientWidth-document.images[0].width);');
  writeln('height=100-(document.body.clientHeight-document.images[0].height);');
  writeln('window.resizeTo(width,height);}');writeln('if (isNN){');
  writeln('window.innerWidth=document.images["George"].width;');writeln('window.innerHeight=document.images["George"].height;}}');
  writeln('function doTitle(){document.title="'+imageTitle+'";}');writeln('</sc'+'ript>');
  if (!AutoClose) writeln('</head><body bgcolor=ffffff scroll="no" onload="reSizeToImage();doTitle();self.focus()">')
  else writeln('</head><body bgcolor=ffffff scroll="no" onload="reSizeToImage();doTitle();self.focus()" onblur="self.close()">');
  writeln('<img name="George" src='+imageURL+' style="display:block"></body></html>');
  close();	
}
}
  </script>
  </head>
  <body style="width: 95%;"> <!--602px -->
	<center>
	<button type="button" onclick="document.getElementById('mode').value='first';document.myform.submit();">|<</button>
	<button type="button" onclick="document.getElementById('mode').value='prev';document.myform.submit();"><<</button>
	<button type="button" onclick="document.getElementById('mode').value='next';document.myform.submit();">>></button>
	<button type="button" onclick="document.getElementById('mode').value='last';document.myform.submit();">>|</button>
	</center>

    <form   action="<?php $_SERVER['PHP_SELF']?>" method="POST" id="myform" name="myform" >
	<center>
        <?php print "<h6>".$rec." => ".$lap."/".$maxoldal."</h6>";?>

        <input type="hidden" id="tabBizTetel" name="tabBizTetel" size="3" value="<?php print $tabBizTetel; ?>" onblur="document.myform.submit();"></input>
        Főcsoport: <?php print tomb2combo($focsop,"focsop","5","document.getElementById(\"mode\").value=\"first\";document.myform.submit();",$_POST['focsop']) ?> 
        Alcsoport: <?php print tomb2combo($alcsop,"alcsop","5","document.getElementById(\"mode\").value=\"first\";document.myform.submit();",$_POST['alcsop']) ?>

        Keresett szövegrész    <input id="keres" name="keres" size="10" value="" onblur="document.getElementById('mode').value='first';document.myform.submit();"></input>
        <input type="button" value="Keresés" />
	</center>
    
    <table style="text-align: left; width: 95%;" border="0"> <!-- 600px -->
	  <?php          
//print "Feltétel:".$feltetel."<br>";
		$ar="elad".$aktualis_ar;
		print "<tr>";
//		print "<th></th>";
		print "<th align='center' bgcolor='#A9D0F5'>Cikk</th>";
		print "<th align='center' bgcolor='#A9D0F5'>Megnevezés</th>";
		print "<th align='center' bgcolor='#A9D0F5'>N.egys.ár</th>";
                print "<th align='center' bgcolor='#A9D0F5'>B.egys.ár</th>";
		//print "<th align='center' bgcolor='#A9D0F5'>Készlet</th>";
//		print "<th align='center' bgcolor='#A9D0F5'>db</th>";
//		print "<th align='center' bgcolor='#A9D0F5'>Me</th>";
//		print "<th align='center' bgcolor='#A9D0F5'>Netó  </th>";
//		print "<th align='center' bgcolor='#A9D0F5'>Brutó </th>";
		print "</tr>\n";
		for($i=($lap-1)*$maxsor;$i<$rec AND $i<($lap-1)*$maxsor+$maxsor;$i++){
		  sql_read($dbf,"termekek",$termekek,$termekek,$feltetel,$i);
		  if(($i % 2)!=0){
			$szin="#ffffff"; 

		  }else{
			$szin="#D8D8D8";  

		  }
		  $id=$termekek['azonosito'];
		  print "<tr>";
//		  print "<td>".$i."</td>";
//-------------------------------------------------
//-------------------------------------------------
//-------------------------------------------------
$kepnev="./uploads/".$termekek['kep'];
$size = getimagesize($kepnev);
$szorzo = "1";
$szorzo_thumb = "1";
if ($size[0] or $size[1] > 200){
  if ($size[0] >= $size[1]){
    $szorzo = (100/$size[0]);
  }
  if ($size[1] >= $size[0]){
    $szorzo = (100/$size[1]);
  }
}
$ujszel = $size[0]*$szorzo;
$ujmag = $size[1]*$szorzo;

print "<td bgcolor='".$szin."'><a href=\"javascript:popImage('$kepnev','')\"><img src='".$kepnev."' height=$ujmag width=$ujszel border='0px'/></a></td>";                  
//-------------------------------------------------
//-------------------------------------------------
//-------------------------------------------------
//		  print "<td bgcolor='".$szin."'>".
//                  "<img src='./uploads/".$termekek['kep']."' height='100' width='100'></td>";                  

		  print "<td bgcolor='".$szin."'>".
		  "<input type='hidden' id='id_$id' name='id_$id' value='".$termekek['azonosito']."' onchange=''></input>".
		  "<input type='hidden' id='kshjel_$id' name='kshjel_$id' value='".$termekek['ksh']."' onchange=''></input>".
		  "<input type='hidden' id='kshsz_$id' name='kshsz_$id' value='".$termekek['szam']."' onchange=''></input>".
		  "<b>".$termekek['megnevezes']."</b><br><br>".$termekek['leiras']."</td>";
//---------------------------------------------------		  
//ha már más nettó ár van megadva, akkor azt hozza fel
//---------------------------------------------------		  

                  $feltetel_x="WHERE gepissz LIKE '".$xfejid."' AND azon LIKE '".$id."'";
		  if($armodositas=="true"){
                    if(sql_count($dbf,"tetel",$feltetel_x)>0){		
                      sql_read($dbf,"tetel",$tetel,$tetel,$feltetel_x);
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='ar_$id' name='ar_$id' value='".$tetel['eladar']."' ";  			  
                    }else{
		      $aremlekeze_ar_feltetel="WHERE cikkID LIKE '".$termekek['azonosito']."' AND ceg LIKE '".$vevok['vevokod']."'";  
		      if($van_aremlekezes=="true" AND sql_count($dbf,"aremlekezes",$aremlekeze_ar_feltetel)>0){
			sql_read($dbf,"aremlekezes",$aremlekezes,$aremlekezes,$aremlekeze_ar_feltetel);	
		        print "<td align='right' bgcolor='".$szin."'>".
		        "<input size='10' id='ar_$id' name='ar_$id' value='".$aremlekezes['ar']."' ";  					
		      }else{
		        print "<td align='right' bgcolor='".$szin."'>".
		        "<input size='10' id='ar_$id' name='ar_$id' value='".$termekek[$ar]."' ";  	
		      }  			
                    }
		  }else{
                    //debug($termekek['azonosito'].":".$vevok['vevokod']);
		    $aremlekeze_ar_feltetel="WHERE cikkID LIKE '".$termekek['azonosito']."' AND ceg LIKE '".$vevok['vevokod']."'";  
		    if($van_aremlekezes=="true" AND sql_count($dbf,"aremlekezes",$aremlekeze_ar_feltetel)>0){
		      sql_read($dbf,"aremlekezes",$aremlekezes,$aremlekezes,$aremlekeze_ar_feltetel);	
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='ar_$id' name='ar_$id' value='".$aremlekezes[$ar]."' readonly";  					
		    }else{
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='ar_$id' name='ar_$id' value='".$termekek[$ar]."' readonly";  	
		    }  			
		  }
		  print "
		  onchange='
		  document.getElementById(\"netto_$id\").value=(parseFloat(document.getElementById(\"ar_$id\").value)*parseFloat(document.getElementById(\"menny_$id\").value));
		  document.getElementById(\"brutto_$id\").value=
                  parseInt((parseFloat(document.getElementById(\"netto_$id\").value)*(parseFloat(document.getElementById(\"afa_$id\").value)+100)/100)+0.5);
		  '></input>"."</td>";
//---------------------------------------------------		  
                  $feltetel_x="WHERE gepissz LIKE '".$xfejid."' AND azon LIKE '".$id."'";
		  if($armodositas=="true"){
                    if(sql_count($dbf,"tetel",$feltetel_x)>0){		
                      sql_read($dbf,"tetel",$tetel,$tetel,$feltetel_x);
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='br_ar_$id' name='br_ar_$id' value='".
                      
                      kerekites($tetel['eladar']*(1+$termekek['afa']/100),1)
                      
                      ."' ";  			  
                    }else{
		      $aremlekeze_ar_feltetel="WHERE cikkID LIKE '".$termekek['azonosito']."' AND ceg LIKE '".$vevok['vevokod']."'";  
		      if($van_aremlekezes=="true" AND sql_count($dbf,"aremlekezes",$aremlekeze_ar_feltetel)>0){
			sql_read($dbf,"aremlekezes",$aremlekezes,$aremlekezes,$aremlekeze_ar_feltetel);	
		        print "<td align='right' bgcolor='".$szin."'>".
		        "<input size='10' id='br_ar_$id' name='br_ar_$id' value='".
                        
                        kerekites($aremlekezes['ar']*(1+$termekek['afa']/100),1)
                        
                        ."' ";  					
		      }else{
		        print "<td align='right' bgcolor='".$szin."'>".
		        "<input size='10' id='br_ar_$id' name='br_ar_$id' value='".
                        
                        kerekites($termekek[$ar]*(1+$termekek['afa']/100),1)
                        
                        ."' ";  	
		      }  			
                    }
		  }else{
		    $aremlekeze_ar_feltetel="WHERE cikkID LIKE '".$termekek['azonosito']."' AND ceg LIKE '".$vevok['vevokod']."'";  
		    if($van_aremlekezes=="true" AND sql_count($dbf,"aremlekezes",$aremlekeze_ar_feltetel)>0){
		      sql_read($dbf,"aremlekezes",$aremlekezes,$aremlekezes,$aremlekeze_ar_feltetel);	
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='br_ar_$id' name='br_ar_$id' value='".
                      
                      kerekites($aremlekezes[$ar]*(1+$termekek['afa']/100),1)
                      
                      ."' readonly";  					
		    }else{
		      print "<td align='right' bgcolor='".$szin."'>".
		      "<input size='10' id='br_ar_$id' name='br_ar_$id' value='".
                      
                      kerekites($termekek[$ar]*(1+$termekek['afa']/100),1)
                      
                      ."' readonly";  	
		    }  			
		  }
		  print "
		  onchange='
		  document.getElementById(\"ar_$id\").value=
                  parseFloat(document.getElementById(\"br_ar_$id\").value)/(1+(parseFloat(document.getElementById(\"afa_$id\").value)/100));
		  '></input>"."</td>";

//---------------------------------------------------		  
//Mennyiség
/*
                  $kfeltetel="WHERE raktar LIKE '".$gep_azonosito."' AND cikk LIKE '".$id."'";
                  if(sql_count($dbf,"keszlet",$kfeltetel)>0){
                    sql_read($dbf,"keszlet",$keszlet,$keszlet,$kfeltetel);
                    print "<td align='right' bgcolor='".$szin."'>".$keszlet['db']."</td>";
                  }else{
  		    print "<td align='right' bgcolor='".$szin."'>".$termekek['mennyiseg']."</td>";
                  }
*/                  
//---------------------------------------------------		  
/*
		  $feltetel_x="WHERE gepissz LIKE '".$xfejid."' AND azon LIKE '".$id."'";
		  if(sql_count($dbf,"tetel",$feltetel_x)>0){
		    sql_read($dbf,"tetel",$tetel,$tetel,$feltetel_x);	
		    print "<td align='center' bgcolor='#FFD8FF'>".
		    "<input size='4' id='menny_$id' name='menny_$id' value='".$tetel['menny']."' onchange='";
		    print "document.getElementById(\"netto_$id\").value=(parseFloat(document.getElementById(\"ar_$id\").value)*parseFloat(document.getElementById(\"menny_$id\").value));
		    document.getElementById(\"brutto_$id\").value=
                    parseInt((parseFloat(document.getElementById(\"netto_$id\").value)*(parseFloat(document.getElementById(\"afa_$id\").value)+100)/100)+0.5);";
		    print "' ></input>"."</td>";
		  }else{
		    print "<td align='center' bgcolor='#FFD8FF'>".
		    "<input size='4' id='menny_$id' name='menny_$id' value='' onchange='";
		    print "document.getElementById(\"netto_$id\").value=(parseFloat(document.getElementById(\"ar_$id\").value)*parseFloat(document.getElementById(\"menny_$id\").value));
		    document.getElementById(\"brutto_$id\").value=
                    parseInt((parseFloat(document.getElementById(\"netto_$id\").value)*(parseFloat(document.getElementById(\"afa_$id\").value)+100)/100)+0.5);";
		    print "' ></input>"."</td>";
		  }
		  print "<td align='center' bgcolor='".$szin."'>"."<input size='4' id='egyseg_$id' name='egyseg_$id' value='".$termekek['egyseg']."' readonly></input></td>";
                  if(sql_count($dbf,"tetel",$feltetel_x)>0){
		    print "<td align='right' bgcolor='".$szin."'>".
		    "<input size='10' id='netto_$id' name='netto_$id' value='".$tetel['x1']."' readonly onchange=''></input>"."</td>";
		    print "<td align='right' bgcolor='".$szin."'>".
		    "<input type='hidden' size='4' id='afa_$id' name='afa_$id' value='".$termekek['afa']."' readonly onchange=''></input>".
		    "<input size='10' id='brutto_$id' name='brutto_$id' value='".$tetel['x3']."' readonly  onchange=''></input>"."</td>";
		    print "</tr>\n";
		  }else{
		    print "<td align='right' bgcolor='".$szin."'>".
		    "<input size='10' id='netto_$id' name='netto_$id' readonly onchange=''></input>"."</td>";
		    print "<td align='right' bgcolor='".$szin."'>".
		    "<input type='hidden' size='4' id='afa_$id' name='afa_$id' value='".$termekek['afa']."' readonly onchange=''></input>".
		    "<input size='10' id='brutto_$id' name='brutto_$id' readonly onchange=''></input>"."</td>";
		    print "</tr>\n";			  

		  }
*/
		}
	  ?>
	</table>
    </br>
	<input type="hidden" id="mode" name="mode" value="done"></input>
	<center>
	<button type="button" style="font-size: 20px" onclick="document.getElementById('mode').value='first';document.myform.submit();">|<</button>
	<button type="button" style="font-size: 20px" onclick="document.getElementById('mode').value='prev';document.myform.submit();"><<</button>
	<button type="button" style="font-size: 20px" onclick="document.getElementById('mode').value='next';document.myform.submit();">>></button>
	<button type="button" style="font-size: 20px" onclick="document.getElementById('mode').value='last';document.myform.submit();">>|</button>
    </br></br>
        <!--
	<button type="button" style="font-size: 20px" onclick="document.getElementById('mode').value='done';document.myform.submit();"> Kész </button>
	</center>
        -->
    </form>
  </body>
</html>
