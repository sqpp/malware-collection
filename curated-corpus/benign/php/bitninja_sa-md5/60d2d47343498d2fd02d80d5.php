<?php
foreach ($movie_list as $value) {
	$alphabet = substr($value->film_name,0,1);
	$movie_list_alpha[$alphabet][] = $value;
}
print_r($movie_list_alpha);
?>

<div class="row mt-4">
  <div class="col-sm-12">
    <div class="panel panel-info">
            Sort by :<select id="sort">
              <option value="all">All Movie</option>
              <option value="film_name" <?php if($_REQUEST['sort'] == 'film_name'){ ?>selected<?php }?>>Film Name(A-Z)</option>
              <option value="z_a" <?php if($_REQUEST['sort'] == 'z_a'){ ?>selected<?php }?>>Film Name(Z-A)</option>
              <option value="release_date" <?php if($_REQUEST['sort'] == 'release_date'){ ?>selected<?php }?>>Release Date</option>
              <option value="movie_type" <?php if($_REQUEST['sort'] == 'movie_type'){ ?>selected<?php }?>>Type</option>
</select>
    <div class="panel-body">
          <?php
          if($_REQUEST['sort'] == 'release_date')
          {
            $i = 0;
          foreach ($movie_list_data as $key => $value) {
            ?>
            <li style="color: red; list-style: none; font-size: 1.5rem;"><?=$key?>
            <?php
                foreach ($value as $date => $data){
          ?>
            <p style="color: deeppink; list-style: none; font-size: 1.2rem; margin-bottom: -8px;"><?=$date?></p>
            <?php
            foreach ($data as $movie) {
                $i++;
            ?>
            <p style="color: brown; list-style: none; font-size: 0.8rem; margin: -10px 0px 0px 0px;"><a href="<?=$movie->trailer_url?>" style="text-decoration: none;" onmousemove="mouseOver(<?=$i?>)" onmouseout="mouseOut(<?=$i?>)"><?=$movie->film_name?>
            </a>(<?=$movie->availability?>)</p>
            
            <div><img src="<?=$movie->poster_url?>" alt="loading<?=$i?>..." style="position: absolute; z-index:1; display: none;" id="img_<?=$i?>"></div>
        <?php } }?>
        </li>
      <?php } }
      elseif ($_REQUEST['sort'] == 'film_name' || $_REQUEST['sort'] == 'z_a') {
        foreach ($movie_list as $movie) {
          $Date = $movie->release_date;
          $date = date('F d (l)', strtotime($Date));
                $i++;
            ?>
            <p style="color: brown; list-style: none; font-size: 0.8rem; margin-bottom: -6px;"><a href="<?=$movie->trailer_url?>" style="text-decoration: none;" onmousemove="mouseOver(<?=$i?>)" onmouseout="mouseOut(<?=$i?>)"><?=$movie->film_name?>
            </a>(<?=$movie->availability?>,<?=$date?>)</p>
            
            <div><img src="<?=$movie->poster_url?>" alt="loading<?=$i?>..." style="position: absolute; z-index:1; display: none;" id="img_<?=$i?>"></div>
        <?php } }
        elseif ($_REQUEST['sort'] == 'movie_type') {
        foreach ($movie_list as $movie) {
          $Date = $movie->release_date;
          $date = date('F d (l)', strtotime($Date));
                $i++;
            ?>
            <p style="color: brown; list-style: none; font-size: 0.8rem; "><a href="<?=$movie->trailer_url?>" style="text-decoration: none;" onmousemove="mouseOver(<?=$i?>)" onmouseout="mouseOut(<?=$i?>)"><?=$movie->film_name?>
            </a>(<?=$movie->availability?>,<?=$date?>)</p>
            
            <div><img src="<?=$movie->poster_url?>" alt="loading<?=$i?>..." style="position: absolute; z-index:1; display: none;" id="img_<?=$i?>"></div>
        <?php } }
        else {
          $i = 0;
          foreach ($movie_list_data as $key => $value) {
            ?>
            <li style="color: red; list-style: none; font-size: 1.5rem;"><?=$key?>
            <?php
                foreach ($value as $date => $data){
          ?>
            <p style="color: deeppink; list-style: none; font-size: 1.2rem; margin-bottom: -8px;"><?=$date?></p>
            <?php
            foreach ($data as $movie) {
                $i++;
            ?>
            <p style="color: brown; list-style: none; font-size: 0.8rem; margin: -10px 0px 0px 0px;"><a href="<?=$movie->trailer_url?>" style="text-decoration: none;" onmousemove="mouseOver(<?=$i?>)" onmouseout="mouseOut(<?=$i?>)"><?=$movie->film_name?>
            </a>(<?=$movie->availability?>)</p>
            
            <div><img src="<?=$movie->poster_url?>" alt="loading<?=$i?>..." style="position: absolute; z-index:1; display: none;" id="img_<?=$i?>"></div>
        <?php } }?>
        </li>
      <?php }
        } 
        ?>
    </div>
    </div>
  </div>
</div>
<script type="text/javascript">
function mouseOver(i) {
  var e = window.event;
  var img = document.getElementById("img_"+i);
  img.style.display = "block";
  let left = e.layerX+15;
  let top = e.layerY+10;
  img.style.left = left + 'px';
  img.style.top = top + 'px';
}

function mouseOut(i) {
  document.getElementById("img_"+i).style.display = "none";
}

jQuery(document).ready(function(){
    jQuery(document).on('change','#sort',function(){
      var sort = jQuery(this).val();
      if(sort == 'all')
      {
        var url = 'https://test.krishavinfotech.com/t1/movie-schedule';
      }
      else
      {
        var url = 'https://test.krishavinfotech.com/t1/movie-schedule?sort='+sort;
      }
      jQuery(location).prop('href', url);
    });
  });
</script>