<?php
include 'connect.php';
$api = !empty($_POST['android_api']);
if ($api && $api == API ) {
$message = array();
$id = $_POST['android_id'];
$get_limit_status_data = mysqli_fetch_array(mysqli_query($connect,"SELECT * FROM user_task WHERE user_id = '$id' "));
if ($get_limit_status_data['watch_limit']=="true") {
$from_time = date("Y-m-d H:i:s");
$to_time = mysqli_fetch_array(mysqli_query($connect,"SELECT * FROM user_task WHERE `user_id` = '$id' "));
$time_first = strtotime($from_time);
$time_second = strtotime($to_time['duration_watch']);
$def = $time_second - $time_first;
if($def<=0){
mysqli_query($connect,"UPDATE `user_task` SET `video_own_imp` = '0',watch_limit = 'false' WHERE `user_task`.`user_id` = '$id' ");
}else{
$message['error'] = "false";
$message['message'] = "Wait ".gmdate("H:i:s", $def)." for next Task";
}
}else{
$message['error'] = "true";    
}
echo json_encode($message);
}else{
	echo "Fake Request";
}
?>