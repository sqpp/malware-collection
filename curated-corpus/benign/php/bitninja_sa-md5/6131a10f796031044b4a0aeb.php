<?php

//fetch_item.php

include('../../config.php');

$req_inventaire=$con->query("select * from volume_na9el where(categorie_volume='salon') order by nom_volume ASC");
$nbr_inventaire=($req_inventaire->num_rows);

 $output = '';
 $nbr=0;
 ?>
 <script>

var inc = document.getElementsByClassName("stepper_salon");
for (i = 0; i < inc.length; i++) {
  var incI = inc[i].querySelector("input"),
    id = incI.getAttribute("id"),
    min = incI.getAttribute("min"),
    max = incI.getAttribute("max"),
    step = incI.getAttribute("step");
  document
    .getElementById(id)
    .previousElementSibling.setAttribute(
      "onclick",
      "stepperInput('" + id + "', -" + step + ", " + min + ")"
    ); 
  document
    .getElementById(id)
    .nextElementSibling.setAttribute(
      "onclick",
      "stepperInput('" + id + "', " + step + ", " + max + ")"
    ); 
}

function stepperInput(id, s, m) {
  var el = document.getElementById(id);
  if (s > 0) {
    if (parseInt(el.value) < m) {
      el.value = parseInt(el.value) + s;
    }
  } else {
    if (parseInt(el.value) > m) {
      el.value = parseInt(el.value) + s;
    }
  }
}
</script>
 <?php
while($dn_inventaire=$req_inventaire->fetch_array(MYSQLI_ASSOC)){

$nbr++;
  $output .= '
  
  <div class="col-md-4 mb-4 p-3" style="width: 18rem;" style="border:1px solid;">  
  <div class="card " style="background-color:#EEF0F3; border-radius:10px" >
  <img class="card-img-top p-5 text-center"  src="inventaire/images/'.$dn_inventaire["icon_volume"].'" />
  <div class="card-body">
    <h5 class="card-title text-center">'.$dn_inventaire["nom_volume"].'</h5>
     
              <span class="row stepper_salon">
  <button class="btn btn-sm  col-md-3" id="munis_inventaire_salon'.$nbr.'" type="button"><i class="fas fa-minus-circle"></i></button>
      <input type="number" name="quantity[]" id="quantity_salon'.$nbr.'" class="form-control form-control-sm col-md-6" min="0" max="100" step="1" value="0" />
      
  <button  class="btn btn-sm col-md-3" id="add_inventaire_salon'.$nbr.'" type="button"><i class="fas fa-plus-circle"></i></button>
</span>
     <input type="hidden" id="volume_salon'.$nbr.'" value="'.$dn_inventaire["volume"].'"/>   
      <input type="hidden" id="volume_inventaire_salon'.$nbr.'" value=""/>   
      
  </div>
</div>
           
        </div>
        
        
  ';
?>

<script>

$("#volume_inventaire_salon" +<?php echo $nbr; ?>).val(0);
$("#add_inventaire_salon" +<?php echo $nbr; ?>).click(function(){
   var volume<?php echo $nbr; ?>= parseFloat($("#volume_salon" +<?php echo $nbr; ?>).val() );
    var quantity<?php echo $nbr; ?>= parseInt($("#quantity_salon" +<?php echo $nbr; ?>).val());
    var total_volume<?php echo $nbr; ?>=Number(volume<?php echo $nbr; ?> * quantity<?php echo $nbr; ?>).toFixed(1);
    volume_total_salon=0;
    $("#volume_inventaire_salon" +<?php echo $nbr; ?>).val(total_volume<?php echo $nbr; ?>);
   for(var count =1 ; count<= <?php echo $nbr_inventaire ;?>;count++){
    volume_total_salon=Number(parseFloat(volume_total_salon) + parseFloat( $("#volume_inventaire_salon" + count).val())).toFixed(1);
   }
    var volume_total= volume_total_salon
    $("#volume_inventaire").val(volume_total);
    $("#volume_choisi").html(volume_total);
    $("#volume_total_estime").html(volume_total);
  
});

$("#munis_inventaire<?php echo $nbr; ?>").click(function(){
   var volume<?php echo $nbr; ?>= parseFloat($("#volume" +<?php echo $nbr; ?>).val() );
    var quantity<?php echo $nbr; ?>= parseInt($("#quantity" +<?php echo $nbr; ?>).val());
    var total_volume<?php echo $nbr; ?>=Number(volume<?php echo $nbr; ?> * quantity<?php echo $nbr; ?>).toFixed(1);
   volume_total=0;
    $("#volume_inventaire" +<?php echo $nbr; ?>).val(total_volume<?php echo $nbr; ?>);
   for(var count =1 ; count<= <?php echo $nbr_inventaire ;?>;count++){
    volume_total=Number(parseFloat(volume_total) + parseFloat( $("#volume_inventaire" + count).val())).toFixed(1);
   }
    
    $("#volume_inventaire").val(volume_total);
     $("#volume_choisi").html(volume_total);
      $("#volume_total_estime").html(volume_total);
});
</script>
<?php
 }
 echo $output;


?>

 <link rel="stylesheet" href="../../../../fontawesome-5-pro/css/all.css"/>


<style>
[type="number"]::-webkit-inner-spin-button,
[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  height: auto;
}



.stepper_salon input {
  width: 60%;
  height: 100%;
  text-align: center;
  border: 0;
  background: transparent;
  color: #000;
}

.stepper_salon button {
  width: 40px;
  height: 40px;
  font-weight: 700;
  line-height: 0.1em;
  font-size: 2em;
  padding: 0;
  background:  transparent;
  color: #000;
  border: 1px solid;
}
.stepper_salon button:focus {
  outline: none;
  color: #000;
}
</style>



