	<!DOCTYPE html>
	<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="">
		<meta name="author" content="">
		<title>ERP</title>
		<link type="text/css" href="css/muktai.css" rel="Stylesheet" />
		<link rel='stylesheet' type='text/css' href='css/styles.css' />
		<link rel='stylesheet' type='text/css' href='css/header.css' />	
		<link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="css/NewCss.css" type="text/css" />
		<script src="../bower_components/jquery/dist/jquery.min.js"></script>
		<style type="text/css" media="print">
			@page {
				size: auto;
				margin: 5mm 8mm 4mm 8mm;
				page-break-after: always;
			}	
			/*@media all {
				.page-break	{ display: none; }
			}
			@media print {
				.page-break	{ display: block; 
					page-break-after: always;
					page-break-inside: avoid;
				}
			}*/
		
		</style>
		<style type="text/css" media="print">
		 /*  div.muktaiDELIVERY
		  {
			page-break-after: always;
			page-break-inside: avoid;
		  } */
		</style>
		<style>
		table{
			white-space:nowrap;
		}
		.bill {
			border: 1px solid #777575;
			font-weight: normal ! important;
		}
		.editlabelclass {
			font-size:11px;
		}
		.MainRLside1 {
			width: 98%;
			margin-left: 8px;
			margin-top: 5px;
		}
		.Lside {
			width: 64%;
			float: left;
		}
		.Rside {
			width: 35%;
			float: right;
		}
			.tdatad{
				border: 1px solid #777575;
				width: 5%;
				
			}

			.tdatadfirst{
				border: 1px solid #777575;
				border-style: solid;
				border-color: #777575;
				
				width: 5%;
			}.tdatadfirst1{
				border: 1px dashed #777575;
				border-style: dashed;
				border-color: #777575;
				
				width: 5%;
			}
			.tblcust1GST {
				border-collapse: collapse;
				width: 100%;
				height: auto;
				font-size: 11px;
				border-weight: normal ! important;
			}
			.text-vertical-lt {
				position: absolute;
				-webkit-transform: rotate(270deg);
				transform: rotate(270deg);
				-webkit-transform-origin: 50% 360%;
				float: left;
			}
			.text-vertical-gt {
				position: absolute;
				-webkit-transform: rotate(270deg);
				transform: rotate(270deg);
				-webkit-transform-origin: 43% 360%;
				float: left;
			}
		</style>
		<style>
			.rsidebillprinttax {
			width: 25%;
			height: 20px;
			display: block;
			float: left;
			margin-bottom: 0px;
			border-radius: 3px;
			font-size: 11px;
			}
			.lsidebillprinttax {
			width: 20%;
			height: 20px;
			display: block;
			padding-right: 20px;
			float: left;
			text-align: right;
			margin-top: 1px;
			font-size: 11px;
			}
			
			.tdataqty {
				//border: 1px solid #777575;
				width: 10%;
					border-right: 1px solid #777575;
			}
			
			.NewtdatarowDC {
				text-align: left;
				width: 14%;
			}
			.report31 {
		//margin-left: 25.8%;
		border: none 1px;
		height: Auto;
	   // width: 45%;
		//float: left;
		
	}
	.SideFlex {
		width: 100%;
		// height: auto;
	}
	.LSideFlexA {
		width: 50%;
		margin-left: 1%;
		margin-bottom: 1%;
		float: left;
	}
	.RSideFlexA {
		width: 50%;
		 margin-left: 15%;
	}
	.container {
		width: 100%;
		height: 105px;
		margin: auto;
		padding: 10px;
		overflow: hidden;
		border: transparent;
	 }
	.one {
		width: 70%;
		height: 125px;
		float: left;
	}
	.two {
		margin-left: 30%;
		height: 125px;
	 }
	  
	.one1 {
	  display: flex;
	}
	.one1 > div {
	  flex: 1; /*grow*/
	}
	.muktai
	{
		width:100%;
	}
	.tblcust1GST
	{
	border-right: hidden;
	// border-left: hidden;
	}
	.boldc{ font-weight:normal; }
	.tdataitemname { border-color: #777575; }
	.invoiceaddress1 {
		width: 100%;
		text-align: center;
		height: auto;
		// margin-bottom: 5px;
		// margin-top: 4px;
		font-size: 12px;
	}
	tr{
		line-height: 1.60;
	}
	 </style>
	</head>
	<?php
		include("includes/connection.php"); 
		include("includes/config.php");
		require_once('applyPrintSetting.php');
		$roleid=$_SESSION['roleid'];
	?>		
	<body style="background:white">		

		<form method="POST">
		<div id="print-cancel" style="margin-bottom:10px;">	
			<center>
				<button type="button" style="margin:5px 0px 20px 0px;" class='btn btn-info' name='print' id='print' onClick = 'Hide();PrintElem();'>PRINT</button>
				<a href="DelivaryReportPrint.php" style="margin:5px 1px 20px 0px;" class='btn btn-danger' name='cancel' id='cancel' onClick = 'Hide();'>CANCEL</a>
				<?php if($roleid==0 || $roleid==1){ ?>
				<a href="invoicesetting.php?Page=Delivary" style="margin:5px 1px 20px 0px;" class='btn btn-primary' name='cancels' id='cancels' >Print Setting</a>
				<button type="submit" style="margin:5px 0px 20px 0px;" class="btn btn-info" name="labelreset" id="labelreset" >Label Reset</button>
				<?php } ?>
			</center>
		</div>
	<?php 
		if(isset($_POST['labelreset'])){
			 $Cateconstant="update dimtextsetting set labeltext='' where PageName='delivaryprint'";
			$ResCateconstant=mysql_query($Cateconstant);
			echo "<script>alert('Reset Successfully'); window.location.assign('DelivaryReportPrint.php');</script>";
		}
	define('DEF_INVOICEGEN_SIZE',14);
	ini_set( 'error_reporting', E_ALL ^ E_NOTICE );
	ini_set( 'display_errors', '0' ); ?>
	 <?php  
		$idSaleskpost= $_POST['idSales'];
		// $printcopy= $_POST['printcopy'];
		$CustomerId= $_POST['CustomerId'];
		$From1 = str_replace('/', '-', $_POST['From']);
		$From = date('Y-m-d', strtotime($From1));
	 
		//'2018-10-23';//
		//print_r($CustomerId);
		$ComapnyIdSession=$_SESSION['companyId'];
		$dimCompany="select CompanyName,address,contactNum1,email,GSTIN,PANno,BankName,BranchName,AccountNo,IFSCcode,logo from dimcompany where idCompany='".$ComapnyIdSession."'";
		$ResCompany=mysql_query($dimCompany);
		$RwCompany=mysql_fetch_array($ResCompany);
		 
		$CompanyName=$RwCompany['CompanyName'];
		$CompanyAddress =$RwCompany['address'];
		$CompanyMob =$RwCompany['contactNum1'];
		$companyemail =$RwCompany['email'];
		$GSTIN =$RwCompany['GSTIN'];
		$PANno =$RwCompany['PANno'];
		$BankName =$RwCompany['BankName'];
		$BranchName =$RwCompany['BranchName'];
		$accountNumber =$RwCompany['AccountNo'];
		$IFSCcode =$RwCompany['IFSCcode'];
		$AccountType =$RwCompany['AccountType'];
		$logo =$RwCompany['logo'];
		function buildLedgerQuerys($AcctId, $dbdtStart, $dbdtEnd){
			$acctype="select AcctTypeId from tblaccount where idAcct='".$AcctId."'";
			$Resacctype=mysql_query($acctype);
			$Rowacctype=mysql_fetch_array($Resacctype);
			$AcctTypeId=$Rowacctype['AcctTypeId'];
			if($AcctTypeId=='1004'){
			$qryLedger="SELECT le.FAEntryDate, lt.idLedgerTxn,lt.txnNarration, if(le.CrDr = 4, entryAmt, 0) AS CR, if (le.CrDr = -4, entryAmt, 0) AS DR,TxnTypeId,TxnRefId
							FROM tblledgerentry le 
							JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn ";
			}elseif($AcctTypeId=='1002'){
			$qryLedger="SELECT le.FAEntryDate, lt.idLedgerTxn,lt.txnNarration, if(le.CrDr = 3, entryAmt, 0) AS CR, if (le.CrDr = -3, entryAmt, 0) AS DR,TxnTypeId,TxnRefId
							FROM tblledgerentry le 
							JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn ";
			}else{
			 $qryLedger="SELECT le.FAEntryDate, lt.idLedgerTxn,lt.txnNarration, if(le.CrDr = 1, entryAmt, 0) AS CR, if (le.CrDr = -1, entryAmt, 0) AS DR,TxnTypeId,TxnRefId
							FROM tblledgerentry le 
							JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn ";
			}	
			$strWHERE = " WHERE le.DeleteStatus !='Y' and le.accountId = ".$AcctId;
			$strOrder = " ORDER BY le.FAEntryDate, le.CrDr ";
			if($strWHERE != "") {
				$strWHERE = $strWHERE . " AND (lt.fstatus !='p' AND lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P')"; 
			}else{
				$strWHERE = $strWHERE . " (lt.fstatus !='p' AND lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P') ";
			} //AND lt.status !='customeroutstandingstatementload.php'
			// From and To Date checking
			if ($dbdtStart != "" AND $dbdtEnd != "") { 
				if($strWHERE != "") { 
					$strWHERE = $strWHERE . " AND "; 
				}
				$strWHERE = $strWHERE . " le.FAEntryDate BETWEEN '".$dbdtStart."' AND '".$dbdtEnd."'";
			} else {
				throw new Exception ("ErrU001: buildLedgerQuery: Dates should not be empty");
			}
			if($strWHERE != "") {
				 $qryLedger = $qryLedger . $strWHERE . $strOrder;
			}
			return $qryLedger;
		}
		function buildLedgerQuery($AcctId, $dbdtStart, $dbdtEnd,$RouteId,$CashTT) { //and lt.RouteId= '".$RouteId."'
			 if($CashTT == 'Cash'){ $Qry01="lt.TxnTypeId=4"; }else{ $Qry01="lt.TxnTypeId=20 or lt.TxnTypeId=4 or lt.TxnTypeId=5 or lt.TxnTypeId=24";}
			 $qryLedger="SELECT le.FAEntryDate, lt.idLedgerTxn,lt.txnNarration, if(le.CrDr = 1, entryAmt, 0) AS CR, if (le.CrDr = -1, entryAmt, 0) AS DR,TxnTypeId,TxnRefId
						FROM tblledgerentry le JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn
						WHERE le.DeleteStatus !='Y' and le.accountId = '".$AcctId."' 
						AND ($Qry01) and (lt.fstatus !='p' AND lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P')
						and le.FAEntryDate BETWEEN '".$dbdtStart."' AND '".$dbdtEnd."' ORDER BY le.FAEntryDate, le.CrDr ";
			return $qryLedger;
		}
		$srno=0;$CrAmt = 0; $DrAmt = 0;$TotReceivedAmt = 0;$TotPaidAmt = 0;$TotRemainAmt = 0;
		// print_r($idSaleskpost);
		// echo "<br>";
		// print_r($CustomerId);
	for($k=0;$k<sizeOf($CustomerId);$k++){
		$totalrow = 0;
		$sql="select s.PersonId,s.RouteId,s.GRNo,s.multiordergrn,s.idSales,s.VehicleNo,s.RouteName,s.TransportMode,s.PlaceOfSupply,
		s.SalesDate,s.InvoiceDate,p.AcctId,p.Gstin,f.FSSAINo,p.personName,p.personAddress,p.personMobilePrimary from tblsales s 
		JOIN tblperson  p ON s.PersonId=p.idPerson 
		JOIN tblfarmer  f ON p.idPerson=f.PersonId 
		where s.PersonId='".$CustomerId[$k]."' and s.idSales ='".$idSaleskpost[$k]."' and s.DispatchDate ='".$From."' group by s.PersonId desc";
		$res=mysql_query($sql);
		$row=mysql_fetch_array($res); 
		//echo '--------------------------'.
		$printcopy=$_POST['printcopy1_'.$idSaleskpost[$k]];
		$RouteId=$row['RouteId'];
		$GRNo=$row['GRNo'];
		$multiordergrn=$row['multiordergrn'];
		$Date=$row['SalesDate'];
		$InvoiceDate=$row['InvoiceDate'];
		$PersonId=$row['PersonId'];
		$RouteName=$row['RouteName'];
		$FSSAINo=$row['FSSAINo'];
		$VehicleNo=$row['VehicleNo'];
		$TransportMode=$row['TransportMode'];
		if($TransportMode==''){ $TransportMode='Road'; }
		$Transporter='';
		if($VehicleNo!=''){
			$sqlTranVech = "select p.personName from tbltranspvech a join tblperson p ON p.idPerson=a.PersonId where a.VechileNo='".$VehicleNo."'";
			$ResTranVech = mysql_query($sqlTranVech);
			$ResTranVechs = mysql_fetch_array($ResTranVech);
			$Transporter=$ResTranVechs['personName'];
		}
		$personNameGSTIN=$row['Gstin'];
		$PlaceOfSupply=$row['PlaceOfSupply'];
		$personMobilePrimary=$row['personMobilePrimary'];
		$IdAcc=$row['AcctId'];
		$SalesDate = DateTime::createFromFormat($gdbDateFormat,$Date)->format($gstdDateFormat);
		$InvoiceDate = DateTime::createFromFormat($gdbDateFormat,$InvoiceDate)->format($gstdDateFormat);
		$PreDate = date('d/m/Y', strtotime('-1 day', strtotime($From)));
		$PreDate1 = date('Y-m-d', strtotime('-1 day', strtotime($From)));
		$personName=$row['personName'];
		$personAddress=$row['personAddress'];
		$res=mysql_query($sql);
		$row=mysql_fetch_array($res);
		
		$To = date('Y-m-d');
		// $CustomerId[$k]=38; //remove
		$sRecovCrAmt = "select FromDateCredit,ToDateCredit from tblcombinecancrate
							where PersonId='".$CustomerId[$k]."' order by sr desc limit 1";
		$rRecovCrAmt = mysql_query($sRecovCrAmt);
		$rwRecovCrAmt = mysql_fetch_array($rRecovCrAmt);
		$FromDateCredit = $rwRecovCrAmt['FromDateCredit'];
		$ToDateCredit = $rwRecovCrAmt['ToDateCredit'];
		$qryAcctName = "SELECT a.AcctName,a.idAcct,a.AcctTypeId,a.CrDr,a.openbaldate,ac.accTypeName,a.AcctOpBal
											FROM tblaccount a 
											JOIN dimaccttype ac ON ac.idAcctType = a.AcctTypeId
							WHERE a.idAcct = '".$IdAcc."'";
		$resAcctName = mysql_query($qryAcctName);	
		$row1 = mysql_fetch_assoc($resAcctName);
		
		$AcctOpBal = $row1['AcctOpBal'];
		$OpBalCrDr = $row1['CrDr'];
			
				try {
					$dbdtS = $FromDateCredit;//DateTime::createFromFormat($gstdDateFormat, $gFinYearStrtDate)->format($gdbDateFormat);
					$dbdtE = $ToDateCredit;//$To;
					$qryLedger = buildLedgerQuery($IdAcc, $dbdtS, $dbdtE,$RouteId,'');
					$resLedger = mysql_query($qryLedger);
				} catch(Exception $e) {
					echo $e->getMessage();
					die();
				}
			
				while($row = mysql_fetch_assoc($resLedger)) {
					$signedBalBF += ($row['CR'] - $row['DR']);
					 $CrAmt = $CrAmt + $row['CR'];
					 $DrAmt = $DrAmt + $row['DR'];
				}
				$TotReceivedAmt = $TotReceivedAmt+$DrAmt;
				$TotPaidAmt = $TotPaidAmt+$CrAmt;
				$TotRemainAmt = $TotReceivedAmt - $TotPaidAmt;
				$CrAmt = $CrAmt + $AcctOpBal;
				if($signedBalBF < 0){ 
					$signedBalCF = $signedBalBF ;//*-1
				}else{
					$signedBalCF = $signedBalBF ;
				}
	//rrrrrrrrrrrrrrrrr			
				try {
					$dbdtSs = '2016-04-01';//DateTime::createFromFormat($gstdDateFormat, $gFinYearStrtDate)->format($gdbDateFormat);
					$dbdtEs = date('Y-m-d');//$To;
					// echo $qryLedgers = buildLedgerQuery($IdAcc, $dbdtSs, $dbdtEs,$RouteId,'');
					  $qryLedgers = buildLedgerQuerys($IdAcc, $dbdtSs, $dbdtEs);
					$resLedgers = mysql_query($qryLedgers);
				} catch(Exception $e) {
					echo $e->getMessage();
					die();
				}
				$signedBalBFs=0;$signedBalCFs=0;
				
			if($OpBalCrDr == constCREDIT)
				$signedBalBFs = $AcctOpBal * constCREDIT;
			else
				$signedBalBFs = $AcctOpBal * constDEBIT;
				
				while($rows = mysql_fetch_assoc($resLedgers)) {
				 $signedBalBFs += ($rows['CR'] - $rows['DR']); 
				}
				if($signedBalBFs < 0){ 
					$signedBalCFs = $signedBalBFs *-1;
				}else{
					$signedBalCFs = $signedBalBFs ;
				} 
	//rrrrrrrrrrrrrrrrrrr		
				$DelivaryDate= date('Y-m-d', strtotime(str_replace('/', '-',$SalesDate)));
				$DelivaryDate1= date('Y-m-d', strtotime(str_replace('/', '-',$InvoiceDate)));
				// $s020 = "select TodayClsCanB,TodayClsTrayB from tblpaidcan where PersonId='".$CustomerId[$k]."' order by PaidCanDate desc limit 1"; //and PaidCanDate='".$From."'
				$sRecovCan = "select FromDateCan,ToDateCan from tblcombinecancrate
							where PersonId='".$CustomerId[$k]."' and CanRecoveryDate='".$DelivaryDate1."' order by sr asc limit 1";
				$rRecovCan = mysql_query($sRecovCan);
				$rwRecovCan = mysql_fetch_array($rRecovCan);
				$FromDateCan = $rwRecovCan['FromDateCan'];
				$ToDateCan = $rwRecovCan['ToDateCan'];
				
				
				$sRecovCrate = "select FromDatePayRecov,ToDatePayRecov,RecoveryDate from tblcombinecancrate
							where PersonId='".$CustomerId[$k]."' and RecoveryDate='".$DelivaryDate1."' order by sr asc limit 1";
				$rRecovCrate = mysql_query($sRecovCrate);
				$rwRecovCrate = mysql_fetch_array($rRecovCrate);
				$FromDatePayRecov = $rwRecovCrate['FromDatePayRecov'];
				$ToDatePayRecov = $rwRecovCrate['ToDatePayRecov'];
				$RecoveryDatepayn = $rwRecovCrate['RecoveryDate'];
				$s021n = "select sum(ReceivedCrate) as ReceivedCrate,sum(PaidCrate) as PaidCrate,sum(FinalAmt) as TotPlusGST,
				sum(ProPaidCrate) as ProPaidCrate,sum(ProReceivedCrate) as ProReceivedCrate 
				from tblscrapmilk where PersonId='".$CustomerId[$k]."' and InvoiceDate between '".$FromDatePayRecov."' and '".$ToDatePayRecov."'"; //and PaidCanDate='".$From."'
				$r021n = mysql_query($s021n);
				$rw021n = mysql_fetch_array($r021n);
				$PENDING_AMOUNT=0;
				if($DelivaryDate1 == $RecoveryDatepayn){
					$PENDING_AMOUNT = $rw021n['TotPlusGST'];
				}
				
				$sRecovCrate = "select FromDateCrate,ToDateCrate from tblcombinecancrate
							where PersonId='".$CustomerId[$k]."' and CrateRecoveryDate='".$DelivaryDate1."' order by sr asc limit 1";
				$rRecovCrate = mysql_query($sRecovCrate);
				$rwRecovCrate = mysql_fetch_array($rRecovCrate);
				$FromDateCrate = $rwRecovCrate['FromDateCrate'];
				$ToDateCrate = $rwRecovCrate['ToDateCrate'];
				
				$s020 = "select (ReceivedCan) as ReceivedCan,(PaidCan) as PaidCan,
				(ProPaidCan) as ProPaidCan,(ProReceivedCan) as ProReceivedCan 
				from tblscrapmilk where PersonId='".$CustomerId[$k]."' and
				InvoiceDate between '".$FromDateCan."' and '".$ToDateCan."' and DeleteStatus !='Y' and (ReceivedCrate >0 or ProReceivedCrate >0 or PaidCrate >0 or ProPaidCrate >0 
				or ReceivedCan >0 or ProReceivedCan >0 or PaidCan >0 or ProPaidCan >0) group by SalesId asc"; //and PaidCanDate='".$From."'
				$r020 = mysql_query($s020);
				$UnpaidCan=0;
				while($rw020 = mysql_fetch_array($r020)){
				
				// $UnpaidCan = $rw020['ReceivedCan']+$rw020['ProReceivedCan']-$rw020['PaidCan']-$rw020['ProPaidCan'];
				$UnpaidCan += ($rw020['ReceivedCan']+$rw020['ProReceivedCan']);
				// $UnpaidCan = $rw020['PaidCan']+$rw020['ProPaidCan'];
				}
				$s021 = "select (ReceivedCrate) as ReceivedCrate,(PaidCrate) as PaidCrate,(FinalAmt) as TotPlusGST,
				(ProPaidCrate) as ProPaidCrate,(ProReceivedCrate) as ProReceivedCrate 
				from tblscrapmilk where PersonId='".$CustomerId[$k]."' 
				and InvoiceDate between '".$FromDateCrate."' and '".$ToDateCrate."' and DeleteStatus !='Y' and (ReceivedCrate >0 or ProReceivedCrate >0 or PaidCrate >0 or ProPaidCrate >0 
				or ReceivedCan >0 or ProReceivedCan >0 or PaidCan >0 or ProPaidCan >0) group by SalesId asc"; //and PaidCanDate='".$From."'
				$r021 = mysql_query($s021);
				$UnpaidTray=0;
				while($rw021 = mysql_fetch_array($r021)){
					 // $UnpaidTray = $rw021['ReceivedCrate']+$rw021['ProReceivedCrate']-$rw021['ProPaidCrate']-$rw021['PaidCrate'];
					$UnpaidTray += ($rw021['ReceivedCrate']+$rw021['ProReceivedCrate']);
					// $UnpaidTray = $rw021['ProPaidCrate']+$rw021['PaidCrate'];
				}
				$FromDate='2018-01-04';
				$ToDate=date('Y-m-d');
				 $s020e = "select sum(ReceivedCan) as ReceivedCan,sum(PaidCan) as PaidCan,
				sum(ProPaidCan) as ProPaidCan,sum(ProReceivedCan) as ProReceivedCan 
				from tblscrapmilk where PersonId='".$CustomerId[$k]."' and SalesId ='".$idSaleskpost[$k]."' and InvoiceDate between '".$FromDate."' and '".$ToDate."'"; //and PaidCanDate='".$From."'
				$r020e = mysql_query($s020e);
				$rw020e = mysql_fetch_array($r020e);
				
				$s021e = "select sum(ReceivedCrate) as ReceivedCrate,sum(PaidCrate) as PaidCrate,
				sum(ProPaidCrate) as ProPaidCrate,sum(ProReceivedCrate) as ProReceivedCrate 
				from tblscrapmilk where PersonId='".$CustomerId[$k]."' and SalesId ='".$idSaleskpost[$k]."' and InvoiceDate between '".$FromDate."' and '".$ToDate."'"; //and PaidCanDate='".$From."'
				$r021e = mysql_query($s021e);
				$rw021e = mysql_fetch_array($r021e);
				
				 $UnpaidCane = $rw020e['ReceivedCan']+$rw020e['ProReceivedCan']-$rw020e['PaidCan']-$rw020e['ProPaidCan'];
				
				 $UnpaidTraye = $rw021e['ReceivedCrate']+$rw021e['ProReceivedCrate']-$rw021e['ProPaidCrate']-$rw021e['PaidCrate'];
	 ?>
		
		<div class="muktaiDELIVERY" id="muktai" >
			<div class="page" style=''>
			<div class="report31" id="report3" <?php if($printcopy=='' || $printcopy=='CC'){ }else{ ?> style="display:none;" <?php } ?> >
				<div class="bill" style="">	
					<div class="container" style="border-bottom:0.5px dashed black;">
						<div class="one">
								<div class="invoiceheader" style="margin-bottom:0px;margin-top:0px;font-family: Cambria;"><b><?php echo $CompanyName;?></b></div>
								<div class="invoiceaddress1" style="margin-bottom:0px;margin-top:0px;">
								<?php  $CompanyAddress=strtolower($CompanyAddress);
									echo ucwords($CompanyAddress); ?>
								</div>
								<div class="invoiceaddress1" style="margin-bottom:0px;margin-top:0px;"><?php if($companyemail!='' || $CompanyMob!=''){ echo "Contact : ".$CompanyMob." / "."Email : ".$companyemail." / "."Website : www.saharaagro.com"; } ?> </div>
								<?php if($GSTIN !=''){ ?><div class="invoiceaddress1" style="font-size:11.5px;margin-bottom:0px;margin-top:0px;"> GSTIN: <?php echo $GSTIN ?>, STATE:MAHARASHTRA, STATE CODE:27 </div><?php } ?>
								<div class="invoiceaddress1" style="margin-bottom:0px;margin-top:0px;"><center style='font-size:16px;font-family:cambria;'><b>Bill Of Supply</b></center></div>
						</div>	
						<div class="two">
							<img class="img-responsive" src="logo/<?php echo $logo;?>" width="180" height="90" style="margin-left:-8%;">
						</div>	
					</div>
						
					<div class="muktai" style="margin-bottom:1px;">
							<div class="MainRLside">
							<table class="tblcust1GST" cellpadding="5" style='line-height:2.42857143;width:99.99%;border-collapse:collapse;height: auto;' >
								<tr>
									<td class="editlabelclass" hideshow="SalesInfoName">Buyer Name :</td>
									<td class="boldc" hideshow="SalesInfoName"><b><?php echo $personName ?></b></td>
									<td class="editlabelclass" hideshow="SalesInfoInvoiceNo">Bill Of Supply No :</td>
									<td class="boldc" hideshow="SalesInfoInvoiceNo"><?php echo $GRNo ?></td>
									<td class="editlabelclass" hideshow="SalesInfoDateOfSupply">Invoice Date:</td>
									<td class="boldc" hideshow="SalesInfoDateOfSupply"><b><?php echo $InvoiceDate ?></b></td>
								</tr>
								<tr>
									<td class="editlabelclass" hideshow="SalesInfoMobileNo">Conatact No :</td>
									<td class="boldc" hideshow="SalesInfoMobileNo"><b><?php echo $personMobilePrimary ?></b></td>
									<td class="editlabelclass" hideshow="SalesInfoPlaceOfSupply">Place of Supply :</td>
									<!--td class="boldc" hideshow="SalesInfoPlaceOfSupply"><?php //echo $PlaceOfSupply; ?></td-->
									<td class="boldc" hideshow="SalesInfoPlaceOfSupply"><?php echo $personAddress; ?></td>
									<td class="editlabelclass" hideshow="SalesInfoLrPoNo">PO No :</td>
									<td class="boldc" hideshow="SalesInfoLrPoNo"><?php echo $multiordergrn ?></td>
								</tr>
								<tr>
									<td class="editlabelclass" hideshow="SalesInfoGstin">GSTIN :</td>
									<td class="boldc" hideshow="SalesInfoGstin"><?php echo $personNameGSTIN ?></td>
									<td class="editlabelclass" hideshow="SalesInfoTranspMode">Transport Mode :</td>
									<td class="boldc" hideshow="SalesInfoTranspMode"><?php echo $TransportMode; ?></td>
									<td class="editlabelclass" hideshow="SalesInfoVehicleNo">Vehicle No :</td>
									<td class="boldc" hideshow="SalesInfoVehicleNo"><b><?php echo $VehicleNo; ?></b></td>
								</tr>
								<tr>
									<td class="editlabelclass" hideshow="SalesInfoFssaiNo">Fssai No:</td>
									<td class="boldc" hideshow="SalesInfoFssaiNo"><?php echo $FSSAINo; ?></td>
									<td class="editlabelclass" hideshow="SalesInfoTraspoterName">Transporter Name:</td>
									<td class="boldc" hideshow="SalesInfoTraspoterName"><?php echo $Transporter; ?></td>
									<td class="editlabelclass" hideshow="SalesInfoRouteName">Route Name :</td>
									<td class="boldc" hideshow="SalesInfoRouteName"><b><?php echo $RouteName; ?></b></td>
								
								</tr>
							</table>
							</div>
							</div>
						  
					<div class="muktai" style="margin-bottom:5px;">
						<div class="MainRLside">
							<table  class="tblcust1GST" cellpadding="5" style=" border:1px solid #777575;font-weight: normal ! important; border-left: hidden;border-right: hidden;font-size:11;">
							<tr style="font-size:11px;height:25px;"> 
							   <td class="tdatadfirst text-center editlabelclass">Sr.No</td>
							   <td class="tdatadfirst text-center editlabelclass">Product Description</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowHSNCodeC">HSN Code</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowNoofCrates">No.Of Crates</td>
							   <td class="tdatadfirst text-center editlabelclass">Qty</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowUnit">Unit</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowRtnQty">Extra Qty</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowLeakage">Rtn Qty</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowRATEC">Rate</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowAmountC">Amount</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowGSTPerC">GST %</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowGST">GST Amount</td>
							   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowTotalC">Total Amount</td>
						  </tr>
						  <?php 
							$GTotal = 0;
							$Qty = 0;
							$itemamount = 0;
							$TaxAmt = 0;
							$finalamt = 0;
							$srno = 1;
							$offerqtytot=0;$SchemeQtytot=0;
							$SoftCrateQtytot=0;$SoftCrateQtytotoff=0;$SoftCrateQtytotsch=0;
							  $SQLSalesDtls="select u.UOMName,sd.itemid,s.GRNo,s.idSales,s.RouteName,s.SalesDate,sum(sd.itemQty) as itemQty,sum(sd.TaxAmt) as TaxAmt,sum(sd.TotalAmt) as TotalAmt,sum(sd.SchemeQty) as SchemeQty,
									i.ItemName,i.hsncode ,i.Unit,i.vatpercentage,sd.itemRate from tblsales s 
									JOIN tblsalesdetails sd ON sd.salesId=s.idSales
									JOIN tblitem i ON i.idItem=sd.itemId
									Join dimuom u on u.idUOM = i.itemUOMId
									where s.PersonId='".$CustomerId[$k]."' and s.idSales ='".$idSaleskpost[$k]."' and s.DispatchDate ='".$From."' 
									and s.DeleteStatus !='Y' and sd.DeleteStatus !='Y' and sd.SchemeOffer !='Yes' group by sd.itemId order by i.idSubcategory desc, sd.idSalesDetails asc";
							$RESSalesDtls = mysql_query($SQLSalesDtls);
							  $rowscount=mysql_num_rows($RESSalesDtls);
							while($RowSalesDtls = mysql_fetch_assoc($RESSalesDtls)) {
							++$i;
							++$totalrow;
							++$pagerowcount;
							$GOrderQty = $GOrderQty+$RowSalesDtls['itemQty'];
							$GSchemeQty = $GSchemeQty+$RowSalesDtls['SchemeQty'];
							$offeritemid = $RowSalesDtls['offeritemid'];
							$idSales = $RowSalesDtls['idSales'];
							$itemid = $RowSalesDtls['itemid'];
							$RouteName = $RowSalesDtls['RouteName'];
							
							$s00 = "select u.UOMName,i.ItemName,i.hsncode,i.Unit,i.vatpercentage,sd.itemRate,sum(sd.itemQty) as offerqty from tblsales s 
									JOIN tblsalesdetails sd ON sd.salesId=s.idSales
									JOIN tblitem i ON i.idItem = sd.itemId
									Join dimuom u on u.idUOM = i.itemUOMId
									where s.idSales='".$idSales."' and sd.offeritemid = '".$itemid."'
									and s.DeleteStatus !='Y' and sd.DeleteStatus !='Y' and sd.SchemeOffer='Yes' group by sd.itemId desc";
							$r00 = mysql_query($s00);
							$rw00 = mysql_fetch_array($r00);
							$OfferItem = $rw00['ItemName'];
							$offerqty = $rw00['offerqty'];
							$hsncode = $rw00['hsncode'];
							$Unit = $rw00['Unit'];
							$UOMName = $rw00['UOMName'];
							$vatpercentage = $rw00['vatpercentage'];
							$sqlsoftqty = "SELECT RootName,cantainertype FROM tblfarmer where RootName='".$RouteName."' group by RootName";
							$rsoftqty = mysql_query($sqlsoftqty);
							$rwsoftqty = mysql_fetch_array($rsoftqty);
							$cantainertype = $rwsoftqty['cantainertype'];
							$SoftCrateQty1ss = explode('ltrcratein',$cantainertype);
							if($SoftCrateQty1ss[1]!=''){ $cantainertype=$SoftCrateQty1ss[1]; }
							$SoftCrateQty1 = explode('ltr',$cantainertype);
							$SoftCrateQty2 = $SoftCrateQty1[0];
							$SoftCrateQty3 = number_format($RowSalesDtls['itemQty'] / $SoftCrateQty2,1);
							$SoftCrateQty4=explode('.',$SoftCrateQty3);
							// $SoftCrateQty=$SoftCrateQty4[0];
							$SoftCrateQty=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
							// if($SoftCrateQty4[0] <=0){ $SoftCrateQty=1;}
							?>
							<tr style="height:25px" >
							   <td class="tdatadfirst1  text-center" width="10%"><?php echo $srno++;?></td>
							   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $RowSalesDtls['ItemName'];//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowHSNCodeC"><?php echo $RowSalesDtls['hsncode'];?></td>
							   <th class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowNoofCrates"><?php echo $SoftCrateQty;?></th>
							   <th class="tdatadfirst1"  style="text-align:center;"><?php echo number_format($RowSalesDtls['itemQty'],2);?></th>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowUnit"><?php echo $RowSalesDtls['UOMName'];?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRATEC"><?php echo number_format($RowSalesDtls['itemRate'],2);?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowAmountC"><?php echo number_format(($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate']),2);?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowGSTPerC"><?php echo $RowSalesDtls['vatpercentage'];?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowGST"><?php echo number_format($RowSalesDtls['TaxAmt'],2);?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowTotalC"><?php echo number_format(($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate'])+$RowSalesDtls['TaxAmt'],2);?></td>
							 </tr>
							<?php  if($RowSalesDtls['SchemeQty']>0){ 
								$SoftCrateQty3 = number_format($RowSalesDtls['SchemeQty'] / $SoftCrateQty2,1);
								$SoftCrateQty4=explode('.',$SoftCrateQty3);
								$SoftCrateQtysch=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
								// if($SoftCrateQty4[0] <=0){ $SoftCrateQtysch=1;}
							?>
							 <tr style="height:25px" >
							   <td class="tdatadfirst1  text-center" width="10%"><?php echo $srno++;?></td>
							   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $RowSalesDtls['ItemName'].' ( Scheme )';//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowHSNCodeC"><?php echo $RowSalesDtls['hsncode'];?></td>
							   <th class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowNoofCrates"><?php echo $SoftCrateQtysch;?></th>
							   <th class="tdatadfirst1"  style="text-align:center;"><?php echo number_format($RowSalesDtls['SchemeQty'],2);?></th>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowUnit"><?php echo $RowSalesDtls['UOMName'];?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRATEC"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowAmountC"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowGSTPerC"><?php //echo $RowSalesDtls['vatpercentage'];?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowGST"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowTotalC"><?php //echo number_format(0,2);?></td>
							 </tr>
							<?php 
							$SchemeQtytot+=$RowSalesDtls['SchemeQty'];
							$SoftCrateQtytotsch+=$SoftCrateQtysch;
							} ?>
							<?php  if($offerqty>0){ 
								$SoftCrateQty3 = number_format($offerqty / $SoftCrateQty2,1);
								$SoftCrateQty4=explode('.',$SoftCrateQty3);
								$SoftCrateQtyo=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
								// if($SoftCrateQty4[0] <=0){ $SoftCrateQtyo=1;}
							?>
							 <tr style="height:25px" >
							   <td class="tdatadfirst1 text-center" width="10%"><?php echo $srno++;?></td>
							   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $OfferItem.' ( Offer )';//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowHSNCodeC"><?php echo $hsncode;?></td>
							   <th class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowNoofCrates"><?php echo $SoftCrateQtyo;?></th>
							   <th class="tdatadfirst1" style="text-align:center;"><?php echo number_format($offerqty,2);?></th>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowUnit"><?php echo $UOMName;?></td>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowRATEC"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1" style="text-align:right;" hideshow="SalesRowAmountC"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowGSTPerC"><?php //echo $vatpercentage;?></td>
							   <td class="tdatadfirst1" style="text-align:right;" hideshow="SalesRowGST"><?php //echo number_format(0,2);?></td>
							   <td class="tdatadfirst1" style="text-align:right;" hideshow="SalesRowTotalC"><?php //echo number_format(0,2);?></td>
							 </tr>
							<?php 
							$offerqtytot+=$offerqty;
							$SoftCrateQtytotoff+=$SoftCrateQtyo;
							} ?>
							<?php // $srno++;
								$Qty+=$RowSalesDtls['itemQty'];
								$SoftCrateQtytot+=$SoftCrateQty;
								$itemamount+=($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate']);
								$TaxAmt+=($RowSalesDtls['TaxAmt']);
								$finalamt+=($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate'])+$RowSalesDtls['TaxAmt'];
								} ?>
						<tr style="height:25px;" class="">
						   <th class="tdatadfirst editlabelclass" colspan=2 style="margin-left:1px;text-align:center;" >TOTAL</th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowHSNCodeC"></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowNoofCrates"><?php echo number_format($SoftCrateQtytot+$SoftCrateQtytotoff+$SoftCrateQtytotsch,0); ?></th>
						   <th class="tdatadfirst"  style="text-align:center;"><?php echo number_format($Qty+$offerqtytot+$SchemeQtytot,2); ?></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowUnit"></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowRtnQty"></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowLeakage"></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowRATEC"></th>
						   <th class="tdatadfirst"  style="text-align:right;" hideshow="SalesRowAmountC"><?php echo number_format($itemamount,2); ?></th>
						   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowGSTPerC"></th>
						   <th class="tdatadfirst"  style="text-align:right;" hideshow="SalesRowGST"><?php echo number_format($TaxAmt,2); ?></th>
						   <th class="tdatadfirst"  style="text-align:right;" hideshow="SalesRowTotalC"><?php echo number_format($finalamt,2); ?></th>
						</tr>
						</table>
					 
						</div>
					</div>
					
					<div class="muktai"  style="margin-bottom:1px;">
						<div class="one1">
							<div class="left" hideshow="SalesRowTRecvDetails">
								<table  class="tblcust1GST" cellpadding="5" style="font-size:11;border:1px solid #777575;font-weight: normal ! important;border-left: hidden;">
									<tr style="font-size:11px;height:25px;"> 
									   <td class="tdatadfirst text-center editlabelclass" colspan="2">Today Receivable Details</td>
									</tr>
									<tr style="border-top: hidden;font-size:11px;height:25px;"> 
									   <td class="tdatadfirst text-center" style='border-top: none;' colspan=2 ></td>
									</tr>
									
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass"  style="text-align:center;"><b>Crate</b></td>
									   <td class="tdatadfirst1"  style="text-align:right;"><b><?php if($FromDateCrate == $DelivaryDate1){ echo 'As Per Bill'; /*number_format($SoftCrateQtytot+$SoftCrateQtytotoff+$SoftCrateQtytotsch,0);*/ }else{ echo number_format($UnpaidTray,0); } ?></b></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass"  style="text-align:center;"><b>Can</b></td>
									   <td class="tdatadfirst1"  style="text-align:right;"><b><?php if($FromDateCan == $DelivaryDate1){ echo 'As Per Bill'; }else{ echo number_format($UnpaidCan,0); } ?></b></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass" style="text-align:center;" ><b>Amount</b></td>
									   <td class="tdatadfirst1" style="text-align:right;" ><b><?php if($FromDatePayRecov == $DelivaryDate1){ echo 'As Per Bill'; }else{ echo number_format($PENDING_AMOUNT,2);  } //number_format($signedBalCF,2); ?></b></td>
									</tr>
								</table>
							</div>
							<div class="left hidden">
								<table  class="tblcust1GST" cellpadding="5" style="font-size:11;border:1px solid #777575;font-weight: normal ! important;border-left: hidden;">
									<tr style="font-size:11px;height:25px;"> 
									   <td class="tdatadfirst text-center editlabelclass" colspan=2 >Today Receivable Details</td>
									</tr>
									<tr style="border-top: hidden;font-size:11px;height:25px;"> 
									   <td class="text-center" style='border: none;' colspan=2 ></td>
									</tr>
									<?php 
										$s10 = "select PaymentRecovery from tblcombinecancrate where PersonId = '".trim($PersonId)."' 
										and RecoveryDate between '".date('Y-m-d',strtotime($DelivaryDate1))."' and '".date('Y-m-d',strtotime($DelivaryDate1))."' order by idCombine desc";
										$r10 = mysql_query($s10);
										$rw10 = mysql_fetch_array($r10);
										$PaymentRecovery = $rw10['PaymentRecovery'];
										
										$s101 = "select CrateRecovery,CanRecovery from tblcombinecancrate where PersonId = '".trim($PersonId)."' 
										and FromDateCanCrate <='".date('Y-m-d',strtotime($DelivaryDate1))."' and ToDateCanCrate >='".date('Y-m-d',strtotime($DelivaryDate1))."' order by idCombine desc";
										$r101 = mysql_query($s101);
										$rw101 = mysql_fetch_array($r101);
										$CrateRecovery = $rw101['CrateRecovery'];
										$CanRecovery = $rw101['CanRecovery'];
									?>
									<tr style="height:25px" >
										<td class="tdatadfirst editlabelclass"  style="text-align:center;">Crate</td>
									   <td class="tdatadfirst"  style="text-align:center;"><?php echo $CrateRecovery; ?></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass"  style="text-align:center;">Can</td>
									   <td class="tdatadfirst1"  style="text-align:center;"><?php echo $CanRecovery; ?></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass" style="text-align:center;" >Amount</td>
										<td class="tdatadfirst1" style="text-align:right;" ><?php echo number_format($PaymentRecovery,2); ?></td>
									</tr>
								</table>
							</div>
							<div class="left" hideshow="SalesRowTTransDetails">
								<table  class="tblcust1GST" cellpadding="5" style="font-size:11;border:1px solid #777575;font-weight: normal ! important;border-left: hidden;">
									<tr style="font-size:11px;height:25px;"> 
								   <td class="tdatadfirst text-center" colspan=3 >Todays Transaction Details</td>
								  </tr>
								  <tr style="font-size:11px;height:25px;"> 
									   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" ></td>
									   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" >Given</td>
									   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" >Received</td>
								  </tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 text-center editlabelclass">Crate</td>
									   <td class="tdatadfirst1"  style="text-align:right;"></td>
									   <td class="tdatadfirst1"  style="text-align:right;"></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 text-center editlabelclass">Can</td>
									   <td class="tdatadfirst1"  style="text-align:right;"></td>
									   <td class="tdatadfirst1"  style="text-align:right;"></td>
									</tr>
									<tr style="height:25px" >
									   <td class="tdatadfirst1 editlabelclass" colspan="3" style="margin-left:1px;" >Received Amt</td>
									</tr>
								</table>
							</div>
							<div class="left" hideshow="SalesRowBuyerLedger">
			 
								<table  class="tblcust1GST" cellpadding="5" style="font-size:11;border:1px solid #777575;font-weight: normal ! important;border-right: hidden;border-left: hidden;">
									<?php 
										$GiveCans = 0;$PreCashAmt = 0;$signedBalBF = 0;
										$GiveTrays = 0;$TotPlusGST1m2 = 0;$CashAmt112 = 0;
										$ReceivedCans = 0;
										$ReceivedTrays = 0;
										$GiveCan = 0;
										$GiveTray = 0;
										$ReceivedCan = 0;
										$ReceivedTray = 0;
										$TotPlusGST1m = 0;
										
										// $s03 = "select sum(TodayPaidCan) as TodayPaidCan,sum(TodayPaidTray) as TodayPaidTray,
										// sum(TodayPaidCanB) as TodayPaidCanB,sum(TodayPaidTrayB) as TodayPaidTrayB from tblpaidcan 
										// where PersonId='".$CustomerId[$k]."' and PaidCanDate = '".$From."'";
										// $r03 = mysql_query($s03);
										// $rw03 = mysql_fetch_array($r03);
										// $PaidCan = $rw03['TodayPaidCan'];
										// $PaidTray = $rw03['TodayPaidTray'];
										// $PaidCanB = $rw03['TodayPaidCanB'];
										// $PaidTrayB = $rw03['TodayPaidTrayB'];
										
										// $ReceivedCan = $PaidCan + $PaidTray;
										// $ReceivedTray = $PaidCanB + $PaidTrayB;
										$opendate = $date = str_replace('/', '-', $gFinYearStrtDate);

										$se="select o.milkcrate10ltr,o.productcrate10ltr,o.milkcrate12ltr,o.productcrate12ltr,o.milkcan,o.productcan from tblopencancratestk o 
											join tblfarmer f on f.acctId=o.AccountNo where f.PersonId='".trim($CustomerId[$k])."' and o.openbaldate BETWEEN '".date('Y-m-d', strtotime($opendate))."' AND '".date('Y-m-d', strtotime($From))."'";
										$rs00e = mysql_query($se);
										$rw00e = mysql_fetch_assoc($rs00e);
										$opencrate=($rw00e['milkcrate10ltr']+$rw00e['milkcrate12ltr'])+($rw00e['productcrate10ltr']+$rw00e['productcrate12ltr']);
										$opencan=($rw00e['milkcan'])+($rw00e['productcan']);
										$PreDate1 = str_replace('/', '-', $PreDate);
										$s01 = "select (CashAmt) as CashAmt,(NFTAmt) as NFTAmt,(RTGSAmt) as RTGSAmt,(ChequeAmt) as ChequeAmt,(TotPlusGST) as TotPlusGST,(ReturnAmt) as ReturnAmt ,(SampleAmt) as SampleAmt,(SpoilAmt) as SpoilAmt from tblscrapmilk where DeleteStatus !='Y' and PersonId='".$CustomerId[$k]."' and InvoiceDate <= '".date('Y-m-d',strtotime($From))."' 
												and SalesId != '$idSales' and (ReceivedCrate >0 or ProReceivedCrate >0 or PaidCrate >0 or ProPaidCrate >0 
												or ReceivedCan >0 or ProReceivedCan >0 or PaidCan >0 or ProPaidCan >0) group by SalesId desc limit 1";
										$r01 = mysql_query($s01);
										$CashAmt11=0;$TotPlusGST1m=0;
										while($rw01 = mysql_fetch_array($r01)){
											$CashAmt11 += ($rw01['CashAmt']+$rw01['NFTAmt']+$rw01['RTGSAmt']+$rw01['ChequeAmt']);
											$TotPlusGST1m += ($rw01['TotPlusGST']-($rw01['ReturnAmt']+$rw01['SampleAmt']+$rw01['SpoilAmt']));
										}
										$s01 = "select ReceivedCan as MilkCan,ReceivedCrate as MilkTray,
												ProReceivedCan as ProCan,ProReceivedCrate as ProTray,
												PaidCan as PaidMilkCan,PaidCrate as PaidMilkTray,
												ProPaidCan as PaidProCan,ProPaidCrate as PaidProTray
												from tblscrapmilk where DeleteStatus !='Y' and PersonId='".$CustomerId[$k]."' and InvoiceDate <= '".date('Y-m-d',strtotime($From))."' 
												and SalesId != '$idSales' and (ReceivedCrate >0 or ProReceivedCrate >0 or PaidCrate >0 or ProPaidCrate >0 
												or ReceivedCan >0 or ProReceivedCan >0 or PaidCan >0 or ProPaidCan >0) group by SalesId desc limit 1";
										$r01 = mysql_query($s01);
										$GiveCan=0;$GiveTray=0;$ReceivedCan=0;$ReceivedTray=0;
										while($rw01 = mysql_fetch_array($r01)){
											$GiveCan += ($rw01['MilkCan']+$rw01['ProCan']);
											$GiveTray += ($rw01['MilkTray']+$rw01['ProTray']);
											$ReceivedCan += ($rw01['PaidMilkCan']+$rw01['PaidProCan']);
											$ReceivedTray += ($rw01['PaidMilkTray']+$rw01['PaidProTray']);
											// $TotPlusGST1m += ($rw01['TotPlusGST']-($rw01['ReturnAmt']+$rw01['SampleAmt']+$rw01['SpoilAmt']));
											// $CashAmt11 += $rw01['CashAmt'];
										}
										
										$s01s = "select (CashAmt) as CashAmt,(NFTAmt) as NFTAmt,(RTGSAmt) as RTGSAmt,(ChequeAmt) as ChequeAmt,(FinalAmt) as TotPlusGST,(ReceivedCan) as MilkCan,(ReceivedCrate) as MilkTray,
										(ProReceivedCan) as ProCan,(ProReceivedCrate) as ProTray,
										(PaidCan) as PaidMilkCan,(PaidCrate) as PaidMilkTray,
										(ProPaidCan) as PaidProCan,(ProPaidCrate) as PaidProTray
										from tblscrapmilk where DeleteStatus !='Y' and PersonId='".$CustomerId[$k]."' 
										and InvoiceDate <= '".date('Y-m-d',strtotime($From))."' and SalesId != '$idSales' 
										and (ReceivedCrate >0 or ProReceivedCrate >0 or PaidCrate >0 or ProPaidCrate >0 
										or ReceivedCan >0 or ProReceivedCan >0 or PaidCan >0 or ProPaidCan >0) group by SalesId";
										
										$r01s = mysql_query($s01s);
										$GiveCans=0;$GiveTrays=0;$ReceivedCans=0;$ReceivedTrays=0;$TotPlusGST1m2=0;$CashAmt112=0;
										while($rw01s = mysql_fetch_array($r01s)){
											$GiveCans += ($rw01s['MilkCan']+$rw01s['ProCan']);
											$GiveTrays += ($rw01s['MilkTray']+$rw01s['ProTray']);
											$ReceivedCans += ($rw01s['PaidMilkCan']+$rw01s['PaidProCan']);
											$ReceivedTrays += ($rw01s['PaidMilkTray']+$rw01s['PaidProTray']);
											$TotPlusGST1m2 += $rw01s['TotPlusGST'];
											$CashAmt112 += ($rw01s['CashAmt']+$rw01s['NFTAmt']+$rw01s['RTGSAmt']+$rw01s['ChequeAmt']);
										}
										
										$Qry = "JOIN tblsales s ON s.idSales = sc.SalesId
										where sc.PersonId='".$CustomerId[$k]."' and sc.InvoiceDate ='".date('Y-m-d',strtotime($PreDate1))."'";
										
										$To = date('Y-m-d',strtotime($PreDate1));
										try {
											$dbdtS = $To;//DateTime::createFromFormat($gstdDateFormat, $gFinYearStrtDate)->format($gdbDateFormat);
											$dbdtE = $To;
											$qryLedger = buildLedgerQuery($IdAcc, $dbdtS, $dbdtE,$RouteId,'Cash');
											$resLedger = mysql_query($qryLedger);
										} catch(Exception $e) {
											echo $e->getMessage();
											die();
										}
									
										while($row = mysql_fetch_assoc($resLedger)) {
											$signedBalBF += ($row['CR'] - $row['DR']);
											 $PreCashAmt = $PreCashAmt + $row['DR'];
										}
										
										$sPreCash = "select s.CashCreditId,sc.CashAmt,sc.NFTAmt,sc.RTGSAmt,sc.ChequeAmt,sc.VchIdSales from tblscrapmilk sc ".$Qry;
										$rsPreCash = mysql_query($sPreCash);
										$rwPreCash = mysql_fetch_array($rsPreCash);
										// $PreCashAmt = $rwPreCash['CashAmt'];
										
										$VchIdSales = $rwPreCash['VchIdSales'];
										$CashCreditId = $rwPreCash['CashCreditId'];
										if($CashCreditId ==1){
											$s11 = "select sum(sc.FinalAmt) as TotPlusGST from tblscrapmilk sc ".$Qry." and sc.DeleteStatus !='Y'";
											$rs11 = mysql_query($s11);
											$rw11 = mysql_fetch_array($rs11);
											$CashTransactionAmt = $rw11['TotPlusGST'];
										}
										$TotPrevDateCash = $PreCashAmt + $CashTransactionAmt;
										$s11a = "select sum(sc.FinalAmt) as TotPlusGST from tblscrapmilk sc ".$Qry." and sc.DeleteStatus !='Y'";
										$rs11a = mysql_query($s11a);
										$rw11a = mysql_fetch_array($rs11a);
										$CashTransactionAmta = $rw11a['TotPlusGST'];
									?>
									<tr style="font-size:11px;height:25px;"> 
										<td class="tdatadfirst text-center" colspan="4">Buyer Ledger up to last Trans</td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="tdatadfirst text-center editlabelclass" ></td>
										<td class="tdatadfirst text-center editlabelclass" >Last Trans Sale/Given</td>
										<td class="tdatadfirst text-center editlabelclass" >Last Trans Receipts</td>
										<td class="tdatadfirst text-center editlabelclass" >Total Balance up to Last Trans</td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="tdatadfirst1 text-center editlabelclass" >Crate</td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($GiveTray,0);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($ReceivedTray,0);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($opencrate+($GiveTrays-$ReceivedTrays),0);//number_format($UnpaidTraye,2);?></td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="tdatadfirst1 text-center editlabelclass" >Can</td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($GiveCan,0);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($ReceivedCan,0);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($opencan+($GiveCans-$ReceivedCans),0); //number_format($UnpaidCane,2);?></td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="tdatadfirst1 text-center editlabelclass" >Amount</td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($TotPlusGST1m,2);//number_format($CashTransactionAmta,2);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php echo number_format($CashAmt11,2); //number_format($TotPrevDateCash,2);?></td>
										<td class="tdatadfirst1" style="text-align:right;"><?php /*echo number_format($TotPlusGST1m2,2); */ echo number_format($signedBalCFs,2);?></td>
									</tr>
								</table>
							</div>
						</div>
						<div class="one1">
							<div class="left">
								<table  class="tblcust1GST" cellpadding="5" style=" border-left: hidden;font-size:11;">
									<tr style="font-size:11px;height:20px;"> 
										<td class="boldc text-right editlabelclass" colspan=9 >Certified that the perticulars given above are true and correct.</td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="editlabelclass" style="margin-left:1px;border-top:1px solid #777575;" >Bank Details:</td>
										<td class="boldc" style="margin-left:1px;border-top:1px solid #777575;" >CANARA BANK</td>
										<td class="editlabelclass" style="margin-left:1px;" >Branch : </td>
										<td class="boldc" style="margin-left:1px;" ><?php echo $BranchName; ?></td>
										<td class="editlabelclass" style="margin-left:1px;" >IFSC Code:</td>
										<td class="boldc" style="margin-left:1px;border-right:1px solid #777575;" ><?php echo $IFSCcode; ?></td>
										<td class="" colspan=3 style="margin-left:1px;border-right:1px solid #777575;" ></td>
									</tr>
									<tr style="font-size:11px;height:25px;"> 
										<td class="editlabelclass" style="margin-left:1px;" >A/C Name:</td>
										<td class="boldc" colspan=2 style="margin-left:1px;" ><?php echo $CompanyName; ?></td>
										<td class="editlabelclass" style="margin-left:1px;" >CA A/C No: </td>
										<td class="boldc" colspan=2  style="margin-left:1px;border-right:1px solid #777575;" ><?php echo $accountNumber; ?>   </td>
										<td class="editlabelclass text-center" style="margin-left:1px;" >Receiver Sign</td>
										<td class="editlabelclass text-center" style="margin-left:1px;" >Supervisor</td>
										<td class="editlabelclass text-center" style="margin-left:1px;border-right:1px solid #777575;" >Account Manager</td>
									</tr>
									<tr style="font-size:11px;height:20px;"> 
										<td class="editlabelclass text-center" colspan=9 style="margin-left:1px;border-top:1px solid #777575;" >I / We hearby certify that food / foods mentioned in this invoice are warranted to be of the same in nature and quality , which it / these purports / purport to be.</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
	<?php if($printcopy=='' && $srno>10){ ?> 	
		</div>
		</div>
		<div class="page-break" style="page-break-after: always;"></div>
		<?php echo "<br>";  ?>
		<div class="muktaiDELIVERY" id="muktai" >
		<div class="page" style=''>
		<div class="report31" id="report3" >		
	<?php } ?>
			<div class="bill" style="margin-top:5px;margin-bottom:5px;border-top:1px dashed black;border-right:hidden;border-left:hidden;border-bottom:hidden;<?php if($printcopy==''){ }else{?>display:none;<?php } ?><?php if($srno>10 && $printcopy==''){ ?>display:none; <?php } ?>">
			</div> 
			<div class="report31" id="report3" <?php if($printcopy=='' || $printcopy=='OC'){ }else{?> style="display:none;" <?php } ?>>
				<div class="bill" style="">	
					<div class="container" style="height:75px;border-bottom:0.5px dashed black;">
						<div class="text-center">
								<div class="invoiceheader" style="margin-bottom:0px;margin-top:0px;font-family: Cambria;"><b><?php echo $CompanyName;?></b></div>
								<div class="invoiceaddress1" style="margin-bottom:0px;margin-top:0px;">
								<?php  $CompanyAddress=strtolower($CompanyAddress);
									echo ucwords($CompanyAddress); ?>
								</div>
								<div class="invoiceaddress1" style="margin-bottom:0px;margin-top:0px;"><center style='font-size:16px;font-family:cambria;'><b>Bill Of Supply<span style="font-size:11px;">( OC )</span></b></center></div>
						</div>	
					</div>
					
						<div class="muktai" style="margin-bottom:1px;">
							<div class="MainRLside">
								<table class="tblcust1GST" cellpadding="5" style='line-height:2.42857143;width:99.99%;border-collapse:collapse;height: auto;' >
									<tr>
										<td class="editlabelclass" hideshow="SalesInfoName">Buyer Name :</td>
										<td class="boldc" hideshow="SalesInfoName"><b><?php echo $personName ?></b></td>
										<td class="editlabelclass" hideshow="SalesInfoRouteName">Route Name :</td>
										<td class="boldc" hideshow="SalesInfoRouteName"><b><?php echo $RouteName; ?></b></td>
										<td class="editlabelclass" hideshow="SalesInfoInvoiceNo">Bill Of Supply No :</td>
										<td class="boldc" hideshow="SalesInfoInvoiceNo"><?php echo $GRNo ?></td>
										<td class="editlabelclass" hideshow="SalesInfoDateOfSupply">Invoice Date:</td>
										<td class="boldc" hideshow="SalesInfoDateOfSupply"><b><?php echo $InvoiceDate ?></b></td>
									</tr>
								</table>
							</div>
						</div>
					  
			<div class="muktai" style="">
			<div class="MainRLside">
			<div class="one1">
				<div class="left" hideshow="SalesRowTTransDetails">
				<table  class="tblcust1GST" cellpadding="5" style="border:1px solid #777575;font-weight: normal ! important; border-left: hidden;font-size:11;">
					<tr style="font-size:11px;height:25px;"> 
					   <td class="tdatadfirst text-center editlabelclass">Sr.No</td>
					   <td class="tdatadfirst text-center editlabelclass">Product Description</td>
					   <td class="tdatadfirst text-center editlabelclass">Qty</td>
					   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowUnit">Unit</td>
					   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowRtnQty">Extra Qty</td>
					   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowLeakage">Rtn Qty</td>
					   <td class="tdatadfirst text-center editlabelclass" hideshow="SalesRowTotalC">Total Amount</td>
				  </tr>
				  <?php 
					$GTotal = 0;
					$Qty = 0;
					$itemamount = 0;
					$TaxAmt = 0;
					$finalamt = 0;
					$srno1 = 1;
					$offerqtytot=0;$SchemeQtytot=0;
					$SoftCrateQtytot=0;$SoftCrateQtytotoff=0;$SoftCrateQtytotsch=0;
					$SQLSalesDtls="select u.UOMName,sd.itemid,s.GRNo,s.idSales,s.RouteName,s.SalesDate,sum(sd.itemQty) as itemQty,sum(sd.TaxAmt) as TaxAmt,sum(sd.TotalAmt) as TotalAmt,sum(sd.SchemeQty) as SchemeQty,
							i.ItemName,i.hsncode ,i.Unit,i.vatpercentage,sd.itemRate from tblsales s 
							JOIN tblsalesdetails sd ON sd.salesId=s.idSales
							JOIN tblitem i ON i.idItem=sd.itemId
							Join dimuom u on u.idUOM = i.itemUOMId
							where s.PersonId='".$CustomerId[$k]."' and s.idSales ='".$idSaleskpost[$k]."' and s.DispatchDate ='".$From."' 
							and s.DeleteStatus !='Y' and sd.DeleteStatus !='Y' and sd.SchemeOffer !='Yes' group by sd.itemId order by i.idSubcategory desc, sd.idSalesDetails asc";
					$RESSalesDtls = mysql_query($SQLSalesDtls);
					$rowscount=mysql_num_rows($RESSalesDtls);
					while($RowSalesDtls = mysql_fetch_assoc($RESSalesDtls)) {
					++$i;
					++$totalrow;
					++$pagerowcount;
					$GOrderQty = $GOrderQty+$RowSalesDtls['itemQty'];
					$GSchemeQty = $GSchemeQty+$RowSalesDtls['SchemeQty'];
					$offeritemid = $RowSalesDtls['offeritemid'];
					$idSales = $RowSalesDtls['idSales'];
					$itemid = $RowSalesDtls['itemid'];
					$RouteName = $RowSalesDtls['RouteName'];
					
					$s00 = "select u.UOMName,i.ItemName,i.hsncode,i.Unit,i.vatpercentage,sd.itemRate,sum(sd.itemQty) as offerqty from tblsales s 
							JOIN tblsalesdetails sd ON sd.salesId=s.idSales
							JOIN tblitem i ON i.idItem = sd.itemId
							Join dimuom u on u.idUOM = i.itemUOMId
							where s.idSales='".$idSales."' and sd.offeritemid = '".$itemid."'
							and s.DeleteStatus !='Y' and sd.DeleteStatus !='Y' and sd.SchemeOffer='Yes' group by sd.itemId desc";
					$r00 = mysql_query($s00);
					$rw00 = mysql_fetch_array($r00);
					$OfferItem = $rw00['ItemName'];
					$offerqty = $rw00['offerqty'];
					$hsncode = $rw00['hsncode'];
					$Unit = $rw00['Unit'];
					$UOMName = $rw00['UOMName'];
					$vatpercentage = $rw00['vatpercentage'];
					$sqlsoftqty = "SELECT RootName,cantainertype FROM tblfarmer where RootName='".$RouteName."' group by RootName";
					$rsoftqty = mysql_query($sqlsoftqty);
					$rwsoftqty = mysql_fetch_array($rsoftqty);
					$cantainertype = $rwsoftqty['cantainertype'];
					$SoftCrateQty1ss = explode('ltrcratein',$cantainertype);
					if($SoftCrateQty1ss[1]!=''){ $cantainertype=$SoftCrateQty1ss[1]; }
					$SoftCrateQty1 = explode('ltr',$cantainertype);
					$SoftCrateQty2 = $SoftCrateQty1[0];
					$SoftCrateQty3 = number_format($RowSalesDtls['itemQty'] / $SoftCrateQty2,1);
					$SoftCrateQty4=explode('.',$SoftCrateQty3);
					// $SoftCrateQty=$SoftCrateQty4[0];
					$SoftCrateQty=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
					// if($SoftCrateQty4[0] <=0){ $SoftCrateQty=1;}
					?>
					<tr style="height:25px" >
					   <td class="tdatadfirst1  text-center" width="10%"><?php echo $srno1++;?></td>
					   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $RowSalesDtls['ItemName'];//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
					   <th class="tdatadfirst1"  style="text-align:center;"><?php echo number_format($RowSalesDtls['itemQty'],2);?></th>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowUnit"><?php echo $RowSalesDtls['UOMName'];?></td>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
					   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowTotalC"><?php echo number_format(($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate'])+$RowSalesDtls['TaxAmt'],2);?></td>
					 </tr>
					<?php  if($RowSalesDtls['SchemeQty']>0){ 
						$SoftCrateQty3 = number_format($RowSalesDtls['SchemeQty'] / $SoftCrateQty2,1);
						$SoftCrateQty4=explode('.',$SoftCrateQty3);
						$SoftCrateQtysch=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
						// if($SoftCrateQty4[0] <=0){ $SoftCrateQtysch=1;}
					?>
					 <tr style="height:25px" >
					   <td class="tdatadfirst1  text-center" width="10%"><?php echo $srno1++;?></td>
					   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $RowSalesDtls['ItemName'].' ( Scheme )';//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
					   <th class="tdatadfirst1"  style="text-align:center;"><?php echo number_format($RowSalesDtls['SchemeQty'],2);?></th>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowUnit"><?php echo $RowSalesDtls['UOMName'];?></td>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
					   <td class="tdatadfirst1"  style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
					   <td class="tdatadfirst1"  style="text-align:right;" hideshow="SalesRowTotalC"><?php //echo number_format(0,2);?></td>
					 </tr>
					<?php 
					$SchemeQtytot+=$RowSalesDtls['SchemeQty'];
					$SoftCrateQtytotsch+=$SoftCrateQtysch;
					} ?>
					<?php  if($offerqty>0){ 
						$SoftCrateQty3 = number_format($offerqty / $SoftCrateQty2,1);
						$SoftCrateQty4=explode('.',$SoftCrateQty3);
						$SoftCrateQtyo=round($SoftCrateQty4[0], 0, PHP_ROUND_HALF_DOWN);
						// if($SoftCrateQty4[0] <=0){ $SoftCrateQtyo=1;}
					?>
					 <tr style="height:25px" >
					   <td class="tdatadfirst1 text-center" width="10%"><?php echo $srno1++;?></td>
					   <th class="tdatadfirst1" style="margin-left:1px;" ><?php echo $OfferItem.' ( Offer )';//."<br>";if($OfferItem !=''){ echo " (".$OfferItem." - Offer Qty $offerqty ) "; } ?></th>
					   <th class="tdatadfirst1" style="text-align:center;"><?php echo number_format($offerqty,2);?></th>
					   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowUnit"><?php echo $UOMName;?></td>
					   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowRtnQty"><?php //echo 0;?></td>
					   <td class="tdatadfirst1" style="text-align:center;" hideshow="SalesRowLeakage"><?php //echo 0;?></td>
					   <td class="tdatadfirst1" style="text-align:right;" hideshow="SalesRowTotalC"><?php //echo number_format(0,2);?></td>
					 </tr>
					<?php 
					$offerqtytot+=$offerqty;
					$SoftCrateQtytotoff+=$SoftCrateQtyo;
					} ?>
					<?php // $srno++;
						$Qty+=$RowSalesDtls['itemQty'];
						$SoftCrateQtytot+=$SoftCrateQty;
						$itemamount+=($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate']);
						$TaxAmt+=($RowSalesDtls['TaxAmt']);
						$finalamt+=($RowSalesDtls['itemQty'] * $RowSalesDtls['itemRate'])+$RowSalesDtls['TaxAmt'];
						} ?>
				<tr style="height:25px;" class="">
				   <th class="tdatadfirst editlabelclass" colspan=2 style="margin-left:1px;text-align:center;" >TOTAL</th>
				   <th class="tdatadfirst"  style="text-align:center;"><?php echo number_format($Qty+$offerqtytot+$SchemeQtytot,2); ?></th>
				   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowUnit"></th>
				   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowRtnQty"></th>
				   <th class="tdatadfirst"  style="text-align:center;" hideshow="SalesRowLeakage"></th>
				   <th class="tdatadfirst"  style="text-align:right;" hideshow="SalesRowTotalC"><?php echo number_format($finalamt,2); ?></th>
				</tr>
				</table>
				</div>
				<div class="left" hideshow="SalesRowTTransDetails">
							<table  class="tblcust1GST" cellpadding="5" style="font-size:11;border:1px solid #777575;font-weight: normal ! important;border-right: hidden;border-bottom: hidden;">
								<tr style="font-size:11px;height:25px;"> 
							   <td class="tdatadfirst text-center" colspan=3 >Todays Transaction Details</td>
							  </tr>
							  <tr style="font-size:11px;height:25px;"> 
								   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" ></td>
								   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" >Given</td>
								   <td class="tdatadfirst editlabelclass" style="margin-left:1px;" >Received</td>
							  </tr>
								<tr style="height:25px" >
								   <td class="tdatadfirst1 text-center editlabelclass">Crate</td>
								   <td class="tdatadfirst1"  style="text-align:right;"></td>
								   <td class="tdatadfirst1"  style="text-align:right;"></td>
								</tr>
								<tr style="height:25px" >
								   <td class="tdatadfirst1 text-center editlabelclass">Can</td>
								   <td class="tdatadfirst1"  style="text-align:right;"></td>
								   <td class="tdatadfirst1"  style="text-align:right;"></td>
								</tr>
								<tr style="height:25px" >
								   <td class="tdatadfirst1 editlabelclass" colspan="3" style="margin-left:1px;" >Received Amt</td>
								</tr>
	 
								<tr style="font-size:11px;height:25px;"> 
									<td class="editlabelclass text-center"  style="margin-left:1px;border-top:1px solid #777575;" ></td>
									<td class="editlabelclass text-center"  style="margin-left:1px;border-top:1px solid #777575;" ></td>
									<td class="editlabelclass text-center"  style="margin-left:1px;border-top:1px solid #777575;border-right:1px solid #777575;" ></td>
								</tr>
								<tr style="font-size:11px;height:25px;"> 
									<td class="editlabelclass text-center"  style="margin-left:1px;" >Receiver Sign</td>
									<td class="editlabelclass text-center"  style="margin-left:1px;" >Supervisor</td>
									<td class="editlabelclass text-center"  style="margin-left:1px;border-right:1px solid #777575;" >Account Manager</td>
								</tr>
							</table>
						</div>
				</div> 
				</div>
				</div> 
	 
			</div>
		</div>
		</div>
	</div>
	</div>
	<br>
	<div class="page-break" style="page-break-after: always;"></div>
	<?php 
	} ?>
	  </form>	
	<script src="../bower_components/jquery/dist/jquery.min.js"></script>
	<script type='text/javascript' src='includes/LSLcommon.js'></script>
	<script type='text/javascript' src='js/textlabelsetting.js'></script>
		
	<script type="text/javascript">
		var hidden = false;
		function Hide() {
			if(!hidden) {
				$("#print-cancel").css("display","none");
			} else {
				$("#print-cancel").css("display","");
			}
		}
			
		function PrintElem(){
			window.print();
			window.location.assign('DelivaryReportPrint.php');
		}
	<?php if($roleid==0 || $roleid==1){ ?>
	$(document).ready(function(){	
		$(".editlabelclass").on("dblclick", function(evt) {
			$(this).attr("contenteditable", "true").focus();
		});
		$(".editlabelclass").on("blur", function(evt) {
			calllabeldata(1,'delivaryprint');
		});
		calllabeldata('','delivaryprint');
	});
		<?php } ?>
	</script>
	</body>
	</html>