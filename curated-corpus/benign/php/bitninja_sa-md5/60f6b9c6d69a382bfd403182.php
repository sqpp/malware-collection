<?php
session_start();
$local = $_SESSION["server"];
$user = $_SESSION["user"];
$pass = $_SESSION["pass"];

$con = mysqli_connect($local,$user,$pass);
if($con){
	$status = "Database: terhubung";
	$s = '<div style="float:left;color:white;border:1px solid #ccc;padding:20px;border-radius:10px;width:300px;"><form action="" method="POST" ><table border="0"><tr><td width="90px" >Server</td><td><input type="text" name="server" value="localhost" placeholder="value" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>User</td><td><input type="text" name="user" value="'.$user.'" placeholder="user" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>Password</td><td><input type="text" name="pass" value="'.$pass.'" placeholder="password" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>Get</td><td><button style="width:100px;border:1px solid red;background:none;color:white;padding:5px;" name="connect">Connect</button></td></tr></table></form></div>';
	
}else{
	$status = "Database: error!";
	$s = '<div style="float:left;color:white;border:1px solid #ccc;padding:20px;border-radius:10px;width:300px;"><form action="" method="POST" ><table border="0"><tr><td width="90px" >Server</td><td><input type="text" name="server" value="localhost" placeholder="value" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>User</td><td><input type="text" name="user" value="" placeholder="user" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>Password</td><td><input type="text" name="pass" value="" placeholder="password" style="width:150px;background:none;border:1px solid red;padding:5px;color:white;"></td></tr><tr><td>Get</td><td><button style="width:100px;border:1px solid red;background:none;color:white;padding:5px;" name="connect">Connect</button></td></tr></table></form></div>';
}

if(isset($_POST["connect"])){
	$server_ = $_POST["server"];
	$user_ = $_POST["user"];
	$pass_ = $_POST["pass"];
	if($server_ and $user_ and $pass_){
		$_SESSION["server"] = $server_;
		$_SESSION["user"] = $user_;
		$_SESSION["pass"] = $pass_;
	}
}
?>
<!DOCTYPE html>
<html>
<head>
<title>DATABASE - CONNECT</title>
<style type="text/css">
a {
	text-decoration:none;
	color:blue;
}
</style>
</head>
<body bgcolor="black" style="padding:5px;" >
<?php
$t = $_GET["tbl"];
$c = $_GET["clmns"];
$d = $_GET["data"];
if($t and $c and $d){
	echo '<div style="float:none;color:white;border:1px solid #ccc;padding:20px;border-radius:10px;width:100%;"><form action="" method="POST"><input type="text" name="tbls" value="'.$t.'" style="display:none;"><input type="text" name="clm" value="'.$c.'" style="display:none;"><textarea style="width:100%;height:300px;border:none;color:black;" name="new">'.$d.'</textarea><br><br><button style="width:100px;padding:10px 5px;border:none;" name="update">UPDATE</button></div>';
}

if(isset($_POST["update"])){
	$xo = mysqli_connect($local,$user,$pass,$_GET["ds"]);
	$tbl_ = $_POST["tbls"];
	$c_ = $_POST["clm"];
	$new = $_POST["new"];
	$sqll = "UPDATE $tbl_ SET $c_='".$new."' limit 1";
	if(mysqli_query($xo,$sqll)){
		
	}
}
?>
<?php echo $s;?>

<div style="margin-left:10px;float:left;color:white;border:1px solid #ccc;padding:20px;border-radius:10px;width:500px;">
<?php echo $status;?><br>
	<a href="?show_db" ><button style="width:100%;border:1px solid red;background:none;color:white;padding:5px;" name="connect">Show Database</button></a>
	<?php
	if(isset($_GET["show_db"])){
		$sql = mysqli_query($con,"SHOW DATABASES");
		while($show_ = mysqli_fetch_row($sql)){
			echo "DATABASE: ".$show_[0]." <a href='?db=".$show_[0]."'>Buka</a><br>";
		}
	}else{
		
	}
	
	if(isset($_GET["db"])){
		$tables_ = mysqli_query(mysqli_connect($local,$user,$pass,$_GET["db"]), "SHOW TABLES");
		while($row = mysqli_fetch_row($tables_)) {
			$table = $row[0];
			echo "<code style='font-size:10px;'>Table: ".$table." <a href='?dbs=".$_GET["db"]."&open=".$table."'>Buka</a></code><br/>";
		}
	}
	
	if(isset($_GET["open"])){
		$op = $_GET["open"];
		$columns_ = mysqli_query(mysqli_connect($local,$user,$pass,$_GET["dbs"]), "SHOW COLUMNS FROM $op");
		while($row = mysqli_fetch_row($columns_)){
			$columns = $row[0];
			echo "<code style='font-size:10px;'>Columns: ".$columns." <a href='?ds=".$_GET['dbs']."&tbl=".$op."&clmns=".$columns."'>List Data</a></code><br/>";
		}
	}
	
	if(isset($_GET["clmns"])){
		$ops = $_GET["tbl"];
		$clmns = $_GET["clmns"];
		$x = mysqli_query(mysqli_connect($local,$user,$pass,$_GET["ds"]), "select * from $ops");
		while($row = mysqli_fetch_array($x)){
			echo "<code style='font-size:10px;'>Data: ".$row[$clmns]." <a href='?ds=".$_GET['ds']."&tbl=".$ops."&clmns=".$clmns."&data=".$row[$clmns]."'>Edit</a></code><br/>";
		}
	}
	?>
</div>

</table>
</form>

</body>
</html>