<?php
session_start();
if(!isset($_SESSION['username']))
{
    header('location:login.php');
}
?>
<?php
include 'includes/dbconnection.php';

if(isset($_POST['submit']))
{
$name=$_POST['name'];
$mname=$_POST['mname'];
$lname=$_POST['lname'];
$Dob=$_POST['Dob'];
$gender=$_POST['gender'];
$roll=$_POST['roll'];
$aadhar_no=$_POST['aadhar_no'];
$phone_no=$_POST['phone_no'];
$alternate_no=$_POST['alternate_no'];
$qualification=$_POST['qualification'];
$email=$_POST['email_id'];
$username=$_POST['username'];
$password=$_POST['password'];
$address=$_POST['address'];
$subject_teching=$_POST['subject_teching'];
$timing=$_POST['timing'];
$payment=$_POST['payment'];
$payment_type=$_POST['payment_type'];
$date=date('d/m/Y');
  $name_1=$_FILES['photo_1']['name'];
  $name_2=$_FILES['photo_2']['name'];
  $name_3=$_FILES['photo_3']['name'];
  //move-file
  $temp1=$_FILES['photo_1']['tmp_name'];
  $temp2=$_FILES['photo_2']['tmp_name'];
  $temp3=$_FILES['photo_3']['tmp_name'];
  //file-rename
   $filename1   = uniqid('Marks');
        $basename1  = $filename1.'.pdf'; 
   $filename2   = uniqid('Aadhar_Card_');
        $basename2   = $filename2.'.pdf'; 
  $filename3   = uniqid('photo_');
        $basename3   = $filename3.'.jpg'; 
//file-size
  $file1=$_FILES['photo_1']['size']<1000000;
  $file2=$_FILES['photo_2']['size']<1000000;
  $file2=$_FILES['photo_3']['size'];
  if($file1){  
move_uploaded_file($temp1,"upload-files/staff/".$basename1); 
move_uploaded_file($temp2,"upload-files/staff/".$basename2);
move_uploaded_file($temp3,"upload-files/staff/".$basename3);
$query=mysqli_query($con,"INSERT INTO `staff`(`name`, `mname`, `l_name`, `Dob`, `gender`, `roll`, `aadhar_no`, `Phone`, `Phone_2`, `qualification`, `email`, `username`, `password`, `full_address`,`Date_of_join`,`Payment`,`payment_type`, `Timing`,`subject_teching`, `Mark_Sheet`, `aadhar_card`, `profile_pic`,`Status`) VALUES ('$name','$mname','$lname','$Dob','$gender','$roll','$aadhar_no','$phone_no','$alternate_no','$qualification','$email','$username','$password','$address','$date','$payment','$payment_type','$timing','$subject_teching','$basename1','$basename2','$basename3','yes')");
if ($query) {
      echo "<script>alert('Your data inserted..');</script>"; 
      $Staff_id = $con->insert_id;
}
else{
      echo "<script>alert('try again later..');</script>"; 
}
}
}
?>

<!DOCTYPE html>
<html lang="en">
<head>

<body>
     <div class="col-md-12">
       <?php include 'includes/header.php'?>
     </div>
<div class="app-container">
   <div class="row">
     <div class="col-lg-2"> 
        <?php include 'includes/sidebar.php'?>
     </div>
                        <div class="col-lg-10" style="padding-bottom: 70px;">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card card-statistics">
                                    <div class="row no-gutters">
                                       <div class="col-lg-12">
                                            <div class="p-20 card">
                                                <h3>Add New Staff</h3>
                                            </div>
                                        </div>
                                         <div class="col-md-12 p-2">
                                          
                                          <div class="container">
  <section id="join-form">
<div class="testbox">
    <form class="form shadow" enctype="multipart/form-data" method="POST" action="">
<!-----------------------------------------------Stu Name----------------------------------------------------->
 <fieldset class="scheduler-border">
  <legend class="scheduler-border">Personal Information:</legend>
                       <div class="row">
              <div class="col-md-4">               
            <div class="form-group">
           <label >First Name</label>
             <input type="text" name="name" value="" class="form-control" placeholder="ex_Rohit" required="">
              </div></div>
            <div class="col-md-4">               
            <div class="form-group">
           <label >Middle Name</label>
            <input type="text" name="mname" value="" class="form-control" placeholder="ex_Patil" required="">
              </div> </div>

            <div class="col-md-4">               
            <div class="form-group">
           <label >Last Name</label>
            <input type="text" name="lname" value="" class="form-control" placeholder="ex_Patil" required="">
              </div>       
             </div>
         </div>
<!----------------------------------------------Dob email phone-------------------------------------------->
<div class="row">
    <div class="form-group col-md-4">             
      <label >Date Of Birth</label>
             <input type="Date" name="Dob" value="" min="1955-01-01" max="2030-12-31" class="form-control" placeholder="Date Of Birth" required="">
              </div>
    <div class="form-group col-md-4" id="genderid">  
     <label for="inputgender">Gender </label><br>       
        <input type="radio" name="gender" value="Male" required=""><label style="padding-left: 5px;">Male</label>
        <input type="radio" name="gender" value="Female" required=""><label style="padding-left: 5px;">Female</label>
        </div> 
    <div class="form-group col-md-4">             
      <label>Roll</label>
             <select required="" name="roll" class="form-control"><option value="">Select Roall</option><option value="counsellor">Counselor</option><option value="staff">Staff</option></select>
              </div>
                 </div>

                <div class="row">
              <div class="form-group col-md-4">             
      <label for="inputaadhar">Aadhar-No</label><br>
             <input  type="text" name="aadhar_no" class="form-control" value="" placeholder="Aadhar_no" required="">
              </div>
        <div class="form-group col-md-4">
      <label for="inputphoneno">Phone Number</label>
      <input type="number" name="phone_no" class="form-control"  placeholder="789-456-1234" required="">
    </div>
    <div class="form-group col-md-4">
      <label>Alternate Number</label>
      <input type="number" name="alternate_no" class="form-control"  placeholder="789-456-1234" required="">
    </div>
</div>
<div class="row">
      <div class="form-group col-md-2">
      <label >Qualification</label>
      <input type="text" name="qualification" class="form-control"  placeholder="10th Class"  required="">
    </div>
  <div class="form-group col-md-4">
      <label >Email</label>
      <input type="email" name="email_id" class="form-control"  placeholder="xyz@01.com"  required="">
    </div>
      <div class="form-group col-md-3">
      <label >Username</label>
      <input type="email" name="username" class="form-control"  placeholder="ABC"  required="">
    </div>
      <div class="form-group col-md-3">
      <label >password</label>
      <input type="text" name="password" class="form-control"  placeholder="abc@123"  required="">
    </div>
</div>
       </fieldset>
<!----------------------------------------------phone-------------------------------------------->
             <fieldset class="scheduler-border">
  <div class="row">
    <div class="form-group col-md-12">
    <label for="inputAddress">Address</label>
    <textarea name="address" class="form-control" placeholder="Enter Your Full Address" required=""> </textarea>
  </div>
     </fieldset>  
 <fieldset class="scheduler-border"> 
<legend class="scheduler-border">Upload-Document <span style="color:red; padding:2px 5px; font-size: 15px;">Select Document file size less than 1mb and pdf format only</span></legend>
 <div class="row">    
       <div class="form-group col-md-6">
        <div class="row">
            <div class="col-md-12">
        <label class="scheduler-border">Qualification Certificate</label>
        <input type="file" name="photo_1" id="photo" accept="application/pdf" onchange="Filevalidation()" required="" class="form-control">
           </div>
       <div class="form-group col-md-12">
        <label class="scheduler-border">Aadhar-Card</label>
        <input type="file" name="photo_2" id="photo" accept="application/pdf" onchange="Filevalidation()" required="" class="form-control">
           </div>
    <div class="form-group col-md-12">
<label class="scheduler-border">Photo</label>
        <input type="file" name="photo_3" id="photo" required="" class="form-control">
         </div>    
         </div>  
     </div>
         <div class="col-md-6">
            <div class="row">
                <dir class="col-md-12">
                    <label class="scheduler-border">Subject</label>
                    <input type="text" name="subject_teching" placeholder="Ex_..PHP" class="form-control" >
                </dir>
                <dir class="col-md-12">
                    <label class="scheduler-border">Timing</label>
                    <input type="text" name="timing" placeholder="Enter Timing" class="form-control" >
                </dir>
                 <dir class="col-md-6">
                    <label class="scheduler-border">Payment Type</label>
                    <select name="payment_type" class="form-control" required="">
                      <option value="">Select any one</option><option value="Monthly">Monthly</option><option value="student">Student base</option>
                    </select>
                </dir>
             <dir class="col-md-6">
                    <label class="scheduler-border">Payment</label>
                    <input type="text" name="payment" placeholder="Enter Monthly Payment" class="form-control" >
                </dir>
            </div>
         </div>

        </fieldset>

<!------------------------------------------button---------------------------------------------------------->
  <div class="row">
      <div class="col-md-12">               
      <div class="form-group btn1">
<input type="submit" class="btn btn-success" name="submit" value="Submit">             </div>
                 </div>
          </div>
<!----------------------------------------------Form-end-------------------------------------------->
            </form>
          </div>
       </div>
</section>

                                           </div>
                                    </div>
                                </div>
                            </div>
                        </div>                                  
                    </div>
     </div>
  </div>
                                    
    <?php include 'includes/footer.php';?>
</body>
</head>
<style type="text/css">
    
fieldset {
    text-align: left;
    min-width: 73px;
    border: 1px;
    width: 100%;
}
legend
{
    color: #ac2015 !important;
}
.form-control
{
    color: #000 !important;
}
form {
/*        border: solid 1px #000;*/
    padding: 8px 20px;
    width: 90%;
    margin: 0px auto;
}
.card h3{
    font-size: 25px;
    font-family: none;
    color: #3434a5;
}
.card{

    padding-bottom: 50px;
}
label
{
color:#384893;
}
</style>
<script>
//subject-select
function getsubject(val) {
  $.ajax({
  type: "POST",
  url: "includes/get_subject-name.php",
  data:'Stream_name='+val,
  success: function(data){
    $("#subject_select").html(data);
  }
  });
}
//subject-fees
function getfees(val) {
  $.ajax({
  type: "POST",
  url: "includes/get_subject-name.php",
  data:'subject='+val,
  success: function(data){
    $("#fees_section").html(data);
  }
  });
}
</script>
 
<script> 
    Filevalidation = () => { 
        const fi = document.getElementById('photo'); 
        // Check if any file is selected. 
        if (fi.files.length > 0) { 
            for (const i = 0; i <= fi.files.length - 1; i++) { 
  
                const fsize = fi.files.item(i).size; 
                const file = Math.round((fsize / 1024)); 
                // The size of the file. 
                if (file >=1024) { 
                    alert( 
                      "File too Big, please select a file less than 1mb"); 
                } else if (file >1048) { 
                    alert( 
                      "File too small, please select a file greater than 1mb"); 
                } else { 
                    document.getElementById('size').innerHTML = '<b>'
                    + file + '</b> KB'; 
                } 
            } 
        } 
    } 
</script> 
<script>
    function add() {
  a = Number(document.getElementById('fees').value);
  b = Number(document.getElementById('pay_now').value);
  c = a - b;

  document.getElementById('total').value = c;
}
</script>