<?php
include('connection.php');
    $docs_error   = array();
    $response = array('status'=>false,'docs_error' => $docs_error);
    if(isset($_POST['title'])){
        
        $title                  = $_POST['title'];
        $description            = $_POST["description"];
        
        $pdf_name             = $_FILES['pdf']['name'];
        $pdf_temp             = $_FILES['pdf']['tmp_name'];

        

        if(empty($title)){
            $docs_error['title_error']= "Please enter post title";
        }
        
        
       
        // if(empty($description))
        // {
        //      $docs_error['description_errror'] = "Please enter post description.";
            
        // }

        $allowed_image_extension = array(
            "pdf",
            
        );
        $file_extension = pathinfo($_FILES["pdf"]["name"], PATHINFO_EXTENSION);

        if(empty($description)){
            if(empty($pdf_name)){
                $docs_error['pdf_error'] = "Please Select pdf.";
            }
            if (! in_array($file_extension, $allowed_image_extension)) {
                $docs_error['pdf_error'] = "Please Select only pdf.";
            }
        }
        
        
        
        
        if(empty($docs_error))
        {
            
            $created_at = date('Y-m-d  H:i:s');
            $status = 1;
            $pdf_name = time()."_".$pdf_name;
            $target = "docs/" . basename($pdf_name);
            move_uploaded_file($pdf_temp, $target);
            $ins= "INSERT INTO documents(title,description,pdf,status,created_at) VALUES ('$title','$description','$pdf_name','$status','$created_at')";
            $sql= mysqli_query($conn,$ins);
            if($sql){
                $response['status'] = true;
            }else{
                echo mysqli_error($conn);
            }
            //header("location:login.php");
        }
        else
        {
            $response['docs_error'] = $docs_error;
        }
    }    
echo json_encode($response);            
?>