<?php
ob_start();
function main()
{
	require_once("../includes/conn.php");
    require_once("../includes/common.php");
	
//==============CODE FOR INSERT========================//
if(isset($_POST['Add']) && $_POST['Add']=="Add Product")
{			  
	$furl=getcs($_POST['title']);
	$price=$_POST['price'];
	$size=$_POST['size'];
	
	$sql="insert into motif set 
		prod_id=".$_POST['product'].",
		motif_name='".addslashes($_POST['title'])."',
		motif_no='".$_POST['motif_code']."',
		furl='".$furl."',
		price_type='".$_POST['rdprice']."',
		price='".$price."',
		no_of_tiers='".addslashes($_POST['tiernum'])."',
		size_type='".$_POST['rdsize']."',
		size='".$size."',
		no_of_tails='".$_POST['no_of_tails']."',
		length_of_tails='".$_POST['length_of_tails']."',
		description='".addslashes($_POST['description'])."',
		post_date='".time()."',
		status='Active'";
	//echo $sql;
	//die();
	$ins_motif="insert into motif set 
		prod_id=".$_POST['product'].",
		motif_name='".addslashes($_POST['title'])."',
		motif_no='".$_POST['motif_code']."',
		furl='".$furl."',
		price_type='".$_POST['rdprice']."',
		price='".$price."',
		no_of_tiers='".addslashes($_POST['tiernum'])."',
		size_type='".$_POST['rdsize']."',
		size='".$size."',
		no_of_tails='".$_POST['no_of_tails']."',
		length_of_tails='".$_POST['length_of_tails']."',
		price_of_printedtails='".$_POST['price_of_printedtails']."',
		shape_type='".$_POST['rdshape']."',
		shape='".$_POST['shape']."',
		minqty='".$_POST['minqty']."',
		width='".$_POST['width']."',
		description='".addslashes($_POST['description'])."',
		post_date='".time()."',
		status='Active'";
	
	mysql_query($ins_motif) or die(mysql_error());
	
	$lastId=mysql_insert_id();
	
	$count=sizeof($_POST['to_file']);
	for($i=0;$i<$count;$i++)
	{
	mysql_query("insert into product_price set 
		motif_id='".$lastId."',
		qty_from='".addslashes($_POST['from_file'][$i])."',
		qty_to='".addslashes($_POST['to_file'][$i])."',
		price='".addslashes($_POST['price_file'][$i])."',
		status='Active'");
	}
	
	$uploadImageName=$_FILES['file']['name'];
	$uploadImageTempName=$_FILES['file']['tmp_name'];
	$uploadImageType=$_FILES['file']['type'];
	$explodeImageName=explode(".",$uploadImageName);		
	$imageExtension=$explodeImageName[1];
	$imageName=md5(microtime()).".".$imageExtension;
	
	if($uploadImageName!= "" && $uploadImageTempName!="")
	{
		$imageOriginal="../product/org_".$imageName;
		$imageThumb="../product/thb_".$imageName;
		list($width,$height)=getimagesize($uploadImageTempName);
		copy($uploadImageTempName,$imageOriginal);
		if($width>200 || $height>144)
		{
			if($width>200)
			{
				$maximum_thb_width=200;
			}
			else
			{ 
				$maximum_thb_width=$width;
			}
			if($height>144)
			{ 
				$maximum_thb_height=144;
			} 
			else
			{
				$maximum_thb_height=$height;
			}
			resize2($uploadImageTempName,$imageThumb,$maximum_thb_width,$maximum_thb_height,$uploadImageType);
			//copy($uploadImageTempName,$imageThumb);
		}
		else
		{
			copy($uploadImageTempName,$imageThumb);
		}
		mysql_query("update motif set motif_photo='".$imageName."' where id='".$lastId."'") or die(mysql_error());
	}
	header("Location:manage_rosettes.php?succ=1");
}
//==============END OF CODE FOR INSERT================//


//==============CODE FOR UPDATE========================//
if(isset($_POST['Edit']) && $_POST['Edit']=="Edit Product")
{
	$furl=getcs(trim($_POST['title']));
	$size_type=$_POST['rdsize'];
	$price_type=$_POST['rdprice'];
	$shape_type=$_POST['rdshape'];
	$count=sizeof($_POST['to_file']);
	if($count>0)
	{
	for($i=0;$i<$count;$i++)
	{
	mysql_query("insert into product_price set 
		motif_id='".$_GET['id']."',
		qty_from='".addslashes($_POST['from_file'][$i])."',
		qty_to='".addslashes($_POST['to_file'][$i])."',
		price='".addslashes($_POST['price_file'][$i])."',
		status='Active'");
	}
	}
	if($price_type=='F')
	{
	$price=$_REQUEST['price'];
	}
	else
	{
	$price='';
	$count1=sizeof($_POST['to_file1']);
	if($count1>0)
	{
	for($i=0;$i<$count1;$i++)
	{
	$j=$i+1;

	mysql_query("update product_price set 
		qty_from='".addslashes($_POST['from_file1'][$i])."',
		qty_to='".addslashes($_POST['to_file1'][$i])."',
		price='".addslashes($_POST['price_file1'][$i])."'
		where motif_id='".$_GET['id']."' and id='".$j."'");
		
	}
	}
	}
	if($size_type=='V')
	{
	$size=$_POST['size'];
	$no_of_tails=$_POST['no_of_tails'];
	$length_of_tails=$_POST['length_of_tails'];
	}
	else
	{
	$size='';
	$no_of_tails='';
	$length_of_tails='';
	}
	if($shape_type=='V')
	{
	$shape=$_POST['shape'];
	}
	else
	{
	$shape='';
	}
	/*echo $size_type;
	die();
	
	prod_id=".$_POST['product'].",
		motif_name='".addslashes($_POST['title'])."',
		motif_no='".$_POST['motif_code']."',
		furl='".$furl."',
		price_type='".$_POST['rdprice']."',
		price='".$price."',
		size_type='".$_POST['rdsize']."',
		size='".$size."',
		no_of_tails='".$_POST['no_of_tails']."',
		length_of_tails='".$_POST['length_of_tails']."',
		description='".addslashes($_POST['description'])."',
		post_date='".time()."',
		status='Active'"; 
	*/
	
	mysql_query("update motif set
	prod_id=".$_POST['product'].", 
	motif_name='".addslashes($_POST['title'])."',
	furl='".$furl."',
	price_type='".$price_type."',
	price='".$price."',
	no_of_tiers='".addslashes($_POST['tiernum'])."',
	size_type='".$size_type."',
	size='".$size."',
	no_of_tails='".$no_of_tails."',
	length_of_tails='".$length_of_tails."',
	price_of_printedtails='".$_POST['price_of_printedtails']."',
	shape_type='".$shape_type."',
	shape='".$shape."',
	minqty='".$_POST['minqty']."',
	width='".$_POST['width']."',
	description='".addslashes($_POST['description'])."',	
	motif_photo='".$_POST['ext_image']."'where id='".$_GET['id']."'");
									
	$uploadImageName=$_FILES['file']['name'];
	$uploadImageTempName=$_FILES['file']['tmp_name'];
	$uploadImageType=$_FILES['file']['type'];
	$explodeImageName=explode(".",$uploadImageName);		
	$imageExtension=$explodeImageName[1];
	$imageName=md5(microtime()).".".$imageExtension;

	if($uploadImageName!= "" && $uploadImageTempName!="")
	{
		@unlink("../product/org_".$_POST['ext_image']);
		@unlink("../product/thb_".$_POST['ext_image']);
		
		$imageOriginal="../product/org_".$imageName;
		$imageThumb="../product/thb_".$imageName;

		list($width,$height)=getimagesize($uploadImageTempName);
		copy($uploadImageTempName,$imageOriginal);
		
		if($width>200 || $height>144)
		{
			if($width>200)
			{
				$maximum_thb_width=200;
			}
			else
			{ 
				$maximum_thb_width=$width;
			}
			if($height>144)
			{ 
				$maximum_thb_height=144;
			} 
			else
			{
				$maximum_thb_height=$height;
			}
			resize2($uploadImageTempName,$imageThumb,$maximum_thb_width,$maximum_thb_height,$uploadImageType);
			
		}
		else
		{
			copy($uploadImageTempName,$imageThumb);
		}
		mysql_query("update motif set motif_photo='".$imageName."' where id='".$_GET['id']."'") or die(mysql_error());
	}
//	header("Location: manage_rosettes.php?succ=2");
	
}
//==============END OF CODE FOR UPDATE========================//


//=============CODE FOR DELETE===========================//
if((isset($_REQUEST['action']))&&($_REQUEST['action']=="del"))
{
	$arrPro=mysql_fetch_array(mysql_query("select * from motif where id='".$_GET['id']."'"));
	if($arrPro['motif_photo']!='')
    {
		@unlink("../product/org_".$arrPro['motif_photo']);
		@unlink("../product/thb_".$arrPro['motif_photo']);
    }
	mysql_query("delete from product_price where motif_id='".$_GET['id']."'");
    mysql_query("delete from motif where id='".$_GET['id']."'");
	header("Location: manage_rosettes.php?succ=3");
}

/*function pcal($size,$id)
{
	$pid=$id;
	if($size=='XtraLarge')
	{
		$val='Xtra Large';
	}
	else
	{
		$val=$size;
	}
	$productQuery="select * from motif where id=".$pid."";
	$ProductResult=mysql_fetch_array(mysql_query($productQuery)) or die (mysql_error());
	$sizeArr=explode(",",$ProductResult['size']);
	$priceArr=explode(",",$ProductResult['price']);

	foreach ($sizeArr as $key => $value)
	{
		if($value==$val)
		{
			return $price=$priceArr[$key];
		}
	}
}*/
//=============END OF CODE FOR DELETE===================//
?>

<script language="javascript" type="text/javascript">
var submitted = false;
var error = false;
var error_message = ""; // To display error message

function validation()
{
  if (submitted == true) {
    alert("JS_ERROR_SUBMITTED");
    return false;
  }

  error = false;
  error_message = "";
  
	 if(document.getElementById('product').value.search(/\S/)== -1)
	 {
	    document.getElementById('spancat').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Select Category From Category Dropdown</font>';
	    error=true;
	 }
	 else
	 {
		document.getElementById('spancat').innerHTML='';
	 }
	 
	 
	 if(document.getElementById('title').value.search(/\S/)== -1)
	 {
	    document.getElementById('spantitle').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Product/Motif Name</font>';
	    error=true;
	 }
	 else
	 {
		document.getElementById('spantitle').innerHTML='';
	 }
	 
	 if(document.getElementById('motif_code').value.search(/\S/)== -1)
	 {
	    document.getElementById('spancode').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Product/Motif Code</font>';
	    error=true;
	 }
	 else
	 {
		document.getElementById('spancode').innerHTML='';
	 }
	 
	 if(document.getElementById('rdf').checked== true)
	 {
		if(document.getElementById('price').value.search(/\S/)== -1)
		 {
			document.getElementById('spanfprice').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Product/Motif Price</font>';
			error=true;
		 }
	 }
	 else
	 {
		document.getElementById('spanfprice').innerHTML='';
	 }
	 
	 
	 
	 if(document.getElementById('rdv').checked== true)
	 {
		var isChecked = 0;
		if(document.frm.small.checked == true){
			isChecked++;
		}
		if(document.frm.medium.checked == true){
			isChecked++;
		}
		if(document.frm.large.checked == true){
			isChecked++;
		}
		if(document.frm.xlarge.checked == true){
			isChecked++;
		}
		if(isChecked == 0)
		{
			document.getElementById('spanvsize').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please ticked at least one Size Checkbox!</font>';
			error=true;
		}
		else
		{
			document.getElementById('spanvsize').innerHTML='';
		}
	 }
	 else
	 {
		document.getElementById('spanvsize').innerHTML='';
	 }
	 
	 if(document.getElementById('rdv').checked== true)
	 {
	 	if(document.frm.small.checked == true)
		{
			if(document.getElementById('smallPr').value.search(/\S/)== -1)
			 {
				document.getElementById('spansmallPr').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Small Size Price!</font>';
			error=true;
				
			 }
			 else
			 {
			 	document.getElementById('spansmallPr').innerHTML='';
			 }
		}
		else
		 {
			document.getElementById('spansmallPr').innerHTML='';
		 }
		
		if(document.frm.medium.checked == true)
		{
			if(document.getElementById('mediumPr').value.search(/\S/)== -1)
			 {
				document.getElementById('spanmediumPr').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Medium Size Price!</font>';
				error=true;
			 }
			 else
			 {
			 	document.getElementById('spanmediumPr').innerHTML='';
			 }
		}
		else
		 {
			document.getElementById('spanmediumPr').innerHTML='';
		 }
		if(document.frm.large.checked == true)
		{
			if(document.getElementById('largePr').value.search(/\S/)== -1)
			 {
				document.getElementById('spanlargePr').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Large Size Price!</font>';
				error=true;
			 }
			 else
			 {
			 	document.getElementById('spanlargePr').innerHTML='';
			 }
		}
		else
		 {
			document.getElementById('spanlargePr').innerHTML='';
		 }
		if(document.frm.xlarge.checked == true)
		{
			if(document.getElementById('xlargePr').value.search(/\S/)== -1)
			 {
				document.getElementById('spanxlargePr').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter XtraLarge Size Price!</font>';
				error=true;
			 }
			 else
			 {
			 	document.getElementById('spanxlargePr').innerHTML='';
			 }
		}
		else
		 {
			document.getElementById('spanxlargePr').innerHTML='';
		 }
	 }	 
	 
	 if(document.getElementById('file').value.search(/\S/)== -1 && document.getElementById('ext_image').value.search(/\S/)== -1)
	 {
	    document.getElementById('spanfile').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Upload Image</font>';
	    error=true;
	 }
	 else
	 {
	 	document.getElementById('spanfile').innerHTML='';
	 }
	 
	 if(document.frm.file.value!="")
	{
		var filename = document.frm.file.value;
		var fileExtension=filename.substring(filename.lastIndexOf(".")+1);
	
		if(fileExtension == "jpg" || fileExtension == "JPG" || fileExtension == "jpeg" || fileExtension == "JPEG" || fileExtension == "png" || fileExtension == "PNG" || fileExtension == "gif" || fileExtension == "GIF" )
		{
		}
	else
		{
			alert("Please select an image of type .jpg,.gif or .png to upload");
			document.frm.file.focus();
			error=true;
		}
	}

	
	 var inst = FCKeditorAPI.GetInstance("description");
     var sValue = inst.GetHTML();
	 if(sValue=="")
	 {
	    document.getElementById('spandesc').innerHTML='<img src="images/error_bang.gif" border="0" align="absmiddle">&nbsp;<font color="#FF0000">Please Enter Description</font>';
	    error=true;
	 }
	 else
	 {
		document.getElementById('spandesc').innerHTML='';
	 }

	  if (error == true) 
	  {
		return false;
	  } 
	  else 
	  {
		submitted = true;
		return true;
	  }
}
</script>
<script src="ckeditor/ckeditor.js"></script>
<?php
if($_REQUEST['action']=="edit")
{
	$pid=$_REQUEST['id'];
	$arrMotif=mysql_fetch_array(mysql_query("select * from motif where id='".$_REQUEST['id']."'"));
	$motif_name=stripslashes($arrMotif['motif_name']);
	$price=stripslashes($arrMotif['price']);
	$price_type=stripslashes($arrMotif['price_type']);
	$tiernum=stripslashes($arrMotif['no_of_tiers']);
	$decription=stripslashes($arrMotif['description']);
	$motif_no=stripslashes($arrMotif['motif_no']);
	$size_type=stripslashes($arrMotif['size_type']);
	$size=stripslashes($arrMotif['size']);
	$shape_type=stripslashes($arrMotif['shape_type']);
	$shape=stripslashes($arrMotif['shape']);
	$minqty=stripslashes($arrMotif['minqty']);
	$width=stripslashes($arrMotif['width']);
	$no_of_tails=stripslashes($arrMotif['no_of_tails']);
	$length_of_tails=stripslashes($arrMotif['length_of_tails']);
	$price_of_printedtails=stripslashes($arrMotif['price_of_printedtails']);
	if($price_type=='V')
	{
		$rsprice=mysql_query("select * from product_price where motif_id='".$pid."'");		
		$count=mysql_num_rows($rsprice);
	}
}
?>
<form action="" method="post" name="frm" enctype="multipart/form-data">
<input type="hidden" name="ext_image" id="ext_image" value="<?php echo $arrMotif['motif_photo']?>" />
<table width="97%" border="0" cellspacing="1" cellpadding="2" align="center" class="tableborder">
<tr>
<td height="20" class="headline" align="center" colspan="3"><?php if($_REQUEST['action']=="edit") { ?>Edit Product<?php } else { ?>Add Product<?php } ?></td>
</tr>
<tr>
<td height="26" colspan="3" align="right" class="text" style="padding-right:5px;"><font color="#FF0000">*</font> Fields Are Mandatory</td>
</tr>
<?php if(sizeof($error)>0){?>
<tr>
<td align="center" colspan="3" class="text"><font color="#FF0033"><b><?php echo implode('<br>',$error);?></b></font></td>
</tr>
<?php 
	}
?>
  <tr>
    <td width="26%" align="right" class="text"><font color="#FF0000">* </font>Select Category</td>
    <td width="1%" align="center" class="text"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><select class="select" name="product" id="product" onchange="javascript:show(this.value)">
	<option value="">...Select Category ...</option>
	<?php
	$rsproduct = mysql_query("select * from product order by id desc");
		while($rowproduct = mysql_fetch_array($rsproduct))
		{
	?>
	<option value="<?php echo $rowproduct["id"];?>" 
	<? if($_REQUEST['action']=="edit" && $arrMotif['prod_id']==$rowproduct["id"]){echo "selected";}?> 
	><?php echo stripslashes($rowproduct["title"]);?></option>
	<?php
	}
	?>
	</select>&nbsp;&nbsp;<span id="spancat"></span></td>
 </tr>
  <tr>
    <td width="26%" align="right" class="text"><font color="#FF0000">*</font> Product Name </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="title" name="title" size="40" <? if($_REQUEST['action']=="edit"){print "value=\"$motif_name\"";}else{print "value='".$_REQUEST['title']."'";}?>/>&nbsp;&nbsp;<span id="spantitle"></span></td>
  </tr>
  <tr id="tiernum" style="display:">
    <td width="26%" align="right" class="text">Enter no. of Tiers</td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="tiernum" name="tiernum" size="20" <? if($_REQUEST['action']=="edit"){print "value=\"$tiernum\"";}else{print "value='".$_REQUEST['tiernum']."'";}?> maxlength="6"/>&nbsp;&nbsp;</td>
  </tr>
<!--<tr>
    <td width="26%" align="right" class="text">Product Code </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="motif_code" name="motif_code" size="20" <? if($_REQUEST['action']=="edit"){print "value=\"$motif_no\"";}else{print "value='".$_REQUEST['motif_code']."'";}?> maxlength="6"/>&nbsp;&nbsp;<span id="spancode"></span></td>
  </tr>-->
  <tr>
    <td width="26%" align="right" class="text" valign="top">Upload Image </td>
    <td width="1%" align="center" valign="top" class="text"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="file" name="file" id="file" size="34" />&nbsp;&nbsp;<span id="spanfile"></span><br />
	
	<?php if($_REQUEST['action']=="edit"){ ?>
	<br /><img src="../product/thb_<?php echo $arrMotif['motif_photo']?>" />
	<?php } ?></td>
  </tr>
  
  <tr>
    <td width="26%" align="right" class="text"></td>
    <td width="1%" align="center"></td>
    <td width="73%" align="left" class="text"><font color="#FF0000">(supports only .jpg, .jpeg, .gif or .png type files)</font></td>
  </tr>
  <tr>
    <td width="26%" align="right" class="text"><font color="#FF0000">*</font>Price</td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text" valign="top">
	<input type="radio" name="rdprice"  id="rdf1"   onClick="showhide1()" value="F" <?php if($_REQUEST['action']=="edit" && $price_type=='F')echo 'checked'; else echo 'checked';?> />Single &nbsp;
	<input type="radio" name="rdprice"  id="rdv1" onClick="showhide1()" Value="V" <?php if($_REQUEST['action']=="edit" && $price_type=='V')echo 'checked'; elseif($_POST['rdsize']=='V')echo 'checked';?> />Range</td>
  </tr>
  
  <tr id="fPrice" style="display:<?php if($_REQUEST['action']=="edit" && $price_type=='V' )echo 'none';elseif($_REQUEST['action']=="edit" && $price_type=='F')echo '';else echo '';?>">
    <td width="26%" align="right" class="text"><font color="#FF0000">*</font> Product Price </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="price" name="price" size="20" <? if($_REQUEST['action']=="edit" && $price_type=='F'){print "value=\"$price\"";}else{print "value='".$_REQUEST['price']."'";}?>/>&nbsp;<strong>&pound;</strong>&nbsp;&nbsp;<span id="spanfprice"></span></td>
  </tr>
  
  <tr id="rPrice" style="display:<?php if($_REQUEST['action']=="edit" && $price_type=='V')echo '';elseif($_REQUEST['action']=="edit" && $price_type=='F')echo 'none';else echo 'none';?>">
  <td width="26%" align="right" class="text"><font color="#FF0000">*</font> Product Price </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text">
	<table id="display_files1"><tr>
	<td><a href="javascript:void(0);" class="glossy" onclick="add_det();">
                      Add Range&Price+ 
                    </a></td>
	</tr>
	<input type="hidden" name="no_item" value="0">
		<input type="hidden" name="no_item1" value="">
	</table>
	</td>
  </tr>
  <tr id="rPrice" style="display:<?php if($_REQUEST['action']=="edit" && $price_type=='V' )echo '';else echo 'none';?>">
  <td width="26%" align="right" class="text">&nbsp;</td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text">
	<table id="display_files1"><tr>
	<td><a href="javascript:void(0);">
                      Edit existing Range & Price 
                    </a></td>
	</tr>
	</table>
	</td>
  </tr>
  <?php if($_REQUEST['action']=="edit" && $price_type=='V')
  {
  $cnt=0;
  while($rowprice = mysql_fetch_array($rsprice))
  {
  ?>
  <tr>
  <td width="26%" align="right" class="text">&nbsp;</td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text">
	<table id="display_files1"><tr>
	<td class="text">From:<input type="text" name="from_file1[]" id="from_file1_<?=$cnt?>" value="<?=$rowprice['qty_from']?>" class="inplogin" size="25"></td>
	<td class="text">To:<input type="text" name="to_file1[]" id="to_file1_<?=$cnt?>" value="<?=$rowprice['qty_to']?>" class="inplogin" size="25"></td>
		<td class="text">Price:<input type="text" name="price_file1[]" id="price_file1_<?=$cnt?>" value="<?=$rowprice['price']?>" class="inplogin" size="20"></td>
		<td><input type="hidden" name="image_id_0" id="image_id_0" value="0"></td>
	</tr>
	</table>
	</td>
  </tr>
	<?
	$cnt++;
	}
	}
  ?>  
   <tr>
    <td width="26%" align="right" class="text"><font color="#FF0000">*</font> Size </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text" valign="top">
	<input type="radio" name="rdsize"  id="rdf"   onClick="showhide()" value="F" <?php if($_REQUEST['action']=="edit" && $size_type=='F')echo 'checked';?> />No &nbsp;
	<input type="radio" name="rdsize"  id="rdv" onClick="showhide()" Value="V" <?php if($_REQUEST['action']=="edit" && $size_type=='V')echo 'checked'; else echo 'checked';?> />Yes</td>
  </tr>
  
  <tr id="psize" style="display:<?php if($_REQUEST['action']=="edit" && $size_type=='V' )echo '';elseif($_REQUEST['action']=="edit" && $size_type=='F')echo 'none';else echo '';?>">
    <td width="26%" align="right" class="text">Enter Size </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="size" name="size" size="20" <? if($_REQUEST['action']=="edit" && $size_type=='V'){print "value=\"$size\"";}else{print "value='".$_REQUEST['size']."'";}?>/>&nbsp;&nbsp;<span id="spanfprice"></span></td>
  </tr>
  
  <tr id="pntail" style="display:<?php if($_REQUEST['action']=="edit" && $size_type=='V' )echo '';elseif($_REQUEST['action']=="edit" && $size_type=='F')echo 'none';else echo '';?>">
    <td width="26%" align="right" class="text">Number of Tails </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="no_of_tails" name="no_of_tails" size="20" <? if($_REQUEST['action']=="edit" && $size_type=='V'){print "value=\"$no_of_tails\"";}else{print "value='".$_REQUEST['no_of_tails']."'";}?>/>&nbsp;&nbsp;<span id="spanfprice"></span></td>
  </tr>
  
  <tr id="pnlen" style="display:<?php if($_REQUEST['action']=="edit" && $size_type=='V' )echo '';elseif($_REQUEST['action']=="edit" && $size_type=='F')echo 'none';else echo '';?>">
    <td width="26%" align="right" class="text">Length of Tails </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="length_of_tails" name="length_of_tails" size="20" <? if($_REQUEST['action']=="edit" && $size_type=='V'){print "value=\"$length_of_tails\"";}else{print "value='".$_REQUEST['length_of_tails']."'";}?>/>
	&nbsp;&nbsp;<span id="spanfprice"></span></td>
  </tr>
  
  <tr id="pnprprice" style="display:<?php if($_REQUEST['action']=="edit" && $size_type=='V' )echo '';elseif($_REQUEST['action']=="edit" && $size_type=='F')echo 'none';else echo '';?>">
    <td width="26%" align="right" class="text">Price of Printed Tails </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="price_of_printedtails" name="price_of_printedtails" size="20" <? if($_REQUEST['action']=="edit" && $size_type=='V'){print "value=\"$price_of_printedtails\"";}else{print "value='".$_REQUEST['price_of_printedtails']."'";}?>/>
	&nbsp;&nbsp;<span id="spanfprice"></span></td>
  </tr>
  <!--<tr>
    <td width="26%" align="right" class="text">Shape </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text" valign="top">
	<input type="radio" name="rdshape"  id="rdfshape"   onClick="showhideshape()" value="F" <?php if($_REQUEST['action']=="edit" && $shape_type=='F')echo 'checked'; else echo 'checked';?> />No &nbsp;
	<input type="radio" name="rdshape"  id="rdvshape" onClick="showhideshape()" Value="V" <?php if($_REQUEST['action']=="edit" && $shape_type=='V')echo 'checked';?> />Yes</td>
  </tr>-->
   <tr id="pshape" style="display:<?php if($_REQUEST['action']=="edit" && $shape_type=='V' )echo '';elseif($_REQUEST['action']=="edit" && $shape_type=='F')echo 'none';else echo 'none';?>">
    <td width="26%" align="right" class="text">Enter Shape </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="shape" name="shape" size="20" <? if($_REQUEST['action']=="edit" && $shape_type=='V'){print "value=\"$shape\"";}else{print "value='".$_REQUEST['shape']."'";}?>/></td>
  </tr>
  <tr id="exhibit" style="display:none">
    <td width="26%" align="right" class="text">Minimum Quantity</td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="minqty" name="minqty" size="20" <? if($_REQUEST['action']=="edit"){print "value=\"$minqty\"";}else{print "value='".$_REQUEST['minqty']."'";}?> maxlength="6"/>&nbsp;&nbsp;</td>
  </tr>
  <tr id="sash" style="display:none">
    <td width="26%" align="right" class="text">Width </td>
    <td width="1%" align="center"><strong>:</strong></td>
    <td width="73%" align="left" class="text"><input class="input" type="text" id="width" name="width" size="20" <? if($_REQUEST['action']=="edit"){print "value=\"$width\"";}else{print "value='".$_REQUEST['width']."'";}?> maxlength="6"/>&nbsp;&nbsp;</td>
  </tr>
   <tr>
    <td width="26%" align="right" class="text" valign="top"><font color="#FF0000">*</font> Description</td>
    <td width="1%" align="center" valign="top"><strong>:</strong></td>
    <td width="73%" align="left" class="text" ><!--<textarea rows="5" name="description" cols="40" class="input"></textarea>-->
	<?php 
	if($_REQUEST['action']=='edit'){$decription=$decription;}else{$decription=$_REQUEST['description'];}
	//$oFCKeditor = new FCKeditor('description');
	//$oFCKeditor->Height=450;
	//$oFCKeditor->Width=550;
	//$oFCKeditor->BasePath = '../fckeditor/';
	//$oFCKeditor->Value= stripslashes($decription);
	//$oFCKeditor->Create(); 
   ?>
   <textarea name="description" id="description" style="height:500px;width:100%;"><?php echo $content;?></textarea>
   <script>
                // Replace the <textarea id="editor1"> with a CKEditor
                // instance, using default configuration.
               CKEDITOR.replace( 'description' ,
{
	filebrowserBrowseUrl : 'ckfinder/ckfinder.html',
	filebrowserImageBrowseUrl : 'ckfinder/ckfinder.html?type=Images',
	filebrowserFlashBrowseUrl : 'ckfinder/ckfinder.html?type=Flash',
	filebrowserUploadUrl : 'ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Files',
	filebrowserImageUploadUrl : 'ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Images',
	filebrowserFlashUploadUrl : 'ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Flash'
});
	</script>
   <br /><span id="spandesc"></span>
   </td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;
	<?php
	##### DETERMINE NEXT
	$WC	=	"";
	if ($_REQUEST['category']!='')
	$WC		=	" AND prod_id='".$_REQUEST['category']."' ";
	if ($_GET['id']!='')
	$WC		.=	" AND id>".$_GET['id']." ";
	$SQL	=	" SELECT * FROM  motif WHERE 1=1 ".$WC." ORDER BY id ASC LIMIT 1 ";
	$nextres	=	mysql_query($SQL);
	$nextfetch	=	mysql_fetch_array($nextres);
	?>
	
	</td>
    <td align="left"><?php if($_REQUEST['action']=="edit") { ?><input class="button" type="submit" name="Edit" value="Edit Product" onclick="return validation();">&nbsp;&nbsp;<input class="button" type="button" name="Back" value="Back To Listing" 
	onclick="window.location.href='manage_rosettes.php?category=<?php echo $_REQUEST['category']."&page=".$_REQUEST['page']; ?>'">
	<?php if (mysql_num_rows($nextres)>0) { ?><input class="button" type="button" name="next-item" value="Edit Next Product" onclick="window.location.href='add_edit_del_rosettes.php?category=<?php echo $_REQUEST['category']; ?>&action=edit&id=<?php echo $nextfetch[id]; ?>&page=<?php echo $_REQUEST['page']; ?>'">		
	<?php  } } else { ?><input class="button" type="submit" name="Add" value="Add Product" onclick="return validation()"><?php } ?></td>
  </tr>
  <tr>
    <td colspan="3">&nbsp;</td>
  </tr>
</table>
</form>
<?
}//END OF MAIN
require_once("template.php");
?>


<script language="javascript" type="text/javascript">
function show(id)
{
	//alert(id);
	if(id==33) 
	{
	document.getElementById('exhibit').style.display='';
	document.getElementById('sash').style.display='none';
	document.getElementById('tiernum').style.display='none';
	}
	else if(id==32)
	{
	document.getElementById('exhibit').style.display='none';
	document.getElementById('sash').style.display='none';
	document.getElementById('tiernum').style.display='none';
	}
	else if(id==31)
	{
	document.getElementById('exhibit').style.display='none';
	document.getElementById('sash').style.display='';
	document.getElementById('tiernum').style.display='none';
	}
	else if(id==30)
	{
	document.getElementById('exhibit').style.display='none';
	document.getElementById('sash').style.display='none';
	document.getElementById('tiernum').style.display='none';
	}
	else if(id==36)
	{
	document.getElementById('exhibit').style.display='none';
	document.getElementById('sash').style.display='none';
	document.getElementById('tiernum').style.display='none';
	}
	else
	{
	document.getElementById('exhibit').style.display='none';
	document.getElementById('sash').style.display='none';
	document.getElementById('tiernum').style.display='';
	}
	
	
}
function showhide()
{
	if(document.getElementById('rdf').checked==true)
	{
		document.getElementById('psize').style.display='none';
		document.getElementById('pntail').style.display='none';
		document.getElementById('pnlen').style.display='none';
		document.getElementById('pnprprice').style.display='none';
	}
	else if(document.getElementById('rdv').checked==true)
	{
		document.getElementById('psize').style.display='';
		document.getElementById('pntail').style.display='';
		document.getElementById('pnlen').style.display='';
		document.getElementById('pnprprice').style.display='';
	}
}
function showhide1()
{
	if(document.getElementById('rdf1').checked==true)
	{
		document.getElementById('fPrice').style.display='';
		document.getElementById('rPrice').style.display='none';
	}
	else if(document.getElementById('rdv1').checked==true)
	{
		document.getElementById('fPrice').style.display='none';
		document.getElementById('rPrice').style.display='';
	}
}
function showhideshape()
{
	if(document.getElementById('rdfshape').checked==true)
	{
		document.getElementById('pshape').style.display='none';
	}
	else if(document.getElementById('rdvshape').checked==true)
	{
		document.getElementById('pshape').style.display='';
	}
}
function add_det()
 {
    var obj = document.getElementById('display_files1');
    var rowsLength = obj.rows.length;
   	var createRow = obj.insertRow(rowsLength);
    var createCell_1 = createRow.insertCell(0);
	var createCell_2 = createRow.insertCell(1);
	var createCell_3 = createRow.insertCell(2);
	var createCell_4 = createRow.insertCell(3);
	var createCell_5 = createRow.insertCell(4);
			
    document.frm.no_item1.value=parseInt(rowsLength)+1;
	obj.rows[rowsLength].cells[0].className = "text";
	obj.rows[rowsLength].cells[0].innerHTML = "From:<input type='text' name='from_file[]' id='from_file_1' value='' class='inplogin' size='25'>"
	obj.rows[rowsLength].cells[1].className = "text";
	obj.rows[rowsLength].cells[1].innerHTML = "To:<input type='text' name='to_file[]' id='to_file_1' value='' class='inplogin' size='25'>"
	obj.rows[rowsLength].cells[2].className = "text";
  	obj.rows[rowsLength].cells[2].innerHTML = "Price:<input type='text' name='price_file[]' id='price_file_1' value='' class='inplogin' size='20'>";
  	obj.rows[rowsLength].cells[3].innerHTML = "<input type='hidden' name='image_id_"+rowsLength+"' id='image_id_"+rowsLength+"' value='0'><a class='glossy_go' onClick='deleteRow1(this);'>Delete</a>"; 
 }
function deleteRow1(r)
{
	var i=r.parentNode.parentNode.rowIndex;
	document.getElementById('display_files1').deleteRow(i);
}
</script>
