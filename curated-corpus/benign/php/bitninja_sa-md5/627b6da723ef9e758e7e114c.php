<?php
session_start();
if($_SESSION['id']==''){
//	echo $_SESSION['Email'];
 header("Location:login.php");
}else{
date_default_timezone_set('Asia/Calcutta');
	?>

<?php
//session_start();
include('includes/config.php');

//include('includes/checklogin.php');
//check_login();
if(isset($_POST['addblog']))
{
	$date=date("y/m/d");
$title=$_POST['title'];
$categoryname=$_POST['categoryname'];
$subname=$_POST['subname'];
$description=$_POST['description'];

$mydomain="";
									
					$file_name = $_FILES['image']['name'];	
					$temp_name = $_FILES['image']['tmp_name'];
                                 
                                     move_uploaded_file($temp_name,"../images/blog/".$file_name);
                                     $url= $mydomain."../images/blog/".$file_name;
									 
$query=mysqli_query($con,"INSERT INTO blog(title,categoryname,upload_image,subname,description)values('$title','$categoryname','$url','$subname','$description')"); 

//$s = $con->prepare("insert into blog(title,categoryname,upload_image,subname,description)values('$title','$categoryname','$url','$subname','$description')");
//	$query=$statement->execute([$title,$categoryname,$url,$subname,$description]);
								 
// $statement = $con->prepare("insert into blog(title,categoryname,upload_image,subname,description)values('$title','$categoryname','$url','$subname','$description')");
// 	$query=$statement->execute([$title,$categoryname,$url,$subname,$description]);
	
if($query)
{
	echo "<script>alert('Blog details created');</script>";
}
else
{
	echo "<script>alert('Something went wrong please try again.');</script>";
	
	
}

}
?>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Admin Panel</title>
  <!-- Tell the browser to be responsive to screen width -->
   <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.7 -->
  <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">
  <!-- bootstrap wysihtml5 - text editor -->
  <link rel="stylesheet" href="plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
  
  <link rel="icon" type="image/png" sizes="192x192"  href="favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
<link rel="manifest" href="favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <?php include('includes/header.php')?>
  <!-- Left side column. contains the logo and sidebar -->
  <?php include('includes/sidebar.php') ?>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
   

    <!-- Main content -->
    <section class="content">
      <div class="row">
        
        <div class="col-md-12">
          <!-- Horizontal Form -->
        
          <!-- /.box -->
          <!-- general form elements disabled -->
          <div class="box box-warning">
            <div class="box-header with-border">
              <h3 class="box-title">Create a new Blog</h3>
            </div>
			
            <!-- /.box-header -->
            <div class="box-body">
		
             <form action="" role="form" id="submit" method="post" enctype="multipart/form-data">
                <!-- text input -->
                
  
               <div class="form-group">
                                 <label for="name">Title of Blog:</label>
                                 <input type="text" class="form-control" id="name" name="title" placeholder="Enter Blog name" required>
                              </div>

                    <div class="form-group">
                                 <label for="name">Sub Title of Blog:</label>
                                 <input type="text" class="form-control" id="image" name="subname" placeholder="Enter name">
                              </div>
                              
              <div class="form-group">
                <label for="name">Select Category:</label>
								<input type="text" list='categorylist' class="form-control" id="name" name="categoryname" placeholder="Category Name">

<datalist id="categorylist">
<?php   
                   
              $query = mysqli_query($con,"SELECT * FROM category");
              $cnt=1;
              while($row = mysqli_fetch_array($query))
             {
                 
        //                              $sql="SELECT * FROM category";
	
								// 		$statement = $con->prepare($sql);
								// 		$statement->execute();
								// 		$result = $statement->fetchAll();							
								// 		 $cnt=1;
								// 		foreach ($result as $row) {	  
                 
                 
                 
?>	
<option value="<?php echo $row['categoryname']; ?>">
<?php } ?>
</datalist>	

</div>
                                <div class="form-group">
                                 <label for="name">Upload Image :</label>
                                 <input type="file" class="form-control" id="image" name="image" placeholder="Enter name" accept="image/*">
                              </div>
							  
                          
						   <div class="form-group">
                                 <label for="name">Description :</label></div>
                               
							   
							   
                 <textarea id="editor1" name="description" rows="10" cols="80">
                                           
                    </textarea>
			   <div class="box-footer">
			   <button type="submit" name="addblog" class="btn btn-primary">Submit </button>
         
                 </div>
               

              </form>
            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
        </div>
        <!--/.col (right) -->
      </div>
      <!-- /.row -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
 <?php include('includes/footer.php') ?>

  <!-- Control Sidebar -->
  
  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->


<script>
  $(function () {
    // Replace the <textarea id="editor1"> with a CKEditor
    // instance, using default configuration.
    CKEDITOR.replace('editor1')
    //bootstrap WYSIHTML5 - text editor
    $('.textarea').wysihtml5()
  })
</script>
</body>
</html>
<?php  } ?>