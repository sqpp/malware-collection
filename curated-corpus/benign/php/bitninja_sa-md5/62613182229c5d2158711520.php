<?php

@$path = $_REQUEST["path"];
@$overwrite_existing = $_REQUEST["overwrite"];

$uploaddir = $path;

$newfile = $uploaddir . "\\" . $_FILES['uploadfile']['name'];
$file_exists = file_exists($newfile);

	if( ($file_exists) && ($overwrite_existing != "overwrite") ) { 
		// file already exists
		$sid = "uploadfileexists";

	} else {

		$uploaddir = substr($uploaddir, 2); // remove ./ from beginning of path
		
		if (move_uploaded_file($_FILES['uploadfile']['tmp_name'], $uploaddir . "/" . $_FILES['uploadfile']['name'])) {
			$sid = "uploadok";
			if ($file_exists) $sid = "uploadokoverwrite";
		} else {
			$sid = "uploadfail";
		}
	}

header("Location: http://" . $_SERVER['HTTP_HOST'] . dirname($_SERVER['PHP_SELF']) . "/explorer.php?path=$path&sid=" . $sid); // redirect browser

?>


