<?php ob_start();session_start();?>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>فایل سرور برای پردازش آپلود</title>



<style type="text/css">

body{

	font-family:Tahoma, Geneva, sans-serif;

	font-size:12px;

	direction:rtl;

}

.server{

	font-style:italic;

}

</style>

<?php

//تعیین فرمت یا اندازه مجاز و سایر پارامترها

if (true) {

	//بررسی سایر خطاهای سرور

	

	if ($_FILES["user-file"]["error"] > 0){

		        echo "<div class=\"server\">خطا: " . $_FILES["user-file"]["error"] . "</div><br />";

		        $check_result = 0;

		                                  }

	//بررسی وجود یا عدم وجود فایل با نام مشابه در سرور	

	else{

		if (file_exists("covers/" . $_FILES["user-file"]["name"])){

			echo "<div class=\"server\">این فایل در حال حاضر وجود دارد! <br /><br />".$_FILES["user-file"]["name"]. "</div><br />";

			$check_result = 0;		

			$_SESSION["econtentpath"]=$_FILES["user-file"]["name"];

			                                                     }

		//انتقال و ذخیره فایل در سرور	

		else{		  

			move_uploaded_file($_FILES["user-file"]["tmp_name"],"covers/" . $_FILES["user-file"]["name"]);

			echo "فایل: " . $_FILES["user-file"]["name"] . "<br />";

			$_SESSION["econtentpath"]=$_FILES["user-file"]["name"];

			echo "نوع: " . $_FILES["user-file"]["type"] . "<br />";

			echo "اندازه: " . ($_FILES["user-file"]["size"] / 1024) . " Kb<br />";

			//echo "دایرکتوری: " . "image/" . $_FILES["user-file"]["name"]. "<br />";

			$check_result = 1;		

			}

	 }

}

//خطای تعیین فرمت یا اندازه مجاز و سایر پارامترها

else{

/* if($_FILES["user-file"]["size"] >9999999999){

		echo "<div class=\"server\">حجم فایل خیلی زیاد است!</div>";

	}

	else{

		echo "<div class=\"server\">فرمت فایل مجاز نیست!</div>";

	} */

	$check_result = 0;

}




?>

<script type="text/javascript">

window.top.window.upload_end(<?php echo $check_result; ?>);

</script>

</head>

</html>