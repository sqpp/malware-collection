<?php
error_reporting(1);
require_once("common.php");
require_once('functions.php');
$row  = $db->query("SELECT * FROM amazon");
$fangate=$row[0]["fangate"];
$signed_request = $_REQUEST['signed_request'];

if (isset($signed_request)) {

  $data_signed_request = explode('.',$signed_request); // Get the part of the signed_request we need.
  $jsonData = base64_decode($data_signed_request['1']); // Base64 Decode signed_request making it JSON.
  $objData = json_decode($jsonData,true); // Split the JSON into arrays.
  $pageData = $objData['page'];
  $liked = $pageData['liked']; //you have the liked boolean
  $sourceData = $objData['app_data']; // yay you got the damn data in an string, slow clap for you
  $appDataArray = explode(';',$sourceData); // explode the app data because you hate it as a string, only do this if you are sending an array of variables through the app_data

  if($row[0]["fangate_active"]===0)
  include("home.php");
  else if($liked===false && $row[0]["fangate_active"]==1) {  
  include("fangate.php");
  // go to other page bc they liked and send the app_data in a string
  } else {
  include("home.php");
	  		
  }
} 
?>