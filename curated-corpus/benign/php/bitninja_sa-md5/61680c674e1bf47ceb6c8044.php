<?php
/**
 * @package     VikEvents
 * @subpackage  com_vikevents
 * @author      Alessio Gaggii - e4j - Extensionsforjoomla.com
 * @copyright   Copyright (C) 2018 e4j - Extensionsforjoomla.com. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE
 * @link        https://e4j.com
 */

defined('_JEXEC') or die('Restricted access');

$fpath = $this->fpath;

$editor = JEditor::getInstance('codemirror');
$fcode = '';
$fp = fopen($fpath, "rb");
if (false === $fp || empty($fpath)) {
	?>
	<p class="err"><?php echo JText::_('VEVTMPLFILENOTREAD'); ?></p>
	<?php
} else {
	while (!feof($fp)) {
		$fcode .= fread($fp, 8192);
	}
	fclose($fp);
?>
<form name="adminForm" id="adminForm" action="index.php" method="post">
	<fieldset class="adminform">
		<legend class="adminlegend"><?php echo JText::_('VEVEDITTMPLFILE'); ?></legend>
		<p class="vev-path-tmpl-file"><?php echo $fpath; ?></p>
		<?php echo $editor->display("cont", $fcode, '100%', 350, 70, 20); ?>
		<br clear="all" />
		<p style="text-align: center;"><button type="submit" class="btn btn-success"><?php echo JText::_('VEVSAVETMPLFILE'); ?></button></p>
	</fieldset>
	<input type="hidden" name="path" value="<?php echo $fpath; ?>">
	<input type="hidden" name="option" value="com_vikevents" />
	<input type="hidden" name="task" value="savetmplfile" />
</form>
<?php
}