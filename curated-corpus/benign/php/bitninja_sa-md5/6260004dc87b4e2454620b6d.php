<?php require_once 'includes/header.php' ?>
<?php require_once 'includes/sidebar_individual.php'; ?>


<?php
    require_once '../vendor/autoload.php';
    $file = new App\classes\File;
    

$id = $_SESSION['id'];

$message='';

    if(isset($_POST['btn'])){
        if(!empty($_POST['category_name'])){
            $message = $file->saveFileInfo($_POST); 
        }else{
            $categorynameError = true;
        }
    }

/*    if(isset($_POST['btn'])){
        if(!empty($_POST['category_name'])){
            $message = $file->saveFileInfo($_POST); 
        }else{
            $categorynameError = true;
        }
    }*/
    $queryResult = $file->getAllCategoryInfo($id);
    
    
    if($category = mysqli_fetch_assoc($queryResult)){
             $category['category_name'];
        }else{
            $categoryError = true;
        }
    
    $queryResult = $file->getAllCategoryInfo($id);
    
?>

<!-- Breadcrumbs-->
<ol class="breadcrumb">
    <li class="breadcrumb-item">
        <a href="dashboard_individual.php">Dashboard</a>
    </li>
    <li class="breadcrumb-item active">Add New File</li>
</ol>
<!-- Page Content -->

<div class="row">
    <div class="col-md-8  mt-2 mx-auto ">
        <h4 class="text-primary text-center">
            
            <?php
                if(isset($message)) {
                    echo $message;
                }
                
            ?>
        </h4>
        <div class="card alert-success">
            <h5 class="card-header text-center text-success">Add New File</h5>
                <?php if(isset($categoryError)){ ?>
                    <h3 class="card-header text-center text-success" >You Create The First Category, Then Select Category.</h3>
                <?php } ?>
            <div class="card-body">
                <form action="" method="post" enctype="multipart/form-data">
                    <div class="form-group row mt-3">
                        <label for="file_name" class="col-sm-3 col-form-label text-right dis_none">File Name :</label>
                        <div class="col-sm-9">
                            <input type="text" name="file_name" class="form-control" id="file_name" placeholder="File Name" required>
                        </div>
                    </div>
                    
                    <div class="form-group row mt-3">
                        <label for="category_name" class="col-sm-3 col-form-label text-right dis_none" >Category Name :</label>
                        <div class="col-sm-9">
                            <select class="form-control" id="category_name" name="category_name" required>
                                <option value="">-- Select Category Name --</option>
                                <?php while($category = mysqli_fetch_assoc($queryResult)) { ?>
									<option value="<?php echo $category['id']; ?>">
									    <?php echo $category['category_name']; ?>
								    </option>
                                <?php } ?>
                            </select>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="file" class="col-sm-3 col-form-label text-right dis_none">Upload File :</label>
                        <div class="col-sm-9">
                            <input type="file" name="file_upload" id="file" accept="pdf/*"/ required>
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="" class="col-sm-8 col-form-label dis_none"></label>
                        <div class="col-sm-4">
                            <button type="submit" name="btn" class="btn btn-success btn-block" onclick="move()">Save</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>






<?php require_once 'includes/footer.php' ?>