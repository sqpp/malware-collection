<?php
// Export the current site_id database into site_id.sql

if (!isset($_GET['site_id'])) {

	echo "No site_id set!";
	exit;
}

$relative = "../";

// Load config file for this site (includes db connection)
require_once($relative."config/".$_GET['site_id']."_public.php");

// Load utilities, if needed
require_once($relative."xq-includes/XQUtil.class.php");

// identify where we want the file to be:
$sql_backup_file = $xq_util->getDocumentRoot()."/".$_GET['site_id'].".sql"; 

// backup the database to this sql file:

// Make sure we are on a local machine:
if (DB_PASSWORD == "") {
	system("mysqldump -u ".DB_USERNAME." ".$_GET['site_id']." > ".$sql_backup_file);
	echo "Database has been backed up to ".$_GET['site_id'].".sql.";
} else {
	echo "You appear to running this script on a live server.  Thats not how you are supposed to use it.";
}