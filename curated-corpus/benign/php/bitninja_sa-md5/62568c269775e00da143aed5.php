<?php

foreach ($_POST as $key => $value) {
  $$key = $value;
}

include("include/misc.inc");

// Set Zone Date
date_default_timezone_set('Asia/Singapore');
$CurrentTimestamp = date('d-m-Y H:i:s');
$CurrentYear = date('Y');


switch ($action) {
	
//////////////////////////////////////////////////
//          Upload Common Image
////////////////////////////////////////////////// 
  	case "Upload Common Image": 
	
	// Save common image in category folder
	$target_dir = "../images/common-image/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = 'common' . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Insert into shop_category with image file
			$sql = "INSERT into common_image (image_name, created_timestamp) VALUES ('$newfilename', '$CurrentTimestamp')";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to insert into common_image");	
					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}		
	
	$redirect = "common-image-view.php?ImagMsg=$ImgMsg";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Common Image
////////////////////////////////////////////////// 
	case "Update Common Image": 
	
	@$image_id = addslashes($_POST["image_id"]);
	
	$target_dir = "../images/common-image/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";
			
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = 'common' . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE common_image SET image_name='$newfilename', modify_timestamp='$CurrentTimestamp' WHERE id = $image_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into common_image");
					
			
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";			
		}
	}
	
	$redirect = "common-image-view.php?ImagMsg=$ImgMsg";		
				
    break;
	

//////////////////////////////////////////////////
//          Add Individual Course
////////////////////////////////////////////////// 
	case "Add Course": 
	
	@$status = addslashes($_POST["status"]);
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$title = addslashes($_POST["title"]);
	@$category_code = addslashes($_POST["category_code"]);
	@$prerequisite_id = addslashes($_POST["prerequisite_id"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	//@$start_date = isset($_REQUEST["date1"]) ? $_REQUEST["date1"] : "";
	@$start_date = addslashes($_POST["start_date"]);
		$start_date = date("Y-m-d", strtotime($start_date));
	//@$end_date = isset($_REQUEST["date2"]) ? $_REQUEST["date2"] : "";
	@$end_date = addslashes($_POST["end_date"]);
		$end_date = date("Y-m-d", strtotime($end_date));
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);	
	@$lesson_to_be_complete_by = addslashes($_POST["lesson_to_be_complete_by"]);	
	@$max_seat = addslashes($_POST["max_seat"]);
	@$location = addslashes($_POST["location"]);
	
	$sql = "INSERT into course_individual (status, youtube_link, title, category_code, prerequisite_id, short_description, description, start_date, end_date, price, discount_price, administration_price, no_of_lesson, hour_of_lesson, lesson_to_be_complete_by, max_seat, location, created_timestamp) VALUES ('$status', '$youtube_link', '$title', '$category_code', '$prerequisite_id', '$short_description', '$description', '$start_date', '$end_date', '$price', '$discount_price', '$administration_price', '$no_of_lesson', '$hour_of_lesson', '$lesson_to_be_complete_by', '$max_seat', '$location', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into course_individual");
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		
		if ($category_code == 'S1.1.') {$category_end_code = 'U';}
		else if ($category_code == 'S2.1.') {$category_end_code = 'P';}
		else if ($category_code == 'S3.1.') {$category_end_code = 'D';}
		else if ($category_code == 'S4.1.') {$category_end_code = 'S';}
		
		$sql2 = "SELECT * FROM course_individual WHERE (category_code = \"$category_code\")";
		$result2 = mysqli_query($cxn,$sql2)
		or die("Invalid course_individual query");
		$record2 = mysqli_num_rows($result2);
		
		$course_code = "$category_code" . '' . "$record2" . '' . "$category_end_code";
		
		$sql3 = "UPDATE course_individual SET course_code='$course_code' WHERE id = $id";
		$result3 = mysqli_query($cxn,$sql3) 
		or die("Unable to update into course_individual");
		
		$sql4 = "INSERT into course_prerequisite (course_code, course_title) VALUES ('$course_code', '$title')";
		$result4 = mysqli_query($cxn,$sql4) 
		or die("Unable to insert into course_prerequisite");
	}
			
	$redirect = "course-individual-view.php";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Individual Course
////////////////////////////////////////////////// 
	case "Update Course": 	
	
	@$course_id = addslashes($_POST["course_id"]);
	@$course_code = addslashes($_POST["course_code"]); //use for course_prerequisite table
	
	@$status = addslashes($_POST["status"]);
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$title = addslashes($_POST["title"]);
	@$category_code = addslashes($_POST["category_code"]);
	@$prerequisite_id = addslashes($_POST["prerequisite_id"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$start_date = addslashes($_POST["start_date"]);
		$start_date = date("Y-m-d", strtotime($start_date));
	@$end_date = addslashes($_POST["end_date"]);
		$end_date = date("Y-m-d", strtotime($end_date));
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);	
	@$lesson_to_be_complete_by = addslashes($_POST["lesson_to_be_complete_by"]);	
	@$max_seat = addslashes($_POST["max_seat"]);
	@$location = addslashes($_POST["location"]);
	
	$sql = "UPDATE course_individual SET status='$status', youtube_link='$youtube_link', title='$title', category_code='$category_code', prerequisite_id='$prerequisite_id', short_description='$short_description', description='$description', start_date='$start_date', end_date='$end_date', price='$price', discount_price='$discount_price', administration_price='$administration_price', no_of_lesson='$no_of_lesson', hour_of_lesson='$hour_of_lesson', lesson_to_be_complete_by='$lesson_to_be_complete_by', max_seat='$max_seat', location='$location', modify_timestamp='$CurrentTimestamp' WHERE id = $course_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into course_individual");
	
	$sql2 = "UPDATE course_prerequisite SET course_title='$title' WHERE course_code = '$course_code'";
	$result2 = mysqli_query($cxn,$sql2) 
	or die("Unable to update into course_prerequisite");
	
	//if ($result) {
		//if ($category_code == 'S1.1.') {$category_end_code = 'U';}
		//else if ($category_code == 'S2.1.') {$category_end_code = 'P';}
		//else if ($category_code == 'S3.1.') {$category_end_code = 'D';}
		//else if ($category_code == 'S4.1.') {$category_end_code = 'S';}
		
		//$sql2 = "SELECT * FROM course WHERE (category_code = \"$category_code\")";
		//$result2 = mysqli_query($cxn,$sql2)
		//or die("Invalid course query");
		//$record2 = mysqli_num_rows($result2);
		
		//$course_code = "$category_code" . '' . "$record2" . '' . "$category_end_code";
		
		//$sql3 = "UPDATE course SET course_code = '$course_code' WHERE id = $course_id";
		//$result3 = mysqli_query($cxn,$sql3) 
		//or die("Unable to update into course");
	//}
			
	$redirect = "course-individual-view.php";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Group Learning
////////////////////////////////////////////////// 
	case "Add Group Learning": 
	
	@$status = addslashes($_POST["status"]);
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$title = addslashes($_POST["title"]);
	@$category_code = addslashes($_POST["category_code"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);	
	@$date_info = addslashes($_POST["date_info"]);
	@$start_time_hour = addslashes($_POST["start_time_hour"]);
	@$start_time_minute = addslashes($_POST["start_time_minute"]);
	@$start_time_am_pm = addslashes($_POST["start_time_am_pm"]);
	@$end_time_hour = addslashes($_POST["end_time_hour"]);
	@$end_time_minute = addslashes($_POST["end_time_minute"]);
	@$end_time_am_pm = addslashes($_POST["end_time_am_pm"]);
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);
	@$max_seat = addslashes($_POST["max_seat"]);
	@$materials_provided = addslashes($_POST["materials_provided"]);	
	@$location = addslashes($_POST["location"]);
	
	$sql = "INSERT into course_group_learning (status, youtube_link, title, category_code, short_description, description, date_info, start_time_hour, start_time_minute, start_time_am_pm, end_time_hour, end_time_minute, end_time_am_pm, price, discount_price, administration_price, no_of_lesson, hour_of_lesson, max_seat, materials_provided, location, created_timestamp) VALUES ('$status', '$youtube_link', '$title', '$category_code', '$short_description', '$description', '$date_info', '$start_time_hour', '$start_time_minute', '$start_time_am_pm', '$end_time_hour', '$end_time_minute', '$end_time_am_pm', '$price', '$discount_price', '$administration_price', '$no_of_lesson', '$hour_of_lesson', '$max_seat', '$materials_provided', '$location', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into course_group_learning");
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		
		$category_end_code = 'GL';
		
		$sql2 = "SELECT * FROM course_group_learning WHERE (category_code = \"$category_code\")";
		$result2 = mysqli_query($cxn,$sql2)
		or die("Invalid course_group_learning query");
		$record2 = mysqli_num_rows($result2);
		
		$course_code = "$category_code" . '' . "$record2" . '' . "$category_end_code";
		
		$sql3 = "UPDATE course_group_learning SET course_code='$course_code' WHERE id = $id";
		$result3 = mysqli_query($cxn,$sql3) 
		or die("Unable to update into course_group_learning");
		
		$sql4 = "INSERT into course_prerequisite (course_code, course_title) VALUES ('$course_code', '$title')";
		$result4 = mysqli_query($cxn,$sql4) 
		or die("Unable to insert into course_prerequisite");
	}
			
	$redirect = "course-group-learning-view.php?action=edit&course_id=$id";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Group Learning
////////////////////////////////////////////////// 
	case "Update Group Learning": 	
	
	@$course_id = addslashes($_POST["course_id"]);
	@$course_code = addslashes($_POST["course_code"]); //use for course_prerequisite table
	
	@$status = addslashes($_POST["status"]);
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$title = addslashes($_POST["title"]);
	@$category_code = addslashes($_POST["category_code"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$date_info = addslashes($_POST["date_info"]);
	@$start_time_hour = addslashes($_POST["start_time_hour"]);
	@$start_time_minute = addslashes($_POST["start_time_minute"]);
	@$start_time_am_pm = addslashes($_POST["start_time_am_pm"]);
	@$end_time_hour = addslashes($_POST["end_time_hour"]);
	@$end_time_minute = addslashes($_POST["end_time_minute"]);
	@$end_time_am_pm = addslashes($_POST["end_time_am_pm"]);
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);
	@$max_seat = addslashes($_POST["max_seat"]);
	@$materials_provided = addslashes($_POST["materials_provided"]);	
	@$location = addslashes($_POST["location"]);
	
	$sql = "UPDATE course_group_learning SET status='$status', youtube_link='$youtube_link', title='$title', category_code='$category_code', short_description='$short_description', description='$description', date_info='$date_info', start_time_hour='$start_time_hour', start_time_minute='$start_time_minute', start_time_am_pm='$start_time_am_pm', end_time_hour='$end_time_hour', end_time_minute='$end_time_minute', end_time_am_pm='$end_time_am_pm', price='$price', discount_price='$discount_price', administration_price='$administration_price', no_of_lesson='$no_of_lesson', hour_of_lesson='$hour_of_lesson', max_seat='$max_seat', materials_provided='$materials_provided', location='$location', modify_timestamp='$CurrentTimestamp' WHERE id = $course_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into course_group_learning");
	
	$sql2 = "UPDATE course_prerequisite SET course_title='$title' WHERE course_code = '$course_code'";
	$result2 = mysqli_query($cxn,$sql2) 
	or die("Unable to update into course_prerequisite");
	
	$redirect = "course-group-learning-view.php";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Group Learning Schedule
////////////////////////////////////////////////// 
	case "Add Group Learning Schedule": 
	
	@$course_id = addslashes($_POST["course_id"]);
	
	@$multiple_date = addslashes($_POST["multiple_date"]);
		$arr = explode(",", $multiple_date);
	@$start_date = current($arr);
		$start_date = date("Y-m-d", strtotime($start_date));
	@$end_date = end($arr);
		$end_date = date("Y-m-d", strtotime($end_date));
	
	$sql = "INSERT into course_group_learning_schedule (group_learning_id, multiple_date, start_date, end_date, created_timestamp) VALUES ('$course_id', '$multiple_date', '$start_date', '$end_date', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into course_group_learning_schedule");
			
	$redirect = "course-group-learning-view.php?action=edit&course_id=$course_id";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Group Learning Schedule
////////////////////////////////////////////////// 
	case "Update Group Learning Schedule": 	
	
	@$course_id = addslashes($_POST["course_id"]);
	@$course_schedule_id = addslashes($_POST["course_schedule_id"]);
	
	@$multiple_date = addslashes($_POST["multiple_date"]);
		$arr = explode(",", $multiple_date);
	@$start_date = current($arr);
		$start_date = date("Y-m-d", strtotime($start_date));
	@$end_date = end($arr);
		$end_date = date("Y-m-d", strtotime($end_date));
		
	$sql = "UPDATE course_group_learning_schedule SET multiple_date='$multiple_date', start_date='$start_date', end_date='$end_date', modify_timestamp='$CurrentTimestamp' WHERE id = $course_schedule_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into course_group_learning_schedule");
	
	$redirect = "course-group-learning-view.php?action=edit&course_id=$course_id";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Workshop
////////////////////////////////////////////////// 
	case "Add Workshop": 
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$category_sub_code = addslashes($_POST["category_sub_code"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$start_time_hour = addslashes($_POST["start_time_hour"]);
	@$start_time_minute = addslashes($_POST["start_time_minute"]);
	@$start_time_am_pm = addslashes($_POST["start_time_am_pm"]);
	@$end_time_hour = addslashes($_POST["end_time_hour"]);
	@$end_time_minute = addslashes($_POST["end_time_minute"]);
	@$end_time_am_pm = addslashes($_POST["end_time_am_pm"]);
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);
	@$max_seat = addslashes($_POST["max_seat"]);
	@$location = addslashes($_POST["location"]);
	
	// Save wokshop image in image/course/workshop folder
	$target_dir = "../images/course/workshop/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Insert into workshop with image file
			$sql = "INSERT into course_workshop (status, title, category_sub_code, short_description, description, start_time_hour, start_time_minute, start_time_am_pm, end_time_hour, end_time_minute, end_time_am_pm, price, discount_price, administration_price, no_of_lesson, hour_of_lesson, max_seat, location, image_name, created_timestamp) VALUES ('$status', '$title', '$category_sub_code', '$short_description', '$description', '$start_time_hour', '$start_time_minute', '$start_time_am_pm', '$end_time_hour', '$end_time_minute', '$end_time_am_pm', '$price', '$discount_price', '$administration_price', '$no_of_lesson', '$hour_of_lesson', '$max_seat', '$location', '$newfilename',  '$CurrentTimestamp')";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to insert into course_workshop");
			
			if ($result) {
				$id = mysqli_insert_id($cxn);
				
				$category_end_code = 'W';
				
				$sql2 = "SELECT * FROM course_workshop WHERE (category_sub_code = \"$category_sub_code\")";
				$result2 = mysqli_query($cxn,$sql2)
				or die("Invalid course_workshop query");
				$record2 = mysqli_num_rows($result2);
				
				$course_code = "$category_sub_code" . '' . "$record2" . '' . "$category_end_code";
				
				$sql3 = "UPDATE course_workshop SET course_code='$course_code' WHERE id = $id";
				$result3 = mysqli_query($cxn,$sql3) 
				or die("Unable to update into course_workshop");
				
				$sql4 = "INSERT into course_prerequisite (course_code, course_title) VALUES ('$course_code', '$title')";
				$result4 = mysqli_query($cxn,$sql4) 
				or die("Unable to insert into course_prerequisite");
			}	
					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}	
			
	$redirect = "course-workshop-view.php?action=edit&course_id=$id";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Workshop
////////////////////////////////////////////////// 
	case "Update Workshop": 	
	
	@$course_id = addslashes($_POST["course_id"]);
	@$course_code = addslashes($_POST["course_code"]); //use for course_prerequisite table
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$category_sub_code = addslashes($_POST["category_sub_code"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$start_time_hour = addslashes($_POST["start_time_hour"]);
	@$start_time_minute = addslashes($_POST["start_time_minute"]);
	@$start_time_am_pm = addslashes($_POST["start_time_am_pm"]);
	@$end_time_hour = addslashes($_POST["end_time_hour"]);
	@$end_time_minute = addslashes($_POST["end_time_minute"]);
	@$end_time_am_pm = addslashes($_POST["end_time_am_pm"]);
	@$price = addslashes($_POST["price"]);
	@$discount_price = addslashes($_POST["discount_price"]);
	@$administration_price = addslashes($_POST["administration_price"]);
	@$no_of_lesson = addslashes($_POST["no_of_lesson"]);	
	@$hour_of_lesson = addslashes($_POST["hour_of_lesson"]);
	@$max_seat = addslashes($_POST["max_seat"]);
	@$location = addslashes($_POST["location"]);
	@$image_name = addslashes($_POST["image_name"]);
	
	$target_dir = "../images/course/workshop/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
		
		
		// Update into shop_category WITHOUT image file
		$sql = "UPDATE course_workshop SET status='$status', title='$title', category_sub_code='$category_sub_code', short_description='$short_description', description='$description', start_time_hour='$start_time_hour', start_time_minute='$start_time_minute', start_time_am_pm='$start_time_am_pm', end_time_hour='$end_time_hour', end_time_minute='$end_time_minute', end_time_am_pm='$end_time_am_pm', price='$price', discount_price='$discount_price', administration_price='$administration_price', no_of_lesson='$no_of_lesson', hour_of_lesson='$hour_of_lesson', max_seat='$max_seat', location='$location', modify_timestamp='$CurrentTimestamp' WHERE id = $course_id";
		$result = mysqli_query($cxn,$sql) 
		or die("Unable to update into course_workshop");
		
		$sql2 = "UPDATE course_prerequisite SET course_title='$title' WHERE course_code = '$course_code'";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into course_prerequisite");
		
		
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE course_workshop SET status='$status', title='$title', category_sub_code='$category_sub_code', short_description='$short_description', description='$description', date='$date', start_time_hour='$start_time_hour', start_time_minute='$start_time_minute', start_time_am_pm='$start_time_am_pm', end_time_hour='$end_time_hour', end_time_minute='$end_time_minute', end_time_am_pm='$end_time_am_pm', price='$price', discount_price='$discount_price', no_of_lesson='$no_of_lesson', max_seat='$max_seat', location='$location', image_name='$newfilename', modify_timestamp='$CurrentTimestamp' WHERE id = $course_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into course_workshop");
			
			$sql2 = "UPDATE course_prerequisite SET course_title='$title' WHERE course_code = '$course_code'";
			$result2 = mysqli_query($cxn,$sql2) 
			or die("Unable to update into course_prerequisite");
					
			
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";			
		}
	}
	
	$redirect = "course-workshop-view.php";	
				
    break;	
	
	
//////////////////////////////////////////////////
//          Add Workshop Schedule
////////////////////////////////////////////////// 
	case "Add Workshop Schedule": 
	
	@$course_id = addslashes($_POST["course_id"]);
	@$category_sub_code = addslashes($_POST["category_sub_code"]);
	
	@$multiple_date = addslashes($_POST["multiple_date"]);
		$arr = explode(",", $multiple_date);
	@$start_date = current($arr);
		$start_date = date("Y-m-d", strtotime($start_date));
	@$end_date = end($arr);
		$end_date = date("Y-m-d", strtotime($end_date));
	
	$sql = "INSERT into course_workshop_schedule (workshop_id, category_sub_code, multiple_date, start_date, end_date, created_timestamp) VALUES ('$course_id', '$category_sub_code', '$multiple_date', '$start_date', '$end_date', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into course_workshop_schedule");
			
	$redirect = "course-workshop-view.php?action=edit&course_id=$course_id";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Workshop Schedule
////////////////////////////////////////////////// 
	case "Update Workshop Schedule": 	
	
	@$course_id = addslashes($_POST["course_id"]);
	@$course_schedule_id = addslashes($_POST["course_schedule_id"]);
	
	@$multiple_date = addslashes($_POST["multiple_date"]);
		$arr = explode(",", $multiple_date);
	@$start_date = current($arr);
		$start_date = date("Y-m-d", strtotime($start_date));
	@$end_date = end($arr);
		$end_date = date("Y-m-d", strtotime($end_date));
		
	$sql = "UPDATE course_workshop_schedule SET multiple_date='$multiple_date', start_date='$start_date', end_date='$end_date', modify_timestamp='$CurrentTimestamp' WHERE id = $course_schedule_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into course_workshop_schedule");
	
	$redirect = "course-workshop-view.php?action=edit&course_id=$course_id";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Holiday
////////////////////////////////////////////////// 
	case "Add Holiday": 
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$date = addslashes($_POST["date"]);
		$date = date("Y-m-d", strtotime($date));
	@$time = addslashes($_POST["time"]);
		if($time == "09:30am - 12:30pm") { $time_sort = '01'; }
		else if($time == "02:30pm - 05:30pm") { $time_sort = '02'; }
		else if($time == "07:00pm - 10:00pm") { $time_sort = '03'; }
		else { $time_sort = '04'; }
		
	
	$sql = "INSERT into set_holiday (status, title, date, time, time_sort, created_timestamp) VALUES ('$status', '$title', '$date', '$time', '$time_sort', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into set_holiday");
				
	$redirect = "holiday-view-1.php";	
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Holiday
////////////////////////////////////////////////// 
	case "Update Holiday": 	
	
	@$holiday_id = addslashes($_POST["holiday_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$date = addslashes($_POST["date"]);
		$date = date("Y-m-d", strtotime($date));
	@$time = addslashes($_POST["time"]);
		if($time == "09:30am - 12:30pm") { $time_sort = '01'; }
		else if($time == "02:30pm - 05:30pm") { $time_sort = '02'; }
		else if($time == "07:00pm - 10:00pm") { $time_sort = '03'; }
		else { $time_sort = '04'; }
	
	$sql = "UPDATE set_holiday SET status='$status', title='$title', date='$date', time='$time', time_sort='$time_sort', modify_timestamp='$CurrentTimestamp' WHERE id = $holiday_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into set_holiday");
	
	$redirect = "holiday-view-1.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Reuse Standard Content for Course
////////////////////////////////////////////////// 
	case "Update Course Content": 
	
	@$id = addslashes($_POST["id"]);
	
	@$title = addslashes($_POST["title"]);
	@$contant = addslashes($_POST["content"]);
	
	$sql = "UPDATE course_reuse_standard_content SET title='$title', content='$content' WHERE id = $id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into course_reuse_standard_content");
			
	$redirect = "course-standard-content-view.php";	
				
    break;
	
	
	
	
	
	
	
	
	
	
	
///////////////////////////////////////////////////////////	
/////////// Manage Page Category //////////////////////////
///////////////////////////////////////////////////////////	

/////////// Manage Home Page Category //////////////////////////		
	
//////////////////////////////////////////////////
//          Update Home Page Main Category
////////////////////////////////////////////////// 
	case "Update Home Page Main Category": 
	
	@$main_category_id = addslashes($_POST["main_category_id"]);
	
	@$content = $_POST["content"];
	
	$sql = "UPDATE page_home_main_category SET content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $main_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_home_main_category");	
	
	$redirect = "page-home-sub-category-view.php";		
				
    break;

//////////////////////////////////////////////////
//          Add Home Page Sub Category
////////////////////////////////////////////////// 
  	case "Add Home Page Sub Category": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "INSERT into page_home_sub_category (status, title, content, created_timestamp) VALUES ('$status', '$title', '$content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into page_home_sub_category");	
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		
		$page_link = 'home.php?id=' . "$id";
		
		$sql2 = "UPDATE page_home_sub_category SET page_link='$page_link' WHERE id = $id";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into page_home_sub_category");		
	}
					
	$redirect = "page-home-sub-category-view.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Home Page Sub Category
////////////////////////////////////////////////// 
	case "Update Home Page Sub Category": 
	
	@$sub_category_id = addslashes($_POST["sub_category_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_home_sub_category SET status='$status', title='$title', content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $sub_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_home_sub_category");	
	
	$redirect = "page-home-sub-category-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Home Page Slider
////////////////////////////////////////////////// 
  	case "Add Home Page Slider": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	@$page_link = strtolower (addslashes($_POST["page_link"])); // Lowercase all character of each word in a string
	
	// Save category image in category folder
	$target_dir = "../images/home-page-slider/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Insert into shop_category with image file
			$sql = "INSERT into page_home_slider (status, title, content, page_link, image, created_timestamp) VALUES ('$status', '$title', '$content', '$page_link', '$newfilename', '$CurrentTimestamp')";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to insert into page_home_slider");	
					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}		
	
	$redirect = "page-home-slider-view.php?ImagMsg=$ImgMsg";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Home Page Slider
////////////////////////////////////////////////// 
	case "Update Home Page Slider": 
	
	@$slider_id = addslashes($_POST["slider_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$content = addslashes($_POST["content"]);
	@$page_link = strtolower (addslashes($_POST["page_link"])); // Lowercase all character of each word in a string
	
	$target_dir = "../images/home-page-slider/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
		
		
		// Update into shop_category WITHOUT image file
		$sql = "UPDATE page_home_slider SET status='$status', title='$title', content='$content', page_link='$page_link', modify_timestamp='$CurrentTimestamp' WHERE id = $slider_id";
		$result = mysqli_query($cxn,$sql) 
		or die("Unable to update into page_home_slider with image file");
		
		
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE page_home_slider SET status='$status', title='$title', content='$content', page_link='$page_link', image='$newfilename', modify_timestamp='$CurrentTimestamp' WHERE id = $slider_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into page_home_slider with image file");
					
			
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";			
		}
	}
	
	$redirect = "page-home-slider-view.php?ImagMsg=$ImgMsg";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Home Page Network
////////////////////////////////////////////////// 
	case "Update Home Page Network": 
	
	@$network_id = addslashes($_POST["network_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$content = addslashes($_POST["content"]);
	@$page_link_title = addslashes($_POST["page_link_title"]);
	@$page_link = strtolower (addslashes($_POST["page_link"])); // Lowercase all character of each word in a string
	
	$target_dir = "../images/network/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
		
		
		// Update into shop_category WITHOUT image file
		$sql = "UPDATE page_home_network SET status='$status', title='$title', content='$content', page_link_title='$page_link_title', page_link='$page_link', modify_timestamp='$CurrentTimestamp' WHERE id = $network_id";
		$result = mysqli_query($cxn,$sql) 
		or die("Unable to update into page_home_network without image file");
		
		
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE page_home_network SET status='$status', title='$title', content='$content', page_link_title='$page_link_title', page_link='$page_link', image='$newfilename', modify_timestamp='$CurrentTimestamp' WHERE id = $network_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into page_home_network with image file");
					
			
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";			
		}
	}
	
	$redirect = "page-home-network-view.php?ImagMsg=$ImgMsg";		
				
    break;
	
	
/////////// Manage Programmes Page Category //////////////////////////		
	
//////////////////////////////////////////////////
//          Update Programmes Page Main Category
////////////////////////////////////////////////// 
	case "Update Programmes Page Main Category": 
	
	@$main_category_id = addslashes($_POST["main_category_id"]);
	
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	
	$sql = "UPDATE page_programmes_main_category SET youtube_link='$youtube_link', short_description='$short_description', description='$description', modify_timestamp='$CurrentTimestamp' WHERE id = $main_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_programmes_main_category");	
	
	$redirect = "page-programmes-sub-category-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Programmes Page Sub Category
////////////////////////////////////////////////// 
	case "Update Programmes Page Sub Category": 
	
	@$sub_category_id = addslashes($_POST["sub_category_id"]);
	
	@$youtube_link = addslashes($_POST["youtube_link"]);
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	
	$sql = "UPDATE page_programmes_sub_category SET youtube_link='$youtube_link', short_description='$short_description', description='$description', modify_timestamp='$CurrentTimestamp' WHERE id = $sub_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_programmes_sub_category");	
	
	$redirect = "page-programmes-sub-category-view.php";		
				
    break;


/////////// Manage Services and Works Page Category //////////////////////////		
	
//////////////////////////////////////////////////
//          Update Services and Works Page Main Category
////////////////////////////////////////////////// 
	case "Update Services Page Main Category": 
	
	@$main_category_id = addslashes($_POST["main_category_id"]);
	
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_services_main_category SET content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $main_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_services_main_category");	
	
	$redirect = "page-services-sub-category-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Services and Works Page Sub Category
////////////////////////////////////////////////// 
  	case "Add Services Page Sub Category": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "INSERT into page_services_sub_category (status, title, content, created_timestamp) VALUES ('$status', '$title', '$content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into page_services_sub_category");	
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		
		$page_link = 'services-and-works.php?id=' . "$id";
		
		$sql2 = "UPDATE page_services_sub_category SET page_link='$page_link' WHERE id = $id";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into page_services_sub_category");		
	}
					
	$redirect = "page-services-sub-category-view.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Services and Works Page Sub Category
////////////////////////////////////////////////// 
	case "Update Services Page Sub Category": 
	
	@$sub_category_id = addslashes($_POST["sub_category_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_services_sub_category SET status='$status', title='$title', content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $sub_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_services_sub_category");	
	
	$redirect = "page-services-sub-category-view.php";		
				
    break;
	
	
/////////// Manage Our Share Page Category //////////////////////////		
	
//////////////////////////////////////////////////
//          Update Our Share Page Main Category
////////////////////////////////////////////////// 
	case "Update Our Share Page Main Category": 
	
	@$main_category_id = addslashes($_POST["main_category_id"]);
	
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_our_share_main_category SET content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $main_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_our_share_main_category");	
	
	$redirect = "page-our-share-sub-category-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Our Share Page Sub Category
////////////////////////////////////////////////// 
  	case "Add Our Share Page Sub Category": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "INSERT into page_our_share_sub_category (status, title, content, created_timestamp) VALUES ('$status', '$title', '$content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into page_our_share_sub_category");	
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		
		$page_link = 'our-share.php?id=' . "$id";
		
		$sql2 = "UPDATE page_our_share_sub_category SET page_link='$page_link' WHERE id = $id";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into page_our_share_sub_category");		
	}
					
	$redirect = "page-our-share-sub-category-view.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Our Share Page Sub Category
////////////////////////////////////////////////// 
	case "Update Our Share Page Sub Category": 
	
	@$sub_category_id = addslashes($_POST["sub_category_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_our_share_sub_category SET status='$status', title='$title', content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $sub_category_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_our_share_sub_category");	
	
	$redirect = "page-our-share-sub-category-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Our Share Page Faq
////////////////////////////////////////////////// 
  	case "Add Our Share Page Faq": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "INSERT into page_our_share_faq (status, title, content, created_timestamp) VALUES ('$status', '$title', '$content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into page_our_share_faq");	
	
	$redirect = "page-our-share-faq-view.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Our Share Page Faq
////////////////////////////////////////////////// 
	case "Update Our Share Page Faq": 
	
	@$faq_id = addslashes($_POST["faq_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_our_share_faq SET status='$status', title='$title', content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $faq_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_our_share_faq");	
	
	$redirect = "page-our-share-faq-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Our Share Page Testimonials
////////////////////////////////////////////////// 
  	case "Add Our Share Page Testimonials": 
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "INSERT into page_our_share_testimonials (status, title, content, created_timestamp) VALUES ('$status', '$title', '$content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into page_our_share_testimonials");	
	
	$redirect = "page-our-share-testimonials-view.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Our Share Page Testimonials
////////////////////////////////////////////////// 
	case "Update Our Share Page Testimonials": 
	
	@$testimonials_id = addslashes($_POST["testimonials_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$content = addslashes($_POST["content"]);
	
	$sql = "UPDATE page_our_share_testimonials SET status='$status', title='$title', content='$content', modify_timestamp='$CurrentTimestamp' WHERE id = $testimonials_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into page_our_share_testimonials");	
	
	$redirect = "page-our-share-testimonials-view.php";		
				
    break;
	
	
	
	
	





/////////// Online Shop //////////////////////////
	
//////////////////////////////////////////////////
//          Add Category
////////////////////////////////////////////////// 
  	case "Add Category": 
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$description = addslashes($_POST["description"]);	
		@$new_image_folder_name = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string	
		@$new_image_folder_name = preg_replace('/\s+/', '', $new_image_folder_name); // Remove all space in between words
	
	// Create a new folder for new category. ie new category is Dress, all dress products images will saved into the new folder 	
	mkdir('../images/shop-online/' . "$new_image_folder_name" . '/', 0777, true);	
	
	// Save category image in category folder
	$target_dir = "../images/shop-online/category/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Insert into shop_category with image file
			$sql = "INSERT into shop_category (status, title, description, image_name, image_folder_name, created_timestamp) VALUES ('$status', '$title', '$description', '$newfilename', '$new_image_folder_name', '$CurrentTimestamp')";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to insert into shop_category");	
					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}		
	
	$redirect = "shop-category-view.php?ImagMsg=$ImgMsg";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Category
////////////////////////////////////////////////// 
	case "Update Category": 
	
	@$category_id = addslashes($_POST["category_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$title = addslashes($_POST["title"]);
	@$description = addslashes($_POST["description"]);
	
	$target_dir = "../images/shop-online/category/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
		
		
		// Update into shop_category WITHOUT image file
		$sql = "UPDATE shop_category SET status='$status', title='$title', description='$description', modify_timestamp='$CurrentTimestamp' WHERE id = $category_id";
		$result = mysqli_query($cxn,$sql) 
		or die("Unable to update into shop_category with image file");
		
		
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = "$title" . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE shop_category SET status='$status', title='$title', description='$description', image_name='$newfilename', modify_timestamp='$CurrentTimestamp' WHERE id = $category_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into shop_category with image file");
					
			
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";			
		}
	}
	
	$redirect = "shop-category-view.php?ImagMsg=$ImgMsg";		
				
    break;	
	
	
//////////////////////////////////////////////////
//          Add Product
////////////////////////////////////////////////// 
  	case "Add Product": 
	
	@$status = addslashes($_POST["status"]);
	@$category_id = addslashes($_POST["category_id"]);
	@$promotion_sale = addslashes($_POST["promotion_sale"]);
		if (empty($promotion_sale)) {$promotion_sale = 'No';}
	@$featured = addslashes($_POST["featured"]);
		if (empty($featured)) {$featured = 'No';}
	@$new_product = addslashes($_POST["new_product"]);
		if (empty($new_product)) {$new_product = 'No';}
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$quantity = addslashes($_POST["quantity"]);
	@$regular_price = addslashes($_POST["regular_price"]);
	@$sales_price = addslashes($_POST["sales_price"]);
	@$show_price = addslashes($_POST["show_price"]);
	@$hide_price_text = addslashes($_POST["hide_price_text"]);
	// get SKU code
	@$back_sku = addslashes($_POST["back_sku"]);
	
	$sql2 = "SELECT * FROM shop_category WHERE (id = \"$category_id\")";
	$result2 = mysqli_query($cxn,$sql2)
	or die("Invalid shop_product query");
	$display2 = mysqli_fetch_array($result2);
					  			
	$front_sku = $display2["front_sku"];
		
	$sku_code = "$front_sku" . '' . "$back_sku";
	
	$sql = "INSERT into shop_product (status, category_id, promotion_sale, featured, new_product, title, short_description, description, sku, quantity, regular_price, sales_price, show_price, hide_price_text, created_timestamp) VALUES ('$status', '$category_id', '$promotion_sale', '$featured', '$new_product', '$title', '$short_description', '$description', '$sku_code', '$quantity', '$regular_price', '$sales_price', '$show_price', '$hide_price_text', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_product");
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
	}	
	
	$redirect = "shop-product-image-add.php?product_id=$id";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Product
////////////////////////////////////////////////// 
	case "Update Product": 
	
	@$product_id = addslashes($_POST["product_id"]);
	
	@$status = addslashes($_POST["status"]);
	@$promotion_sale = addslashes($_POST["promotion_sale"]);
		if (empty($promotion_sale)) {$promotion_sale = 'No';}
	@$featured = addslashes($_POST["featured"]);
		if (empty($featured)) {$featured = 'No';}
	@$new_product = addslashes($_POST["new_product"]);
		if (empty($new_product)) {$new_product = 'No';}
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	@$short_description = addslashes($_POST["short_description"]);
	@$description = addslashes($_POST["description"]);
	@$quantity = addslashes($_POST["quantity"]);
	@$regular_price = addslashes($_POST["regular_price"]);
	@$sales_price = addslashes($_POST["sales_price"]);
	@$show_price = addslashes($_POST["show_price"]);
	@$hide_price_text = addslashes($_POST["hide_price_text"]);
	
	$sql = "UPDATE shop_product SET status='$status', promotion_sale='$promotion_sale', featured='$featured', new_product='$new_product', title='$title', short_description='$short_description', description='$description', quantity='$quantity', regular_price='$regular_price', sales_price='$sales_price', show_price='$show_price', hide_price_text='$hide_price_text', modify_timestamp='$CurrentTimestamp' WHERE id = $product_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into shop_product");
					
	$redirect = "shop-product-view.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Product Image
////////////////////////////////////////////////// 
  	case "Add Product Image": 
	
	@$product_id = addslashes($_POST["product_id"]);
	@$category_id = addslashes($_POST["category_id"]);
	@$image_folder_name = addslashes($_POST["image_folder_name"]);
	
	// Save category image in category folder
	$target_dir = "../images/shop-online/$image_folder_name/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = 'Product-' . "$product_id" .'-' . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Insert into shop_category with image file
			$sql = "INSERT into shop_product_image (product_id, category_id, image_name, created_timestamp) VALUES ('$product_id', '$category_id', '$newfilename', '$CurrentTimestamp')";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to insert into shop_product_image");	
					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}		
	
	$redirect = "shop-product-image-add.php?product_id=$product_id";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Product Image
////////////////////////////////////////////////// 
  	case "Update Product Image": 
	
	@$product_id = addslashes($_POST["product_id"]);
	@$image_id = addslashes($_POST["image_id"]);	
	@$image_folder_name = addslashes($_POST["image_folder_name"]);
	
	// Save category image in category folder
	$target_dir = "../images/shop-online/$image_folder_name/";
	$target_file = $target_dir . basename($_FILES["fileToUpload"]["name"]);
	$uploadOk = 1;
	$imageFileType = pathinfo($target_file,PATHINFO_EXTENSION);
	// Check if image file is a actual image or fake image
	if(isset($_POST["submit"])) {
		$check = getimagesize($_FILES["fileToUpload"]["tmp_name"]);
		if($check !== false) {
			//echo "File is an image - " . $check["mime"] . ".";
			$uploadOk = 1;
		} else {
			//echo "File is not an image.";
			$uploadOk = 0;
		}
	}	
	// Allow certain file formats
	if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" ) {
		//echo "Sorry, only JPG, JPEG & PNG files are allowed.";
		$uploadOk = 0;
	}
	// Check if $uploadOk is set to 0 by an error
	if ($uploadOk == 0) {
		$ImgMsg = "File not uploaded";
		//echo "Sorry, your file was not uploaded.";	
	// if everything is ok, try to upload file	
	} else {
		// Change unique file name to Category Title with microtime
		$temp = explode(".", $_FILES["fileToUpload"]["name"]);
		$newfilename = 'Product-' . "$product_id" .'-' . round(microtime(true)) . '.' . end($temp);
		if (move_uploaded_file($_FILES["fileToUpload"]["tmp_name"], "$target_dir" . $newfilename)) {
			$ImgMsg = "File uploaded";
			//echo "The file ". basename( $_FILES["fileToUpload"]["name"]). " has been uploaded.";
			
			
			// Update into shop_category with image file
			$sql = "UPDATE shop_product_image SET image_name='$newfilename' WHERE id = $image_id";
			$result = mysqli_query($cxn,$sql) 
			or die("Unable to update into shop_product_image");					
	
		} else {
			$ImgMsg = "There was an error uploading your file.";
			//echo "Sorry, there was an error uploading your file.";		
		}
	}		
	
	$redirect = "shop-product-image-add.php?product_id=$product_id";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Product Image
////////////////////////////////////////////////// 
  	case "Delete Product Image": 
	
	@$product_id = addslashes($_POST["product_id"]);
	@$image_id = addslashes($_POST["image_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_product_image WHERE id = $image_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_product_image");					
	
	$redirect = "shop-product-image-add.php?product_id=$product_id";
				
    break;	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Add Shop Attribute Non Apparel Title
////////////////////////////////////////////////// 
  	case "Add Shop Attribute Non Apparel Title": 
	
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	
	$sql = "INSERT into shop_attribute_non_apparel_title (title) VALUES ('$title')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_attribute_non_apparel_title");	
	
	$redirect = "shop-attribute-non-apparel-title-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Shop Attribute Non Apparel Title
////////////////////////////////////////////////// 
  	case "Update Shop Attribute Non Apparel Title": 
	
	@$title_id = addslashes($_POST["title_id"]);
	@$title = ucwords(addslashes($_POST["title"])); // Uppercase the first character of each word in a string
	
	$sql = "UPDATE shop_attribute_non_apparel_title SET title='$title' WHERE id = $title_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into shop_attribute_non_apparel_title");	
	
	$redirect = "shop-attribute-non-apparel-title-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Shop Attribute Non Apparel Title
////////////////////////////////////////////////// 
  	case "Delete Shop Attribute Non Apparel Title": 
	
	@$title_id = addslashes($_POST["title_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_attribute_non_apparel_title WHERE id = $title_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_attribute_non_apparel_title");					
	
	$redirect = "shop-attribute-non-apparel-title-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Shop Attribute Non Apparel Description
////////////////////////////////////////////////// 
  	case "Add Shop Attribute Non Apparel Description": 
	
	@$title_id = addslashes($_POST["title_id"]);
	@$description = ucwords(addslashes($_POST["description"])); // Uppercase the first character of each word in a string
	
	$sql = "INSERT into shop_attribute_non_apparel_description (title_id, description) VALUES ('$title_id', '$description')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_attribute_non_apparel_description");	
	
	$redirect = "shop-attribute-non-apparel-description-add.php?action=add";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Shop Attribute Non Apparel Description
////////////////////////////////////////////////// 
  	case "Update Shop Attribute Non Apparel Description": 
	
	@$description_id = addslashes($_POST["description_id"]);
	@$title_id = addslashes($_POST["title_id"]);
	@$description = ucwords(addslashes($_POST["description"])); // Uppercase the first character of each word in a string
	
	$sql = "INSERT into shop_attribute_non_apparel_description (title_id, description) VALUES ('$title_id', '$description')";
	$sql = "UPDATE shop_attribute_non_apparel_description SET title_id='$title_id', description='$description' WHERE id = $description_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_attribute_non_apparel_description");	
	
	$redirect = "shop-attribute-non-apparel-description-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Shop Attribute Non Apparel Description
////////////////////////////////////////////////// 
  	case "Delete Shop Attribute Non Apparel Description": 
	
	@$description_id = addslashes($_POST["description_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_attribute_non_apparel_description WHERE id = $description_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_attribute_non_apparel_description");					
	
	$redirect = "shop-attribute-non-apparel-description-add.php";
				
    break;
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Add Product Attribute
////////////////////////////////////////////////// 
  	case "Add Product Attribute": 
	
	@$product_id = addslashes($_POST["product_id"]);
	@$category_id = addslashes($_POST["category_id"]);
	@$attribute = addslashes($_POST["attribute"]);
	@$attribute_2 = addslashes($_POST["attribute_2"]);
		// For Apparel Products
		if (($category_id == 3) || ($category_id == 4)) { $attribute = "$attribute" . ' / ' . "$attribute_2"; }
		// For Non Apparel Products
		else if (($category_id == 2) || ($category_id == 5) || ($category_id == 6)) { $attribute = "$attribute"; }
	
	$sql = "INSERT into shop_product_attribute (product_id, category_id, attribute) VALUES ('$product_id', '$category_id', '$attribute')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_product_attribute");	
	
	$redirect = "shop-product-attribute-add.php?action=add&product_id=$product_id";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Product Attribute
////////////////////////////////////////////////// 
  	case "Delete Product Attribute": 
	
	@$product_id = addslashes($_POST["product_id"]);
	@$attribute_id = addslashes($_POST["attribute_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_product_attribute WHERE id = $attribute_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_product_attribute");					
	
	$redirect = "shop-product-attribute-add.php?product_id=$product_id";
				
    break;
	
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Add Shop Attribute Apparel Color
////////////////////////////////////////////////// 
  	case "Add Shop Attribute Apparel Color": 
	
	@$color = ucwords(addslashes($_POST["color"])); // Uppercase the first character of each word in a string
	
	$sql = "INSERT into shop_attribute_apparel_color (color) VALUES ('$color')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_attribute_apparel_color");	
	
	$redirect = "shop-attribute-apparel-color-add.php?action=add";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Shop Attribute Apparel Color
////////////////////////////////////////////////// 
	case "Update Shop Attribute Apparel Color": 
	
	@$color_id = addslashes($_POST["color_id"]);
	@$color = ucwords(addslashes($_POST["color"])); // Uppercase the first character of each word in a string
	
	$sql = "UPDATE shop_attribute_apparel_color SET color='$color' WHERE id = $color_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into shop_attribute_apparel_color");	
	
	$redirect = "shop-attribute-apparel-color-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Shop Attribute Apparel Color
////////////////////////////////////////////////// 
  	case "Delete Shop Attribute Apparel Color": 
	
	@$color_id = addslashes($_POST["color_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_attribute_apparel_color WHERE id = $color_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_attribute_apparel_color");					
	
	$redirect = "shop-attribute-apparel-color-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Add Shop Attribute Apparel Size
////////////////////////////////////////////////// 
  	case "Add Shop Attribute Apparel Size": 
	
	@$size = strtoupper(addslashes($_POST["size"])); // Make a string uppercase
	
	$sql = "INSERT into shop_attribute_apparel_size (size) VALUES ('$size')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into shop_attribute_apparel_size");	
	
	$redirect = "shop-attribute-apparel-size-add.php?action=add";
				
    break;
	
	
//////////////////////////////////////////////////
//          Update Shop Attribute Apparel Size
////////////////////////////////////////////////// 
	case "Update Shop Attribute Apparel Size": 
	
	@$size_id = addslashes($_POST["size_id"]);
	@$size = strtoupper(addslashes($_POST["size"])); // Make a string uppercase
	
	$sql = "UPDATE shop_attribute_apparel_size SET size='$size' WHERE id = $size_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into shop_attribute_apparel_size");	
	
	$redirect = "shop-attribute-apparel-size-add.php";
				
    break;
	
	
//////////////////////////////////////////////////
//          Delete Shop Attribute Apparel Size
////////////////////////////////////////////////// 
  	case "Delete Shop Attribute Apparel Size": 
	
	@$size_id = addslashes($_POST["size_id"]);
	
	// DELETE shop_category with image file
	$sql = "DELETE FROM shop_attribute_apparel_size WHERE id = $size_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to delete shop_attribute_apparel_size");					
	
	$redirect = "shop-attribute-apparel-size-add.php";
				
    break;
	
	
	
	
	
	
	

	
	
//////////////////////////////////////////////////
//          Update Reuse Standard Content for Shop
////////////////////////////////////////////////// 
	case "Update Shop Content": 
	
	@$id = addslashes($_POST["id"]);
	
	@$title = addslashes($_POST["title"]);
	@$contant = addslashes($_POST["content"]);
	
	$sql = "UPDATE shop_reuse_standard_content SET title='$title', content='$content' WHERE id = $id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into shop_reuse_standard_content");
			
	$redirect = "shop-standard-content-view.php";	
				
    break;






//////////////////////////////////////////////////
//          Add Newsletter Content
////////////////////////////////////////////////// 
  	case "Add Newsletter Content": 
	
	@$subject = addslashes($_POST["subject"]);
	@$content = addslashes($_POST["content"]);
                $str_replace_content = str_replace("../images/","https://www.astitch-works.com/images/",$content);
	
	$sql = "INSERT into newsletter_content (subject, content, created_timestamp) VALUES ('$subject', '$str_replace_content', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into newsletter_content");	
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		$encypt_id = md5("$id"."$CurrentTimestamp");
		
		$sql2 = "UPDATE newsletter_content SET encypt_id='$encypt_id' WHERE id = $id";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into newsletter_content");		
	}
					
	$redirect = "newsletter-content-view.php";
				
    break;
    
    
//////////////////////////////////////////////////
//          Update Newsletter Content
////////////////////////////////////////////////// 
	case "Update Newsletter Content": 
	
	@$newsletter_content_id = addslashes($_POST["newsletter_content_id"]);
	
	@$subject = addslashes($_POST["subject"]);
	@$content = addslashes($_POST["content"]);
                $str_replace_content = str_replace("../images/","https://www.astitch-works.com/images/",$content);
	
	$sql = "UPDATE newsletter_content SET subject='$subject', content='$str_replace_content', modify_timestamp='$CurrentTimestamp' WHERE id = $newsletter_content_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into newsletter_content");	
	
	$redirect = "newsletter-content-view.php";		
				
    break;
	
	
	
	
	
	
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Approve Course Payment
////////////////////////////////////////////////// 
	case "Approve Course Payment": 
	
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	@$order_encypt_id = addslashes($_POST["order_encypt_id"]);
	@$bank_transfer_verification_code = substr($order_encypt_id, 0, 8);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	@$payment_status = 'Pending User Verification';
	
	$sql = "UPDATE order_by_course SET payment_status='$payment_status', bank_transfer_verification_code='$bank_transfer_verification_code', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (order_encypt_id = \"$order_encypt_id\") && (user_encypt_id = \"$user_encypt_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into order_by_course");
	
	$redirect = "manage-payment-complete.php?u=$user_encypt_id&o=$order_encypt_id&vc=$bank_transfer_verification_code";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Reject Course Payment
////////////////////////////////////////////////// 
	case "Reject Course Payment": 
	
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	@$order_encypt_id = addslashes($_POST["order_encypt_id"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	@$payment_status = 'Admin Reject Payment';
	
	$sql = "UPDATE order_by_course SET payment_status='$payment_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (order_encypt_id = \"$order_encypt_id\") && (user_encypt_id = \"$user_encypt_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into order_by_course");
	
	$redirect = "manage-payment-complete.php?u=$user_encypt_id&o=$order_encypt_id";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Approve Product Payment
////////////////////////////////////////////////// 
	case "Approve Product Payment": 
	
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	@$order_encypt_id = addslashes($_POST["order_encypt_id"]);
	$bank_transfer_verification_code = substr($order_encypt_id, 0, 8);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	@$payment_status = 'Pending User Verification';
	
	$sql = "UPDATE order_by_product SET payment_status='$payment_status', bank_transfer_verification_code='$bank_transfer_verification_code', modify_timestamp='$CurrentTimestamp' WHERE (order_encypt_id = \"$order_encypt_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into order_by_product");
	
	$redirect = "manage-payment-product-complete.php?u=$user_encypt_id&o=$order_encypt_id&vc=$bank_transfer_verification_code";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Reject Product Payment
////////////////////////////////////////////////// 
	case "Reject Product Payment": 
	
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	@$order_encypt_id = addslashes($_POST["order_encypt_id"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	@$payment_status = 'Admin Reject Payment';
	
	$sql = "UPDATE order_by_product SET payment_status='$payment_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (order_encypt_id = \"$order_encypt_id\") && (user_encypt_id = \"$user_encypt_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into order_by_product");
	
	$redirect = "manage-payment-product-complete.php?u=$user_encypt_id&o=$order_encypt_id";		
				
    break;
	
	
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Individual Course Attendance
////////////////////////////////////////////////// 
	case "Individual Course Attendance": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "UPDATE attendance_by_individual_course SET course_status='$course_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_individual_course");
	
	$redirect = "attendance-by-individual-course.php";		
				
    break;

  		
//////////////////////////////////////////////////
//          Individual Course Attendance Edit
////////////////////////////////////////////////// 
	case "Individual Course Attendance Edit": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	@$admin_change_lesson_date_num = addslashes($_POST["admin_change_lesson_date_num"]);
	@$admin_change_lesson_date_remarks = addslashes($_POST["admin_change_lesson_date_remarks"]);
	
	$sql = "UPDATE attendance_by_individual_course SET course_status='$course_status', admin_remarks='$admin_remarks', admin_change_lesson_date_num='$admin_change_lesson_date_num', admin_change_lesson_date_remarks='$admin_change_lesson_date_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_individual_course");
	
	$redirect = "user-signup-single-view.php?u=$user_encypt_id";		
				
    break;


//////////////////////////////////////////////////
//          Workshop Attendance
////////////////////////////////////////////////// 
	case "Workshop Attendance": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "UPDATE attendance_by_workshop SET course_status='$course_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_workshop");
	
	$redirect = "attendance-by-workshop.php";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Workshop Attendance Edit
////////////////////////////////////////////////// 
	case "Workshop Attendance Edit": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "UPDATE attendance_by_workshop SET course_status='$course_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_workshop");
	
	$redirect = "user-signup-single-view.php?u=$user_encypt_id";		
				
    break;


//////////////////////////////////////////////////
//          Group Learning Attendance
////////////////////////////////////////////////// 
	case "Group Learning Attendance": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "UPDATE attendance_by_group_learning SET course_status='$course_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_group_learning");
	
	$redirect = "attendance-by-group-learning.php";		
				
    break;	
	
	
//////////////////////////////////////////////////
//          Group Learning Attendance Edit
////////////////////////////////////////////////// 
	case "Group Learning Attendance Edit": 
	
	@$attendance_course_id = addslashes($_POST["attendance_course_id"]);
	@$user_encypt_id = addslashes($_POST["user_encypt_id"]);
	
	@$course_status = addslashes($_POST["course_status"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "UPDATE attendance_by_group_learning SET course_status='$course_status', admin_remarks='$admin_remarks', modify_timestamp='$CurrentTimestamp' WHERE (id = \"$attendance_course_id\")";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into attendance_by_group_learning");
	
	$redirect = "user-signup-single-view.php?u=$user_encypt_id";		
				
    break;

  	






//////////////////////////////////////////////////
//          Extend Course Certificate Valid Date
////////////////////////////////////////////////// 
	case "Extend Course Certificate Valid Date": 
	
	@$cert_valid_date = addslashes($_POST["cert_valid_date"]);
		$cert_valid_date = date("Y-m-d", strtotime($cert_valid_date));
	@$order_id = addslashes($_POST["order_id"]);
			
	$sql = "UPDATE order_by_course SET cert_valid_date='$cert_valid_date' WHERE id = $order_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into order_by_course");
	
	$redirect = "course-certificate-admin-view.php";		
				
    break;
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Course Individual Add Extra Lesson
////////////////////////////////////////////////// 
	case "Course Individual Add Extra Lesson": 
	
	@$u = addslashes($_POST["u"]);
	@$o = addslashes($_POST["o"]);
	@$course_code = addslashes($_POST["course_code"]);
	@$num_extra_lesson_to_add = addslashes($_POST["num_extra_lesson_to_add"]);
	
	$redirect = "course-individual-add-extra-lesson-confirm.php?u=$u&o=$o&course_code=$course_code&num_extra_lesson_to_add=$num_extra_lesson_to_add";		
				
    break;
	
	
//////////////////////////////////////////////////
//          Course Individual Add Extra Lesson Confirm
////////////////////////////////////////////////// 
	case "Course Individual Add Extra Lesson Confirm": 
	
	@$u = addslashes($_POST["u"]);
	@$o = addslashes($_POST["o"]);
	@$course_title = addslashes($_POST["course_title"]);
	@$course_code = addslashes($_POST["course_code"]);
	@$num_extra_lesson_to_add = addslashes($_POST["num_extra_lesson_to_add"]);
	@$pay_price = addslashes($_POST["pay_price"]);
	
	@$payment_type = addslashes($_POST["payment_type"]);
	@$admin_remarks = addslashes($_POST["admin_remarks"]);
	
	$sql = "INSERT into order_by_course (user_encypt_id, invoice_id, course_name, course_code, total_price, type_of_payment, admin_remarks, created_timestamp) VALUES ('$u', '$o', '$course_title', '$course_code', '$pay_price', '$payment_type', '$admin_remarks', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into order_by_course");
	
	// Change Payment Status to Pending Bank Transfer
	if ($result) {
		$id = mysqli_insert_id($cxn);
		$order_id = "$CurrentYear" . '-Course-00' . "$id";
		$order_encypt_id = md5("$order_id"."$CurrentTimestamp");
		
		$sql2 = "UPDATE order_by_course SET order_id='$order_id', order_encypt_id='$order_encypt_id', payment_status = 'Complete', add_lesson = 'Yes' WHERE id = $id";
		$result2 = mysqli_query($cxn,$sql2) 
		or die("Unable to update into order_by_course");	
		
		
		// Insert Individual Course booking into attendance_by_individual_course - START	
		$sql9 = "SELECT * FROM course_individual WHERE (course_code = \"$course_code\")";
		$result9 = mysqli_query($cxn,$sql9)
		or die("Invalid course course_individual");
		$record9 = mysqli_num_rows($result9);
		
		if ($record9 > 0) {
			$display9 = mysqli_fetch_array($result9);
			
			for ($i = 1; $i <= "$num_extra_lesson_to_add"; $i++) {			
				$sql10 = "INSERT into attendance_by_individual_course (order_encypt_id, user_encypt_id, course_code, course_status, created_timestamp) VALUES ('$o', '$u', '$course_code', 'Pending Booked', '$CurrentTimestamp')";
				$result10 = mysqli_query($cxn,$sql10) 
				or die("Unable to insert into attendance_by_individual_course");
			}
		}
		// Insert Individual Course booking into attendance_by_individual_course - END
	}
			
	$redirect = "user-signup-single-view.php?u=$u";		
				
    break;
	
	
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Add Admin Account
////////////////////////////////////////////////// 
	case "Add Admin Account": 
	
	@$type = addslashes($_POST["type"]);
	@$name = ucwords(strtolower(addslashes($_POST["name"]))); // Uppercase the first character of each word in a string
	@$email = strtolower(addslashes($_POST["email"])); // Make a string lowercase	
	@$password = addslashes($_POST["password"]);	
	
	
	$sql = "INSERT into admin_account (type, name, UserEmail, UserPassword) VALUES ('$type', '$name', '$email', '$password')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into user_account");
	
	if ($result) {
		$id = mysqli_insert_id($cxn);
		$encypt_id = md5("$id" . "$email" . "$CurrentTimestamp");	
		
		$sql3 = "UPDATE admin_account SET encypt_id='$encypt_id' WHERE id = $id";
		$result3 = mysqli_query($cxn,$sql3) 
		or die("Unable to update into admin_account");
			
		$redirect = "admin-view.php";	
			
		break;	
	}	
	
	
	
//////////////////////////////////////////////////
//          Update Admin Account
////////////////////////////////////////////////// 
	case "Update Admin Account": 
	
	@$admin_id = addslashes($_POST["admin_id"]);
	
	@$type = addslashes($_POST["type"]);
	@$name = ucwords(strtolower(addslashes($_POST["name"]))); // Uppercase the first character of each word in a string
			
	$sql = "UPDATE admin_account SET type='$type', name='$name' WHERE id = $admin_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to update into admin_account");
	
	$redirect = "admin-view.php";
				
    break;
	
	
	
	
	
	
	
	
//////////////////////////////////////////////////
//          Add Offline Transaction
////////////////////////////////////////////////// 
	case "Add Offline Transaction": 
	
	@$type = addslashes($_POST["type"]);
	@$title = ucwords(strtolower(addslashes($_POST["title"]))); // Uppercase the first character of each word in a string
	@$product_name = ucwords(strtolower(addslashes($_POST["product_name"]))); // Uppercase the first character of each word in a string
	@$offline_description = addslashes($_POST["offline_description"]);
	@$date = addslashes($_POST["date"]);
	@$price = addslashes($_POST["price"]);	
	
	
	$sql = "INSERT into offline_transaction (type, title, product_name, offline_description, date, price, create_timestamp) VALUES ('$type', '$title', '$product_name', '$offline_description', '$date', '$price', '$CurrentTimestamp')";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into offline_transaction");
			
	$redirect = "offline-transaction-view.php";	
			
	break;
	
	
	
//////////////////////////////////////////////////
//          Update Offline Transaction
////////////////////////////////////////////////// 
	case "Update Offline Transaction": 
	
	@$ot_id = addslashes($_POST["ot_id"]);
	
	@$type = addslashes($_POST["type"]);
	@$title = ucwords(strtolower(addslashes($_POST["title"]))); // Uppercase the first character of each word in a string
	@$product_name = ucwords(strtolower(addslashes($_POST["product_name"]))); // Uppercase the first character of each word in a string
	@$offline_description = addslashes($_POST["offline_description"]);
	@$date = addslashes($_POST["date"]);
	@$price = addslashes($_POST["price"]);	
	
	
	$sql = "UPDATE offline_transaction SET type='$type', title='$title', product_name='$product_name', offline_description='$offline_description', date='$date', price='$price', modify_timestamp='$CurrentTimestamp' WHERE id = $ot_id";
	$result = mysqli_query($cxn,$sql) 
	or die("Unable to insert into offline_transaction");
			
	$redirect = "offline-transaction-view.php";	
			
	break;	
		
	
			
		
	
	
	default:

    $redirect = "dashboard.php";
	
}
header("Location: $redirect");
?>