<?php
if (isset($_POST)) {
    $modulo = $_POST['model'];
    $funcion = $_POST['method'];
    $nombreClase = $modulo.'Controller';
   
    //existe el directorio
    if(is_dir("../../../../controller/$modulo") && is_dir("../../../../model/$modulo")) {
        if (//existe el archivo
            file_exists("../../../../controller/$modulo/{$modulo}Controller.php") &&
            file_exists("../../../../model/$modulo/{$modulo}Model.php")
        ) {//incluir archivos
            include_once "../../../../lib/conf/Connection.php";
            include_once "../../../../lib/helpers.php";
            include_once "../../../../model/MasterModel.php";            
            include_once "../../../../model/$modulo/{$modulo}Model.php";
            include_once "../../../../controller/$modulo/{$modulo}Controller.php";
            //incluir clase  
            $clase = new $nombreClase();
            //llamar la funcion
            if (method_exists($clase,$funcion)) {
                /** No usar una nueva variable POST llamada 'datos' */
                if (!empty($_POST['datos'])) {
                    $clase->$funcion($_POST['datos']);
                } else {
                    $clase->$funcion($_POST, $_FILES);
                }
            }else{
                echo 'no existe el metodo';
            }
            
        }else{   
        echo 'no existe archivo';
        }
    }else{
        echo 'no existe directorio ';
    }
}