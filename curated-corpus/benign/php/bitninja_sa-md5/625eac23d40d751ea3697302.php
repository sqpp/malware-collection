<?php

//fetch_cart.php

session_start();

$total_price = 0;
$total_item = 0;



if(!empty($_SESSION["shopping_cart"]))
{
 foreach($_SESSION["shopping_cart"] as $keys => $values)
 {
  $output .= '
 
                                <div class="dropdown-cart-products">
                                    <div class="product">
                                        <div class="product-cart-details">
                                            <h4 class="product-title">
                                                <a href="product.html">'.$values["product_name"].'</a>
                                            </h4>

                                            <span class="cart-product-info">
                                                
                                                 '.number_format($values["product_price"],3).' x '.$values["product_quantity"].'
                                            </span>
                                        </div><!-- End .product-cart-details -->

                                        <figure class="product-image-container">
                                            <a href="product.html" >
                                                 <img src="../dashboard_na9el/fournitures/images_fournitures/'.$values["product_image"].'" alt="Product image" >
                                            </a>
                                        </figure>
                                        <a  class="btn-remove delete" name="delete" id="'. $values["product_id"].'"  title="Remove Product"><i class="icon-close"></i></a>
                                        
                                    </div><!-- End .product -->
                                   
                                    
  ';
  $total_price = $total_price + ($values["product_quantity"] * $values["product_price"]);

  $total_item = $total_item + $values["product_quantity"];
 }
 $output .= '
 
 </div>
   <div class="dropdown-cart-total">
                                    <span>Total TTC</span>

                                    <span class="cart-total-price">'.number_format($total_price, 3).'</span>&nbsp;
                                </div><!-- End .dropdown-cart-total -->

     <a href="#"  id="clear_cart">
      <span class="far fa-trash"></span> Vider Panier
     </a>
     
       <div class="dropdown-cart-action">
                                    <a href="cart.html" class="btn btn-primary">Panier</a>
                                    <a href="commande.php" class="btn btn-outline-primary-2"><span>Commander</span><i class="icon-long-arrow-right"></i></a>
                                </div><!-- End .dropdown-cart-total -->
 ';
}
else
{
 $output .= '
  
      <div class="alert alert-info"><i class="fas fa-shopping-bag"></i>&nbsp;&nbsp;Panier Vide&nbsp;<i class="fas fa-exclamation-circle"></i></div>
    
    ';
}


$data = array(
 'cart_details'  => $output,
 'total_price'  =>  number_format($total_price,3),
 'total_item'  => $total_item
);

echo json_encode($data);

?>
