<?php
include_once('includes/db_connection.php');
if (isset($_POST["product_id"])) {
  $output = '';
  $query = "SELECT products.*, categories.cat_name, sub_categories.sub_cat_name FROM products,categories,sub_categories WHERE p_id ='" . $_POST["product_id"] . "'";
  $result = mysqli_query($connect, $query);
  $row = mysqli_fetch_array($result);
  $product_id = $_POST["product_id"];

  $catergory_qry = "SELECT * FROM categories";
  $result_cat = mysqli_query($connect, $catergory_qry);

  $sub_catergory_qry = "SELECT * FROM sub_categories";
  $result_sub_cat = mysqli_query($connect, $sub_catergory_qry);

  $output .= '
          <form action="config.php" method="post">
          <input type="hidden" class="form-control" id="product_name" value="' . $product_id . '" name="product_id">
            <div class="row space was-validated">
              <div class="col">
                <label> Product Name </label>
                <input type="text" class="form-control" id="product_name" value="' . $row["name"] . '" name="product_name" required>
              </div>
              <div class="col">
                <label> Product Code </label>
                <input type="text" class="form-control" id="product_code" value="' . $row["product_code"] . '" name="product_code" required>
              </div>
            </div>
            <div class="row space was-validated">
              <div class="col">
                <label> Product Price </label>
                <input type="text" class="form-control" id="price" value="' . $row["price"] . '" name="price" required>
              </div>
              <div class="col">
                <label> Size  </label>
                <input type="text" class="form-control" id="type" value="' . $row["size"] . '" name="size" required>
              </div>
            </div>
            <div class="row space">
            <div class="col">
            <label> Select Main Category  </label>
              <select class="custom-select mb-3" name="main_cat">
                  <option value="' . $row['cat_id'] . '">' . $row['cat_name'] . '</option>';
                    foreach ($result_cat as $cat_row) {
                      $output .= '<option value="' . $cat_row['cat_id'] . '">' . $cat_row['cat_name'] . '</option>';
                    }
$output .=   '</select>
            </div>

            <div class="col">
            <label> Select Sub Category  </label>
              <select class="custom-select mb-3" name="sub_cat">
                  <option value="' . $row['sub_cat_id'] . '">' . $row['sub_cat_name'] . '</option>';
                    foreach ($result_sub_cat as $sub_cat_row) {
                      $output .= '<option value="' . $sub_cat_row['sub_cat_id'] . '">' . $sub_cat_row['sub_cat_name'] . '</option>';
                    }
$output .=   '</select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <input type="submit" class="btn btn-success" name="update_prod" value="Update Product">
        </div>
        </form>';
}
echo $output;
?>

<style>
  .txt-bold {
    font-weight: Bold;
    font-size: 16px;
  }

  .txt {
    font-size: 16px;
  }
</style>

<!-- <div class="row space">
              <div class="col">
                <select class="custom-select mb-3" name="main_cat">
                  <option selected disabled>Select Catergory</option>';
                  foreach($result_cat as $cat_row){
                  '<option value="'.$cat_row["cat_id"].'">'.$cat_row["cat_name"].'</option>';
                  };
                '</select>
              </div>
            </div> -->