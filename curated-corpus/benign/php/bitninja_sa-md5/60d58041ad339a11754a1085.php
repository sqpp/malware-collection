<?php

include 'connect.php';
session_start();
$username=$_POST["username"];
$password=$_POST["password"];

function goBack(){
  $info="Some error occured!!";
  header('Location: index.php?info='.$info);
  exit();
}

function goToDashboard(){
  header('Location: ./dashboard.php');
  exit();
}

function clean($string) {
   $string = str_replace(' ', '-', $string); // Replaces all spaces with hyphens.

   return preg_replace('/[^A-Za-z0-9\-]/', '', $string); // Removes special chars.
}

$sql = "SELECT id FROM admin where username='".clean($username)."' and password='".clean($password)."'";
$result = $con->query($sql);

if ($result->num_rows > 0) {
    // output data of each row
    while($row = $result->fetch_assoc()) {
        $_SESSION["id"]=$row["id"];
        $_SESSION["name"]=$username;
        goToDashboard();
    }
} else {
    goBack();
}
?>