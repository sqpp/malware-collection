<?php
//	extract($_REQUEST);
include("_config.php");


$bad_chars = array("'", "#", "^", "$", ";", "`",  ";", "|", '"', "select", "drop", "update", "alter", "insert");

foreach ($_REQUEST as $name => $value) {
	$val = str_replace($bad_chars, "", $value);
	$val = strip_tags($val);



	$val = mysqli_real_escape_string($GLOBALS['link'], $val);
	$val = str_replace("\\r\\n", "\n", $val);

	$_REQUEST[$name] = $val;
}

/*
echo "<pre>";
print_r( $_REQUEST);
echo "</pre>";
*/


if (isset($success)) { // tulburiin guigeenii heseg sss
	$sel = "payment";
	$f = "transaction";
} // tulburiin guigeenii heseg eee


//		include("fckeditor/fckeditor.php");
/*if (preg_match("/_main/i",   $_SERVER['REQUEST_URI']  )) 
{   header("Location: index.php");
    die();
}
*/

?>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="bataka.css" rel="stylesheet" type="text/css">


<!-- GOOGLE STATISTIC SSS-->

<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
	try {
		var pageTracker = _gat._getTracker("UA-6707265-2");
		pageTracker._trackPageview();
	} catch (err) {}
</script>


<!-- GOOGLE STATISTIC EEE -->

<style type="text/css">
	.clear {
		clear: both;
	}
</style>
<link rel="stylesheet" href="css/tab-view.css" type="text/css" media="screen">
<script type="text/javascript" src="js/ajax.js"></script>
<script type="text/javascript" src="js/tab-view.js">
	/************************************************************************************************************
	(C) www.bbssoft.biz, September  2007
	************************************************************************************************************/
</script>

<script type="text/javascript" src="js_main.js" language="javascript1.5"></script>
<script type="text/javascript">
	function check_register(register, user_table) { //check register
		//i_max = window.document.frm_people1217.show_objnum.value+1;
		//alert (register);
		// var sId = document.getElementById("user_reg").value;
		// alert ("1--"sId+"2--"+register);
		var oXmlHttp = zXmlHttp.createRequest();
		oXmlHttp.open("get", "checkregister.php?register=" + register + "&user_table=" + user_table, true);
		//		oXmlHttp.open("get", "checkregister.php?register=" + sId+"&user_table="+user_table, true);
		oXmlHttp.onreadystatechange = function() {
			if (oXmlHttp.readyState == 4) {
				if (oXmlHttp.status == 200) {
					displayRegisterInfo(oXmlHttp.responseText);
				} else {
					displayRegisterInfo("An error occurred: " + oXmlHttp.statusText); //statusText is not always accurate
				}
			}
		};
		oXmlHttp.send(null);
	} // check register


	function displayRegisterInfo(sText) {
		var divRegisterInfo = document.getElementById("divRegisterInfo");
		divRegisterInfo.innerHTML = sText;
	}
</script>

<?php


function paging($targetpage, $adjacents, $total_pages, $limit, $p)
{ // function paging


	$targetpageAJAX =  substr($targetpage, 1, strlen($targetpage) - 1);

	if ($p)
		$start = ($p - 1) * $limit; //first item to display on this page
	else
		$start = 0; //if no page var is given, set start to 0

	/* Setup page vars for display. */
	if ($p == 0) $p = 1; //if no page var is given, default to 1.
	$prev = $p - 1; //previous page is page - 1
	$next = $p + 1; //next page is page + 1
	$lastpage = ceil($total_pages / $limit); //lastpage is = total pages / items per page, rounded up.
	$lpm1 = $lastpage - 1; //last page minus 1

	/*
Now we apply our rules and draw the pagination object.
We're actually saving the code to a variable in case we want to draw it more than once.
*/
	$pagination = "";
	if ($lastpage > 1) {
		$pagination .= "<div class=\"pagination\"   align=center >   ";
		//previous button
		if ($p > 1)
			$pagination .= "<a href=\"$targetpage&p=$prev\"   >« өмнөх</a>";
		else
			$pagination .= "<span class=\"disabled\">« өмнөх</span>";

		//pages
		if ($lastpage < 7 + ($adjacents * 2)) //not enough pages to bother breaking it up
		{
			for ($counter = 1; $counter <= $lastpage; $counter++) {
				if ($counter == $p)
					$pagination .= "<span class=\"current\">$counter</span>";
				else
					$pagination .= "<a href=\"$targetpage&p=$counter\"   >$counter</a>";
			}
		} elseif ($lastpage > 5 + ($adjacents * 2)) //enough pages to hide some
		{
			//close to beginning; only hide later pages
			if ($p < 1 + ($adjacents * 2)) {
				for ($counter = 1; $counter < 4 + ($adjacents * 2); $counter++) {
					if ($counter == $p)
						$pagination .= "<span class=\"current\">$counter</span>";
					else
						$pagination .= "<a href=\"$targetpage&p=$counter\"       >$counter</a>";
				}
				$pagination .= "...";
				$pagination .= "<a href=\"$targetpage&p=$lpm1\"     >$lpm1</a>";
				$pagination .= "<a href=\"$targetpage&p=$lastpage\"     >$lastpage</a>";
			}
			//in middle; hide some front and some back
			elseif ($lastpage - ($adjacents * 2) > $p && $p > ($adjacents * 2)) {
				$pagination .= "<a href=\"$targetpage&p=1\"    >1</a>";
				$pagination .= "<a href=\"$targetpage&p=2\"    >2</a>";
				$pagination .= "...";
				for ($counter = $p - $adjacents; $counter <= $p + $adjacents; $counter++) {
					if ($counter == $p)
						$pagination .= "<span class=\"current\">$counter</span>";
					else
						$pagination .= "<a href=\"$targetpage&p=$counter\"       >$counter</a>";
				}
				$pagination .= "...";
				$pagination .= "<a href=\"$targetpage&p=$lpm1\"    >$lpm1</a>";
				$pagination .= "<a href=\"$targetpage&p=$lastpage\"    >$lastpage</a>";
			}
			//close to end; only hide early pages
			else {
				$pagination .= "<a href=\"$targetpage&p=1\"     >1</a>";
				$pagination .= "<a href=\"$targetpage&p=2\"     >2</a>";
				$pagination .= "...";
				for ($counter = $lastpage - (2 + ($adjacents * 2)); $counter <= $lastpage; $counter++) {
					if ($counter == $p)
						$pagination .= "<span class=\"current\">$counter</span>";
					else
						$pagination .= "<a href=\"$targetpage&p=$counter\"       >$counter</a>";
				}
			}
		}

		//next button
		if ($p < $counter - 1)
			$pagination .= "<a href=\"$targetpage&p=$next\"     >дараах »</a>";
		else
			$pagination .= "<span class=\"disabled\">дараах »</span>";
		$pagination .= "</div>\n";
	}


	/*
while($row = mysql_fetch_array($result))
{

// Your while loop here
echo "afdopaisd pfa  ";

}
*/

	return  $pagination;
} // function paging



function generate_password($length = 10)
{ // pass generator sss	

	$allowable_characters = "1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM";

	// We see how many characters are in the allowable list
	$ps_len = strlen($allowable_characters);

	// Seed the random number generator with the microtime stamp
	// (current UNIX timestamp, but in microseconds)
	mt_srand((float)microtime() * 1000000);

	// Declare the password as a blank string.
	$pass = "";

	// Loop the number of times specified by $length
	for ($i = 0; $i < $length; $i++) {

		// Each iteration, pick a random character from the
		// allowable string and append it to the password.
		$pass .= $allowable_characters[mt_rand(0, $ps_len - 1)];
	} // End for

	// Retun the password we've selected
	return $pass;
} // pass generator eee


function getWeatherData($index, $values)
{
	global $length;
	// possible values are 'weather','search, and 'error'
	switch ($values[0]['tag']) {
		case "weather":
			$return_array['type'] = "weather";

			$return_array[unit]['temp'] = $values[$index['ut'][0]]['value'];
			$return_array[unit]['dist'] = $values[$index['ud'][0]]['value'];
			$return_array[unit]['speed'] = $values[$index['us'][0]]['value'];
			$return_array[unit]['precip'] = $values[$index['up'][0]]['value'];
			$return_array[unit]['pressure'] = $values[$index['ur'][0]]['value'];

			$return_array[loc_info]['name'] = $values[$index['dnam'][0]]['value'];
			$return_array[loc_info]['time'] = $values[$index['tm'][0]]['value'];
			$return_array[loc_info]['lat'] = $values[$index['lat'][0]]['value'];
			$return_array[loc_info]['long'] = $values[$index['lon'][0]]['value'];
			$return_array[loc_info]['time_zone'] = $values[$index['zone'][0]]['value'];

			$return_array[cc]['feels_like'] = $values[$index['flik'][0]]['value'];
			$return_array[cc]['last_update'] = $values[$index['lsup'][0]]['value'];
			$return_array[cc]['temp'] = $values[$index['tmp'][0]]['value'];
			$return_array[cc]['text'] = $values[$index['t'][0]]['value'];
			$return_array[cc]['observation_station'] = $values[$index['obst'][0]]['value'];
			$return_array[cc]['icon'] = $values[$index['icon'][0]]['value'];
			$return_array[cc]['humidity'] = $values[$index['hmid'][0]]['value'];
			$return_array[cc]['visibility'] = $values[$index['vis'][0]]['value'];
			$return_array[cc]['dew_point'] = $values[$index['dewp'][0]]['value'];
			$return_array[cc]['uv_index'] = $values[$index['i'][0]]['value'];
			$return_array[cc]['uv_text'] = $values[$index['t'][2]]['value'];
			$return_array[cc]['moon_icon'] = $values[$index['icon'][1]]['value'];
			$return_array[cc]['moon_text'] = $values[$index['t'][3]]['value'];
			$return_array[cc]['uv_index'] = $values[$index['i'][0]]['value'];
			$return_array[cc]['wind_speed'] = $values[$index['s'][0]]['value'];
			$return_array[cc]['wind_gust'] = $values[$index['gust'][0]]['value'];
			$return_array[cc]['wind_direction'] = $values[$index['d'][1]]['value'];
			$return_array[cc]['wind_text'] = $values[$index['t'][1]]['value'];
			$return_array[cc]['barometer'] = $values[$index['r'][0]]['value'];
			$return_array[cc]['barometer_dir'] = $values[$index['d'][0]]['value'];

			$counter = 0;
			if (array_key_exists("day", $index)) {
				foreach ($index['day'] as $day) {
					if ($values[$day]['attributes']['t'] != "") {
						$day_text = (($counter + 1) * 3) + $counter + 1;  // 4,8,12,...
						$day_wind = ((($counter + 1) * 3) + $counter) + 2; // 5,9,13,...
						$day_windspeed = (($counter + 1) * 2) - 1; // 1,3,5,...
						$day_windgust = (($counter + 1) * 2) - 1; // 1,3,5,...
						$day_winddir = ($counter + 1) * 2; // 2,4,6,...
						$day_humidity = (($counter + 1) * 2) - 1; // 1,3,5,...
						$day_precip = $counter * 2; // 0,2,4,...
						$day_icon = ($counter + 1) * 2; // 2,4,6,...

						$night_text = ((($counter + 1) * 3) + $counter) + 3; // 6,10,14,...
						$night_wind = ((($counter + 1) * 3) + $counter) + 4; // 7,11,15,...
						$night_windspeed = ($counter + 1) * 2; // 2,4,6,...
						$night_windgust = ($counter + 1) * 2; // 2,4,6,...
						$night_winddir = (($counter + 1) * 2) + 1; // 3,5,7,...
						$night_humidity = ($counter + 1) * 2; // 2,4,6,...
						$night_precip = ($counter * 2) + 1; // 1,3,5,...
						$night_icon = (($counter + 1) * 2) + 1; // 3,5,7,...

						$return_array['day'][$counter]['date'] = $values[$day]['attributes']['dt'];
						$return_array['day'][$counter]['day'] = $values[$day]['attributes']['t'];
						$return_array['day'][$counter]['hi'] = $values[$index['hi'][$counter]]['value'];
						$return_array['day'][$counter]['low'] = $values[$index['low'][$counter]]['value'];
						$return_array['day'][$counter]['sunrise'] = $values[$index['sunr'][$counter + 1]]['value'];
						$return_array['day'][$counter]['sunset'] = $values[$index['suns'][$counter + 1]]['value'];
						$return_array['day'][$counter]['day_text'] = $values[$index[t][$day_text]][value];
						$return_array['day'][$counter]['day_wind'] = $values[$index[t][$day_wind]][value];
						$return_array['day'][$counter]['day_windspeed'] = $values[$index[s][$day_windspeed]][value];
						$return_array['day'][$counter]['day_windgust'] = $values[$index[gust][$day_windgust]][value];
						$return_array['day'][$counter]['day_winddir'] = $values[$index[d][$day_winddir]][value];
						$return_array['day'][$counter]['day_humid'] = $values[$index[hmid][$day_humidity]][value];
						$return_array['day'][$counter]['day_pct_precip'] = $values[$index[ppcp][$day_precip]][value];
						$return_array['day'][$counter]['day_icon'] = $values[$index[icon][$day_icon]][value];
						$return_array['day'][$counter]['night_text'] = $values[$index[t][$night_text]][value];
						$return_array['day'][$counter]['night_wind'] = $values[$index[t][$night_wind]][value];
						$return_array['day'][$counter]['night_windspeed'] = $values[$index[s][$night_windspeed]][value];
						$return_array['day'][$counter]['night_windgust'] = $values[$index[gust][$night_windgust]][value];
						$return_array['day'][$counter]['night_winddir'] = $values[$index[d][$night_winddir]][value];
						$return_array['day'][$counter]['night_humid'] = $values[$index[hmid][$night_humidity]][value];
						$return_array['day'][$counter]['night_pct_precip'] = $values[$index[ppcp][$night_precip]][value];
						$return_array['day'][$counter]['night_icon'] = $values[$index[icon][$night_icon]][value];
						$counter++;
					}
				}
			}
			break;
		case "search":
			if (array_key_exists('loc', $index)) {
				if (count($index[loc]) == 1) header("Location:" . $_SERVER[PHP_SELF] . "?q=" . $values[$index['loc'][0]]['attributes']['id'] . "&d=" . $length); // if one city is returned for a search, don't draw select drop down menu, get weather data
				$return_array['type'] = "search";
				$search_count = 0;
				foreach ($index['loc'] as $valkey) {
					$return_array[$search_count]['city'] = $values[$valkey]['value'];
					$return_array[$search_count]['locid'] = $values[$valkey]['attributes']['id'];
					$search_count++;
				}
			} else {
				$return_array['type'] = "error";
				$return_array[]['error'] = "no locations found";
			}
			break;
		case "error":
			$return_array['type'] = "error";
			$return_array[]['error'] = $values[1]['value'];;
			break;
	}
	//print_r($return_array);
	return $return_array;
}


function getPathNamesService($PathName)
{
	$query_type = " SELECT menu_id, menu_root, menu_name, menu_link FROM bbs_service WHERE menu_id='$PathName' ORDER BY menu_id ";
	$result_type = mysqli_query($GLOBALS['link'], $query_type) or die("Query failed MENU :" . mysql_error());
	while (list($menu_id1, $menu_root1, $menu_name1, $menu_link1) =  mysqli_fetch_row($result_type)) { // path while ////////////	
		getPathNamesService($menu_root1, $PathColor);
		echo " &nbsp; 
			<img src=\"images/path.gif\" width=9 height=9 style='padding-top:5px; padding-bottom:0px;'> 
			
			<a href=\"#?sel=service&menu_id=$menu_id1\"  onclick=\"requestPage('?sel=service&menu_id=$menu_id1')\"  > <strong style='color:$PathColor;'>$menu_name1</strong> </a> &nbsp;   ";
	} // path while ////////////	
}


function getPathNames($PathName, $PathColor)
{
	$query_type = " SELECT menu_id, menu_root, menu_name, menu_link FROM  bbs_menu WHERE menu_id='$PathName' ORDER BY menu_id ";
	$result_type = mysqli_query($GLOBALS['link'], $query_type) or die("Query failed MENU :" . mysql_error());
	while (list($menu_id1, $menu_root1, $menu_name1, $menu_link1) =  mysqli_fetch_row($result_type)) { // path while ////////////	
		getPathNames($menu_root1, $PathColor);
		echo " &nbsp; 
			<img src=\"images/path.gif\" width=9 height=9 style='padding-top:5px; padding-bottom:0px;'> 
			
			<a href=\"#?sel=$menu_link1&menu_id=$menu_id1\"  onclick=\"requestPage('?sel=$menu_link1&menu_id=$menu_id1')\"  > <strong style='color:$PathColor;'>$menu_name1</strong> </a> &nbsp;   ";
	} // path while ////////////	
}

function getWebCategory($WebId)
{
	$query_webcat = " SELECT webcat_id, webcat_root, webcat_name, webcat_desc FROM  bbs_webcategory 
				  WHERE webcat_id='$WebId' ORDER BY webcat_id ";
	$result_webcat = mysqli_query($GLOBALS['link'], $query_webcat) or die("Query failed WEB :" . mysql_error());
	while (list($webcat_id1, $webcat_root1, $webcat_name1, $webcat_desc1) =  mysqli_fetch_row($result_webcat)) { // web category while ////////////	
		getWebCategory($webcat_root1);
		echo $webcat_name1 . " >> ";;
	} // web category while ////////////	
}



function getFolderNames($FolderName)
{
	$query_type = " SELECT menu_id, menu_root, menu_name, menu_link FROM  bbs_menu WHERE menu_id='$FolderName' ORDER BY menu_id ";
	$result_type = mysqli_query($GLOBALS['link'], $query_type) or die("Query failed MENU :" . mysql_error());
	while (list($menu_id1, $menu_root1, $menu_name1, $menu_link1) =  mysqli_fetch_row($result_type)) { // category while ////////////	
		getFolderNames($menu_root1);
		echo $menu_name1 . " >> ";;
	} // category while ////////////	
}

function getCategoryNames($FolderName)
{
	$query_type = " SELECT menu_id, menu_root, menu_name, menu_link FROM  bbs_category WHERE menu_id='$FolderName' ORDER BY menu_id ";
	$result_type = mysqli_query($GLOBALS['link'], $query_type) or die("Query failed MENU :" . mysql_error());
	while (list($menu_id1, $menu_root1, $menu_name1, $menu_link1) =  mysqli_fetch_row($result_type)) { // category while ////////////	
		getCategoryNames($menu_root1);
		echo $menu_name1 . " >> ";;
	} // category while ////////////	
}

$bgcolor1 = "#FFFFFF";
$bgcolor2 = "#006699";

function OpenTableMI()
{
	echo "<table width=\"100%\" border=\"0\" cellspacing=\"2\" cellpadding=\"0\" ><tr><td>\n";
}

function CloseTableMI()
{
	echo "</td></tr></table>\n";
}

function OpenTable()
{
	global $bgcolor1, $bgcolor2;
	echo "<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"0\" bgcolor=\"$bgcolor2\"><tr><td>\n";
	echo "<table width=\"100%\" border=\"0\" cellspacing=\"1\" cellpadding=\"8\" bgcolor=\"$bgcolor1\"><tr><td>\n";
}

function CloseTable()
{
	echo "</td></tr></table></td></tr></table>\n <br>";
}

?>

<?php

if (isset($_SESSION["biirbeh_admin"]) && isset($_SESSION["biirbeh_pass"])   && $_SESSION['b_level'] == 1) { //if  admin pass session registered bol sss
	// admin bval sss		// admin bval sss	// admin bval sss
	// admin bval sss		// admin bval sss	// admin bval sss
	// include("fckeditor/fckeditor.php");

	$pr = 20;
?>

	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td height="26" align="center" background="images/h1.gif" class="topmenu" style="background-repeat:no-repeat; padding-left:5px; background-position:center">Administration area </td>
		</tr>
		<tr>
			<td height="100%" background="images/bgsub.jpg" style="background-repeat:repeat-y;" valign="top">
				<div id="zar_delete" align="center" style="color:#FF0000">

				</div>
				<?php


				switch ($sel) {

					case "authcat_manager":
						include('a_authcat.php');
						break;
					case "author_manager":
						include('a_author.php');
						break;
					case "zur_manager":
						include('a_zur.php');
						break;
					case 'webcategory_manager':
						require("a_webcategory.php");
						break;
					case 'web_manager':
						require("a_web.php");
						break;
					case 'service_manager':
						require("a_service.php");
						break;
					case 'msg_manager':
						require("a_msg.php");
						break;
					case 'auser_manager':
						require("a_auser.php");
						break;
					case 'properties_manager':
						require("a_properties.php");
						break;
					case 'epapers_send':
						require("a_epapers.php");
						break;
					case 'newsletter_send':
						require("a_newsletter.php");
						break;
					case 'org_manager':
						require("a_org.php");
						break;
					case 'exchange_manager':
						require("a_exchange.php");
						break;
					case 'exchangewhere_manager':
						require("a_exchangewhere.php");
						break;
					case 'newscategory_manager':
						require("a_newscategory.php");
						break;
					case 'poll_manager':
						require("a_poll.php");
						break;
					case 'gallerycategory_manager':
						require("a_gallerycategory.php");
						break;
					case 'gallery_manager':
						require("a_gallery.php");
						break;
					case 'category_manager':
						require("a_category.php");
						break;
					case 'announcement_manager':
						require("a_announcement.php");
						break;
					case 'menu_manager':
						require("a_menu.php");
						break;
					case 'events_manager':
						require("a_events.php");
						break;
					case 'type_manager':
						require("a_menu.php");
						break;
					case 'user_manager':
						include("a_usr.php");
						break;
					case 'mod_manager':
						require("a_mod.php");
						break;
					case 'biirbeh_manager':
						require("a_job.php");
						break;
					case 'content_manager':
						require("a_content.php");
						break;
					case 'banner_manager':
						require("a_banner.php");
						break;
					case 'user':
						require("p_user.php");
						break;
					case 'auser':
						require("p_auser.php");
						break;
					case 'reviews_manager':
						include("a_reviews.php");
						break;
						////////////PAGES  SSS
						////////////PAGES  SSS

					case "calendar":
						include('p_calendar.php');
						break;
						// exchange mini module write date 2009-04-14 by Bat-Erdene zarmedee new admin
					case "exchange":
						include('p_exchange.php');
						break;
					case "zur":
						include('p_zur.php');
						break;
						// post module write date 2008-12-16
					case "web_add":
						include('p_web_add.php');
						break;
					case "web_d":
						include('p_web_d.php');
						break;

					case "web":
						include('p_web.php');
						break;
					case "payment":
						include('p_payment.php');
						break;
					case "post":
						include('p_post.php');
						break;
					case "service":
						include('p_service.php');
						break;
					case "org":
						include('p_org.php');
						break;
					case "contevent":
						include('p_contevent.php');
						break;
					case "weather":
						include('p_weather.php');
						break;
					case "user":
						include('p_user.php');
						break;
					case "home":
						include('p_home.php');
						break;
					case "announcement":
						include('p_announcement.php');
						break;
					case "zar":
						include('p_zar.php');
						break;
					case "search":
						include('p_search.php');
						break;
					case "mail":
						include('p_mail.php');
						break;
					case "content":
						include('p_content.php');
						break;
					case "event":
						include('p_event.php');
						break;
					case "feedback":
						include('p_feedback.php');
						break;
					case "poll":
						include('p_poll.php');
						break;
					case "policy":
						include('p_policy.htm');
						break;
					case "contactus":
						include('p_contactus.php');
						break;
					case "paper":
						include('p_paper.php');
						break;
					case "paper":
						include('p_paper.php');
						break;
					case "gallery":
						include('p_gallery.php');
						break;
					case "sitemap":
						include('p_sitemap.php');
						break;
					case "privacy":
						include('p_privacy.php');
						break;
					case "user":
						include('p_user.php');
						break;
					case "ang":
						include('angilal.php');
						break;
					case "tv":
						include('tv/tv.php');
						break;
					case "zarm":
						include('p_zarm.php');
						break;
						////////////PAGES  EEE
						////////////PAGES  EEE
					default:
						include('p_home.php');
						break;
				}

				?>
			</td>
		</tr>
	</table>

<?php
	// admin bval eee		// admin bval eee	// admin bval eee
	// admin bval eee		// admin bval eee	// admin bval eee
}	//if  moderator session registered bol 
elseif (isset($_SESSION['biirbeh_moderatormini']) && isset($_SESSION['biirbeh_pass'])  && ($_SESSION['b_level'] == 3)) { //if  moderator session registered bol sss
	// moderator bval sss		// moderator bval sss	// moderator bval sss
	// moderator bval sss		// moderator bval sss	// moderator bval sss
	include("fckeditor/fckeditor.php");
	$pr = 30;
?>

	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td height="26" align="center" background="images/h1.gif" class="topmenu" style="background-repeat:no-repeat; padding-left:5px; background-position:center">Moderator area </td>
		</tr>
		<tr>
			<td height="100%" background="images/bgsub.jpg" style="background-repeat:repeat-y;" valign="top">
				<div id="zar_delete" align="center" style="color:#FF0000">

				</div>
				<?php


				switch ($sel) {
						//	case 'service_manager':require("a_service.php");break;
						//	case 'msg_manager':require("a_msg.php");break;
						//	case 'auser_manager':require("a_auser.php");break;
						//	case 'properties_manager':require("a_properties.php");break;
						//	case 'epapers_send':require("a_epapers.php");break;
						//	case 'newsletter_send':require("a_newsletter.php");break;
						//	case 'org_manager':require("a_org.php");break;
						//	case 'exchange_manager':require("a_exchange.php");break;
						//	case 'newscategory_manager':require("a_newscategory.php");break;
						//	case 'poll_manager':require("a_poll.php");break;
						//	case 'gallerycategory_manager':require("a_gallerycategory.php");break;
						//	case 'gallery_manager':require("a_gallery.php");break;
					case 'category_manager':
						require("a_category.php");
						break;
						//	case 'announcement_manager':require("a_announcement.php");break;
					case 'menu_manager':
						require("a_menu.php");
						break;
						//	case 'events_manager':require("a_events.php");break;
						//	case 'type_manager':require("a_menu.php"); break;
						//	case 'user_manager':  include("a_usr.php");  break;
					case 'mcontent_manager':
						require("a_mcontent.php");
						break;
						//	case 'banner_manager':require("a_banner.php");break;
					case 'user':
						require("p_user.php");
						break;
					case 'auser':
						require("p_auser.php");
						break;
					case 'reviews_manager':
						include("a_reviews.php");
						break;
						////////////PAGES  SSS
						////////////PAGES  SSS

					case "calendar":
						include('p_calendar.php');
						break;
						// exchange mini module write date 2009-04-14 by Bat-Erdene zarmedee new admin
					case "exchange":
						include('p_exchange.php');
						break;
					case "zur":
						include('p_zur.php');
						break;
						// post module write date 2008-12-16
					case "web":
						include('p_web.php');
						break;
					case "payment":
						include('p_payment.php');
						break;
					case "post":
						include('p_post.php');
						break;
					case "service":
						include('p_service.php');
						break;
					case "org":
						include('p_org.php');
						break;
					case "contevent":
						include('p_contevent.php');
						break;
					case "weather":
						include('p_weather.php');
						break;
					case "user":
						include('p_user.php');
						break;
					case "home":
						include('p_home.php');
						break;
					case "announcement":
						include('p_announcement.php');
						break;
					case "zar":
						include('p_zar.php');
						break;
					case "search":
						include('p_search.php');
						break;
					case "mail":
						include('p_mail.php');
						break;
					case "content":
						include('p_content.php');
						break;
					case "event":
						include('p_event.php');
						break;
					case "feedback":
						include('p_feedback.php');
						break;
					case "poll":
						include('p_poll.php');
						break;
					case "policy":
						include('p_policy.htm');
						break;
					case "contactus":
						include('p_contactus.php');
						break;
					case "paper":
						include('p_paper.php');
						break;
					case "gallery":
						include('p_gallery.php');
						break;
					case "paper":
						include('p_paper.php');
						break;
					case "sitemap":
						include('p_sitemap.php');
						break;
					case "privacy":
						include('p_privacy.php');
						break;
					case "user":
						include('p_user.php');
						break;
					case "web_add":
						include('p_web_add.php');
						break;
					case "web_d":
						include('p_web_d.php');
						break;
					case "web":
						include('p_web.php');
						break;
					case "ang":
						include('angilal.php');
						break;
					case "tv":
						include('tv/tv.php');
						break;
					case "zarm":
						include('p_zarm.php');
						break;
						////////////PAGES  EEE
						////////////PAGES  EEE
					default:
						include('p_home.php');
						break;
				}

				?>
			</td>
		</tr>
	</table>

<?php
	// moderator bval eee		// moderator bval eee	// moderator bval eee
	// moderator bval eee		// moderator bval eee	// moderator bval eee
}	//if  moderator  session registered bol 
else {	//if  guest bol 

	switch ($sel) {  // SWITCH
			//SYSTEM PAGE PAGES///sss///////////////	
			//SYSTEM PAGE PAGES///sss///////////////	

			// ADMIN ORNO
		case "auser":
			include('p_auser.php');
			break;

			//SYSTEM PAGE PAGES///eee///////////////	
			//SYSTEM PAGE PAGES///eee///////////////	

			////////////PAGES  SSS
			////////////PAGES  SSS

			// exchange mini module write date 2009-04-14 by Bat-Erdene zarmedee new admin
		case "exchange":
			include('p_exchange.php');
			break;
		case "zur":
			include('p_zur.php');
			break;

		case "calendar":
			include('p_calendar.php');
			break;
			// post module write date 2008-12-16
		case "web":
			include('p_web.php');
			break;
		case "web_add":
			include('p_web_add.php');
			break;
		case "web_d":
			include('p_web_d.php');
			break;

		case "payment":
			include('p_payment.php');
			break;
		case "post":
			include('p_post.php');
			break;
		case "service":
			include('p_service.php');
			break;
		case "org":
			include('p_org.php');
			break;

		case "weather":
			include('p_weather.php');
			break;
		case "contevent":
			include('p_contevent.php');
			break;
		case "home":
			include('p_home.php');
			break;
		case "content":
			include('p_content.php');
			break;
		case "event":
			include('p_event.php');
			break;
		case "announcement":
			include('p_announcement.php');
			break;
		case "mail":
			include('p_mail.php');
			break;
		case "feedback":
			include('p_feedback.php');
			break;
		case "poll":
			include('p_poll.php');
			break;
		case "policy":
			include('p_policy.htm');
			break;
		case "contactus":
			include('p_contactus.php');
			break;
		case "paper":
			include('p_paper.php');
			break;
		case "gallery":
			include('p_gallery.php');
			break;
		case "sitemap":
			include('p_sitemap.php');
			break;
		case "privacy":
			include('p_privacy.php');
			break;
		case "user":
			include('p_user.php');
			break;
		case "zar":
			include('p_zar.php');
			break;
		case "search":
			include('p_search.php');
			break;
		case "ang":
			include('angilal.php');
			break;
		case "tv":
			include('tv/tv.php');
			break;
		case "zarm":
			include('p_zarm.php');
			break;
		default:
			include('p_home.php');
			////////////PAGES  SSS
			////////////PAGES  SSS
	} // SWITCH 
}	//if  guest bol 



////////////////////////WHO IS ONLINE ///////////////////////

$ip = $_SERVER["REMOTE_ADDR"];
$uname  =  $_SESSION['exch_name'];

if (!isset($uname)) {
	$uname = "$ip";
	$guest = 1;
}
$past = time() - 3600;
mysqli_query($GLOBALS['link'], "DELETE FROM bbs_session WHERE time < '$past'");
$result = mysqli_query($GLOBALS['link'], "SELECT time FROM bbs_session WHERE uname='$uname'");
$ctime = time();
if ($row = mysqli_fetch_row($result)) {
	mysqli_query($GLOBALS['link'], "UPDATE bbs_session SET uname='$uname', time='$ctime', host_addr='$ip', guest='$guest' WHERE uname='$uname'");
} else {
	mysqli_query($GLOBALS['link'], "INSERT INTO bbs_session (uname, time, host_addr, guest) VALUES ('$uname', '$ctime', '$ip', '$guest')");
}
////////////////////////WHO IS ONLINE ///////////////////////


?>