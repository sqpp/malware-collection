<?php
/* Sucuri integrity monitor
 * Integrity checking and server side scanning.
 *
 * Copyright (C) 2010, 2011, 2012 Sucuri, LLC
 * http://sucuri.net
 * Do not distribute or share.
 */

$MYMONITOR = "monitor12";
$my_sucuri_encoding = "



LyogU3VjdXJpIGludGVncml0eSBtb25pdG9yIC4gCiAqIENvbm5lY3RzIGJhY2sgaG9tZS4KICog
Q29weXJpZ2h0IChDKSAyMDEwLTIwMTMgU3VjdXJpLCBMTEMKICogRG8gbm90IGRpc3RyaWJ1dGUg
b3Igc2hhcmUuCiAqLwoKCiRTVUNVUklQV0QgPSAiNTM1ZTI2ZWIwZjMzMjRlODA1NmZlNjk1NDk3
NmIwNGM2MmViOTc3ZjJjYzUxIjsKCgppZihpc3NldCgkX0dFVFsndGVzdCddKSkKewogICAgZWNo
byAiT0s6IFN1Y3VyaTogRm91bmRcbiI7CiAgICBleGl0KDApOwp9CgoKCi8qIFZhbGlkIGFyZ3Vt
ZW50LiAqLwppZighaXNzZXQoJF9HRVRbJ3J1biddKSkKewogICAgZXhpdCgwKTsKfQoKCi8qIE11
c3QgaGF2ZSBhbiBJUCBhZGRyZXNzLiAqLwppZighaXNzZXQoJF9TRVJWRVJbJ1JFTU9URV9BRERS
J10pKQp7CiAgICBleGl0KDApOwp9Cgokb3JpZ3JlbW90ZWlwID0gJF9TRVJWRVJbJ1JFTU9URV9B
RERSJ107CgovKiBJZiBjb21pbmcgZnJvbSBjbG91ZGZsYXJlOiAqLwppZihpc3NldCgkX1NFUlZF
UlsnSFRUUF9DRl9DT05ORUNUSU5HX0lQJ10pKQp7CiAgICAkX1NFUlZFUlsnUkVNT1RFX0FERFIn
XSA9ICRfU0VSVkVSWydIVFRQX0NGX0NPTk5FQ1RJTkdfSVAnXTsKfQovKiBNb3JlIGdhdGV3YXkg
cmVxdWVzdHMuICovCmVsc2UgaWYoaXNzZXQoJF9TRVJWRVJbJ0hUVFBfWF9PUklHX0NMSUVOVF9J
UCddKSkKewogICAgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gPSAkX1NFUlZFUlsnSFRUUF9YX09S
SUdfQ0xJRU5UX0lQJ107Cn0KLyogUHJveHkgcmVxdWVzdHMuICovCmVsc2UgaWYoaXNzZXQoJF9T
RVJWRVJbJ0hUVFBfVFJVRV9DTElFTlRfSVAnXSkpCnsKICAgICRfU0VSVkVSWydSRU1PVEVfQURE
UiddID0gJF9TRVJWRVJbJ0hUVFBfVFJVRV9DTElFTlRfSVAnXTsKfQovKiBQcm94eSByZXF1ZXN0
cy4gKi8KZWxzZSBpZihpc3NldCgkX1NFUlZFUlsnSFRUUF9YX1JFQUxfSVAnXSkpCnsKICAgICRf
U0VSVkVSWydSRU1PVEVfQUREUiddID0gJF9TRVJWRVJbJ0hUVFBfWF9SRUFMX0lQJ107Cn0KLyog
TW9yZSBnYXRld2F5IHJlcXVlc3RzLiAqLwplbHNlIGlmKGlzc2V0KCRfU0VSVkVSWydIVFRQX1hf
Rk9SV0FSREVEX0ZPUiddKSkKewogICAgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gPSAkX1NFUlZF
UlsnSFRUUF9YX0ZPUldBUkRFRF9GT1InXTsKfQoKCiRteWlwbGlzdCA9IGFycmF5KAonOTcuNzQu
MTI3LjE3MScsCic2OS4xNjQuMjAzLjE3MicsCicxNzMuMjMwLjEyOC4xMzUnLAonNjYuMjI4LjM0
LjQ5JywKJzY2LjIyOC40MC4xODUnLAonNTAuMTE2LjMuMTcxJywKJzUwLjExNi4zNi45MicsCicx
OTguNTguOTYuMjEyJywKJzUwLjExNi42My4yMjEnLAonMTkyLjE1NS45Mi4xMTInLAonMTkyLjgx
LjEyOC4zMScsCicxOTguNTguMTA2LjI0NCcsCicyNjAwOjNjMDA6OmYwM2M6OTFmZjpmZWFlOmUx
MDQnLAonMjYwMDozYzAyOjpmMDNjOjkxZmY6ZmVkZjo1OGM2JywKJzI2MDA6M2MwMjo6ZjAzYzo5
MWZmOmZlZGY6NTgzNScsCicyNjAwOjNjMDM6OmYwM2M6OTFmZjpmZWRmOjZhN2EnLAonZmU4MDo6
ZmNmZDphZGZmOmZlZTY6ODA4NycsCicyNjAwOjNjMDM6OmYwM2M6OTFmZjpmZTcwOjM2Y2UnLAon
MjYwMDozYzAyOjpmMDNjOjkxZmY6ZmU3MDpmMTJkJywKJzI2MDA6M2MwMTo6ZjAzYzo5MWZmOmZl
NzA6NTJiYicsCic1MC4xMTYuMzYuOTMnLAopOwoKCiRpcG1hdGNoZXMgPSAwOwoKZm9yZWFjaCgk
bXlpcGxpc3QgYXMgJG15aXApCnsKICAgIGlmKHN0cnBvcygkX1NFUlZFUlsnUkVNT1RFX0FERFIn
XSwgJG15aXApICE9PSBGQUxTRSkKICAgIHsKICAgICAgICAkaXBtYXRjaGVzID0gMTsKICAgICAg
ICBicmVhazsKICAgIH0KICAgIGlmKHN0cnBvcygkb3JpZ3JlbW90ZWlwLCAkbXlpcCkgIT09IEZB
TFNFKQogICAgewogICAgICAgICRpcG1hdGNoZXMgPSAxOwogICAgICAgIGJyZWFrOwogICAgfQp9
CgoKaWYoJGlwbWF0Y2hlcyA9PSAwKQp7CiAgICBlY2hvICJFUlJPUjogSW52YWxpZCBJUCBBZGRy
ZXNzXG4iOwogICAgZXhpdCgwKTsKfQoKCi8qIFZhbGlkIGtleS4gKi8KaWYoIWlzc2V0KCRfUE9T
VFsnc3NjcmVkJ10pKQp7CiAgICBlY2hvICJFUlJPUjogSW52YWxpZCBhcmd1bWVudFxuIjsKICAg
IGV4aXQoMCk7Cn0KCgovKiBDb25uZWN0IGJhY2sgdG8gZ2V0IHdoYXQgdG8gcnVuLiAqLwppZigh
ZnVuY3Rpb25fZXhpc3RzKCdjdXJsX2V4ZWMnKSB8fCBpc3NldCgkX0dFVFsnbm9jdXJsJ10pKQp7
CiAgICAkcG9zdGRhdGEgPSBodHRwX2J1aWxkX3F1ZXJ5KAogICAgICAgICAgICBhcnJheSgKICAg
ICAgICAgICAgICAgICdwJyA9PiAkU1VDVVJJUFdELAogICAgICAgICAgICAgICAgJ3EnID0+ICRf
UE9TVFsnc3NjcmVkJ10sCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7CgogICAgJG9w
dHMgPSBhcnJheSgnaHR0cCcgPT4KICAgICAgICAgICAgYXJyYXkoCiAgICAgICAgICAgICAgICAn
bWV0aG9kJyAgPT4gJ1BPU1QnLAogICAgICAgICAgICAgICAgJ2hlYWRlcicgID0+ICdDb250ZW50
LXR5cGU6IGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsCiAgICAgICAgICAgICAg
ICAnY29udGVudCcgPT4gJHBvc3RkYXRhCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICk7
CgogICAgJGNvbnRleHQgPSBzdHJlYW1fY29udGV4dF9jcmVhdGUoJG9wdHMpOwogICAgJG15X3N1
Y3VyaV9lbmNvZGluZyA9IGZpbGVfZ2V0X2NvbnRlbnRzKCJodHRwczovLyRNWU1PTklUT1Iuc3Vj
dXJpLm5ldC9pbW9uaXRvciIsIGZhbHNlLCAkY29udGV4dCk7CgogICAgaWYoc3RybmNtcCgkbXlf
c3VjdXJpX2VuY29kaW5nLCAiV09SS0VEOiIsNykgPT0gMCkKICAgIHsKICAgIH0KICAgIGVsc2UK
ICAgIHsKICAgICAgICBlY2hvICJFUlJPUjogVW5hYmxlIHRvIGNvbXBsZXRlIChtaXNzaW5nIGN1
cmwgc3VwcG9ydCBhbmQgZmlsZV9nZXQgZmFpbGVkKS4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydEBz
dWN1cmkubmV0IGZvciBndWlkYW5jZS5cbiI7CiAgICAgICAgZXhpdCgxKTsKICAgIH0KfQoKZWxz
ZQp7CgogICAgJGNoID0gY3VybF9pbml0KCk7CiAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRf
VVJMLCAiaHR0cHM6Ly8kTVlNT05JVE9SLnN1Y3VyaS5uZXQvaW1vbml0b3IiKTsKICAgIGN1cmxf
c2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgICBjdXJsX3NldG9w
dCgkY2gsIENVUkxPUFRfUE9TVCwgdHJ1ZSk7CiAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRf
UE9TVEZJRUxEUywgInA9JFNVQ1VSSVBXRCZxPSIuJF9QT1NUWydzc2NyZWQnXSk7IAogICAgY3Vy
bF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCBmYWxzZSk7CgogICAgJG15X3N1
Y3VyaV9lbmNvZGluZyA9IGN1cmxfZXhlYygkY2gpOwogICAgY3VybF9jbG9zZSgkY2gpOwoKICAg
IGlmKHN0cm5jbXAoJG15X3N1Y3VyaV9lbmNvZGluZywgIldPUktFRDoiLDcpID09IDApCiAgICB7
CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYoJG15X3N1Y3VyaV9lbmNvZGluZyA9PSBO
VUxMIHx8IHN0cmxlbigkbXlfc3VjdXJpX2VuY29kaW5nKSA8IDMpCiAgICAgICAgewogICAgICAg
ICAgICAkbXlfc3VjdXJpX2VuY29kaW5nID0gIngyMzUxIjsKICAgICAgICB9CiAgICAgICAgZWNo
byAiRVJST1I6IFVuYWJsZSB0byBjb25uZWN0IGJhY2sgdG8gU3VjdXJpIChlcnJvcjogJG15X3N1
Y3VyaV9lbmNvZGluZykuIFBsZWFzZSBjb250YWN0IHN1cHBvcnRAc3VjdXJpLm5ldCBmb3IgZ3Vp
ZGFuY2UuXG4iOwogICAgICAgIGV4aXQoMSk7CiAgICB9Cn0KCgokbXlfc3VjdXJpX2VuY29kaW5n
ID0gIGJhc2U2NF9kZWNvZGUoCiAgICAgICAgICAgICAgICAgICAgICAgc3Vic3RyKCRteV9zdWN1
cmlfZW5jb2RpbmcsIDcpKTsKCgpldmFsKAogICAgJG15X3N1Y3VyaV9lbmNvZGluZwogICAgKTsK
Cgo=

";

/* Encoded to avoid that it gets flagged by AV products or even ourselves :) */
eval
    (base64_decode(
                    $my_sucuri_encoding));
exit(0); ?>    
    
