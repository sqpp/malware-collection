<?php session_start();?>
<?php


if( !isset($_SESSION['admin']) ){
    header("location: ./../../admin/index.php");
    exit;
}

include '../dao/daoConnection.php';
include '../dao/aspectsDAO.php';
include '../entities/aspect.php';


$s = $_POST['s'];
$a = $_POST['a'];

$fileName = $_FILES[ 'file' ][ 'name' ];
$fileType = $_FILES['file']["type"];
$fileSize = $_FILES['file']['size'];

$s = "aspecto2";
$location = "location: ./../../admin/menuAdmin.php?s=".$s."&a=".$a;

if($fileName == ""){
    header($location.'&error1');
    exit;
}

$aspectoDAO = new AspectsDAO;
$aspecto = $aspectoDAO->getAspect($a);

$aspecto->setValue($fileName);

//$aspectoDAO->updateAspect($aspecto);
$destino = '../../images/'.$fileName;
if(move_uploaded_file( $_FILES[ 'file' ][ 'tmp_name' ], $destino)){
    $aspectoDAO->updateAspect($aspecto);
    header($location.'&ok');
    exit;
}


//everything fine!
header($location.'&fail');
exit;

?>