<?php
// vim: set noexpandtab tabstop=4 softtabstop=4 shiftwidth=4:
// vim: set syntax=php paste:
// vim: set foldmethod=marker foldmarker={{{,}}} nofoldenable:
// vim: set nolist lcs=tab\:>\ :
// vim: set hlsearch:

# X-Cart  company Support  team uses this  script for  remote access to your
# server.  This script was placed on your server because you ordered support
# service at our corporate site.  After the work on your server is done this
# script can be deleted.
#
# If you have any questions please feel free to ask them through the Support
# Helpdesk.
#
###############################################################################
#
# User settings
#
###############################################################################
##
## User support.css file location
##
#define('LOCAL_HOSTNAME', 'example.com');
##
## Your IP address
## You can set only 2 additional IPs. Use ',' to separate it.
## Example: define('ADDITIONAL_IP', '94.127.74.20, 94.127.74.21');
##
#define('ADDITIONAL_IP', '');
##
## Any tables placed here will exclude from "MySQL dump".
## Enter a list of tables, separated by a ','
## for example: '_stats_, xcart_referers'
##
define('SUPPORT_EXCLUDE_TABLES', '_stats_, xcart_referers');
##
## Prefix for X-Cart v5 and LiteCommrerce v3 tables
##
define('XC5_PREFIX', 'xc_');
##
###############################################################################
#
# WARNING : It is forbidden to change anything below!
#
###############################################################################
define('SUPPORT_LOGIN', 'sarta');
define('SUPPORT_COOKIE_PREFIX', 'support_terminal_');
define('SUPPORT_EXPIRE_COOKIE', 86400);
if (!defined('LOCAL_HOSTNAME')) {
    define('LOCAL_HOSTNAME', 'dev.qtmsoft.com');
}
define('VERSION', '1.13');
if (!empty($_SERVER['SCRIPT_NAME'])) {
    define('SUPPORT_NAME', basename($_SERVER['SCRIPT_NAME']));
} elseif(!empty($_SERVER['SCRIPT_FILENAME'])) {
    define('SUPPORT_NAME', basename($_SERVER['SCRIPT_FILENAME']));
} else {
    define('SUPPORT_NAME', basename(__FILE__));
}

define('SUPPORT_SESSION_NAME', 'sxid');
define('SUPPORT_MAX_LOGIN_ATTEMPTS', 5);
define('SUP_MSG_TYPE_CRIT', 'error');
define('SUP_MSG_TYPE_WARN', 'warning');
define('SUP_MSG_TYPE_DEBUG', 'debug');

define('SUP_SESS_OFF_MESS', 'messages');
define('SUP_SESS_OFF_TEXT', 'text');
define('SUP_SESS_OFF_CODE', 'code');

_func_set_rtm_settings();
_func_send_headers();
_session_start();

// check for cookie error
if (isset($_POST['action']) && $_POST['action'] == 'login') {
	if (empty($support_data)) {
		throw new Exception('cookie failure');			
	}
}

$pwd = $support_data['support_password'];

function _hook_call($zone, $mode) { // {{{
	$mode = func_get_var($mode);
	$params = func_get_var('params', 'POST');
	$func = $zone.'_'.$mode;
	if (function_exists($func)) {
		$func($params);
	}
} // }}}

_hook_call('_pre_action', 'action');
if (empty($pwd)) {
	_func_display_header(true);
	_message_display();
	func_display_auth_form();
	func_display_footer();
	die;
}

$password = md5(SUPPORT_LOGIN . $pwd);
$code = '<?php ?'.'>';
$signature = '07cd1f848d37e5a5de1901f5295ae9a30f2d09653d2fe311933a2eca08d334db5d81ca203706916ea7d4cbd470096e3c';
if (!defined('SUPPORT_DEBUG')) {
	eval('
$code = "";
$code.="1b9f98290930a000514b7f1e53ea23cb3de3c6a45536d7af43db153abe4958cd2dee02352b76ff71";
$code.="ff94d1ba8134088dd3077a1c76a80bf1e72fc0061c2a01e88c58b054f97c468a87e02304cf36083f";
$code.="8e3eadc7637a50f27b2a6312710ed77d3aa33eaac493f336a9b6cd249c4df582540da8443a8860f3";
$code.="aeaea1793ac9f6421ba9ef9aea34682a269eba98ffd0f1a8f2675299188cbea6f38b3ad845396661";
$code.="37f7bd9c22af9f7e54c5155780a82014899581e97529b39820569093dfc9d4163aa33eaac493f336";
$code.="2576d68048f1333341ea9a71060752496e6b7716b4f25de3a7f6cdfe3a898e7259f44c2490973cd1";
$code.="ef8ae1ec9ab8c84e754a44ebd7c798ed6e6b7716b4f25de34ba1e9ee7184b2a2431cacd8a1970337";
$code.="0b6006ace74e48e437e65225e3df78eb5b2a7f52b1421fa89e27cc7caad207a92294cf6bc998c095";
$code.="2f1cc5f25673abf1c6e13754e2f7864a47bfae66eae248ed55d37ddf86183f5949441a7167fd6228";
$code.="482a7820931f0226d28e48edec3d3a909600333c172cb33c2d407a40e7675f2d4dc1934d0d0f35d9";
$code.="609cc7b66f1578670b490c57e5da0a0a64b9e56ca8a67d1cf389936c1f408eb8180efa39be7812cc";
$code.="11c4a8da53f47045205fef9009afb3cf0296e0a8a85f6cedc3cfd27bb8324497986d1748ef4c8fc8";
$code.="daa2d3081fc830ed35a96dc98babbf076a83186c0e0c96c7cd16062d8eba51a43d459406c2748e8f";
$code.="6c784506f340f4e99673ab4bcf45b2a41d986a6cd85e419c7c7e1ee27c88c4307d1386cb37fbc7b2";
$code.="17720cf998926b43e77b27df2e34a35a147b4ef2fae4ad73351b08db3cf9588db2b85b6694487148";
$code.="5ce0a98426ed24f19eedb8e6c2aef8c4912ee77492db701ae76f5f49d8ba128064c0632ad777e94c";
$code.="a0a1f80935f4c07155aae199c6794ec14dcc51d88e0a9f432714c8c0931cddbce7aa656cf3f9bc0c";
$code.="826bb5592c4c0fe640068327dc0f96659dc8f2918c51468399fee2d10fb9cb53f934e9b403dab20f";
$code.="81f37ce122761ddb1b8efdd8505d16a7083edc022c5215f344c3d904a6cff33a1d16553de4db523a";
$code.="9d9651f676ca68750375f4fba22efd38de705c4ce86e2a22c2a60d7e0db193da12283f3f6111d901";
$code.="f4885c578a17af2c463562520dcfd58d892e945fdc5087d346edbac9921078aa00bb1391c2b62250";
$code.="8267b2632e5d8e03d034c7384cb58894efb47916dcbd340536e08a8dced9794c30af237e07b4b3e8";
$code.="0bf63a3ad1ea66b354db23c4c5551ae4e13047ad15178dfb996b12dd46a8f12ea75ab1f523a8d941";
$code.="a6d2fc554b6def7c25ea9c450362a2fd3ac6c00bbf85a1933a8bd53e41f00423e8b26f54f2c7679a";
$code.="e661336f9144e4c1a0e594260e60f9c862fdffcd2f4415274f7620d92aeabb67eb4f3b54a3b93d1e";
$code.="f7019fa7eb6bb5ec14d84898be2903c3aee40fa8f3665073d76ba58253036a88580bcbaff939f979";
$code.="a329413b2ea8f9200cbbee40359d9f3b48fb7a8a4a9579cb0fc12de1e8e364e1ea6c3193e2a89845";
$code.="4be92244fe1f7a4f75e73aff65070d9057ebb95a0b736fec12122fa436c91fbd71663a5751129175";
$code.="a0cf66ed0d374b804b22095cecc7b527481fd0ef72a17c003b74874edf21b387b15084aadc58cbee";
$code.="ddcba887fbae0166e35a6c96d693f2b63358eb63afbbe57ff97c8779ff7e35ca7109881d8569dc98";
$code.="df262fbbf67aa431f2963c90c4d8d67f3bb401f3dd94ec8920e2541f168ff1e20eb5688b149cd34d";
$code.="cea1ff7610099b3c53cedd1e57afd9ccb74f63e894cfe81f8bff97d32441754ca329413b2ea8f920";
$code.="18b31ad7135878a6be2b1365e2ca9b8253e6b0ab70eb2669e0d816998cb5ff62bf9f849a5fd57ab0";
$code.="6f8007b623eeac6c4adb244e80023259f14d2f82b86df8ae62079558710ee46659fa5e90a0493d82";
$code.="19771b5611e9c57f3b73fe0b8da59b184dbb095f508dd86c3aafd0e3251d5a6b3ff8e275d4499f8d";
$code.="c8bf9b90a017729284e895ca8cadbee15066e74f8462c6d1ff5bb7e9e41bc0a5845975aedc1b831a";
$code.="2272ac78296673b56c6b9b8694254877b8e46018f8df31ef87720964763a98f6224f9ed92c7da7a6";
$code.="a7b12214df4d41d98d14293295e7baa12836ef2b1fd7890ebbc59024483969f4d652635397682a5e";
$code.="6b872a46877aef8fcaa42943e0c34a76984235ee353e785ffe798691c5ecb3738a2f07e0a5e8097a";
$code.="f1fa23d10685e06939612cb1e29d12e6e92d531cced8cee506c82d34e2383b9e6acbfc6d62642792";
$code.="2fdd75af8dcbd690bf59dde2f82f15390b692237980fb100696287227067cc9bc24cd3b1df3e6a57";
$code.="435f949da76a31e92b7e0bcfa6f79b24136cc274fe247e1db98362812f5ff625a72bef4afbf7003f";
$code.="984235ee353e785ffe798691c5ecb37348f1bc032d82dd9254953b5d6de29f019f5a296b1d2169df";
$code.="511c8139d6ab15664cb0acf5b0a3eb09d89074c467eec86385dade42de2f2ca052b7a74d49327d76";
$code.="fb7dc6c0fc94b54984833e14763c150346edbac9921078aabf59dde2f82f15390b692237980fb100";
$code.="c963043d1e28958e684bf6674674fc06fc93ee565fed5b3215f52804b51a5571c5a596f198cec5bd";
$code.="9bf62f684b4f188862079558710ee4668abaf585ace2bb14576fb43513adc23bfa4a2b4458777fdc";
$code.="0653cb84c69e0c03446263cc2cc812fb3945e2b48dc168d1ad765b0a236a2b27c963043d1e28958e";
$code.="9f4ebd7d42169ba776a6ac1714ff6451a0cf66ed0d374b8072d3cc3da192c6d57ad61af7d54a15f4";
$code.="7ed48d7c2d6bf218e1e6ebcfd62e024d355f78a100d96d263aafd0e3251d5a6b9382c4425dda0d99";
$code.="a999efb3fee58f67802ba097b3e4e452a5a118fc5155ca64ee4975f145629a1187720964763a98f6";
$code.="2a76e19689e810cea72bef4afbf7003fb7c940940f9b8ca65bdfa29901553ea943e995a9ac564694";
$code.="5a808951fb18b3c7733266f1119386f2199b5e96e2296372e6ee3a57122fd716e1515e16ecf4ea7b";
$code.="d56a739671fc6e2084fb03195f0de6636ec6fe8192e2acd86ee3e60a9ed6902dd5a97cc530c6c580";
$code.="525f28ead5a3ed95dd66c80b0d7bc6b6d530b50f6788fe5141eca57cf48203ca1a3da289f13b36c8";
$code.="a7b12214df4d41d9c1315c051aa51b9eb0006c081f79ee99202c3513e243f53469b648852ee266c4";
$code.="50692356d38cf0e08922dd4ca6c9cb58e3592e04037181c39a5b4beceb294adca250efada3b70d81";
$code.="80097bdc953cd7ac8f9e209a2afcf29c136c4adbda756fd96ad9705d43a0ebd2db96c574f42a42ad";
$code.="939f6d27bec933e99ba01b3a0ff47dc7f8c598d70def02ae1b3f1730e5b0d9ff0e2f0cc8c9f41c78";
$code.="429329e233efe926ec8efe2b605a79450d887cac5c6b2b0f8c20cd7c720e88ea0b490c57e5da0a0a";
$code.="4ce81a2a27ffc41bfa68e5790a83259ff585929f5f4d4f8c8dc79e274de48fc26e230a0ea9d5c631";
$code.="f0ca0fed73782b52ea7b7b10f165399add0938c8892cc181063416d5bdd8e4b967c872c379d830d7";
$code.="c5cc73b01458776421be258913c16701ee9896ef6d7628896165c8592dc72ff85f797a1f550f109c";
$code.="4210356bae038ff65618fa50b1eceeebfe94883e8ca1b4f891e8fae5c710db80a49cf0884b183389";
$code.="4b5c0ecdabc3ed9ca72bef4afbf7003f5fc72140ab5982403d78867a94f1dcfe6aeae1b981386c8b";
$code.="30bfffcf164c669a0a026540585680b030282bc4c3ad2f6892067b38dfe6ab44cb90544c422f5678";
$code.="a7b12214df4d41d9230ffd905841d691a9bbdcaeb1888d6f6f493aa29eb01122d45092541ef932be";
$code.="6d8d4a1a0cfbee99fe5e8bf9a79e450c6086f63de7a630323d80022167d42a5c30060c712cf10ed4";
$code.="463a296b0b50b8d5a335da4ea52727c7a5aea011104953d82e4c7c0135f60ffe3d5d1edb1addd4c9";
$code.="a7b12214df4d41d96e791241a908b6fa50c186e82c65a7ce5fd6e4474b90bbd6f713fbcf742e5cd9";
$code.="bd16c10ac12249c3c865cb81409e10cb71b22d749ea13e11af20e594ebc5881353f8540084d99c2e";
$code.="8ea99322ca7cd0c7a7b12214df4d41d9386af7aeee66d145974ccc0be97f97c5002879a3db85572e";
$code.="d6976a745612338dc952c1391e581532b8ea8120930f9ee35e413a2205cc27c10be492eafb3d0369";
$code.="24eb3fd06c23560934d3835ca307ed27852364c7ffec0322b7ef9f4fc69308b0a65d9283e2234bae";
$code.="4d87112a7bafddf393647731ea2378dd059743f350c6f6245142af0c3de9b0916448414c6477c248";
$code.="649d80d984753ae576da0b2662ea275a07b363a7b3b9871471a0660c9dcb8849bf96b0e59c7e4b75";
$code.="5ab705d655d91bfe985c3bc1e36c69748967674ae93170adaa835bb4672794fd22869c2293c5d5b5";
$code.="9bf82b311b017d0382e40a4a4f28cf00bd6bf36e26f3175a5790605ad11bd7757515d4a96e4e60e4";
$code.="a2095994cc849acb0fe9669a7db7bdbd6822e89548f86774a59c1362b5559b83a77322af0f1146e0";
$code.="81f56f26a762c45dbfb82d0951b3af8d2dfa211a480cd9d962079558710ee4666e30417665f9c9c8";
$code.="ca4da521f7db1681c00816c1aec4fdf4c5e9cb7dedb6922ee9fd38b34cabf40dc00816c1aec4fdf4";
$code.="a72bef4afbf7003f5010f32ecf781c195c95c69696411f49ecebbb4a7368d10c6f1423c03e1b3d68";
$code.="237be9191bd245a1a383e11450be8775484672a494e2e97c5e69feda7dc9a4042ae36b02ca808622";
$code.="2f41e48d7f4be06ba7b12214df4d41d9af409c7f461d625d73b4f2ae81cd5d27092863678594ebdc";
$code.="7a3c9f78fc1e4e1230cef579f39a82ff82d29d0b03657ca50346dea56f6501a8c39cda3f0ca2cd48";
$code.="66170d6d93bb7c7b7987b1d63e69da2d51c0d7e30234121fc53ef473003876d18ea8b9b9cc64fe17";
$code.="93ec7b534889b9098a212efc6df6b13dfbac659aae1101fd6bb2823da622b401763d70c1f692b1d3";
$code.="50c354c0d3d3f919df5f804e2b1954c003b1106bf7be10fea0cf66ed0d374b809ebfcf6194f666a4";
$code.="3845aaf86d51a2d82bc5d08f99154545622afb6357f5e02c815c897dfb748a53c963043d1e28958e";
$code.="5d4acad5d0d1301246edbac9921078aae419d94669b07b8afdd67a6d20f6903c20db319c0ad52a9f";
$code.="b39c9a120b80ef6bd4e0b9745387b485d76ba58253036a88ff4f64db5efc6fbb62079558710ee466";
$code.="e880db3b17b7a6ddf9d948785c981d168fc94d35033f353666170de2c7565ef598793293c11203c5";
$code.="0f82d9e41ee45df52a8b1f4d46f3e126b48b2202c7123cdc0e025d0d2a83e769628e8f991fb610b6";
$code.="9de2814631052770a4d7d6531078ed90d1ebdb6a835502621b19c7c5dc4900ecd863ed73e44dc4fa";
$code.="d76ba58253036a886ea725eed496f8bd62079558710ee466e880db3b17b7a6dd83da996d290505ff";
$code.="bd959a4e0293315cc6cc96b1d1c1c9ac13dd3c054021ad160b692237980fb1005eea37aad8d72228";
$code.="a0cf66ed0d374b802e3d732f8254a9f9e2fa3f35a299a08f4e43f2f28ce6d3a6481fd0ef72a17c00";
$code.="53a3481ddcbf143da329413b2ea8f92084505a8210b4d5760eedac59d7a0d84450052965b94d83b3";
$code.="8f6096c0c0868eabfcda3a764f36ca1490af86a43010c705737b72472da1b6b7a9c3288b6d785508";
$code.="fe798691c5ecb373563ae1b97ffdcce8a329413b2ea8f920751a73797a388065a598d231b7e446fb";
$code.="bda029077f642e753e3d52d067db254227f6f04747ad26ee1edacd9249c343ea1cf475ad9e6fe086";
$code.="a72bef4afbf7003f38d9d12223f0c316b42274775ba52f106f8007b623eeac6cefcb0db977b58e2b";
$code.="fd085b1b929eb2682b3f0409f604616342ca7b3ab84a04409c4989cec6c93eb562079558710ee466";
$code.="15581631173ac96adda4fd548cfcbe466ef00ff3f5e8888b707c74b27d89f46bf9be4620c41916f0";
$code.="a72bef4afbf7003f984235ee353e785fc45b8873623f85fc753ec11c34df678a2b591217d4a9967e";
$code.="83ba36c3f6eacff08c79089e69db8fc136967e838c6f504d01ca647763c09b5f02b5fa583778d839";
$code.="3a900105d41b3f819a2368a59ad638b9965ae11aadbb82f3a329413b2ea8f9207c98e6cecf31d3b1";
$code.="a335da4ea52727c70ba8da5846ef7b2f34b7281c8f2e979191b5fef4427df828c8fef429e521530a";
$code.="450694e094cd66db736e6cc2cd614049439c6d85b080904f5ca8dc51071f93c2bf59dde2f82f1539";
$code.="a1ec320b53b1276ae964e91ef98b8d9dcd3816e773cc2ca56c6fff21bed7859065b036704a2a820b";
$code.="d76fbd0179df216083d0ea5dba5b0243fe24fe076d6b4d211ec1a99fc9327987297db92c4f97a660";
$code.="a7b12214df4d41d9a95aef9bcda350b6c45b8873623f85fc26783d2e0a47c736fc0ef7cf08a74dc7";
$code.="53f8540084d99c2e2712ea77c74afb91d30faebe04ac3ab962079558710ee46670c5911e7a3dc82e";
$code.="1d86f8f996b2f6c35be3da15d1ae67ea9c9f3d1af92d9724cd37e4b0a5025a8f63703165e0927e57";
$code.="62079558710ee466536c9d1d10f2a5a769ee97164c6371a841050afbe04cfd2356b606a04780ef0e";
$code.="c557923cb475212ea329413b2ea8f920c6f968191b1d091206c82d34e2383b9e6acbfc6d62642792";
$code.="4bbbd9a22a31009ccc6b88e019dfd5d8cfc670cb633e2379c5fca0d9870388ad311a9b8e454b0268";
$code.="b6752fb0333ad0b0c24cd3b1df3e6a57c0d65a55170623f0c8596d963779214aab386365666d02b9";
$code.="a329413b2ea8f920decbd6f0d57b7ca4c633f47ed5aa43f775156afcd1b42d27924e25204106dc8c";
$code.="861aca7ea719ff2f0a1a8afcaba6a58894ffb54a614cfc4d4ae4839b9aa83026e08feebbf1dbe275";
$code.="e13047ad15178dfb92dc86da7cd8696bd8fb1fb573a43f78f6a057b18e814903dad6f15715bacf98";
$code.="a7b12214df4d41d93cfbb211d28dd856a81297a851be5aa0d3aa64e078b21a8631276e60c9cbbee5";
$code.="536b9959d21484e3d7a05ebcfd46d8c8f9d92fa57d645772358f7a836cf3e269c22f0fca27c1a36e";
$code.="0b692237980fb10013dc9aac0273dd0ddbb63f18eb5ebefb7d519dc40bb7c94a2ea697f7c61eb080";
$code.="62079558710ee46644c4eb8a1151c4a35d822e7899b41958c99b378330a030f0f94dbbb68eb0d543";
$code.="24b6f2ce0674bdb98c88b2658ce3ab0c140b71cf919b188307f0656a5dcbc63d96fc5e80336ee55f";
$code.="3d2f30a5e87841e35d2ff7a57e72e00d2659a812f385aa0fe0134a6d2618e267374d60bc0357207a";
$code.="dbdddd0fde6ace8893b3bc24361c4ab1b6e3704eefca3a156b0831f97cdce6d349e929e3ac75c561";
$code.="82fa14e88e27bc39a449b0d28fa5e2a9c351027a845b9c498cba8de7b2a54e086691b87059798914";
$code.="d3dfb6398eb7e6a5a4d429da6e0f365e7713a07f849511e27a8213a87881c48c914b4c0ef80c43b6";
$code.="ca67ccbdbfc6088cc3ba3d3549aee4e1a72bef4afbf7003fc0ebc6c3f5fc0047f20b8ea06fc4b302";
$code.="26e5efee8e54b9fc41acd54a7b6972054d87112a7bafddf3921086da3aa6519e1d085b3209736fca";
$code.="d76ba58253036a888ab9f6216885b6b6842cbe687ba4e970bd7d50512d0f9bcf8222b97a9f3bb7b7";
$code.="a6b898558141b169c136b8f33e1914292622f0ca21617d90491ddffa9320fd4cd76ba58253036a88";
$code.="8b976736ca4a068e9bb1c8b6bc10d6d93540e8cb9466b04a4f6e719734a6a9508050ffc34e1a2e7d";
$code.="133fc7fb80e6e1fffca72455f9aa2029e21ae55f16d6fe5a005d9adca1fbabd6a0cf66ed0d374b80";
$code.="420d3d1e39fd86cb4b4648a3ebe938deb8498290eeff71fe3aafd0e3251d5a6bc46ad1277691675f";
$code.="5db06b62f0fcf92e62079558710ee46606b18eede2fbec92fb6a297304f78956b79dd44b82cf92a9";
$code.="51fa8d0f9089626d98862a72e76e3cff25c302fcf77d80f65cf37dfbb503e353778dd2e860ca7246";
$code.="dbb63f18eb5ebefb6f13ea5ab685fde69c8e589b49e6cca91950f0cac215c3c9fa64e6913787499b";
$code.="b8bd934aa947cb7ff302488568e8a9f3fb30612875fa3a573e33b832c9b7d2ef8c4dd700baccba86";
$code.="9285516a9b5b4fa9077328ce9a76243107d9813963ca7c8ae13047ad15178dfbdb5c21ac64db9adf";
$code.="7a1a4560a8533f6134e55eab288c2fbc2ca2e3acc95851e48238c03b00c5da5741acd54a7b697205";
$code.="533240a4997b7fc8bd00c9392e2fc59fcf23348f8d8dc09221fd9f808778cd1d799ff895d207128f";
$code.="5c416de6bfb09ab194ed3bf9887914622cf9d5b77f6eb5862ee847b0fa0f3fee4ae777417dd49dba";
$code.="e6acfde6786443be08f6ab452fac1936e1915bc372d527b462079558710ee46606b18eede2fbec92";
$code.="fadc8cd88f00b5c487eb999a6a997e7a822b630e07694daf704904f105e2d793a2995a2504aefea2";
$code.="6ec6fe8192e2acd86ee3e60a9ed6902dace7bde0e8c1657e59303091a0f2eeb9237be9191bd245a1";
$code.="2b823f556bfcdea3c6b0d95bc8f56e8f48306978e093ab1f12b153e0af4af237aa06f8a185a7ce5d";
$code.="0c6a1309d1775dad8d6a26d0784f32d51874ba09cde08b4379a36b04601daed7c43cac33971bb968";
$code.="3347db2db8642beff499192bc75bba112f573d45faaca87ee7e6af159ecc1672f27261742b5e6a65";
$code.="98789c8e5b0e8e19b5c14cfa16315206628c64f27c362302a00cff79a6023c2ffa502b3752e8b0e0";
$code.="91fd6ab5ff0267da737b72472da1b6b775f1316008df6c995a73784a57587821435c48fcd71be105";
$code.="f38c5f88063674b99856bf1aeb41be8bd380ef256b87f1d38fd1774d023016691347cbfc9e7f89f7";
$code.="ec91c57ed2f13daab7e2151eed31344ee7e6af159ecc1672850d059193ae782a55eb54b8d54268e6";
$code.="72bf33f6b9910afb33149f7567c363bd06c229f57997693832a1ab4bfd746e0fa5228dbbab819a3b";
$code.="6245a500340a0d89ce66a1c81eae31351d1077714774bdb6c02c3fef1981691e803acab0696fa950";
$code.="d0308f88348de3b9bb45efcabd319414983f7c07d27121e066ad3754fff664f6c5ea5e915b840667";
$code.="50746db4cfe3a7ebffdb8c3215ff3ed50faf857b9a4fbdf9862bb78c0a0992cb9fc6553aa9512978";
$code.="5b95b8866775ce9e7b50289f4262c47c59a66fed27b1301a725a61bcd727690e3574c6102c8d9bad";
$code.="255778d56a13f7ae4b1875b547465bcb245ee74e91418e85e783bd8e33aef1544e872ff2d6714a84";
$code.="d54cef78fa9acac6b745221bdc8866a43f67932491f07be07f1b9463ef8316d1c567e60366be5bcf";
$code.="79ffeef29aca454a3e0d2d6c92e3b81dd4a7bb593445a76506b3d31c828b56c3a8e809ffcf080c1e";
$code.="82769bf3c548b5ff9d7ba2f23a8d9862439ae1fc37ae498559c1ed4a289bb65c42319fa6017142b5";
$code.="9563747a1c60f16575d0f4fb18dea222884b68e31fd79fc8e3d805300c42b3da90ff82e5f69063e0";
$code.="37f112e32e2b799c6c753b2f094fc5888b31372676099919d2c19c8505db7c5cf9af0576785ef5b2";
$code.="e947896df51a2973536cabda6ad493f213f31125baf6a3cddf3eb25c97e83ec9d54cef78fa9acac6";
$code.="fa6f6b3d95b57e7a3f67932491f07be0c8698f5f12ffc7774b1875b547465bcba8e809ffcf080c1e";
$code.="82769bf3c548b5ff9d7ba2f23a8d98627ab5d73cff66e989884b68e31fd79fc8e3d805300c42b3da";
$code.="90ff82e5f69063e059d3aac43006224de947896df51a2973536cabda6ad493f259357597a2bb7688";
$code.="39c8ce070c7a4ef059447cb1f0dc8e42997a4182f1528e97e0c633c9212d74f2bc598bfc285fbd97";
$code.="aeb45e2e1f8bcf5b3980b173c633a8bd7ada4758f7b92a9390ff82e5f69063e0ad5c46b82c8ddf1a";
$code.="40c6cea456316e4850405c57309b926df42b66c262a9809e0a9fd80de7b3655a79f71fca13739259";
$code.="97dd75ab617b94799c9d5b70c5b00e2f18ec6138ab3f8eba6af19ddc0be5e40830878267ba99cea4";
$code.="e1a12d7d656d16e566727d9ec4cc09b77c93c5e1cfe8ae528e389e970d304fe002ac0ff2b54686bf";
$code.="e7bcefdfda04a92db3ee8733814928bcc0f1a7820a09313abd292ea5197d69107eee6b2437f9799e";
$code.="9bee895b47acdd5ee52662f792895e642fc156429aa402b1bf51c43f05af1e831f64ea0a69f0c011";
$code.="a6b677c71e03bd888252c0a3ebf97d14e0f665d439efce51632dcef97268fd6e7436c6048c5b6e8d";
$code.="4efffdccb21893c0eb54892ce05f68d50f93bb70160b504c80698ae99f3b20c7e12129015cca487d";
$code.="8451603d5d13c622608faa57831b6574256ddddd719c07b2c6dc42aaf0327e5217f3f4e0f4a74f35";
$code.="804643f1a4d65cdeb9963c121f522cebc00a218c4271b001305c8e29c5cbdfcc3d3684747c5373e7";
$code.="0e79456eefa8986d661c3eb90b945795377ef68353ad93677c05777c55a3db88b21488ea9bf41939";
$code.="92fa06039b70a4f14a886aaf5e8b366531813b0445f981fa34a2f24f4401b0c3d42d74320124cb6e";
$code.="ad0a452757dbf194d4c0895a0e20edabe9a213754e9fc274dd92596e96eb965bbbb8f3478c20d3aa";
$code.="b48cae35c63ba9e5046bff3889628eb587f11f568b3f904d638b0205835dfb32657cc7dee065e29c";
$code.="38e852e5eff050f66491260c9655b1df79bcd74648f513bc849f450685243f1b865b95ea93262709";
$code.="b21488ea9bf419397845e519093e7f7b2463da5e0614db72fe5c9b39e0616fe4fc1757e15be92d90";
$code.="f9d92fa57d6457726d41d4d4b3ca13fd11c3a135a39eba2e3161944c7f2e257656507af4f5a29579";
$code.="e0a850d64a312ea9f9d92fa57d6457724775b96ec663fd1eee3caa38c28cd1b49028d6430ee926c4";
$code.="8451603d5d13c622c9ea4b0e15fc2f8db8cf6cd2165bb5bdf9d92fa57d645772f9d92fa57d645772";
$code.="8e299205f65ec664b08f42cfb2c5ff7bcde178370c9ac70868a9419f55672f97a2ba31999378edd1";
$code.="f9d92fa57d645772993a2a274c3e011bf82b720f1303129314bee4195b623babdcab795e2953ebf2";
$code.="b08f42cfb2c5ff7b405a8fce9570a0e79c89d6b3e72ade27c984a4c36c30139defac051ebcfac742";
$code.="b08f42cfb2c5ff7b4218386228aeea088383f1d4cf24842dba3189d2e2740188c984a4c36c30139d";
$code.="efac051ebcfac742b08f42cfb2c5ff7b2c57c2adfae593a81d8c5a9faa1f10d6966398265bc484e2";
$code.="89c8a02011f6b38f096dcb412effb0a1a16ecb01143deaf7ff227fe3d11fda9e2348288bc7ca556c";
$code.="ec46e413fc5f6a1456496d2d32b22b377edc63be5cca27c11317489f02d4e65b905045a91f7d47d9";
$code.="56496d2d32b22b37eb3684854043e068d78b526de12e1911f01b0552f8bc3c80dbe09e28bdde3f32";
$code.="76d704bd459c1836a97a41c29cd8ac68438cc240046680c36188537771c96e7fbb8adb767e5d6052";
$code.="88b38c186aa99ee4a7e4d6506145b8aae3f887d41f55b023d4a60680b444772e96ab91875626282e";
$code.="7d5870d7cc8d06053faa00df241616b3e3dbe12b1110e83fbf1afa2b24e70b1e5b6cbee97ead728b";
$code.="0b32ae7b7e2270ed289c7d9e46e8611b949b1330b3d6e98e5cbca8ea28e8283898bcd71a579a457d";
$code.="aba4e06e79a9084a68f903507dec52ddef86371f6a718ab12516d1955d3e5922c08702d763603775";
$code.="7ffd986389d58ecca1e82050976e8a9d5fea411fdf7acb5940d3d1a4bb25e2421a98bc3af3a3a410";
$code.="625ee3abfef360d012fbe4612ba966a4c72d6590ba536739aadacc61e504bfd60e97829756550e56";
$code.="b2e198fa3d84af83ac7312786a83fca3ca30c54de057fbbc9b825be8db356fbaa080381862b6add8";
$code.="e1252fc9f9240243f91c8005628ef13e71b36706310bd34051c83d11f7212fdfc3e38db9a95762e1";
$code.="c0812dc8a41b766af82b720f13031293b92ba069bc90d02b45391494c1b5d1f8d38e710a0678e886";
$code.="593d22cf32d96769b57312eaaa6101b01385a5e08ddff535a3d8eefddbe950cc5e35ec8933b651fb";
$code.="61e4579f44905bd1b899e43905129f72c5c88c8c16957a6cd74539fe7837c519f851f11e5bfeef26";
$code.="302b0c2f889479bf46fe2bbcc169e18303c47b13acb6c17f81e266a60f138815711a848af812f712";
$code.="c3fe057bd2929a89ffa01c990291bbb407bfd125efc82162807f38861e34d5dfa45b38d64c1477fd";
$code.="410a2b0d1a3eea94284a2146526a8760e05bd091ed98d4511fcccb0e559ad3852225fef48acf8b1a";
$code.="8ad37f4f68e22d4b34a1dab3395af47c5637c05fdc86cea7a720097ae651349619f18e71b769e4c3";
$code.="b283093f3474544e6b3fe4e1b02dddca60bc53a8816f52673c27561a9486c7a79c4b455122763e56";
$code.="a57d47f28e2c465f44513a7d13cc99f6cc8dd5cf14adc443a323a8ceadc9a56024d8af4c47cf3a69";
$code.="9617c5742c829003b673fa409f32257580180206b52a6583327d1752dc7da2cd88cf868ade2b1399";
$code.="c0542df82e39d465b1732afa03d07b58d4a05cde72d9f55d6b83b9e3f0de29e73faa00df241616b3";
$code.="74908d32c6af0fd31862c9c91030acd8baf847bb8b2c5c66ed9c47f599a9606ffee04f5ecdd37dd4";
$code.="08765c30b9d3bc6f5271f520500bab95dee2407cbb738ae7290080d8638a610df82ab93caf09857c";
$code.="7df8e71b4532f6aa09e9ef4e60171469966398265bc484e289c8a02011f6b38f096dcb412effb0a1";
$code.="160f872a346dbad08c6b539a1b02027146fe2bbcc169e18303c47b13acb6c17f81e266a60f138815";
$code.="711a848af812f712c3fe057bd2929a89ffa01c990291bbb4f3f0cbb24233b98cc420d11fddb06d72";
$code.="413d69eeaa1001fe9be2cb23fe45810c224c74d82331b1647797736c1a2165165de08a8eccb10903";
$code.="e4d4cb7309accb3c18d152bf9fc3c01284375c45dc4b73bac5e871bec265f7967a398b9aa953849f";
$code.="03271e4f5a56f3c3cbacdb9f94702508050d45db8397f4d8802a2d0ad813a1b6b7d1bccd3af0d63f";
$code.="06d566871e6107485db059ff4e59b33a862bb78c0a0992cbfcc67b59ce4508d96240cd24662fe9fc";
$code.="b2fe0badac05ec49c8ae26f61f0d53317d3e8f2ed0ffd9a441ef0e987740b1130f118be87f8f61b1";
$code.="c160e3a93b6a67462856841bb055bd3cc126e182cd4536d6a51550966666d9b1d80c261692e9b798";
$code.="363446b5a283a4eeb08f42cfb2c5ff7b4836c5a3529d315bd74539fe7837c5191bd248147bb42250";
$code.="8a5e2982d493895bf8e27ed28fb49f0266866cbdfdfc6777046bff3889628eb587f11f568b3f904d";
$code.="4836c5a3529d315bd74539fe7837c519c02c69b798016f26e72f1b1058352c182baa40ec0d5aff90";
$code.="8580d8cca73970f2cbfa4eb094be14ad52fbb9a283f4485b2b24135dfe32689d09ee21b9460734c5";
$code.="41295e4f9704b20df85e6dda218c02503331cda57dc19c5b247c3ff17a88962a79bcd74648f513bc";
$code.="671c089324cfee557a3ca7be01ebb7f2871da4fce13fa653c782dc409f782623bbb8f3478c20d3aa";
$code.="f5bcd9c0c7f2be1639277f3038fa1ee853929ed62d0b203646c8a2e06d97c3bdfe0d89fefb6ab0c0";
$code.="95aa2f637bbb4968f01d1789fd4e05444716db2b0c3e75bab2bf2faa0b9484ede13dd0f768a7a9a8";
$code.="eeb86e9143ccf5d1e2e7afe14dc636174f29ad55fafde1222a647dbbb7db519af01d1789fd4e0544";
$code.="4716db2b0c3e75bab2bf2faa0b9484ede13dd0f768a7a9a8eeb86e9143ccf5d1871da4fce13fa653";
$code.="2ef26d900e8c2209c2cb6c25fd75b5e00732dc3d8f269bb6551960bb54bde41f7d5701fb764e2856";
$code.="657384e6990eecc8139bd24fbbd5b08f6f1be5d2e31165e384b5f834933a5a5a070db2e2ffd27632";
$code.="2be71a22f3ce019effe2d255ffec68fb9ca9c97e01bc3ffa5facaed3f3c1dfb6b65cf05d9a530fd0";
$code.="8d6fb93d272c2d6400b85cf96d7e7354e3f3dce70b3c71299a36de3ff3bc76ee67380e8a496815c5";
$code.="497993665c8700a758c16a416c699a822547bf985adf130ad2c587a9721d05fd34f6ad67be568239";
$code.="385c94d05b5f76b99d9ece8399f72578ef88833d7871d7f79a59473ddb718ed0f9e5261292cb7e8a";
$code.="41b7995e2128b7fe102a995d2a70d933d69b9cd99fc6709b0efee2abc4cfb4bbbd5199f1f4b8659d";
$code.="999b016354b47666e3a23d01f55e5f4e16fe98320f796be9acef7a418e41867355e68d4eb8bc2f06";
$code.="c4d7c4b291627e2538cd9365a0b285f85963f83f9391684052fdf4268c6903adc0a9c311512d3960";
$code.="6d38a198d8227365dd7eab11359d9a7709102f0709008fd4096d6e35dfcf146f57ae07e66f187883";
$code.="2e5feadad438f65e761179241e0754214fb28f7ebd744c3bebb85a856b05adc545dcffd9e0bf6c51";
$code.="96362632dbc6295501dc0fa5a3b9a6be48214f975eb7723d0b450c6a37ba9426127d2b044a9363c2";
$code.="540f23a710bb95fdf964587fcca4bbd50e2444a8bed2efcc0e42ee211653e7bacbdb54da97436adf";
$code.="ff7d4fcc5f884f019ba3d66beb74e94356308292a53d007935ae8556faa27f3c31ae2f8daa369fa9";
$code.="127e34aa2b3812f58b54e0ce3c09e5fbb08f42cfb2c5ff7b36249d3f8ae8b112b04e84c664beed56";
$code.="a44f421a2ba72a861cb1b74c3d56f35657f3d25ac09fa9398cc114b74d9188c6842c13f967030467";
$code.="8e7fa31febde670925449ac85f857c552f621661a380cd341df356eb755d518a4c15973e9db366fd";
$code.="431980ba1897c5aba414188d3bae21ea4b221568adfe3df6972339de5ab5e296379cb1f9b4423600";
$code.="f4ee2f984d6cbb60ab5eb6ddeac66f25b6b0e4c989d074a938e735ea656084b4f4f48dfe57c341eb";
$code.="b5ac0c26dd956bacda02103a1557914e962f88b1f51ad7c1f32085a1f303b0575d1c1d69eef31eb7";
$code.="4d21b9e33827657ccd501c89f6fbc97c7f2a3ade84446490be4eb3f9ec88c75ea28445a99d1aea77";
$code.="c2cb6c25fd75b5e09577b2df18688b3177c4a9d63d4c872ea801b6243eb8e53444c99196caef06d4";
$code.="78031d9364dafbd509d7cff3ec1b27f7c2cb6c25fd75b5e0da772320a93f9b65d38d4fa2541c9127";
$code.="13fd229e4c4c0b1c20b8d41cb1b019f8c318903080a3875c46aaf51906eb359c477f06f5f9ef185c";
$code.="7f3e60c84801405b3fc19f15ded7ed0051ba313e950199c190bdfa1691e95cafb33ad515e80ef184";
$code.="fcec4b82d54fef05aa8beb75feb4d57efcef304ad8a1afce92c7fed78cc8401ff72b026d889acadf";
$code.="4f69ec129b3a99651585ebac94008b75dcd6acc127b08102de4701c2d09e44b055fdd6434feeeb59";
$code.="78683d2a11824c21109e7f43f05d0718ed0630b7b91b5efd588860b9d6bb8edc0deaf7fdd73082f3";
$code.="18647cb78c577f2e3c67660181daa7c28dd1f1b7cb21d7d7e39453053c93ef1ae0615a873a2bd275";
$code.="32691faee74cd18c5f8e792027465b7bc021622ebcf6ef9ec45dd2b208421b5484804295f2899e3c";
$code.="c67f8eaf316a4eb082f8f036f7da7a16a31f83c3015e7c508cb9a394bcb24bdcbf37fb4584d42574";
$code.="2b4183abf384354c01a29b722bb3ccf5eeeba8cdbe194894641bdafd20e4735daac9619a623700be";
$code.="ea0910839f548e5f7891169248e3c64a50d45f28990fcee5cf5ab2a49066a53629309de315d7cbfb";
$code.="b129ef6f0fee9fab623d3b7990c6ff82ee3e5d39da711dd51b5ede2f80c044ede2713e1c0d2a352e";
$code.="d863fefb5164f97c7bb4824714f493f14a3896525bac963ffe3eaf3c0baab487a2a7921829cabc46";
$code.="cde01559e2fdf40eaa02a4302b70fcb16a5cf3539838a711fa1aad375d70096166e04b4b0634acd0";
$code.="71ab7fd1b68615651c37864438ec251c560e43ede751de710f5c8f4bc0cbed8209fbeff86b009a59";
$code.="fc2e3fab39faf0c9becf031def331677a4aa3aa44537fb220f07fed7b35513ed0655982e6d00529e";
$code.="05de1b7cac8ce99abeb7be83567deabf8bbd5ae416ab97aed31f1a1723678d222643477936bdb3c6";
$code.="6de61a16fe644790d83e7146461f2c9f2b8bc27ee649e86a9f64889a6122aff4b8edeaf7165dac48";
$code.="3bd558a243ff85ed599582e69bd061e2575e6a2edaf026c81d860648708e044c77cc6ab2903b4863";
$code.="35e65b99acb21e947fcad4bb42f90b2abbd6a3e1ab1052bb2cbf427803693ed0fab6937a094240de";
$code.="7cc3201278d1e481c8a891a558087394bad3c4c73dad7077a88b16130c4bfbda2ffb29a6f311c959";
$code.="2f5217dccde79dca7eb199b8a6cc26d0bbbe77e19c59a0b1c35f6ede9fc2e76bb65246963b1fd5b2";
$code.="20b8d41cb1b019f8a47891054d61d69c726b3e6d4ee9b1d4d576d2cc87cc9ac35f8e792027465b7b";
$code.="778f990de448d28c5cc756ba983fd2e72304ec6cf6709d8112adf11ac8759fbbccf5e82775353aa7";
$code.="5cc756ba983fd2e7c653157ab3a72987ffcc3b320fdc9084674343a0ea69f16be36a6a105a17d6a6";
$code.="acdae0e080cba1afb8edeaf7165dac48ace08abf2877dafb0399fc205cb0e64af699da1d7c4fefdd";
$code.="e05b04c8997317647db297d25d4ca7f18b5c4f02e8e148a503c38f38b4265071d3f7cb2356d00d69";
$code.="ce2cde25ca79bbc51a69b902e6ff6d4289fbc70de4f95761da7a77436eff42faf2f68b147cf380db";
$code.="3dce5495831ec0eca47425ea060cc62bc99a2c5fcb565b5511133bf3ea81cf79e1b870e37b086117";
$code.="99d87c8e9cadbe0a3fbc27172168220e7058bb158bffc2908e31bb0d49174fc7be7286ff04fdb071";
$code.="2643477936bdb3c608131260bc0cbf8181ff28d92d76e59fc215e6d8263452edffcc3b320fdc9084";
$code.="c5a7b58b7bf76231b231f3aeac855deb38c90014c717c92b3f56be1987a9e30e62bf25822728ce6f";
$code.="de56a9b735dadd78dcee5665cb5bdcac63f46b9b26fde0d49723afcdea69a254a188538a9f51911c";
$code.="a7f3500dc255906d1ec1bd0a5d2caf2abc224cde3f2a1facf05b16ddcb13a2f442cb4ec64f8b8b57";
$code.="ec2ff70601588c26a03abbe0f54be343d576d2cc87cc9ac35f8e792027465b7be45ef86531935ca6";
$code.="4520336566b23a8dc653157ab3a72987ffcc3b320fdc9084674343a0ea69f16bbd45c2f345f4d53a";
$code.="d72184027fa8e6a816b68c16fcf39ae90757e866a4bdbc1f235ad2cf4215b3d12f5217dccde79dca";
$code.="e2384ab7c976f035c7701a40da31bb20409f39dc65933cdab1b99c879a2c487d1381d657b6a39032";
$code.="e9b5edfc54f39db04efa60f1d1e666b1c7217d87e5c323b6bee86f1a5b7ba3969165f53d4f521999";
$code.="76d255be0e34ddaae45ef86531935ca6417fbb963c880a59bbbe77e19c59a0b1b88fb0d7f7aaa131";
$code.="e84e3b6b2335090cefdd1c5a4c957a564f71a9bdd3ca225beb54892ce05f68d5d1ee68c3a9130d3c";
$code.="1a56974022f842cb85515f5b245951462acef3b58b872a60bee86f1a5b7ba3960e1ada4f32bab2aa";
$code.="c04851fe37157958f1682f8c3ab3a71bf04f05f6bb8ec369e22e9670f28f28afb2a77cefabaa6044";
$code.="32691faee74cd18c2cf31d3b0bf9f75f2bb51f56558531ab834c1e502c71cb60a8169f3fc1d9b643";
$code.="68b73b397c8754687c7ebb21fea2cb0fe168425eb636c8ddd6d8e9e520ea3203f214931dccaf5604";
$code.="7e596162646794467fd06b1fb1df9a2cd980f79fb5f3f5df4ed6fd389c8369304bff199186e44ae7";
$code.="266e1201d15990ccec83ffd06a7a769e05884d8ab32b24f61dc681e25a2f82a152a14d51aa03d254";
$code.="f3e879d04cca5b14c5d08fdee1fcd060e3de66fffa71c5bc80b054b48909e75427a39a1f2f011d8b";
$code.="2991cc7385b23f572b5c52673cf2eacd29459e8a8cf795b889d421afb256dac068f7b5c85e9fd331";
$code.="54a84557de036dd7e2763cf1fb82feaa39657a00cad8e4f3838d705fe255d5f752a14d51aa03d254";
$code.="e12d92e9ef11230ab775ff793716daa19cf069c17b870e327c647eea9e9de5d3961367b1d723dc1a";
$code.="36bafa0807cd5da6834c1e502c71cb607e0b4d66272f9f7111f293d1086f27f411ab909041595193";
$code.="d3172b0a5408f7fe0ac3c46d515bcbc8e86558fe103d9ef3c2aa914416ce3462cae6bdf1e2b13a6e";
$code.="0b49c6cd9cfaf4c09fa01e9199b022a9d06efc4365633c49c838a3f78e83bc7f5dfaba6893db2a26";
$code.="726f85a57cde985722617b6680e03946a06be699cc668d308a80f9989a4f58816c2829b0b1216e9d";
$code.="8769210f282abe8a6a65b31550c094fa3f0fd0f4e55c46a809fe0381794082a96178722c47ccb058";
$code.="89c2ef8c2d38061ca31626ccdc39a96e8769210f282abe8a6a65b31550c094fa3f0fd0f4e55c46a8";
$code.="f682b4069490f1ea7c3440118a356469a5ef1159f1fb45e5a06be699cc668d301a78b071fa5cee21";
$code.="ac752d42605e5cccb74ed91bf2e5342058cf6494c2c1b0f084089ce113325b7c8758752ea6bceb40";
$code.="066be0c0c8a50e34655409d86077abbb23ae35287f6e65e77a18453a65b6f78c336253ad978cd08e";
$code.="f52cce1b2b23a5a6a28445a99d1aea772fa138b7582a2ab836e0b4ec140508fc9eba817ac93ed0e6";
$code.="ac752d42605e5ccc938eff00f0cbc3cb2123ccee046b9ed3be1db318d51b0c90739e998c1565f23e";
$code.="8b9f8c11e26e05dd6db1079a5669224e9cb04fab611d105d16ee9493ed4f4591ab71d30b744b9ce4";
$code.="7898fa42b81807bb49b3b61d949ea787db1a8dbbda40ec779f1bc6ddb1f2b9de18462af68bbe40a4";
$code.="81c85f8f9a2e83a2d9f97ca1af7b5f7bc9a3f8328cee0e324bf45593db52cebe01bdff08a94e96ce";
$code.="332951c0849e015a3464526247d8b9f8a3dff6daba57a564bc37c8ded432f156883c8614e08f4ffc";
$code.="74b631b57850005287652c105225f54bb1ec17ffbdd93f13aab58b24ac9d771a2fa4fae3097d997b";
$code.="9fb69bcd7ea82647d85ba8ac93dd636937debf4beab6b085cee429e769142e6a281cfbf65a3de7e7";
$code.="ae931a90f8e3482e583d68cdb54cb18be13796598fb51df8223b4fcb4909b59e0deb32d582e26611";
$code.="a895ebf0dbea65e7737982a1c22b7640800e1a34043cd28d9f3195ff6d9904b76ea60f227f99003f";
$code.="63773797d6fe4d68be58731f87022d12a6bb1ddaf80848aaa55a02574e7a32980e906f72a7a39365";
$code.="2549d8abac9b58fd3a73f189a02ef29e06a46f0e7aed720c882c5a2d9885a8d1e280f6d76f60aa7b";
$code.="f521c621e3dc9fb8c7d17d4e08b2743ef712aebc65a7a5cc56d6a5babb8e78126ae8740e93af3d39";
$code.="51e9372a5ba6bdb782aaacafca5a40d8aa9317518374b70cc4c0db27879cb020ac3982243100917b";
$code.="c9069d51ef257f21a930cd3b80ca7a4b84089ce113325b7c8758752ea6bceb403f0fd0f4e55c46a8";
$code.="57e04a64e8e3a19d1dd71ff3b491fc47f5bb62d9571198546166584e0d37ec587514d459e9952e17";
$code.="7986e4181db1191abe9eb3337f70aa9d8c2ef40108c000b93e9bcd339afd8dc6ef10fabe863529a3";
$code.="e59084c1f235ff04eb1d2f1e54811024d7a81c63ea546cc996d54e23124c81ad63f7e4aa0feef3d3";
$code.="2cbcc8887b599654d5138025a0a8b22d67f107165f782b0a2da17fa6b07ef419790ddd39b9b004ed";
$code.="8afbc1381ab0695e0bc721441d72c79d899eb928b521708ed51eab7a2359c2dc45f2cd73f44e8752";
$code.="24468947d6713d3db5019db593258525a7b12214df4d41d9740220ce8bb5eaf4b109446369f19b60";
$code.="0f461e92cbb08d95037cd2c02967072dc9f73d10d64bcf943b2a5319a4346d42eb06fdf232b5457c";
$code.="d86337191d7b9918e328e518828392c31e3ccb95adc9a8435567df41911df33c0e906f72a7a39365";
$code.="3c3b73c8cbee0a534e444ddc471c969697be6a9a84bc2601a0ff8a367efacce89e191abe7e7186e7";
$code.="d64c4c4a1bc395a09811b7bf7d857899f0b7e9ce20878ed1fd32c6373b8368c52a08a062575d9dbd";
$code.="29a4610e63acbd66e86558fe103d9ef30d1d74f617c8191e49e806184917ad2a40b40db801ee22c9";
$code.="8fa564bbd8af28ce8e389e970d304fe0623d3b7990c6ff8254fb1da10c36c6104a3d2915f7e7b9c7";
$code.="1d7a1c1a62ceb5a5c08b613cbdf52cbfe424e1fd68749357e5118b637fa0fe0ccc38bb654ece851b";
$code.="2bb7e4d2153cb9ab29a62adc0d12084936bf5b673197fdcd5c8985568bed0a59362979cd98008a8d";
$code.="5b54b2bf2cd4f5774412c7e313d20fe969e20159d07d7bae1107d8211ffecee44197069f67902da5";
$code.="3da6c6cd8535fdbfdb6f0d1aa234e0049ff030d21dfe015a92257abb026609819009256ef8b5404a";
$code.="cc9e7342132ae800d4a60680b444772ed7a07f09bad182fd8b05aa80c3d74fe74f9127b1372a7a5f";
$code.="88262b1dc29709999e78f2adf53916baa24b38e75c96208acd8629143dab4ec74c45f523598e6984";
$code.="d9e171c773e867599fa01e9199b022a9d06efc4365633c49c838a3f78e83bc7f8d6d0ee8f07e3700";
$code.="5f80131bdd7a35456bf7220ef580263fe0a87728537271ec2d4d3b1931125b339f1bc6ddb1f2b9de";
$code.="2b4183abf384354c1986c54a57ca5b778c136dcab3387100db350bbff266aaa8e589f1fb47ef11f5";
$code.="b3f63730d021e01d1986c54a57ca5b778c136dcab338710031c49d9fdc772dbbbbd6a3e1ab1052bb";
$code.="4c2e3ac81cad4809dc920c1cc035ee4668833dfe91eb677437208011b2bf4d9d449e0fd6080910d4";
$code.="4836c5a3529d315bd74539fe7837c519d0357834e37986c97f91214b379d351d4a8739bbd179eba6";
$code.="f58fef19b61bda0abbb8f3478c20d3aa4ffbb37066d0bd130d9dc96fd905f6225984f7bbb3528bbc";
$code.="88b89d08d35072501ed5831affa42a1e317af57d99fbf7c46c393647d200de90882dd7a8338b12b4";
$code.="7413a2678098fc2eea5c0508ec73f44d6a92ccfd0741d1c81274e4e0f60d1a4bf1e6989b880905e7";
$code.="1193091219aeb3623e0003719e73a7f5dbab76ec0d94910d5fe108f561e22ad947d9ccbff4d3b05c";
$code.="d81c86ad92e578f69181352a659e6516219a4f002541e7190140cd12062b05cf3eea25ae1a0e0bfc";
$code.="a11620cba4745568399e8a1b416493b354fbb22cab38cbf3a2ba02fd3c758261cea715985802deac";
$code.="9abc008e3f07eaabb4e80802f70a7a4845c85d479c074dcd355151685f8b1b51c5ea5e915b840667";
$code.="26fd076a31e1c5bd494e52071c9e81a7f55c73cbcfed06106440667174bb1d927b50289f4262c47c";
$code.="78c3e3556df0516b7bb4824714f493f10728144259abaed4caa53252f9a042467db297d25d4ca7f1";
$code.="ab460c3696345f1cf0831b5a1d2a0c35db7619424e804096390b8081403fea331b94fca8985de703";
$code.="7bb4824714f493f1cad85ca1ab7d8fec5f13b3ebacf68857457a4702d4c1734033536acd11c6c8c8";
$code.="c5a7859f9a91ec2ab7bc802c7309886413fd229e4c4c0b1c20b8d41cb1b019f8daa071c95eeaccee";
$code.="38c90014c717c92b41a9f524acc3af079f94a69662ce6399d322a8132921ffa31ef0bb8c69c7f620";
$code.="e2144fea67773eceda36d9bdc93f7799d3d99946ee70a8f8b365ee6f6c6331ecc2e036f11c076576";
$code.="8551ebd86e5fbc9d13fd229e4c4c0b1c20b8d41cb1b019f8daa071c95eeacceeb4ef650dfd91addc";
$code.="9f94a69662ce6399d322a8132921ffa354613b580adb49307db297d25d4ca7f1e62d1ac1b075d9b3";
$code.="984e5af13ec74e18228ab742984d6d77a148c5cbb701b720de83b13947a13a25d9c13a1db750b6db";
$code.="817398359ccc174d5f66880cdfb2416f7656d3eb799f25435fe108f561e22ad981d059bf9b8cf8cf";
$code.="83094945c3fa11effdc705c7bfc4d6ae623d3b7990c6ff82f3c50596ee7aced1af264fed81ce12d3";
$code.="4ad528c4decac729a49a9ae38b2e26499da12636c141df91a9e60dee154d5cad623d3b7990c6ff82";
$code.="1ccdb07912e6fef8433f1f38afd690f1553929e8763c25478d0a2b96254e6cbbc1438e9e6ddd6ecf";
$code.="8d33232be2538709cde01559e2fdf40ee0b7d614ad9c26e223ea8b7b55cc6dbe6cd2757332844ca4";
$code.="9d130be0420f6e4f5ff5e2a2f5e39ca8a7fdfdf7c76d569caa131e3b55d89d5bb8edeaf7165dac48";
$code.="68e131abc6a7013e76202042c0ff72c321b1270c260af45d0956c152ba91d2bcee323c2c14d1c3b6";
$code.="1f8208e0a15dfc997db297d25d4ca7f18adcc28986c6ba4be26a0b7fbc7dee2957f62502d5816e22";
$code.="309dbc8edf93f282d40fa3738e0cc5b2062468a90db40690f3df6b94b01dfd52a7930b6e76402cc1";
$code.="bbd6a3e1ab1052bb084c059522590700f5691288fb98fea04b1ffd2afe47c172f1dd39e0487e989b";
$code.="2cf31d3b0bf9f75f2bb51f56558531ab834c1e502c71cb60743e1c876a88d90d33e8ce504dcb2766";
$code.="d63714bea690a21d72cf6d9f323a1cdc63553f287e8b67eda232b38780d491a735e1d20da2479c17";
$code.="fdfb8125186f3f4e3897127e50be18de51959db6d9943c1e834c1e502c71cb60e0ef1b80bb982800";
$code.="1c54d55782a517b52a3ec6f14fe6e66452fbb9a283f4485b95cbb507b644a20bb3153d237d80465b";
$code.="7db297d25d4ca7f1d03684dad09f69795a935769e52b2b674d6d80985927701ca6bf27d1dc1cb02d";
$code.="0acd3ef0767354dfa59408cf6e6ada59f034b68856e50ac6c5f0667d73f7a7554c4eadfad5313e56";
$code.="e899a97a06443ddbb901f21bed96f859613dd3ba19c80b9d6f337d39d91480493ca87c99c2787fc8";
$code.="465bd7b20f4923fe1d2a9e01251195fd19682ccb56a6a7901a69b9e1f54072eaa12d89bdd9eac255";
$code.="e3125d9d041d372db6a3ab4d41a5faacfdcc461398891ebfae7b4b3f10b47da21532afe459a702d7";
$code.="e8830940ef57f32bfbfc4117a8a6b4004e6423f3ef31292b6ad467073f702a5fa7930b6e76402cc1";
$code.="bbd6a3e1ab1052bb084c05952259070066b8f8aba715fd4449042c04e68bea627cc3201278d1e481";
$code.="19f928c57c91024b709b103da12b94b366b8f8aba715fd44a73f6f81794e29a00f8c850d185db8a2";
$code.="f04f05f6bb8ec3690307fc6b693df861201121a0ec133aed49042c04e68bea627cc3201278d1e481";
$code.="5d6863d69ba96f4fd7feff9080027f44cc38bb654ece851bcb252a049b3ef2d212428a05f016679e";
$code.="f8c14d44db277a1c66b87c7cbfebfc921b5827536b01a6384667b7400b796a6e433a8426e16cf91b";
$code.="066b1b228a934214f46cd6b42018d868efe59f269c938de3f83890772e51748c5f8acb9e0721a88d";
$code.="39cb73f8cc0197badf5efeee3ba50f44834c1e502c71cb600fe530d133f83aeea59b35ff5fdf0fb8";
$code.="83827d286008a0fb0d7f7bbdb325176763553f287e8b67edcf1f67fb8dda73d055376831ebcf9d47";
$code.="cde178370c9ac7085320990aa05586a494573f4e6fb011df98ebba440a4a3d9dfed5ff74d00d7bb2";
$code.="cde01559e2fdf40ee0b7d614ad9c26e2ae3f9a78190bc8dbdfd2162921f9f41fde69f453c0f6b965";
$code.="eef0349b271ef5f352eb0f90d309204b3076ea1a8728bf15b787665fb4ba504cadae0be71286783d";
$code.="a4fc72f5a3d949d74353401e3e85e95f9ec33791c4b5c2673076ea1a8728bf157db297d25d4ca7f1";
$code.="ab460c3696345f1ceb5ab2e5506825a097a8487827d35eb2ef96c8a164765dfd5fe108f561e22ad9";
$code.="a96c9cc71774f2dc4ae9f846c9bd8006834c1e502c71cb60a2faa46fb0886a417fb4f87b1dcfd77a";
$code.="a4fc72f5a3d949d74353401e3e85e95fdedd68c46087214a1b64b984acaab518f52d224c2fc2cbfb";
$code.="c2db34fbcf28bb3c89d3d9d8a69ef4d063553f287e8b67ed8bf93f0bd1a13dd8e8563d380bdcc27f";
$code.="4dc76b9f4fd16dfc8b0c6c8c2c25dae17e3b468e05894423a04fe4f81c55dc6cfc7ebdd7c1e95d05";
$code.="f018d72ef1c9d58caa131e3b55d89d5bb8edeaf7165dac48f7727c48fa6fbad8ff87bd2f0a39bcac";
$code.="cde01559e2fdf40ee0b7d614ad9c26e299814ca767c9f140bb53062310e4c563e005d8a31d4f91d2";
$code.="cdc7ee8fae12c7eee0b7d614ad9c26e20f0e9d16b8d4c73e193e0d97082dc312b44fc4ab8607d71e";
$code.="24bbda099177e3d5c40c5fbee295185413ac79ccc8e4c14eabe240e686f48a318d7dfa9c03859843";
$code.="48e8ba8d9da3ffe9cc741c2f4bc8d9c296e08615118f3bd2f3bac629cbb805dda3ed80ad0f991744";
$code.="aec26fb2c55c539be37af972c52cbf6f61c3493d2ce5d1987e3b468e05894423a04fe4f81c55dc6c";
$code.="fc7ebdd7c1e95d05f018d72ef1c9d58caa131e3b55d89d5bb8edeaf7165dac48f7727c48fa6fbad8";
$code.="ff87bd2f0a39bcaccde01559e2fdf40ee0b7d614ad9c26e22574c649bce7dca7017fa47b1e821448";
$code.="ae727929a13b57697a63a18c4763f0cda263afc29c0b4155e407a872792f1f71b612b03dc2b5b5b8";
$code.="69477814a483bb58a6a4044520259c27251835f443b734767bb4824714f493f1cad85ca1ab7d8fec";
$code.="d75f65fe682fd7d545d7bd6b8259a877834c1e502c71cb60a2faa46fb0886a41cc72d468f2722dd2";
$code.="1ea4294f4a166c0780b1a8ccc790877e9b90e3809a84c6b807642db58a0291f7fdc2d2385176a149";
$code.="6e351f4b11b4f20ab0281f524c25b7fc6012563404dd81ac68b7950c680dcd3a9f54a16fa9cbb144";
$code.="4ba87fc2a15326181ae4dced101ede60b83b6832aeb190497c157b0e2e7ea4c64d77cba889c8748b";
$code.="a11620cba474556874060e75c0cb62356404431484bbf8d1da0e40ed9e88c11910d4ddb1297580ed";
$code.="76235ed5a9d5740f4916837693aa13e0d6b64abceeb33c9763553f287e8b67ed604d4dcc4771ee80";
$code.="0c206eb5006479de046b5efc69fd54d453359da8082abcfd13fd229e4c4c0b1c20b8d41cb1b019f8";
$code.="daa071c95eeacceeae746e4f5d90c610d6d7b78fa12049ab49042c04e68bea627cc3201278d1e481";
$code.="5d6863d69ba96f4fd7feff9080027f44cc38bb654ece851bdbb99f483d2460d7b8edeaf7165dac48";
$code.="1e33bcc4a6f77ea1521604e56d8cf504a59b35ff5fdf0fb883827d286008a0fb0d7f7bbdb3251767";
$code.="63553f287e8b67edf4715895afe3bb8126f786133ec4952c57a50ceefd3c99afb8edeaf7165dac48";
$code.="51b64f53043f92fe872205d7b59260844c8fda0126228f13b7758c74d5c5260be34d5ff6b43707b2";
$code.="0247e302dcf6c4f22687601415ee6631bb01331fc36e8e9973805d81b9bbb3e10cba1f0bd30cdb98";
$code.="97a8487827d35eb2ef96c8a164765dfd5fe108f561e22ad9be634ab9f0312c0648564274db66d5aa";
$code.="ad683000ead5b47e57ddf36a3f53e6ec8a7619c74f134d505f88fd72a8c9f52975b7c675a915db44";
$code.="04e25dc580467a3389b92bf956a2ebb19f94a69662ce6399d322a8132921ffa3d4bd5b42c775ea9e";
$code.="03ada0294ebe7e85fd32c6373b8368c52a08a062575d9dbde045ce64f8786abace500583edee7490";
$code.="69ce205a962ac93b37208011b2bf4d9d78c3e3556df0516b7bb4824714f493f10728144259abaed4";
$code.="d4333c6285707321e7bcefdfda04a92d339dad96cf0b5c55e0b7d614ad9c26e2435011a5ab245a4d";
$code.="b6d81560cecf09d0c20e91cff95c72297fa2dedc175e664869d1dd523447580cca03a899b8c31b5f";
$code.="c6de53a5196c1e6c49636f0f72d1e87e0f354211878665ad916f98365682f6458b38f5b0bf87efbb";
$code.="ce41d849edc9fe480cfaf919b01ea63e67c9616a67e978f3bb01331fc36e8e9987340553eb5aebd2";
$code.="e0236e790bb8d699773cad086d9e7ec26666fe8ec8e9c417671d18bed1134862afa3817869e9820a";
$code.="85cc3be0c01159b8ddb7bd5f38b72d4f8a37eea5cca5a13982f6494fde0bda1cce41d849edc9fe48";
$code.="cb790a158f655eb2cdc7ee8fae12c7eee0b7d614ad9c26e2d0b03bc296ebbbd97b376aaa8a053c7e";
$code.="dfed67990b3f3431e37b31f53168803352233d3f55aa5c8382f6494fde0bda1cc4f818863841cf65";
$code.="0c4a1bc9927f20a042eb93f982a2bd7fb95ffafe27aff40c56dcce24b7401675d1ff665466947ffc";
$code.="ca99ec6be807325aa4de11e3c2451426e4da468be6a522eb3f91e2180ee700ae0139bfad84ad0c18";
$code.="95e5e5b33c5929b5b684ef902cadecf3053b81520698c7766b1c40a660237612283739138f648e15";
$code.="e50ac709ca6c418359921a98d19f280c608fbee801c44404d14a3588c9d71a4815da852ddcf33244";
$code.="d3d488997dc2d77a9b21687a608b5aae283739138f648e15e50ac709ca6c4183b78a629b305a2dd6";
$code.="fcd9434d1e787412fc799b6a584cd52376235ed5a9d5740f9181352a659e65169eb29a6be1a8ef13";
$code.="e9a4bf67dc341df180f2790aad2e2617df44821d13f5ab76d517db1ebcd2522fc5ea5e915b840667";
$code.="26fd076a31e1c5bd4c8597644a0004f04bbb9e370ee4622418522cb007f4863837208011b2bf4d9d";
$code.="78c3e3556df0516b7bb4824714f493f10728144259abaed4d35a1ae7463f66f277e5dfb43b293ce0";
$code.="6d6f256b09362c020b450c6a37ba9426e2f4e2b9f987f46e35d51c695879a740a012d5ea445dc109";
$code.="5f2a2f6dfa0e348f0b450c6a37ba9426e2f4e2b9f987f46e2752f396f412ccd3f7c63eafc7cc8dff";
$code.="d76533df38e3bec5e1dbebcbd77dfe0b438cc240046680c3d98560a63bda3ed46bec3bc05d8487ba";
$code.="d8e4f62d4ed0545ecd810a299bf8993b994d800660c1c3c75906fabf00ba209fff5b593e66acf523";
$code.="13a838bbd9b042ed1f7b831975de57ae36f5107140235926b3300840c7f95e4c802c133274274f83";
$code.="3212a213304c28b68e1dbc7a8ef75ecdc4a9c1d8ccec4183259b42af49e7d642fec30c95703a839d";
$code.="3dce5495831ec0ecb3f3d82a3b4816591e396ce3e1f410033d16bd309c6639f4a8458ea5ce696f83";
$code.="9ffcbc9fa13b964337eaeb4618d06ae55a4832f50a51759a10e2a3d43533767a16b172a411cf080e";
$code.="df20df076e9f77f6d1ca20a882c2e305014b6d5f3d3f0dd347fb11f3c7f42264a3c55c83f7e07721";
$code.="24369db70e7adeadc509744ce60461c43a4153e6eddef4a431b83f73d4f6fa347ac44653abb717d7";
$code.="e69da7ed2a49565e118c0a79fa0915517bb4824714f493f13c02558364d0768a0ccb38b4dfeadc53";
$code.="be5705d00770169c753a7d9556202ffb6728d446dbbb830c0adc6ce7bb93090baf3ba643226b9571";
$code.="37c8c0efe4e0568462571c797978d154bb6f40b6a3431d5a5f640831f3b3a8a833f0523788154d45";
$code.="4ec3906a0e23e4db04dc44dae7f77de69a4f5356c4864825465f687bf0b7d27b0370e72bc6afefe1";
$code.="02d29e42a922ca55d9f686a55efefc07853635acea659d946a35606fe174017307a1e221382e4c9d";
$code.="71c9fcb16e7a0068a3c55c83f7e0772124369db70e7adeada0f7144e778aa3f5a211e5913dbb6f4a";
$code.="f58fef19b61bda0abbb8f3478c20d3aa6bfb11e6ba694331bdefad646ffd082e3802c45ee230c274";
$code.="5b9d0fefaf524de930b2d38519c8a304ab35cc28d25f3f99f453c9d09adb5f6d1cbd68682083f3ba";
$code.="50a2ebe30a0aacb2820866abb4a448d9bacc4ea4405048daf71edb57858015ceebb98a4edca2bb34";
$code.="0e8dc70972b9994c4facd3e69a5f6ef841a72b48325a0afe7837e6e7839cfe85cf0089db71025fd2";
$code.="ae727929a13b5769b6121ee7c773a62b9ca6450168306912a5da95f16fd4983c91ef79e1183ad3ba";
$code.="e1cad80553e5cacdf54c4b6ba11343c7ce7d457c930abd9be6aef541f128706a0749ccd9184a6761";
$code.="2ec52c88e11e3d5f0801d1b022244453871535fb0328f07d49337c522c0abdeef84b9aadf4419752";
$code.="8d37002d6172980acab61755ddc6b410fbe6d721d6ad08d9afd0f896605eec8b3b4a55f1302431bd";
$code.="2e61a93b3396964d752a27085d6fc39532c2ce73938717245aea6cdbb9b483bf72e3523732c8e486";
$code.="7c7b7a13ca8b56c937a5e1cc9c7ff63b4a309e1575d700d72861372258d542306aa90a59357124c1";
$code.="ee44ca73108e2a4d86b45f6ab6efb446a988286c32ffc674d70bd27e86a520c48b43d1d0e53b0c37";
$code.="085d74383ddacfa63e0887e359806e7ac9a558c75b5b0e11cba4f77f20d505ef22385538084af28c";
$code.="1cc9097040b1f63460a6bb5c8fcec0141a3ee3a9269a155d1424dddb1bb68f58cdbc0b0230a87fa4";
$code.="fa97bb9475f6ba54341962dcf585863acbfa4eb094be14adc65f45ffd6fdaf51a5fb52a687e01b34";
$code.="465f687bf0b7d27b0370e72bc6afefe102d29e42a922ca558f6b4b6e21c06ba10392b1d73ac720e9";
$code.="a3c59a138a6eac4f2e1f33d255b6027437de840e6278c05ced099776e28d7c58a3549b8e1eb57a34";
$code.="96362632dbc62955465f687bf0b7d27b0370e72bc6afefe102d29e42a922ca55c3f5174b3d97e4a1";
$code.="9246f87f018cd147f6c714478d0678188cd65e3116923df5916f98365682f6458b38f5b0bf87efbb";
$code.="06d566871e6107485db059ff4e59b33a3ee1b637603ff6950a968e3bb91f36a4bc1a54c77bc5d8fc";
$code.="0767a1fba8c57d742cf31d3b0bf9f75f2bb51f56558531ab834c1e502c71cb609712cc127c75860b";
$code.="46e48640c563464d5bf8ecb7cbfd8db9878d8732478f5cc3e68fdb242e2a1c90b24e4733dd1f90b0";
$code.="62571c797978d154acc5b737768e02aae59819e5d8510d0635d02dcfe775f6928b30016c88f8fe33";
$code.="733d6139c1be00e8a04f60d69d5e35ffd5b757002a3018349f88d5ff4730e4fa937ad3b63e0763e9";
$code.="e11555c76c2f8e38878d8732478f5cc3c08b613cbdf52cbfa50d8c0cc5df5ba140597d1e26dc8635";
$code.="d7919a176af2775d80774b3421d8fdfd86b45f6ab6efb4467c101017170b6116937ad3b63e0763e9";
$code.="44f6ebacdc74f33504dc44dae7f77de6d98560a63bda3ed44605f99f7a18ac10587d23c038a3d838";
$code.="5f016002dfb4257766e04b4b0634acd0d8e4f62d4ed0545ecd810a299bf8993b733d6139c1be00e8";
$code.="d43f0bde98cf417f86b45f6ab6efb4467c101017170b6116e59819e5d8510d060c7988779d6d02e6";
$code.="2ed318fc31de5e6505814f91a1aecfb07ea548097e54b017cf1ec6b1da3e6fbfe59819e5d8510d06";
$code.="3e8c0860931b9cfdc2362369fa566e46e1d06edb5e36fea3a700e3eebf6edbb403c47b13acb6c17f";
$code.="37eaeb4618d06ae55a4832f50a51759ac15303e63b52028da78ca1c320ab3ad571e245e9e96eac2c";
$code.="e3f9e063c03cdd35f9dcc3ca681041943ca87c99c2787fc8465bd7b20f4923fe73cb739d9af301f4";
$code.="694b7afc57d7b830c82c1932d21c41bce83b77195f1b7848f4d511812adae604439f00d92703851c";
$code.="903ad1ad09fadb456e84e86edb052961e8b8b6034ed167a21341a512d3d1dd2fd35a1ae7463f66f2";
$code.="5d83c50472b67afcc65f45ffd6fdaf510c7b526ddaa4d497a88842b5715b69a03de64c8ce8ab0229";
$code.="efa53bd8dbb629275476bbde9cf43210851111e2a597dd7a7b6e4cc009c71dbc8fa79a334eccb002";
$code.="00bcdd2596e25a997e94097fa9691662d77decb8bd3ca85049603f4bb5b207fa7bb4824714f493f1";
$code.="3c02558364d0768a0ccb38b4dfeadc53be5705d00770169c753a7d9556202ffb6728d446dbbb830c";
$code.="77e072c03989a675833287deddd2ebf0cc4a9484e98eb72b2830dd04738ce14d0586593b086edf71";
$code.="8a4db43cfe6be6b185f552ac5c03903fd37b4fad5f0634733fae6e03599674b06f4a68174e80d432";
$code.="011e609ad014d920e528bfdb5e0c372cc6c4e737f346eac7ac4eff93583e6a3111a136b51b0eb913";
$code.="f1d6c37be0c760f0e0e90c2ebe96d58684c798635fa55bf72752c9e79c4018d6c20e91cff95c7229";
$code.="7fa2dedc175e66481129b4bfffa791cd9da3cc0e29ae9abe5143ad15ebc5c0c4f8851b45fc2bdd38";
$code.="da0e40ed9e88c1192461982652df0eb30d5a991f3e2af128c5ea5e915b84066726fd076a31e1c5bd";
$code.="d0daabdf5dd8e39230071c90c4b20b0bb3dfdb8859b1e582d88204509578382b9028e6e0a12340a0";
$code.="d50454cd6e937c731f5ca27aa830a7dce0a7a79cec611e40bf9aa1222c657943fe03aa6f46e0a1ad";
$code.="dd58b2fa5f77cd741b0066e6c0aaaed07519587472b76e36e04dc544480028ca4fa99eeec6aee050";
$code.="a20f7fd1459859bc87ee7351604acc5861d995db3a8abc5c548844f52ffb8fd52b6006726843d681";
$code.="1402efdd6320f1fadfb6e4b2ae9696a72441f722e2843d3d1136b7f2d55f01e50eef14f4c8c9ccee";
$code.="7d1388979c2c3f1a4c01ee47f2690fa81c1f62eec3ee392426d6bb0004250ba6d100d8696a68501d";
$code.="fb73a18229b5c8a48310cc4e7ed09cd0a1a8131c0b648a71dcf2b76e7972f22d85fc1637c4ada23f";
$code.="e3987f075aa415bb379eb114563f9187e899a97a06443ddbd85d12b958a8d6ba80407b4edb9f151e";
$code.="6741786a719c5428151c0421463de3723d16bd309c6639f460fcf24b4bb997d45268c59de33eaeda";
$code.="2b4183abf384354c0dca20c17837f8ffc4acd560533b1257e7f2a5e99ccb09b4afebb2ef7a463eec";
$code.="9ef96867a454ce2a59a7832573a16a5dd0daabdf5dd8e39276d6214e1417fa6389f1c74ef53c0ed4";
$code.="fe03aa6f46e0a1ad38d2eb1c33c5cb35c103b827564816730a9fb65552bb597eb3dfdb8859b1e582";
$code.="90c96152e8c595bba59469c53862579072d62fb2a26b913d2c6a00ca379bfed65c08251a2ad5d136";
$code.="ea2e6ff474e2c1d20596dd11c6bbbfe4f7e2a23c0b00f96ff353575aa9207b5bb1f4d1ea31ee3b37";
$code.="4b5b054ba9eca57095a4c0d7c09a1eef46604f90ddc03d9cec9f12fe321e3f54e1250ae6e4ddcddb";
$code.="c9712fdfc27091964c33eb22b86fe7c1ef55cea3e5d8d648ee3187645c71ca92f35a803c950dfa3c";
$code.="c8383c9a4da28203326e491e91c9c3bd54dfe2f0a4fe4f456fe3bed7531faef649c614bd221ff9d3";
$code.="42ecab6fe6ed173cf8a8d953a65c5429f0b912397cf19918ee3187645c71ca922b517cdf6b1a665f";
$code.="2a6ff08f40d85b486639f6b62525c2c15193a255de3b9b6c247fe7436120f12100d1a2f3dba99bcf";
$code.="5d5b1fb22c38b6d863b853e66c15ffdd285e9ac25fb153edb1f4d1ea31ee3b374b5b054ba9eca570";
$code.="819dbc96e9b32afcc8383c9a4da282038b199df1d70f2339ee623dd14b60725fcd724bb5d457cdbe";
$code.="a7930b6e76402cc13ba3fdd9aaf4d68d0828c6aa558758fcd88204509578382ba844f93f1e2d33f0";
$code.="58a1043504a0cddd8aeada7cce1762d7ff672d22ac6970925bcfcf7229d31bf03d944b49573a1a4c";
$code.="dadffc133ed4acb219303f4385c4800e070b1b3107f0fff7711f95399a02ab22dfc6cc40116cba0a";
$code.="60b16ea5d4c7f86c7be0ce245e940f53cdba6bb39e9da3ef7307460c9ddff509a174346dab3f635d";
$code.="f29a36fa2c09ae5df55fca19ff2514dfca6180a0c9c1ac65124c7375534c34f9cd81919350e9e67c";
$code.="a61fa3d6b3423f587b3a0492d97d459d4a886aaf5e8b36651d145f187a4d6ec742ed585a551b24eb";
$code.="50797443d01734c806839ec0930fc71531fc75d7bfad9c08f9fd13863a465c172f016d438ca66be5";
$code.="a12d89bdd9eac255ca5635265fd957854746eb008eab949f7acca508ef145bad16a170556a2a130f";
$code.="fbfc4117a8a6b400e8a9d4f19624319d8453f9b3d4df27d9ffcc3b320fdc908406d566871e610748";
$code.="510c8938fd845d0d329eb30ff83e85d72a83761bd94d71f004772f25090dd95f805e2ca6e8251e76";
$code.="3196ed0f0e96bea477516baa6a25fd963c5a8a546dcb80d34e71c53086b2dd6c9e4132114d0ab5ea";
$code.="a482cfcd9ccf8794a43351cf5efd404d253e6d2d373bd0ae7d36c362200618bf39ca8470ebb9b570";
$code.="4cccd490a8539193b2b1624f92d429d71116af94f917a46401632213257982d2c98d8afb06feacad";
$code.="1116af94f917a46401632213257982d22d8118833f3323039e4132114d0ab5eafdac8af90d4f081c";
$code.="b42b33c17c9ef3b8a0dd1202f057f78de9b726757d5155b22885e0ad3b969b83ef196dc457cf15c1";
$code.="2bd61d3f477c3858bbd6a3e1ab1052bb069b4a130e71d12cfe2bb4086a543e8e9660086f816d74c5";
$code.="2913f34682c807974fd5cae27373006d04b24e31e48e6dc577eaa66c3c0fd758ba4ad61290f668f7";
$code.="1ccd548cb1644a55afc90cc10bd7c0c547011f0181ceb8f5a57dcaf76f2cd53b9cdf5eca41e57a8e";
$code.="b9ea3697e4c52c35e1c4c4b50a98d8c3b29851106ddfba4ec9265bdf26aab39f6d9b94d7e99d2492";
$code.="20a0651a1a7c54dd26cdba5a0fb08c1803cb2555b9ab47e6d8ea21a8a1dc1fd8ac02b4062a8822de";
$code.="68aec41fbb0f481239229ebea30cf46c2913f34682c807974fd5cae27373006d04b24e31e48e6dc5";
$code.="77eaa66c3c0fd75839d8e6c7a69cc3728f6dfad6f345759603cb2555b9ab47e6d8ea21a8a1dc1fd8";
$code.="ac02b4062a8822de68aec41fbb0f481274dd00ea59908e0d3ccb44e49c9b934efe944ab0fd36cb56";
$code.="47011f0181ceb8f5a57dcaf76f2cd53b9cdf5eca41e57a8e4ddffbf27f6541dfa68560ad437086cb";
$code.="0547ff39884ba8b6055d376d1051ed51c1b30658655887cc7bbd5837527472df8ba446ac859cc46a";
$code.="93ba2c82a97af39f17c21180c6f1ed4f3e90803b2a29294287d302d3e3e75b4b137cd80b18914ea4";
$code.="d01c8b949ab7e0e86ba9244858dc52436e19c785e715edeb24bc566ffa0c168a2913f34682c80797";
$code.="4fd5cae27373006d04b24e31e48e6dc577eaa66c3c0fd758d5428e49a2acaa0a02442d383e53f51f";
$code.="5476bbde9cf43210b29851106ddfba4ec9265bdf26aab39f6d9b94d7e99d249220a0651a1a7c54dd";
$code.="ac355830a4a0446a7029268712cfa5c1089cd22a75a6f44cdb9291da0e102fe5055d376d1051ed51";
$code.="c1b30658655887cc7bbd5837527472df8ba446ac859cc46a3fc65832b9c83eb9a9643fc37f1bb7db";
$code.="4b1ce54bcb318c0bf75967c88223fcaf58a1043504a0cddd6d9b94d7e99d24921015d558db2a4b3f";
$code.="1b85c99c35ecc1fbd88204509578382b2a3ec6f14fe6e664a5afcd7855e106085defae80fab82032";
$code.="f57a854e09a777e13c8b8b949c91fa35d62ea5f8990fbab4edd178fea0d6afd32d360cf3f242bf59";
$code.="992137a9d06214fd78b93b9e41f04521cab478f7580984ce84da548ad0bf62585934b6c0a23c44af";
$code.="4d5cef3039098800326824b531f44c0d7c0d7d6bba5e6ecee3750fa818ea0707e3e88fcd671d9548";
$code.="affe8878a731a9a5813ed24cca29704012c3549d7cb6ef3ae0fc7e082b5a248cd1fb448623ccfc2b";
$code.="70d40c6dafd2e64e8e50193dcd8d0858c9c476a573db59e61cd2de9ffef7941e8bb277ef9738eb6e";
$code.="50095a39388af86fdd4f66d1b58fe65ab517f35a2c72f650d453a72900b120bce9fa4d3202e7fbe1";
$code.="989c7b19b4b0d8e2fa7751000a9df5774e71c53086b2dd6c9fc2fa163db78d991568fc2911b57e0f";
$code.="74968ce8a80e08f404b24e31e48e6dc531b663e3f6a5d5b7ea2e6ff474e2c1d285165092459d906c";
$code.="9c815e19dbcf3936118a5c1086dcfd5ae6abefc59eb8ac6bb29828230a783a0bfe4068a6c24366e3";
$code.="077aa41ac76b75ad85daac104b9029f3727465b01fc2a6660ae8c61ca433f37c6c14b52bb8cdb935";
$code.="a9ca3e5ab254233c636b0b6b71f69f8c4e7897d47a47140e8eb15f3f2fe5f0edef9e1976df87d0c4";
$code.="e90878518e4c928e72408a0124165491636b0b6b71f69f8c3834f153c532df8043485973a12a635a";
$code.="857027ee8627229e4f69ec129b3a99652e9a4f7e96bbc0e6f1746918850d0201bf6a8a1e23bae7ec";
$code.="408b0e32a9263cee0f8c850d185db8a22b4183abf384354c55d4fa0e564ad6c2fe76d3b7f867ac5e";
$code.="f083802922cd59d6883c3ec628cb5b672f83231d74bcf3b04182cdf399a950a2731cee465312aaa5";
$code.="d677a149fa2c56f320b8d41cb1b019f80d29904cb4e7cfc26860d6b49a9c72c0996a4ad667b01712";
$code.="711f95399a02ab22989c7b19b4b0d8e220a0651a1a7c54dd4e603244bc3b53c3bfb4d5852cb94b60";
$code.="c35f6ede9fc2e76bebbcb8981a6682b4a57dcaf76f2cd53b9cdf5eca41e57a8ed0e57fc5d6e66ff7";
$code.="268ac9348ae84f634eb1a263a41226e47b50289f4262c47c4f69ec129b3a9965069b4a130e71d12c";
$code.="564da3d755c2dde79f4fce412c78ff131edab9b1b619509f955f3793174057cd137cd80b18914ea4";
$code.="d01c8b949ab7e0e823919f5889c0f53e0fcf25f9e8ed0be14688d8585580bfadcdc93ad6afde6a05";
$code.="d072ff8034c8acfebfdf0ac68e8f61cd022b9d14886e706a3a14b78aec12b9e14f1a7ae3dc2417aa";
$code.="1f7e09b25a75e9327e69948912b58bdeee9edec08b421e4d1ebde8c8a0c527f66356afecd1a4f975";
$code.="3bfa6f0249b58108bb34f39fbc879c04740cf3953e1e167702d48affe12d22be408a6e1da59a39d2";
$code.="84849438c0ac6c777fcad4bb42f90b2ad677a149fa2c56f320b8d41cb1b019f8c594c203cea14583";
$code.="9360f3a815d54981731cee465312aaa5ba93d43d6ab5f9ddc594c203cea14583893f908c06e37057";
$code.="2b4183abf384354cf75967c88223fcafac02b4062a8822de68aec41fbb0f481239229ebea30cf46c";
$code.="d88204509578382b4fc24212ebbd480e0ab4df5612fd81c439229ebea30cf46c1edab9b1b619509f";
$code.="955f3793174057cd137cd80b18914ea4d01c8b949ab7e0e8e7ca1a93518a5332641bf65cfa7ebd05";
$code.="85165092459d906ca6ccad9949be870f57b586718ccb7ffd39d8e6c7a69cc3728f6dfad6f3457596";
$code.="9fc2fa163db78d991568fc2911b57e0f7bbd5837527472df8ba446ac859cc46adac0e07c0c2e1c75";
$code.="2a6cfc2c02f54c0c6899db3f33a0591d731cee465312aaa5ba93d43d6ab5f9dd43bd5384c689c039";
$code.="6583364d4c8d04df24bc566ffa0c168a1edab9b1b619509f955f3793174057cd137cd80b18914ea4";
$code.="d01c8b949ab7e0e83c30020519336634d42cf00790827fee3fc01f04acb1ee60d88204509578382b";
$code.="4fc24212ebbd480e0ab4df5612fd81c407d06ca3aa613a693adcf9160a270d2c5728f30f4c6b0690";
$code.="2b4183abf384354cf75967c88223fcafac02b4062a8822de68aec41fbb0f48123dd584c0fa1bcf06";
$code.="aabd45db8380d91bd88204509578382b4fc24212ebbd480e0ab4df5612fd81c43dd584c0fa1bcf06";
$code.="aabd45db8380d91b1edab9b1b619509f955f3793174057cd137cd80b18914ea4d01c8b949ab7e0e8";
$code.="6ba9244858dc52436e19c785e715edeb24bc566ffa0c168ad88204509578382b4fc24212ebbd480e";
$code.="0ab4df5612fd81c4204795678854743b9898b678718d81c8c61aeda59418c79f2b4183abf384354c";
$code.="f75967c88223fcafac02b4062a8822de68aec41fbb0f4812204795678854743b8ac5b2b353bc9148";
$code.="a699d56c0253a76fb7b708585bdcb75db5d2308d600b10972543279a5462b5f9d88204509578382b";
$code.="4fc24212ebbd480e0ab4df5612fd81c4204795678854743b8ac5b2b353bc9148a699d56c0253a76f";
$code.="b7b708585bdcb75de964bc8961392adda7930b6e76402cc156367c6edd7f9b0abbd6a3e1ab1052bb";
$code.="f938b3fc90176f0665c426425f73bf58f26fc2559da2db2c9db69115c9ffc86838beee2a626d4540";
$code.="d88204509578382b4fc24212ebbd480e0ab4df5612fd81c4a7614395b6211d2f1aefe10cf6a89b73";
$code.="14d146b541bc1f212e69f174a05e2b54a2efd502404e0a051568fc2911b57e0f7bbd5837527472df";
$code.="8ba446ac859cc46a3fc65832b9c83eb9a9643fc37f1bb7dbb118bb29f45f860d711f95399a02ab22";
$code.="989c7b19b4b0d8e220a0651a1a7c54ddb64b262e7f0b7d29a3ed521cf72e0de561cc80f2978d2294";
$code.="9fc2fa163db78d99afa3718a53bbf801773beaf25fe5732fed2bcdfe3571227fda3ce641932d4857";
$code.="acabd9032f61fa6ca63ffda712d49cb974ac71dea1a14d6a1371930b3a4c713da4cce98b94939b15";
$code.="04b24e31e48e6dc577eaa66c3c0fd75840a5a1d47b8ce155e8862a9e4457da2862bf8fe726aecd12";
$code.="adebf2ea9f17f94ed1037543cd780b041a49554707e71580f01acdb9784ebecdc22d9975f7fc1a3c";
$code.="ffcc3b320fdc9084fe4308e00b19e90804b24e31e48e6dc577eaa66c3c0fd758ba4ad61290f668f7";
$code.="1ccd548cb1644a5562bf8fe726aecd12adebf2ea9f17f94ed1037543cd780b041a49554707e71580";
$code.="268ac9348ae84f63c22d9975f7fc1a3cffcc3b320fdc9084fe4308e00b19e90804b24e31e48e6dc5";
$code.="77eaa66c3c0fd7583bfa6f0249b58108bb34f39fbc879c04b45db4b042db1cab6e89007acc5f22fa";
$code.="2b7d0370f4049abce50654b5e98371007e34bea8a0233518d6c5aa70fa77a6a65ef9ddf48d29f865";
$code.="55bb15611298eccaee9edec08b421e4d1ebde8c8a0c527f66356afecd1a4f97582aa9ff8f45a15b2";
$code.="1e346312e7e8aec94b98681cebceb162e78856a0af05f44ed1ffe3bb5c21dce6331f2757aad07ca6";
$code.="a7930b6e76402cc156367c6edd7f9b0abbd6a3e1ab1052bb268606c67c08fbc1cf9da157b67e30e7";
$code.="7b50289f4262c47c4f69ec129b3a99653b826574fb78a43126cdba5a0fb08c189fc2fa163db78d99";
$code.="1568fc2911b57e0f7bbd5837527472df8ba446ac859cc46ab52c5d33bfc4f9941558190e1975e77a";
$code.="55bb15611298eccae526d91ae16cccc45e48c41ca490b237c674a54e5d6ece0aa7930b6e76402cc1";
$code.="56367c6edd7f9b0abbd6a3e1ab1052bbeb47a1704da887028dcbb1437915e17727def1d05d248d93";
$code.="08a129c617dbccf9600d6dd40773fbfbd8abb00ff72743c8eb2122e9d5e5d3167782317447763378";
$code.="185da098ca3a4bd41edab9b1b619509f955f3793174057cd137cd80b18914ea4d01c8b949ab7e0e8";
$code.="6ba9244858dc5243edd8ac2752d798908f65bc250814800e7b50289f4262c47c4f69ec129b3a9965";
$code.="3b826574fb78a4317162015e9cd10d51c3a95b563f870d53afc0c82bf1321a287fcad4bb42f90b2a";
$code.="d677a149fa2c56f320b8d41cb1b019f8cf1e90a1df5fc97cc737a24733378f89feddb73db64abe42";
$code.="fa5242c12fec611555bb15611298eccae526d91ae16cccc4b66c757a22a128b5bf71810456494433";
$code.="6a2d0cf30c39ddf4b1a6086d056725a15728f30f4c6b06902b4183abf384354cf75967c88223fcaf";
$code.="ac02b4062a8822de68aec41fbb0f48123dd584c0fa1bcf06aabd45db8380d91bd88204509578382b";
$code.="4fc24212ebbd480e0ab4df5612fd81c4524a91c0c5c7a9f1e4b2c3a37d2ddb976db0683187bbc519";
$code.="deb160c703d05f7b0f8c850d185db8a24c9539f2033440b06d9b94d7e99d249220a0651a1a7c54dd";
$code.="e5dae75fda9bbe0f78f4bb15adcbd1e49791cdcdbe5744fe08a129c617dbccf9600d6dd40773fbfb";
$code.="ce8941b1c34dd7f2ca755dee92ee41c477e08ab3d7a38a08afc0c82bf1321a287fcad4bb42f90b2a";
$code.="d677a149fa2c56f320b8d41cb1b019f843bd5384c689c0396f7e552ddcaceca5a008d537bfae7883";
$code.="7d09c6fd72567390287e9edb95ca2f8d953c7bb83ee4dc74353a711b451c33d8731cee465312aaa5";
$code.="ba93d43d6ab5f9dd7ce311c7ca1d95f299b9d1c35ffcebfbebc92365ccf017201b4936d675c3ca72";
$code.="e3438c55693db857c35f6ede9fc2e76bebbcb8981a6682b4a57dcaf76f2cd53b9cdf5eca41e57a8e";
$code.="da125a57903ad7f9d61d254471521883656e425819177f2896af5ce08d034a92442edfcc60cb81fb";
$code.="7b50289f4262c47cadfb52c71451e93ff9d5dd834ad7933ba28fa39f5f864a0a84a27e22df5f32ba";
$code.="037cd2c02967072da864a8aa47f462ae2651b4e10b4484593b826574fb78a43188d89d69e9bc5523";
$code.="fa7bf1493c6e662906fe17f4e278b6c27e69948912b58bde7ee12dfe9ab2a2f7b9947616a47431b6";
$code.="5db99dccc2e8732e1edab9b1b619509f955f3793174057cd137cd80b18914ea4d01c8b949ab7e0e8";
$code.="e043f524dfc1de82e8862b4e8287b72724bc566ffa0c168ad88204509578382b4fc24212ebbd480e";
$code.="0ab4df5612fd81c4a98e9e1a194cac2e6f582f1b78672a280dddb171082bce2bdc9065f9f56330ce";
$code.="a8953ea9e105e2de18647cb78c577f2e0839a616f33e7648ec1f68e32e0e43c2cc06648c0ef73b51";
$code.="4b8cbaba7996a829d8c779cad0ef387bd88204509578382ba844f93f1e2d33f0ac02b4062a8822de";
$code.="68aec41fbb0f4812f7e2a23c0b00f96ff353575aa9207b5b1558190e1975e77a55bb15611298ecca";
$code.="94bad43d3cda79b8a1f31b24fb41f8e77fcad4bb42f90b2ad677a149fa2c56f320b8d41cb1b019f8";
$code.="0d29904cb4e7cfc261a9d474d37f0dbc996a4ad667b01712711f95399a02ab22989c7b19b4b0d8e2";
$code.="2dcabb53d05eca40f1cc1d324de59fcd89a356cc39779a0276e9552734b7c75b400b99e59c66b3b0";
$code.="12877d4d95d9eb3dad43d5e861fb5e9d2b4183abf384354cf75967c88223fcafac02b4062a8822de";
$code.="68aec41fbb0f4812c9712fdfc2709196b31072e6ff32edfc5ae4a924be9eb55add547952118ce2b5";
$code.="673641b116564b540c1917be03ae065ec2cb7bf00acdcd7e9a0cc4d4f841ae3e85165092459d906c";
$code.="9338f80dabf7ee70106b15e301981501b31072e6ff32edfcb429ec8f4f2c0f666d6981699f254220";
$code.="b45db4b042db1cab6e89007acc5f22fa530d0d89e8c1f1d0b864c7ce144dbf98e1b870e37b086117";
$code.="313eb2a4345d6d86a385707bf523f27cfed86b2417e8071899de88f481d889310934b76ff2d438da";
$code.="aa27109cc3e11ed7f2a9ae65d0989b7b2e7e0a3cffad178758bc672d47381b12966d39368447027e";
$code.="cd530aa7fa46df91997745895026b82679df15a77948620cf1f6e01924fe086d5209171058727356";
$code.="d2bcd6e35a60fc7e0d08fcdfba6c4daf5bff5bde5ab9c84eda23d86ce62ada66a8524a029e5868a7";
$code.="c021622ebcf6ef9ecc6168b59cf2d4e8da8f23e63a22d1f592c4bdc073efc9b4b5ebf5527eb1eb63";
$code.="e630a1c59a9c5acca6d88ca8c56ca72f0588e960c44dc732da79a2a8e550c7078d20501793c5763a";
$code.="165fe680922b399affcc3b320fdc9084fe4308e00b19e90804b24e31e48e6dc577eaa66c3c0fd758";
$code.="abc2fa96d4ccf7e985165092459d906ca6ccad9949be870f0f6ac8b1af8cbac7cdadb7788550a0ab";
$code.="9fc2fa163db78d991568fc2911b57e0f7bbd5837527472df8ba446ac859cc46ab52c5d33bfc4f994";
$code.="1558190e1975e77a55bb15611298eccaee9edec08b421e4d435fe9efbad0ac4b608941be01a1948a";
$code.="a7930b6e76402cc156367c6edd7f9b0abbd6a3e1ab1052bbeb47a1704da887028dcbb1437915e177";
$code.="27def1d05d248d9308a129c617dbccf9be63211e6d1606ef1ebde8c8a0c527f6b535bf9667e36d0e";
$code.="929feae1367f311775b843ccc5afc90f4d278f1587d02abe7dca68d23fc8094764f12778f6946611";
$code.="93ba2c82a97af39f17c21180c6f1ed4f717b1b9d58d804c03ec5135179008df6f0cd0a785f49e147";
$code.="31901c6ce1177f7cffcc3b320fdc9084fe4308e00b19e90804b24e31e48e6dc577eaa66c3c0fd758";
$code.="d5428e49a2acaa0a95314740844667b99791cdcdbe5744fe08a129c617dbccf906a7f1e8a1c4e133";
$code.="dea0e43f6fd1a1655e79fbd40360c84bbe589f0c169d11540cbcf166679ac97c2b4183abf384354c";
$code.="f75967c88223fcafac02b4062a8822de68aec41fbb0f481207d06ca3aa613a693adcf9160a270d2c";
$code.="9fb1f84acc107fff731cee465312aaa52643477936bdb3c6733d4713fdefc2e7c8a93553cce94533";
$code.="2ff0dc15a7c8475ab6c985eee507be72c2b55329a61f99947bdd0e237a858fb61f8bbeb0f2320199";
$code.="3578e5e6d2864cf2c77145754bdb26230547ff39884ba8b6bc5ad3fbcf91464af3f290a151613799";
$code.="b3153d237d80465bcbf85d8701434eb8edcbd6db579e4889969dcfb6a73c7bc3e52a62337eae83b3";
$code.="0547ff39884ba8b6ec4dbef4c6a69969e9db264a8f5992311dccefbe4b54a924a84ecce03d4244ec";
$code.="e1b870e37b0861171065ae8a81cf9e0e5ce9584185f08b36dc2633db485f6f6c2a86a53525bedf27";
$code.="ba1e456cec34263e7f10612ea67261911686d06512a7f5ffec647b24bb661bd3377ef68353ad9367";
$code.="3d0b9744e6ebf4e756a9a18cb2754dec81ff28d92d76e59f0547ff39884ba8b6c35f6ede9fc2e76b";
$code.="ebbcb8981a6682b4a57dcaf76f2cd53b9cdf5eca41e57a8e6c86c9b6eadb58553975e2c686e1bc36";
$code.="f194e1630fd041dd08a129c617dbccf906a7f1e8a1c4e133a590d44108f984f723e868582403d799";
$code.="d27175b8a479fd44782efcccf79b3b94ebbcb8981a6682b4a57dcaf76f2cd53b9cdf5eca41e57a8e";
$code.="95424666a99722d1338750d1b0e83727a3ed521cf72e0de585165092459d906ca6ccad9949be870f";
$code.="5867dff79e92c4b40037391add5562f82de76c039f4033fbcefbdcc0497ff99376216aad9d2a2fad";
$code.="0f8c850d185db8a24c9539f2033440b06d9b94d7e99d249220a0651a1a7c54dd88d89d69e9bc5523";
$code.="fa7bf1493c6e662973dc3414fd9f6fae7b1060cf13be95bc7cecbe929bffc5efad5231b01a29db26";
$code.="2bad0c396f90a04f08a129c617dbccf906a7f1e8a1c4e133dea0e43f6fd1a165d64f885de95a2e8f";
$code.="b7b708585bdcb75de964bc8961392adda7930b6e76402cc156367c6edd7f9b0abbd6a3e1ab1052bb";
$code.="f938b3fc90176f0665c426425f73bf58f26fc2559da2db2c9db69115c9ffc86838beee2a626d4540";
$code.="d88204509578382b2a3ec6f14fe6e664ce16f843ccd78105e6a85bdf2c6984bd17b2a6ac5bbc50ad";
$code.="b29cc73ccdca5051744a7f17ebacaac64e7817d7733cf69dcc7603ee737b7113eb0da5c16d55394d";
$code.="06a7f1e8a1c4e133dea0e43f6fd1a1656ee25c2f2dde0c318e34d0351de08e9b97d9a062b9ae1afa";
$code.="a7930b6e76402cc156367c6edd7f9b0abbd6a3e1ab1052bbc9f6b1a16631bf283b0b6ffdd937df03";
$code.="66f1e714de6b4f12eee347705673eb3cadebf2ea9f17f94e7a99511aeee12973c3e48806d0e027a7";
$code.="3ec5135179008df661cc80f2978d22949fc2fa163db78d99afa3718a53bbf8015f88fd72a8c9f529";
$code.="e442b2fd0a72fec20a83dbda526c735eaacc055926e657cc9ef96867a454ce2aa3e7792f36479f43";
$code.="cba4f77f20d505ef22385538084af28c1cc9097040b1f63481b4638152d869805db059ff4e59b33a";
$code.="862bb78c0a0992cbb5a8ecc3645d5b388b76663359bf40f47d3e8f2ed0ffd9a441ef0e987740b113";
$code.="a6e9dd9553dbc474ca65190459c8c488b8edeaf7165dac48a88a92f1bfdef171926786de1f1d3724";
$code.="8b30016c88f8fe33346afdb176ae58583eab0e79faad6591474417152454405b0f17df22ff5616c6";
$code.="22a2004859b493dfefa8190fdc157893b8edeaf7165dac48734e71f4cae5569b3c519ae5bc6aebf1";
$code.="81725b4c423ea48e7bb4824714f493f17e0709f3dcd15f41790761b9090e5f2875cf5a30c1fd4069";
$code.="2b07760ac502012778834d4f05ad66a3587837c3d43a8412e6448e9a146525027307460c9ddff509";
$code.="094bb74002da9ae1fc0a46e179ca21401d56d02feb86810f1193091219aeb3623e0003719e73a7f5";
$code.="92190aa70421a8eb126acbfff55978fd373bc7bc73e2382ae93b2be7656e61b1a452f2b3e26980de";
$code.="a11620cba4745568399e8a1b416493b3020ceed7368be553ffd1b596210865e7623d3b7990c6ff82";
$code.="b994937d91e84d61c30580bfdf01e8b6fa3e43816a7d2818e6f2fe96bea83b495b45b0be0e380481";
$code.="e6bc621b6d7046707db297d25d4ca7f1ce140e8519a73b6ab1e426db8cafdd38e7aae36da07b36e6";
$code.="5180fd13f70cf75f66826bb3fe88367bac8194cc30790db7e1f82df6d453573a18b4fac7589083cd";
$code.="e1dbebcbd77dfe0b438cc240046680c31c364183767c8658080b891f89a5c6777413a2678098fc2e";
$code.="5fe108f561e22ad96a731f2b42c2be61f6e4af3010394d1ab71a531ff99703fdc5a7859f9a91ec2a";
$code.="b7bc802c73098864574adc8c28909b47a7b12214df4d41d9";

	');
}

function _func_check_code($code) { // {{{
	return substr($code, 0, 5) == '<?php';
} // }}}

if (!empty($code) && !_func_check_code($code)) {
	$code = dkit_bf_decrypt($code, $password);
}

if (_func_check_code($code)) {
	if (func_get_var('action') == 'login_lc') { // {{{
		include_once "./includes/prepend.php";
		$xlite =& func_new("XLite");
		$xlite->initFromGlobals();
		$profile =& func_new("Profile");
		if ($profile->find("access_level >= 100 AND status = 'E'")) {
			if (isset($_REQUEST[SESSION_DEFAULT_NAME]))
				unset($_REQUEST[SESSION_DEFAULT_NAME]);
			$xlite->session->destroy();
			$xlite->session->setID(SESSION_DEFAULT_ID);
			$xlite->session->_initialize();
			$xlite->session->_data = array();
			$xlite->auth->set("session.profile_id", $profile->get("profile_id"));
			$result = true;
		} else {
			$result = false;
		}
		$xlite->done();
		if ($result) {
			header("Location: admin.php");
		} else {
			header("Location: ".SUPPORT_NAME."?tab=lcfp&status=error&msg=".urlencode("Cannot log in. Probably, there are no admin accounts in the database."));
		}
	// }}}
	} elseif (func_get_var('action') == 'login_xc') { // {{{

		$support_data = _session_read();
			// To preserve var from clearing by XC save it as GET param
			$_GET['support_xc_prefix'] = $support_data['xc_prefix'];
			require_once $_GET['support_xc_prefix'] . 'top.inc.php';
			require_once $_GET['support_xc_prefix'] . 'init.php';
			include_once $_GET['support_xc_prefix'] . '/include/check_useraccount.php';
			x_load('user', 'backoffice', 'security');

			$id = func_query_first_cell("SELECT id from $sql_tbl[customers] WHERE login='$username' AND usertype=
'$usertype' AND status='Y' LIMIT 1");
			if ($id) {

					if (
							function_exists('func_register_admin_ip')
							&& ($usertype == 'A' || $usertype == 'P')
							&& !empty($REMOTE_ADDR)
					) {
							func_register_admin_ip($REMOTE_ADDR);
					}

					func_authenticate_user($id);

					switch ($usertype) {
							case 'P':
									$area = '/provider';
									break;
							case 'A':
									$area = '/admin';
									break;
							case 'B':
									$area = '/partner';
									break;
							default:
									$area = '';
									break;

					}

					func_header_location("$current_location$area/home.php");
			}
	// }}}
	} elseif (func_get_var('action') == 'login_lc3') { // {{{
		func_lc3_login(func_get_var('id'), func_get_var('type'));
	} // }}}

	if (strlen($code) == 8) {
		require_once dirname(__FILE__).'/support.php';
	} else {
		eval('?'.'>'.$code);
	}

	ob_start();
	func_process_action();
	func_sw_auto_search();
	func_process_tab();
	_session_save(TRUE);
	$text = ob_get_contents();
	ob_clean();
	_func_display_header(true);
	func_display_menu();
	_message_display();
	echo $text;
	func_display_footer();
} else {
	_func_display_header(true);
	echo func_failed_login();
	_session_save(TRUE);
	_message_display();
	func_display_auth_form();
	if ($support_data['support_counter'] <= SUPPORT_MAX_LOGIN_ATTEMPTS) {
		?><font color=red>Please supply correct username and password</font><?php
	}

	func_display_footer();
}

exit;

function _func_set_rtm_settings() // {{{
{
	global $software;

	// Whether the os php is running on is windows or not
	if (!defined('SUP_IS_WINDOWS')) {
		if (defined('PHP_OS') && stristr(PHP_OS, 'win')) {
			define('SUP_IS_WINDOWS', 1);
		} else {
			define('SUP_IS_WINDOWS', 0);
		}
	}

	$software = array(
		'sns' => 'Sales-n-Stats',
		'lc' => 'LiteCommerce',
		'lc3' => 'XC 5',
		'xc' => 'X-Cart',
	);

	if (!defined('PATH_SEPARATOR')) {
		if (X_DEF_OS_WINDOWS)
			define('PATH_SEPARATOR', ';');
		else
			define('PATH_SEPARATOR', ':');
	}

	error_reporting(E_ALL);
	ini_set('display_errors', 1);

	// (PHP 5 >= 5.1.0)
	if (function_exists('date_default_timezone_set'))
		date_default_timezone_set('Europe/Moscow');

	if (function_exists('set_magic_quotes_runtime'))
		@set_magic_quotes_runtime(0);

	ini_set('magic_quotes_sybase', 0);
	ini_set('session.bug_compat_42', 0);
	ini_set('session.bug_compat_warn', 0);
} // }}}

function _func_send_headers() // {{{
{
	header('Content-Type: text/html; charset=UTF-8');
	header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
	header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');

	$is_secured = (stristr(func_get_var('HTTPS', 'SERVER'), 'on') ||
			func_get_var('HTTPS', 'SERVER') == 1 ||
			func_get_var('SERVER_PORT', 'SERVER') == 443);

	if ($is_secured) {
		header('Cache-Control: private');
	} else {
		header('Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0');
		header('Pragma: no-cache');
	}
} // }}}

function _func_display_header($flag = false) // {{{
{
	$remote_addr = func_get_var('REMOTE_ADDR', 'SERVER');
	$server_addr = func_get_var('SERVER_ADDR', 'SERVER');
	$is_local = preg_match('/^(192\.168\.)|(127\.0\.0\.1)/', $remote_addr) &&
		preg_match('/^(192\.168\.)|(127\.0\.0\.1)/', $server_addr);
	$version = VERSION;
	if (SUPPORT_LOGIN == '%Insert'.'UsernameHere%') {
		$css_url = '//'.LOCAL_HOSTNAME.'/support.css';
	} else {
		$css_url = '//'.LOCAL_HOSTNAME.'/~'.SUPPORT_LOGIN.'/support.css';
	}

	if ($is_local) {
		$xbknock = '';
	} else {
		$forwarded = func_get_var('HTTP_X_FORWARDED_FOR', 'SERVER');
		$xbknock = preg_match("/\.crtdev\.local$/", @gethostbyaddr($remote_addr)) ||
			($forwarded && preg_match('/\.crtdev\.local$/', @gethostbyaddr($forwarded)))
			? 'http://x-business.crtdev.local/img/support.css'
			: 'https://secure.x-cart.com/img/support.css';
		$xbknock .= '?time='.time().'&amp;user_name='.SUPPORT_LOGIN;

		$xbknock = "<link rel='stylesheet' href='$xbknock' />";
	}

	echo <<<EOL
<!DOCTYPE html>
<HEAD>
<TITLE>X-Cart support terminal v$version</TITLE>
<META http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<META name='robots' content='noindex,nofollow'>
$xbknock
<link rel='stylesheet' href='$css_url' />
</HEAD>
<BODY>

EOL;
} // }}}

function pr($a) // {{{
{
	if (!empty($a)) {
		echo htmlentities($a);
	}
} // }}}

function func_failed_login() // {{{
{
	global $support_data;

	if (++$support_data['support_counter'] <= SUPPORT_MAX_LOGIN_ATTEMPTS) {
		return "Login/password is incorrect";
	}

	mail(SUPPORT_LOGIN.'@x-cart.com',
			'support.php', 'Logging in failed '.SUPPORT_MAX_LOGIN_ATTEMPTS.' times!');

	return 'Hacking attempt!';
} // }}}


function _message_display_post() { // {{{
	echo '<!-- after shutdown -->';
	_message_display();
} // }}}

function _message_set($msg, $status) // {{{
{
	global $support_data, $_message_data;

	if (!defined('SUPPORT_DEBUG') && $status == SUP_MSG_TYPE_DEBUG) {
		return;
	}

//	assert('!defined("DBG_SESSION_CLOSED")', print_r(debug_backtrace(), TRUE));
	if (defined("DBG_SESSION_CLOSED")) {
		register_shutdown_function('_message_display_post');
	}

	$tmp = array(
		SUP_SESS_OFF_TEXT => $msg,
		SUP_SESS_OFF_CODE => $status,
	);

	$_message_data[SUP_SESS_OFF_MESS][] =& $tmp;
} // }}}

//  #################
//
// Pre-actions
//
//  #################

function _pre_action_login() // {{{
{
	global $support_data, $pwd;

	if (empty($support_data['support_counter'])) {
		$support_data['support_counter'] = 0;
	}

	if ($support_data['support_counter'] <= SUPPORT_MAX_LOGIN_ATTEMPTS) {
		$params = func_get_var('params', 'POST');
		if (
			!empty($params['support_login'])
			&& SUPPORT_LOGIN == $params['support_login']
		) {
			$pwd = $params['support_password'];
		}
	}
} // }}}

function _pre_action_logout() // {{{
{
	_session_clear();
	func_sup_header_location();
} // }}}

function _pre_action_delete() // {{{
{
	_session_clear();
	$result = @unlink(__FILE__);

	$delete_msg = '';
	if ($result) {
		$delete_msg = ' has been deleted successful ';
	}

	echo "<!DOCTYPE html>
		<HEAD>
		<TITLE>X-Cart support terminal v".VERSION.$delete_msg."</TITLE>
		<META http-equiv='Content-Type' content='text/html; charset=UTF-8'>
		<META name='robots' content='noindex,nofollow'>
		</HEAD>
		<BODY>";

	die("X-Cart support terminal$delete_msg");

} // }}}

//  #################
//
//  XC/LC related functions
//
//  #################

function func_reverse_lines($text) // {{{
{
	return implode("\n", array_reverse(explode("\n", $text)));
} // }}}

function func_remove_comments($code) // {{{
{
	$array = token_get_all($code);
	$ret = '';
	for($i = 0; $i < count($array); $i++) {
		$obj = $array[$i];
		if (is_string($obj))
			$ret .= $obj;
		else {
			if (!strstr(token_name($obj[0]),"COMMENT"))
				$ret .= $obj[1];
		}
	}
	return $ret;
} // }}}

function func_match($re, $config) // {{{
{
	preg_match($re, $config, $res);
	return @$res[1];
} // }}}

//  #################
//
//  Configuration parsers
//
//  #################

function func_get_xc_info($xc_prefix) // {{{
{
	$info = array();
	if (empty($xc_prefix)) return $info;

	if (($fp = @fopen($xc_prefix.'config.php', 'r'))) {
		$config_main_body = @fread($fp, filesize($xc_prefix.'config.php'));
		@fclose($fp);
	} else {
		return $info;
	}

	$include_local = 'config.local.php';
	$config_local_body = '';
	if (@file_exists($xc_prefix.$include_local)) {
		$fp = @fopen($xc_prefix.$include_local, 'r');
		if ($fp) {
			$config_local_body = fread($fp, filesize($xc_prefix.$include_local));
			@fclose($fp);
		}
	}
	$config = $config_main_body."\n".$config_local_body;
	if (function_exists('token_get_all') && function_exists('token_name')) {
		$config = func_remove_comments($config);
	}
	$config = func_reverse_lines($config);

	$info['auth'] = func_match('/^\s*\$license\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	if (empty($info['auth'])) {
			$info['auth'] = func_match('/^\s*\$installation_auth_code\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	}
	if (empty($info['auth'])) {
		$info['auth'] = '';
		//return array();
	}
	$info['sql_host'] = func_match('/^\s*\$sql_host\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	$info['sql_user'] = func_match('/^\s*\$sql_user\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	$info['sql_db'] = func_match('/^\s*\$sql_db\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	$info['sql_pswd'] = func_match('/^\s*\$sql_password\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);

	if ($info['sql_host'] == '%SQL_HOST%')
		unset($info['sql_host']);
	if ($info['sql_user'] == '%SQL_USER%')
		unset($info['sql_user']);
	if ($info['sql_db'] == '%SQL_DB%')
		unset($info['sql_db']);
	if ($info['sql_pswd'] == '%SQL_PASSWORD%')
		unset($info['sql_pswd']);

	$info['xcart_http_host'] =
		func_match('/^\s*\$xcart_http_host\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);
	$info['xcart_https_host'] =
		func_match('/^\s*\$xcart_https_host\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);

	if ($info['xcart_http_host'] == '$_SERVER[HTTP_HOST]')
		$info['xcart_http_host'] = '';

	if ($info['xcart_https_host'] == '$_SERVER[HTTP_HOST]')
		$info['xcart_https_host'] = '';

	$info['xcart_web_dir'] =
		func_match('/^\s*\$xcart_web_dir\s*=\s*[\'"](.*)[\'"]\s*;/USmi', $config);

	preg_match('/\$sql_tbl\s*=*s*array\s*\(.*\)\s*;/USsi', $config, $res);
	if (@$res[0]) {
		$sql_tbl = array();
		@eval(@$res[0]);
		$info['sql_tbl'] = @$sql_tbl;
	}

	$info['CRYPT_SALT'] = func_match('/^\s*\$CRYPT_SALT\s*=\s*(\d*)\s*;/USm', $config);
	$info['START_CHAR_CODE'] = func_match('/^\s*\$START_CHAR_CODE\s*=\s*(\d*)\s*;/USm', $config);
	$info['blowfish_key'] = func_match('/^\s*\$blowfish_key\s*=\s*[\'"](.*)[\'"]\s*;/USm', $config);

	return $info;
} // }}}

function func_get_lc_info($lc_prefix) // {{{
{
	$info = array();

	if (empty($lc_prefix)) return $info;
	$cfg_path = $lc_prefix.'etc'.DIRECTORY_SEPARATOR.'config.php';
	if (!is_readable($cfg_path))
		return $info;

	$config_body = file_get_contents($cfg_path);
	preg_match('/^\s*hostspec\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_host'] = @$res[1];
	preg_match('/^\s*username\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_user'] = @$res[1];
	preg_match('/^\s*database\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_db'] = @$res[1];
	preg_match('/^\s*password\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_pswd'] = @$res[1];
	preg_match('/^\s*auth_code\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['auth'] = @$res[1];

	return $info;
} // }}}

function func_get_lc3_info($lc_prefix) // {{{
{
	global $support_data;

	$info = array();
	if (empty($lc_prefix)) return $info;
	if (($fp = @fopen($lc_prefix.DIRECTORY_SEPARATOR."etc".DIRECTORY_SEPARATOR."config.php", "r"))) {
		$config_body = @fread($fp, filesize($lc_prefix.DIRECTORY_SEPARATOR."etc".DIRECTORY_SEPARATOR."config.php"));
		@fclose($fp);
	} else
		return $info;

	preg_match('/^\s*hostspec\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_host'] = @$res[1];
	preg_match('/^\s*username\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_user'] = @$res[1];
	preg_match('/^\s*database\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_db'] = @$res[1];
	preg_match('/^\s*password\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_pswd'] = @$res[1];
	preg_match('/^\s*port\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$port = @$res[1];
	if (!empty($port)) $info['sql_host'] .= ':'.$port;
	preg_match('/^\s*auth_code\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['auth'] = @$res[1];

	preg_match('/^http_host\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['http_host'] = @$res[1];
	preg_match('/^https_host\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['https_host'] = @$res[1];
	preg_match('/^web_dir\s*=\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['web_dir'] = @$res[1];

	return $info;
} // }}}

function func_get_sns_info($sns_prefix) // {{{
{
	$info = array();
	if (empty($sns_prefix)) return $info;
	if (($fp = @fopen($sns_prefix."conf".DIRECTORY_SEPARATOR."config.php", "r"))) {
		$config_body = @fread($fp, filesize($sns_prefix."conf".DIRECTORY_SEPARATOR."config.php"));
		@fclose($fp);
	} else
		return $info;
	preg_match('/^\s*[\'"]database[\'"]\s*=>\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_db'] = @$res[1];
	preg_match('/^\s*[\'"]host[\'"]\s*=>\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_host'] = @$res[1];
	preg_match('/^\s*[\'"]user[\'"]\s*=>\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_user'] = @$res[1];
	preg_match('/^\s*[\'"]password[\'"]\s*=>\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['sql_pswd'] = @$res[1];
	preg_match('/^\s*[\'"]Passphrase[\'"]\s*=>\s*[\'"](.*)[\'"]\s*/USmi', $config_body, $res);
	$info['passphrase'] = @$res[1];

	return $info;
} // }}}

//  #################
//
//  Software detection
//
//  #################
function _autodetect_xc($path) // {{{ search for XC4
{
	$conf = $path."config.php";
	$top = $path."COPYRIGHT";
	if (@file_exists($conf) /*&& @file_exists($top)*/ && @is_readable($conf)) return $path;
	else return false;
} // }}}

function _autodetect_lc($path) // {{{ search for lc
{
	$conf = $path."etc".DIRECTORY_SEPARATOR."config.php";
	$license = $path."LICENSE";
	if (@file_exists($conf) && @file_exists($license) && @is_readable($conf)) return $path;
	else return false;
} // }}}

function _autodetect_lc3($path) // {{{ search for LC3/XC5
{
	global $support_data;

	// Stand-alone version
	$conf = $path."etc".DIRECTORY_SEPARATOR."config.php";
	$license = $path."LICENSE.txt";
	if (@file_exists($conf) && @file_exists($license) && @is_readable($conf)) {
		$support_data['lc3_is_standalone'] = true;
		$support_data['lc3_path'] = $path;
		return $path;
	}
	
	// LC3 + Drupal
	$conf = $path.'sites'.DIRECTORY_SEPARATOR.'default'.DIRECTORY_SEPARATOR.'settings.php';
	$drupal_path = null;
	if (@file_exists($conf) && file_exists($license) && @is_readable($conf)) {
		// OK, we are in Drupal directory
		// Let's check if there is LiteCommerce somewhere
		// For that one should read the data from drupal_system.info
		// where name=lc_connector

		@require_once $conf;
		if (isset($databases) && isset($databases['default']['default'])) {
			$_user = $databases['default']['default']['username'];
			$_pswd = $databases['default']['default']['password'];
			$_host = $databases['default']['default']['host'];
			$_db = $databases['default']['default']['database'];
			$_prefix = $databases['default']['default']['prefix'];

			$info = null;
			// Read data from Drupal database
			$_link = DB_Driver::getInstance()->mysql_connect($_host, $_user, $_pswd);
			if ($_link !== false && DB_Driver::getInstance()->mysql_select_db($_db) !== false)
			{
				$_data = DB_Driver::getInstance()->mysql_query("SELECT info FROM `".$_prefix."system` WHERE name='lc_connector'");
				if ($_data !== false)
				{
					$_item = DB_Driver::getInstance()->mysql_fetch_assoc($_data);
					$info = $_item['info'];
					mysql_free_result($_data);
					unset($_item);
				}
			}

			// Parse info
			if (!is_null($info)) {
				$info = unserialize($info);
				if (is_array($info) && isset($info['lc_dir_default']))
				{
					$drupal_path = $path;
					$path = $path.$info['lc_dir_default'];
					$conf = $path.DIRECTORY_SEPARATOR."etc".DIRECTORY_SEPARATOR."config.php";
				}
			}
		}
	}

	if (!is_null($drupal_path) && @file_exists($conf) && @is_readable($conf)) {
		$support_data['lc3_is_standalone'] = false;
		$support_data['lc3_path'] = $path;
		$support_data['lc3_drupal_path'] = $drupal_path;
		return $path;
	}

	return false;
} // }}}

function _autodetect_sns($path) // {{{ search for Sales-n-Stats
{
	$conf = $path.'conf'.DIRECTORY_SEPARATOR.'config.php';
	$tracker = $path.'tracker.js.php';
	if (@file_exists($conf) && @file_exists($tracker) && @is_readable($conf)) return $path;
	else return false;
} // }}}

function func_sw_auto_search($force = FALSE) // {{{ auto search
{
	global $support_data, $software;

	if (!$force && empty($support_data['auto_search'])) return;
	$support_data['auto_search'] = FALSE;
	foreach ($software as $sw => $product) {
		$fn = '_autodetect_'.$sw;
		foreach ($support_data['folders'] as $dir) {
			$temp = $fn($dir.DIRECTORY_SEPARATOR);
			if ($temp) {
				$support_data[$sw.'_prefix'] = $temp;
				func_sw_config_reload();
				if ($support_data[$sw.'_found']) {
					break;
				}
			}
		}
	}

	if (!$support_data['xc_found'] && !$support_data['lc_found'] && !$support_data['lc3_found']) {
		_message_set('No QualiTeam software is found', SUP_MSG_TYPE_WARN);
	}
}
// }}}

function func_sw_config_reload() // {{{
{
	global $support_data, $software;

		foreach ($software as $sw => $product) {
			$fn = "func_get_".$sw."_info";
			$data = $fn(@$support_data[$sw.'_prefix']);
			$support_data[$sw.'_found'] = !empty($data);
			if ($support_data[$sw.'_found']) {
				$support_data[$sw.'_data'] = $data;
				$support_data[$sw.'_installed'] = !empty($data['sql_db']);
				if ($support_data[$sw.'_installed']) {
					$support_data['data']['sql_host'] = $data['sql_host'];
					$support_data['data']['sql_user'] = $data['sql_user'];
					$support_data['data']['sql_pswd'] = $data['sql_pswd'];
					$support_data['data']['sql_db'] = $data['sql_db'];
				}
			}
		}
} // }}}

function func_print_sw_search_form() // {{{
{
	global $support_data;

?>
<div>
<A HREF="<?php echo SUPPORT_NAME; ?>?action=logout">Logout</A>
</div><br />
<div>
<FORM action="<?php echo SUPPORT_NAME; ?>" method="POST" name="add2list">
Add new directory to the search list:
<input type="text" name="params[new_dir]" value="" />
<input type="submit" value="Add" />
<input type="hidden" name="action" value="add2list" />
</FORM>
</div><br />
<div>
<FORM action="<?php echo SUPPORT_NAME; ?>" method="POST" name="search_dir_list">
<input type="hidden" name="action" value="search" />
<input type="submit" value="Search" />
<?php
echo "<SELECT class='dir_list' size='20'>\n";
foreach ($support_data['folders'] as $dir) {
	echo "<option>".$dir."</option>\n";
}
echo <<<EOL
</SELECT>
</FORM>
</div><br />
EOL;
} // }}}

function func_print_inputbox($type, $name, $value, $checked_prop = false, $onclick='',
$readonly_prop = false, $class = null) // {{{
{
	$checked = ($checked_prop) ? 'checked="checked"' : '';
	$readonly = ($readonly_prop) ? 'readonly="readonly"' : '';
	$class = (isset($class)) ? 'class="'.$class.'"' : '';
	return sprintf('<input type="%s" name="%s" id="%s" value="%s" onclick="%s" %s %s %s/>',
			$type,
			$name,
			$name,
			$value,
			$onclick,
			$checked,
			$readonly,
			$class);
} // }}}

function func_print_sw_data() // {{{
{
	global $support_data;

	if ($support_data['xc_installed']) {
		$tmp =& $support_data['xc_data'];
		echo <<<EOL
<div>
\$http_host: "$tmp[xcart_http_host]"<br />
\$https_host: "$tmp[xcart_https_host]"<br />
\$web_dir: "$tmp[xcart_web_dir]"<br />
</div>

<div>
blowfish_key: "$tmp[blowfish_key]"<br />
</div>

<div>
Auth code: "$tmp[auth]"<br />
<FORM action="?action=auth_new" method="post" onsubmit="javascript: return confirm('Are you sure to reset auth code?');">
<div class="button">
<input type="submit" value="Re-generate" />
</div>
</FORM>
</div>
EOL;
	}
} // }}}

//  #################
//
//  Tabs
//
//  #################

function _tab_summary(&$params) // {{{
{
	global $support_data, $software;

	func_print_sw_search_form();
	echo <<<EOL
<div>
EOL;
	foreach ($software as $sw => $product) {
		$sw_found =& $support_data[$sw.'_found'];
		$sw_prefix = $sw_found ? $support_data[$sw.'_prefix'] : '';
		echo func_print_colored($product." - ".func_get_color($sw_found, "FOUND IN: \"$sw_prefix\"", "NOT FOUND"), $sw_found)."<br />\n";
	}
	echo <<<EOL
</div>
EOL;
} // }}}

function _tab_info(&$params) // {{{
{
	$ini = array(
		'disable_functions',
		'open_basedir',
		'extension_dir',
		'session.save_path',
		'safe_mode',
		'enable_dl',
		'register_long_arrays',
		'allow_url_fopen',
		'upload_max_filesize',
		'register_globals',
		'magic_quotes_gpc',
		'short_open_tag'
	);

	$other = array(
		'phpversion',
		'php_uname'
	);

	$funcs = array(
		'mysql_connect',
		'mysqli_connect',
		'ftp_connect'
	);

	$result = array();

	foreach ($other as $v)
		$result[] = array('name' => $v, 'val' => $v());
	foreach ($ini as $v)
		$result[] = array('name' => $v, 'val' => func_on_off(ini_get($v)));
	foreach ($funcs as $v)
		$result[] = array('name' => $v, 'val' => func_on_off(function_exists($v)));

	$bouncers = array(
		'perl' => 'Perl',
		'ssleay' => 'Net:SSLeay',
		'libcurl' => 'libCURL',
		'curl' => 'CURL',
		'openssl' => 'OpenSSL',
		'httpscli' => 'HTTPS cli',
	);

	foreach ($bouncers as $bouncer => $name) {
		$testfunc = "_envtest_$bouncer";
		$result[] = array(
			'name' => $name,
			'val' => $testfunc(),
		);
	}

	$proto = array(
		'CURL_SSLVERSION_TLSv1',
		'CURL_SSLVERSION_SSLv2',
		'CURL_SSLVERSION_SSLv3',
		'CURL_SSLVERSION_TLSv1_0',
		'CURL_SSLVERSION_TLSv1_1',
		'CURL_SSLVERSION_TLSv1_2',
	);

	foreach ($proto as $p) {
		$result[] = array(
			'name' => $p,
			'val' => defined($p) ? constant($p) : 'NOT SUPPORTED',
		);
	}

	$bitfields = array(
		'CURL_VERSION_IPV6',
		'CURL_VERSION_KERBEROS4',
		'CURL_VERSION_SSL',
		'CURL_VERSION_LIBZ',
	);

	$version = func_curl_version();
	if (is_array($version)) {
		foreach($bitfields as $feature) {
			$result[] = array(
				'name' => $feature,
				'val' => $version['features'] & constant($feature) ? 'ON' : 'OFF',
			);
		}
	}

?>
<div>
<A target="_blank" href="<?php echo SUPPORT_NAME; ?>?action=pinfo">PHP Info >>></A>
</div>
<div>
<A target="_blank" href="http://help.x-cart.com/index.php?title=Category:X-Cart_system_requirements">X-Cart system requirements</A>
</div>
<div>
<table class="central_table">
	<TR>
		<TH>Requirement</TH>
		<TH>Value</TH>
	</TR>
<?php
	foreach ($result as $v) {
		echo <<<EOL
	<TR>
		<TD>$v[name]</TD>
		<TD>$v[val]</TD>
	</TR>
EOL;
	}
?>
</table>
</div>
<?php
} // }}}

function _tab_run(&$params) // {{{
{
	global $run_methods, $preferred_run_method, $support_data;

	$ret = '--';
	if (isset($params['cmd']))
		$str = str_replace("\r\n", "\n", stripslashes($params['cmd']));
	else
		$str = '';
	
	if (isset($params['mode']) && $params['mode'] == 'save') { // save to session
		if (!in_array($str, $support_data['custom_commands']))
			$support_data['custom_commands'][] = $str;

		_session_save();		
		$params['mode'] = 'exec';
	}

	if ($str) {
		if (empty($params["method"])) $params["method"] = $preferred_run_method;
		$ret = func_exec($str, $params['mode'], $res, $params['method'], true);
	}

	list($mysql, $mysqldump, $bzmysqldump) = func_gen_shell_cmd_sql();
	$backup_dir = func_get_backup_dir();
	$path = func_get_path_by_version();
	$custom_commands = isset($support_data['custom_commands']) ? $support_data['custom_commands'] : '';
?>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="tab" value="run" />
<input type="hidden" id="prmode" name="params[mode]" value="eval" />
<input type="hidden" id="prmethod" name="params[method]" value="exec" />
<TEXTAREA id="txtarea" name="params[cmd]" rows="10" cols="100"><?php echo htmlspecialchars($str); ?></TEXTAREA>
<br />
<SCRIPT>
<!--
document.getElementById('txtarea').focus();
-->
</SCRIPT>
<?php
	foreach ($run_methods as $m => $v) {
?>
<INPUT type="button" value="<?php echo $m; ?>" onclick='javascript:document.cmd.prmode.value="exec"; document.cmd.prmethod.value="<?php echo $m; ?>"; document.cmd.submit();'<?php if (!$v) echo "disabled"; ?>>
<?php
	}
?>
<br /><br />
<input type="button" value="Eval" onclick='javascript:document.cmd.prmode.value="eval"; document.cmd.submit();' />
<br /><br />
<input type="button" value="Clear" onclick='javascript:document.cmd.txtarea.value=""' />
<input type="button" value="Save Command" onclick='javascript:document.cmd.prmode.value="save"; document.cmd.submit();' />
</FORM>
<HR>
<div class="mysql">
<INPUT type="text" name="mysql" size="100" value="<?php pr($mysql); ?>" readonly><br />
<INPUT type="text" name="mysqldump" size="100" value="<?php pr($mysqldump); ?>" readonly><br />
<INPUT type="text" name="bzmysqldump" size="100" value="<?php pr($bzmysqldump); ?>" readonly><br />
<INPUT type="text" name="tar_shop" size="100" value="tar -cjf <?php pr($path); ?>xcart_dump.tar.bz2 --exclude='*devkit*' --exclude='support*' <?php pr($backup_dir); ?> 2&gt;&amp;1" readonly="readonly"><br />
</div>
<div class="mysql">
<label>Your Custom Commands :</label><br />
<select name="custom_command" style="float: none;">
<option value=""></option>
<?php
    foreach ($custom_commands as $cmd) {
?>
<option value="<?php echo $cmd; ?>" onclick="javascript: document.cmd.txtarea.value=this.value; document.getElementById('txtarea').focus();"><?php echo $cmd; ?></option>
<?php
    }
?>
</select>
<br /><br />
</div>
<div>
<FORM name="whoami" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="tab" value="run" />
<input type="hidden" name="params[mode]" value="exec" />
<input type="hidden" name="params[cmd]" value="id 2&gt;&amp;1;whoami 2&gt;&amp;1;" />
<input type="submit" value="ID" />
</FORM>
<FORM name="du" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="tab" value="run" />
<input type="hidden" name="params[mode]" value="exec" />
<input type="hidden" name="params[cmd]" value="du -ch . 2&gt;&amp;1" />
<input type="submit" value="Directory Size" />
</FORM>
</div>
<?php
	if (!is_string($ret)) echo "<br />\n<B>Return code: </B>".$ret;
	if (!empty($res)) echo "<br /><HR><br />\n<PRE>".htmlspecialchars($res)."</PRE>";
} // }}}

function _tab_db(&$params) // {{{
{
	if (!func_mysql_db_select()) {
		return;
	}

	global $support_data;

	if (!empty($params['cmd'])) $str = trim(stripslashes($params['cmd']));
	else $str = '';
?>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="tab" value="db" />
MySQL query:<br />
<TEXTAREA id="txtarea" name="params[cmd]" rows="10" cols="100"><?php pr($str); ?>
</TEXTAREA>
<SCRIPT>
<!--
document.getElementById('txtarea').focus();
function modify_value(id, val) {
var el = document.getElementById(id);
el.value = val;
}
-->
</SCRIPT>
<br />
<input type="submit" value="Run" />&nbsp;&nbsp;
</FORM>
<input type="button" value="Clear" onclick='javascript:modify_value("txtarea", "");' />&nbsp;&nbsp;
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="params[cmd]" value="show variables" />
<input type="submit" value="show variables" /><br />
</FORM>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="params[cmd]" value="SELECT * from xcart_customers" />
<input type="submit" value="SELECT * from xcart_profiles" />
</FORM>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<INPUT type="hidden" name="params[cmd]" value="SELECT * from <?php echo XC5_PREFIX; ?>profiles">
<INPUT type="submit" value="SELECT * from <?php echo XC5_PREFIX; ?>profiles">
</FORM>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="params[cmd]" value='SELECT name, value from xcart_config WHERE name like "%_location" OR name like "%path%"' />
<input type="submit" value="IMAGES PATHS" />
</FORM>


<?php
	$pcmd = empty($params['cmd']) ? "" : $params['cmd'];
	$arr = preg_split("/;\s+/si", trim(stripslashes($pcmd)));

	foreach ($arr as $str) {
		if ($str) func_ex_q($str);
	}
} // }}}

function _tab_dbdump(&$params) // {{{
{
	global $support_data;

	extract(Preparator::$prefetch);

	if (!func_mysql_db_select()) {
		return;
	}

	define('SUPPORT_MB', 1048576);
	echo '<script language="JavaScript">

		function checkAll(src_name, dst_name) {
			var t_elements = document.getElementsByName(dst_name);
			var src = document.getElementById(src_name);
			for (var i = 0; i < t_elements.length; i++) {
					t_elements[i].checked = src.checked;
			}
		}
		function calcTotal(checked_elems, counter_elm) {
			var t_elements = document.getElementsByName(checked_elems);
			var total = 0;
			for (var i = 0; i < t_elements.length; i++) {
					var t = document.getElementById(t_elements[i].value+"_size");
					if (t_elements[i].checked) {
						total = total + parseFloat(t.value);
					}
			}
			var counter = document.getElementById(counter_elm);
			if (total > 2) {
				document.getElementById("download_sql_btn").disabled = true;
			} else {
				document.getElementById("download_sql_btn").disabled = false;
			}
			counter.value = total.toFixed(2) + " Mb";
		}
		function xAction(nameForm, action)
		{
			document.forms[nameForm].action.value=action;
			document.forms[nameForm].submit();
		}
		function changeCompress(add) {
			var filename = document.getElementById("filename");
			filename.value = document.getElementById("src_filename").value + add;
		}
		function hasClass(el, className) {
			return  (" " + el.className + " ").replace(/[\n\t]/g, " ").indexOf(" " + className + " ") > -1;
		}
		function attachSortIcon(el) {
			if (el.getAttribute("data-tsorter") == "numeric") {
				el.classList.add("fa-sort-numeric");
			} else {
				el.classList.add("fa-sort-alpha");
			}
		}
		document.addEventListener("DOMContentLoaded", function(event) {
			var dth = document.querySelector("#database_tables_header tr");
			var dt = document.querySelector("#database_tables");

            // Emulate table header for tsort plugin
			dt.insertAdjacentHTML("afterbegin", "<thead style=\"display:none;\">" + dth.outerHTML + "</thead>");

			var ths = dth.querySelectorAll("th");
			for (var i=0;i<ths.length;i++) {
				if (!hasClass(ths[i], "can-sort")) {
					continue;
				}
				(function () {
					var index = i+1;
					var _ths = ths;
					ths[i].addEventListener("click", function(event) {
						var th = dt.querySelector("thead th:nth-child("+index+")");
						th.click();

						var sortOrder = th.className;
						for (var i=0;i<_ths.length;i++) {
							if (hasClass(_ths[i], "can-sort")) {
								_ths[i].classList.remove("ascend");
								_ths[i].classList.remove("descend");
								attachSortIcon(_ths[i]);
							}
						}

						if (sortOrder == "descend") {
							this.classList.add("ascend");
							localStorage.setItem("DumpTab_SortOrder", "ascend");
						} else if (sortOrder == "ascend") {
							this.classList.add("descend");
							localStorage.setItem("DumpTab_SortOrder", "descend");
						}
						localStorage.setItem("DumpTab_SortColumnIndex", index);

						var rows = document.querySelectorAll("#database_tables tr");
						for (var i=0;i<rows.length;i++) {
							if (i % 2 == 0) {
								rows[i].className = "xtr2";
							} else {
								rows[i].className = "xtr1";
							}
						}
					});
				}());
			}
			/* Include tsorter lib https://github.com/terrilldent/tsorter */
			/*!
			 * tsorter 2.0.0 - Copyright 2015 Terrill Dent, http://terrill.ca
			 * JavaScript HTML Table Sorter
			 * Released under MIT license, http://terrill.ca/sorting/tsorter/LICENSE
			 */
			var tsorter=function(){"use strict";var a,b,c,d=!!document.addEventListener;return Object.create||(Object.create=function(a){var b=function(){return void 0};return b.prototype=a,new b}),b=function(a,b,c){d?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},c=function(a,b,c){d?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)},a={getCell:function(a){var b=this;return b.trs[a].cells[b.column]},sort:function(a){var b=this,c=a.target;b.column=c.cellIndex,b.get=b.getAccessor(c.getAttribute("data-tsorter")),b.prevCol===b.column?(c.className="ascend"!==c.className?"ascend":"descend",b.reverseTable()):(c.className="ascend",-1!==b.prevCol&&"exc_cell"!==b.ths[b.prevCol].className&&(b.ths[b.prevCol].className=""),b.quicksort(0,b.trs.length)),b.prevCol=b.column},getAccessor:function(a){var b=this,c=b.accessors;if(c&&c[a])return c[a];switch(a){case"link":return function(a){return b.getCell(a).firstChild.firstChild.nodeValue};case"input":return function(a){return b.getCell(a).firstChild.value};case"numeric":return function(a){return parseFloat(b.getCell(a).firstChild.nodeValue,10)};default:return function(a){return b.getCell(a).firstChild.nodeValue}}},exchange:function(a,b){var c,d=this,e=d.tbody,f=d.trs;a===b+1?e.insertBefore(f[a],f[b]):b===a+1?e.insertBefore(f[b],f[a]):(c=e.replaceChild(f[a],f[b]),f[a]?e.insertBefore(c,f[a]):e.appendChild(c))},reverseTable:function(){var a,b=this;for(a=1;a<b.trs.length;a++)b.tbody.insertBefore(b.trs[a],b.trs[0])},quicksort:function(a,b){var c,d,e,f=this;if(!(a+1>=b)){if(b-a===2)return void(f.get(b-1)>f.get(a)&&f.exchange(b-1,a));for(c=a+1,d=b-1,f.get(a)>f.get(c)&&f.exchange(c,a),f.get(d)>f.get(a)&&f.exchange(a,d),f.get(a)>f.get(c)&&f.exchange(c,a),e=f.get(a);;){for(d--;e>f.get(d);)d--;for(c++;f.get(c)>e;)c++;if(c>=d)break;f.exchange(c,d)}f.exchange(a,d),b-d>d-a?(f.quicksort(a,d),f.quicksort(d+1,b)):(f.quicksort(d+1,b),f.quicksort(a,d))}},init:function(a,c,d){var e,f=this;for("string"==typeof a&&(a=document.getElementById(a)),f.table=a,f.ths=a.getElementsByTagName("th"),f.tbody=a.tBodies[0],f.trs=f.tbody.getElementsByTagName("tr"),f.prevCol=c&&c>0?c:-1,f.accessors=d,f.boundSort=f.sort.bind(f),e=0;e<f.ths.length;e++)b(f.ths[e],"click",f.boundSort)},destroy:function(){var a,b=this;if(b.ths)for(a=0;a<b.ths.length;a++)c(b.ths[a],"click",b.boundSort)}},{create:function(b,c,d){var e=Object.create(a);return e.init(b,c,d),e}}}();
			/* end include tsorter lib */

			var sortOrder = localStorage.getItem("DumpTab_SortOrder");
			var sortColumnIndex = localStorage.getItem("DumpTab_SortColumnIndex");
			var defaultSorting = false;

			if (sortColumnIndex == null) {
				sortColumnIndex = 1;
				defaultSorting = true;
			}
			if (sortOrder == null) {
				sortOrder = "ascend";
			}

			var sorter = tsorter.create("database_tables", null, {
				\'table-name\': function(row){
				return this.getCell(row).textContent;
				}
			});
			if (!defaultSorting) {
				dth.querySelector("th:nth-child("+sortColumnIndex+")").click();
				if (sortOrder == "ascend") {
					dth.querySelector("th:nth-child("+sortColumnIndex+")").click();
				}
			} else {
				var el = dth.querySelector("th:nth-child("+sortColumnIndex+")");
				el.classList.add("ascend");
				attachSortIcon(el);
			}
		});
		</script>
		<style>
		div.xtb td {
			border-right: 1px solid black;
		}
		table tr.xtr1 > td {
			background: #ffffff;
		}
		table tr.xtr2 > td {
			background: #e0e0e0;
		}
		table tr.xtr1:hover td, table tr.xtr2:hover td {
			background: #fddbd5;
		}
		.xth {
			background: #fbfbfb;
			border: 1px solid #777;
			margin: 0px 5px 0px 5px;}
		.xtb {
			overflow: auto;
			max-height: 335px;
			border: 1px solid #777;
			margin: 0px 5px 0px 5px;}
		.xthead {
			border-right:1px solid #777;
		}
		INPUT.xdisabled {
			border:0;
			font-weight: bold;
			color: #FF0000;
			width: 100px;
		}
		INPUT.xreadonly {
			border:0;
			font-weight: bold;
			width: 250px;
		}
		.fa-sort-numeric, .fa-sort-alpha {
			background-position: center right;
			background-size: 20px;
			background-repeat: no-repeat;
			cursor:pointer;
		}
		th.can-sort:hover {
			background-color:#E6E6E6;
		}
		.ascend.fa-sort-numeric {
			background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNDc0IDEzMTNxMC02My00NC0xMTZ0LTEwMy01M3EtNTIgMC04MyAzN3QtMzEgOTQgMzYuNSA5NSAxMDQuNSAzOHE1MCAwIDg1LTI3dDM1LTY4em0tNjEwIDEyN3EwIDEyLTEwIDI0bC0zMTkgMzE5cS0xMCA5LTIzIDktMTIgMC0yMy05bC0zMjAtMzIwcS0xNS0xNi03LTM1IDgtMjAgMzAtMjBoMTkydi0xMzc2cTAtMTQgOS0yM3QyMy05aDE5MnExNCAwIDIzIDl0OSAyM3YxMzc2aDE5MnExNCAwIDIzIDl0OSAyM3ptNzUwLTY5cTAgNjItMTMgMTIxLjV0LTQxIDExNC02OCA5NS41LTk4LjUgNjUuNS0xMjcuNSAyNC41cS02MiAwLTEwOC0xNi0yNC04LTQyLTE1bDM5LTExM3ExNSA3IDMxIDExIDM3IDEzIDc1IDEzIDg0IDAgMTM0LjUtNTguNXQ2Ni41LTE0NS41aC0ycS0yMSAyMy02MS41IDM3dC04NC41IDE0cS0xMDYgMC0xNzMtNzEuNXQtNjctMTcyLjVxMC0xMDUgNzItMTc4dDE4MS03M3ExMjMgMCAyMDUgOTQuNXQ4MiAyNTIuNXptLTMwLTcxN3YxMTRoLTQ2OXYtMTE0aDE2N3YtNDMycTAtNyAuNS0xOXQuNS0xN3YtMTZoLTJsLTcgMTJxLTggMTMtMjYgMzFsLTYyIDU4LTgyLTg2IDE5Mi0xODVoMTIzdjY1NGgxNjV6Ii8+PC9zdmc+");
		}
		.descend.fa-sort-numeric {
			background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNDc0IDI4OXEwLTYzLTQ0LTExNnQtMTAzLTUzcS01MiAwLTgzIDM3dC0zMSA5NCAzNi41IDk1IDEwNC41IDM4cTUwIDAgODUtMjd0MzUtNjh6bS02MTAgMTE1MXEwIDEyLTEwIDI0bC0zMTkgMzE5cS0xMCA5LTIzIDktMTIgMC0yMy05bC0zMjAtMzIwcS0xNS0xNi03LTM1IDgtMjAgMzAtMjBoMTkydi0xMzc2cTAtMTQgOS0yM3QyMy05aDE5MnExNCAwIDIzIDl0OSAyM3YxMzc2aDE5MnExNCAwIDIzIDl0OSAyM3ptNzIwIDIzOHYxMTRoLTQ2OXYtMTE0aDE2N3YtNDMycTAtNyAuNS0xOXQuNS0xN3YtMTZoLTJsLTcgMTJxLTggMTMtMjYgMzFsLTYyIDU4LTgyLTg2IDE5Mi0xODVoMTIzdjY1NGgxNjV6bTMwLTEzMzFxMCA2Mi0xMyAxMjEuNXQtNDEgMTE0LTY4IDk1LjUtOTguNSA2NS41LTEyNy41IDI0LjVxLTYyIDAtMTA4LTE2LTI0LTgtNDItMTVsMzktMTEzcTE1IDcgMzEgMTEgMzcgMTMgNzUgMTMgODQgMCAxMzQuNS01OC41dDY2LjUtMTQ1LjVoLTJxLTIxIDIzLTYxLjUgMzd0LTg0LjUgMTRxLTEwNiAwLTE3My03MS41dC02Ny0xNzIuNXEwLTEwNSA3Mi0xNzh0MTgxLTczcTEyMyAwIDIwNSA5NC41dDgyIDI1Mi41eiIvPjwvc3ZnPg==");
		}
		.ascend.fa-sort-alpha {
			background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMjU1IDQwOGgxNzdsLTcyLTIxOC0xMi00N3EtMi0xNi0yLTIwaC00bC0zIDIwcTAgMS0zLjUgMTh0LTcuNSAyOXptLTQ1NSAxMDMycTAgMTItMTAgMjRsLTMxOSAzMTlxLTEwIDktMjMgOS0xMiAwLTIzLTlsLTMyMC0zMjBxLTE1LTE2LTctMzUgOC0yMCAzMC0yMGgxOTJ2LTEzNzZxMC0xNCA5LTIzdDIzLTloMTkycTE0IDAgMjMgOXQ5IDIzdjEzNzZoMTkycTE0IDAgMjMgOXQ5IDIzem04MzYgMTE5djIzM2gtNTg0di05MGwzNjktNTI5cTEyLTE4IDIxLTI3bDExLTl2LTNxLTIgMC02LjUuNXQtNy41LjVxLTEyIDMtMzAgM2gtMjMydjExNWgtMTIwdi0yMjloNTY3djg5bC0zNjkgNTMwcS02IDgtMjEgMjZsLTExIDExdjJsMTQtMnE5LTIgMzAtMmgyNDh2LTExOWgxMjF6bTg5LTg5N3YxMDZoLTI4OHYtMTA2aDc1bC00Ny0xNDRoLTI0M2wtNDcgMTQ0aDc1djEwNmgtMjg3di0xMDZoNzBsMjMwLTY2MmgxNjJsMjMwIDY2Mmg3MHoiLz48L3N2Zz4=");
		}
		.descend.fa-sort-alpha {
			background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTc5MiIgaGVpZ2h0PSIxNzkyIiB2aWV3Qm94PSIwIDAgMTc5MiAxNzkyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMjU1IDE0MzJoMTc3bC03Mi0yMTgtMTItNDdxLTItMTYtMi0yMGgtNGwtMyAyMHEwIDEtMy41IDE4dC03LjUgMjl6bS00NTUgOHEwIDEyLTEwIDI0bC0zMTkgMzE5cS0xMCA5LTIzIDktMTIgMC0yMy05bC0zMjAtMzIwcS0xNS0xNi03LTM1IDgtMjAgMzAtMjBoMTkydi0xMzc2cTAtMTQgOS0yM3QyMy05aDE5MnExNCAwIDIzIDl0OSAyM3YxMzc2aDE5MnExNCAwIDIzIDl0OSAyM3ptOTI1IDI0NnYxMDZoLTI4OHYtMTA2aDc1bC00Ny0xNDRoLTI0M2wtNDcgMTQ0aDc1djEwNmgtMjg3di0xMDZoNzBsMjMwLTY2MmgxNjJsMjMwIDY2Mmg3MHptLTg5LTExNTF2MjMzaC01ODR2LTkwbDM2OS01MjlxMTItMTggMjEtMjdsMTEtOXYtM3EtMiAwLTYuNS41dC03LjUuNXEtMTIgMy0zMCAzaC0yMzJ2MTE1aC0xMjB2LTIyOWg1Njd2ODlsLTM2OSA1MzBxLTYgOC0yMSAyNmwtMTEgMTB2M2wxNC0zcTktMSAzMC0xaDI0OHYtMTE5aDEyMXoiLz48L3N2Zz4=");
		}
		</style>';
		$result = DB_Driver::getInstance()->mysql_query('SHOW TABLE STATUS;');
		func_show_sql_error();
		echo '<body onLoad="calcTotal(\'dump_data[]\', \'total_sum\');">'.
			'<form name="dump_action" method="post" action="?action=dbdump">'.
			'<div class="xth" width="100%"><table id="database_tables_header" width="99%" border="0" cellspacing="0" cellpadding="2"><tr>'.
			'<th data-tsorter="table-name" width="40%" class="xthead can-sort">Table</th>'.
			'<th data-tsorter="numeric" width="15%" class="xthead can-sort">Rows</th>'.
			'<th data-tsorter="numeric" width="15%" class="xthead can-sort">Size, Mb</th>'.
			'<th width="15%" class="xthead">Dump structure&nbsp;'.
			func_print_inputbox('checkbox','check_struct', 0, false, "checkAll('check_struct', 'dump_struct[]')").'</th>'.
			'<th width="15%">Dump data&nbsp;'.
			func_print_inputbox('checkbox','check_data', 0, false,
			"checkAll('check_data', 'dump_data[]');calcTotal('dump_data[]', 'total_sum');").'</th>'.
			'</tr></table></div>'.
			'<div class="xtb"><table id="database_tables" width="100%" border="0" cellspacing="0" cellpadding="2">';

		$total_size = 0;
		$num = 0;
		$exclude_tables = explode(',', str_replace(' ', '',SUPPORT_EXCLUDE_TABLES));
		$dump_data = func_get_cookie('dump_data', null);
		$dump_data = (empty($dump_data)) ? null : explode(',', $dump_data);
		$dump_struct = func_get_cookie('dump_struct', null);
		$dump_struct = (empty($dump_struct)) ? null : explode(',', $dump_struct);
		while($row = DB_Driver::getInstance()->mysql_fetch_array($result)) {
			$class = ($num % 2 == 0) ? 'xtr1' : 'xtr2';
			$data_len = isset($row['Data_length']) ? round($row['Data_length']/SUPPORT_MB, 2) : 0;
			$index_len = isset($row['Index_length']) ? round($row['Index_length']/SUPPORT_MB, 2) : 0;
			$rows = isset($row['Rows']) ? $row['Rows'] : 0;
			$row_total = $data_len + $index_len;
			$total_size = $total_size + $row_total;
			if (empty($dump_data)) {
				$check_data_dump = true;
				foreach ($exclude_tables as $pattern) {
					$pattern_dump = ((strpos($row['Name'], $pattern) === false) && ($rows>0)) ? true : false;
					$check_data_dump = $check_data_dump && $pattern_dump;
				}
			} else {
				$check_data_dump = (in_array($row['Name'], $dump_data)) ? true : false;
			}
			if (isset($dump_struct)) {
				$check_data_struct = (in_array($row['Name'], $dump_struct)) ? true : false;
			} else {
				$check_data_struct = true;
			}

			echo '<tr class="'.$class.'">'.
				'<td width="40%"><b>'.$row['Name'].'</b></td>'.
				'<td width="15%" align="right">'.$rows.'</td>'.
				'<td width="15%" align="right">'.$row_total.
				func_print_inputbox('hidden',$row['Name'].'_size', $row_total).'</td>'.
				'<td width="15%" align="center">'.
				func_print_inputbox('checkbox','dump_struct[]', $row['Name'], $check_data_struct).'</td>'.
				'<td width="15%" align="center">'.
				func_print_inputbox('checkbox', 'dump_data[]', $row['Name'], $check_data_dump,
				"calcTotal('dump_data[]', 'total_sum')").'</td>'.
				'</tr>';
			$num ++;	
		}

		$filename = sprintf('%s_%s.sql', $support_data['data']['sql_db'], date('Y_m_d'));
		echo '</table></div>';
		echo '<div style="text-align:right;padding:5px;"> Total size:&nbsp;'.
		func_print_inputbox('input', 'total_sum', 0, 0, '', 1, 'xdisabled').'</div>';
		echo '<div style="text-align:left;padding:5px;">'.
		func_print_inputbox('hidden','action', 'compress_dump').
		'<fieldset style="float:left;width:47%;padding:5px;">'.
		'<legend>Compress and save dump</legend>'.
		'<table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td>'.
		'<label for="dumppath">Path to save dump</label>:</br>'.
		'<td><input name="dumppath" id="dumppath" value="'.$path.'" type="text" size="30"></td></tr>'.
		'<tr><td>Filename:</td><td>'. func_print_inputbox('hidden','src_filename', $filename).
		func_print_inputbox('input','filename', $filename, 0, '', 1, 'xreadonly').'</td></td>'.
		'<tr><td colspan="2"><small><b>Note:</b> web server must have access to write to this directory</small></td></tr>'.
		'<tr><td>Compression:</td>'.
		'<td><input name="compression" value="none" id="radio_compression_none" checked="checked" type="radio" onclick="changeCompress(\'\');">'.
		'<label for="radio_compression_none">None</label>&nbsp;&nbsp;'.
		'<input name="compression" value="gzip" id="radio_compression_gzip" type="radio" onclick="changeCompress(\'.gz\');">'.
		'<label for="radio_compression_gzip">"gzipped"</label>&nbsp;&nbsp;'.
		'<input name="compression" value="bzip" id="radio_compression_bzip" type="radio" onclick="changeCompress(\'.bz2\');">'.
		'<label for="radio_compression_bzip">"bzipped"</label>'.
		'</td></tr>'.
		'<tr><td colspan="2">'.
		func_print_inputbox('button', 'save_sql_btn', 'Compress & save dump', false, "xAction('dump_action', 'compress_dump');").
		'</tr></td>'.
		'</table>'.
		'</fieldset>'.
		'<fieldset style="float:right;width:47%;padding:5px;">'.
		'<legend>Download sql dump</legend>'.
		'<table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td>'.
		'<small><b>Note:</b> total size must be less than 2Mb</small></td></tr><tr><td>'.
		func_print_inputbox('button', 'download_sql_btn', 'Download SQL dump', false, "xAction('dump_action', 'download_sql');").
		'</td></tr></table>'.
		'</fieldset>'.
		'</div>';

		echo '</form></body>';
		


} // }}}

function _tab_dbinfo(&$params) // {{{
{
	global $support_data, $software;

	extract(Preparator::$prefetch);

	func_display_switch_to_sw_db();

	$_tmp = $support_data['data'];
	$readonly = empty($dbs) ? '' : 'readonly="readonly"';
?>
<TABLE class="central_table">
<TR valign="top">
	<TD>
		<FORM name="details" action="<?php echo SUPPORT_NAME; ?>" method="POST">
		<input type="hidden" name="tab" value="dbinfo" />
		<input type="hidden" name="params[mode]" value="db_connect" />
		<TABLE>
		<TR><TH colspan="2">MySQL details</TH></TR>
		<TR>
			<TD><label for="sql_host">MySQL host</label><INPUT id="sql_host" type="text" name="params[sql_host]" value="<?php pr( @$_tmp['sql_host']); ?>"></TD>
		</TR>
		<TR>
			<TD class="L"><label for="sql_user">MySQL user</label><INPUT id="sql_user" type="text" name="params[sql_user]" value="<?php pr( @$_tmp['sql_user']); ?>"></TD>
		</TR>
		<TR>
			<TD class="L"><label for="sql_pswd">MySQL password</label><INPUT id="sql_pswd" type="text" name="params[sql_pswd]" value="<?php pr( @$_tmp['sql_pswd']); ?>"></TD>
		</TR>
		<TR class="buttons">
			<TD>
				<input type="submit" value="Login" />
			</TD>
		</TR>
		<TR>
			<TD><?php echo "Client version:<br />$c_ver"; ?></TD>
		</TR>
		<TR>
			<TD><?php echo "Server version:<br />$s_ver"; ?></TD>
		</TR>
		<TR>
			<TD><?php echo "Current DB Driver: $driver"; ?></TD>
		</TR>
		<TR class="buttons">
	<TD>
		<!--
		Undocumented feature
		<a href="<?php echo SUPPORT_NAME; ?>?tab=xcart_stat" name="xcart_stat">X-Cart statistics</a>
		-->
	</TD>
		</TR>
		</TABLE>
		</FORM>
	</TD>
	<TD>
		<FORM name="dbs" action="<?php echo SUPPORT_NAME; ?>" method="POST">
		<input type="hidden" name="tab" value="dbinfo" />
		<input type="hidden" name="params[mode]" value="ch_db" />
		<TABLE>
		<TR><TH colspan="2">MySQL databases</TH></TR>
		<TR>
			<TD class="L"><label for="sql_db">MySQL DB:</label><INPUT id="sql_db" type="text" name="params[sql_db]" value="<?php pr( @$_tmp['sql_db']); ?>"<?php echo $readonly; ?> /></TD>
		</TR>
		<TR><TD COLSPAN=2>
				<SELECT class="select" id="dbs" size="15" name="params[sql_db]">
<?php
			foreach ($dbs as $db) { ?>
					<option value="<?php pr( @$db); ?>"<?php if ($db == @$_tmp['sql_db']) echo " selected='selected' class='current_db'"; ?>><?php pr($db); ?></option>
<?php	} ?>
				</SELECT>
			</TD>
		</TR><TR class="buttons">
			<TD>
				<input type="submit" value="select" />
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("status");
?>
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("drop");
?>
			</TD>
		</TR>

		</TABLE>
		</FORM>
	</TD>
	<TD>
		<FORM name="tbls" action="<?php echo SUPPORT_NAME; ?>" method="POST">
		<input type="hidden" name="tab" value="dbinfo" />
		<input type="hidden" name="params[mode]" value="ch_tbls" />
		<TABLE>
		<TR><TH>MySQL tables</TH></TR>
		<TR>
			<TD>
				<SELECT class="select" id="tbls" size="15" multiple name="params[sql_tbls][]">

<?php
/*
			if (empty($_tmp['sql_tbls'])) $_tmp['sql_tbls'] = array();
*/
			if (isset($tbls))
				foreach ($tbls as $tbl) {
					echo "<option value='$tbl'>$tbl</option>\n";
				} ?>
				</SELECT>
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("check");
func_display_table_action("repair");
?>
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("optimize");
func_display_table_action("analyze");
?>
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("innodb");
func_display_table_action("myisam");
?>
			</TD>
		</TR><TR class="buttons">
			<TD>
<?php
func_display_table_action("drop");
?>
			</TD>
		</TR>
		</TABLE>
		</FORM>
	</TD>
</TR>
</TABLE>
<?php
} // }}}

function _tab_lcfp(&$params) // {{{
{
	_software_is_found('lc');
	echo "<A HREF=\"".SUPPORT_NAME."?action=login_lc\" target=_blank>Login to the Admin Area</A>";
} // }}}

function _tab_lc3($params) // {{{
{
	global $support_data;

	_software_is_found('lc3');
	echo 'LiteCommerce 3 [' . ($support_data['lc3_is_standalone'] ? 'stand-alone' : 'Ecommerce CMS') . ']<br />';
	echo 'Core version: ' . func_get_lc3_core_version();
	func_show_lc3_modules($params);
	func_show_lc3_users_form($params);
} // }}}

function _tab_sns(&$params) // {{{
{
	global $support_data;

	_software_is_found('sns');
	$tmp =& $support_data["sns_data"];
	$collector = $support_data["sns_prefix"]."chat.php?passphrase=".urlencode($tmp["passphrase"]);
	echo "passphrase=\"".$tmp["passphrase"]."\"<br />";
	echo "<A HREF=\"$collector&command=getGeneration\">getGeneration</A><br />";
	echo "<A HREF=\"$collector&command=getSettings\">getSettings</A><br />";
} // }}}

function _tab_xcfp(&$params) // {{{
{
	global $support_data;

	_software_is_found('xc');
	func_print_sw_data();

	if ($support_data['xc_installed']) {
		$xcart_ver = func_get_db_version();
		echo <<<EOL
<div>
Database version: $xcart_ver[db_version]
</div>
EOL;
		if (empty($params['query'])) $params['query'] = '.*';
		if (empty($params['usertype'])) $params['usertype'] = 'X';
		$params['ver'] = $xcart_ver['version'];
		$params['query'] = trim($params['query']);

		func_display_search_users_form($params);
		func_show_xcart_customers($params);
	}
} // }}}

function _tab_email(&$params) // {{{
{
	global $support_data;
	$ffrom = 'webmaster@'.func_get_var('SERVER_NAME', 'SERVER');
	$rcpt = SUPPORT_LOGIN.'@x-cart.com';

?>
<TABLE class="central_table">
<TR valign="top">
	<TD>

<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>?tab=email" method="POST">
<input type="hidden" name="action" value="php_mail_params" />
<TABLE>
<TR>
	<TH colspan="2">PHP Settings</TH>
</TR>
<?php
if (!SUP_IS_WINDOWS)
{ ?>
<TR>
	<TD class="L">sendmail_path</TD>
	<TD class="R">
		<?php echo ini_get("sendmail_path"); ?>&nbsp;</TD>
</TR>
<?php
} else {
?>
<TR>
	<TD class="L">sendmail_from</TD>
	<TD class="R">
		<INPUT type="text" size="30" name="params[sendmail_from]" value="<?php pr($support_data['sendmail_from']);?>">
	</TD>
</TR>
<TR>
	<TD class="L">SMTP</TD>
	<TD class="R">
		<INPUT type="text" size="30" name="params[SMTP]" value="<?php pr($support_data['SMTP']);?>">
	</TD>
</TR>
<TR>
	<TD class="L">smtp_port</TD>
	<TD class="R">
		<INPUT type="text" size="30" name="params[smtp_port]" value="<?php pr($support_data['smtp_port']);?>">
	</TD>
</TR>
<TR>
	<TD colspan=2>
	<input type="submit" value="Set" />
	</TD>
</TR>
<?php
};
?>
</TABLE>
</FORM>
</TD>

<TD>
<FORM name="cmd" action="<?php echo SUPPORT_NAME; ?>?tab=email" method="POST">
<input type="hidden" name="action" value="email" />
<TABLE>
<TR>
	<TH colspan="2">Test form</TH>
</TR>
<TR>
	<TD class="L">From</TD>
	<TD class="R"><INPUT type="text" size="30" name="params[from]" value="<?php pr(@$support_data['from']);?>"></TD>
</TR>
<TR>
	<TD class="L">-f&nbsp;From</TD>
	<TD class="R"><INPUT type="text" size="30" name="params[ffrom]" value="<?php pr($ffrom);?>"></TD>
</TR>
<TR>
	<TD class="L">To</TD>
	<TD class="R"><INPUT type="text" size="30" name="params[rcpt]" value="<?php pr($rcpt);?>"></TD>
</TR>
<TR>
	<TD class="L">Subject</TD>
	<TD class="R"><INPUT type="text" size="30" name="params[subj]" value="<?php pr(@$support_data['subj']);?>"></TD>
</TR>
<TR>
</TR>
<TR>
	<TD class="L">Body</TD>
	<TD class="R"><TEXTAREA name="params[body]" rows="5" cols="30"><?php pr(@$support_data['body']);?></TEXTAREA></TD>
</TR>
<TR>
	<TD class="L">Mode:</TD>
	<TD class="R">
<?php
$modes = array("default" => "default", "simple" => "simple", "fkey" => "with -f key");
func_display_options("params[mode]", $modes, @$support_data["mode"]);
?>
	</TD>
</TR>

<TR>
<TD colspan=2>
<input type="submit" value="Send" />
</TD>
</TR>
</TABLE>
</FORM>
	</TD>
</TR>
</TABLE>
<?php
} // }}}

//  #################
//
// Database functions
//
//  #################

function func_ex_q($str, $show_stat = TRUE) // {{{
{
	if (empty($str)) return;
	if (!func_mysql_connect()) {
		return;
	}

	$res = DB_Driver::getInstance()->mysql_query($str);

	func_show_sql_error();

	if ($res && $show_stat) echo "<br /><B>Affected rows: </B>".DB_Driver::getInstance()->mysql_affected_rows()."\n";
	if ($res) {
		$qarr = DB_Driver::getInstance()->mysql_fetch_assoc($res);
		if (FALSE !== $qarr) {
		echo "<TABLE border=1 cellspacing=0 cellpadding=2>";
		echo "<TR><TH>";
		echo implode("</TH><TH>", array_keys($qarr));
		echo "</TH></TR>";
			do {
				$a = _func_array_map('htmlspecialchars', $qarr);
				echo "<TR>\n<TD><pre>".implode("</pre></TD><TD><pre>", $a)."</pre></TD>\n</TR>\n";
			} while ($qarr = DB_Driver::getInstance()->mysql_fetch_assoc($res));
		echo "</TABLE><br />";
		}
	}
} // }}}

function func_display_switch_to_sw_db() // {{{
{
	global $software, $support_data;
?>

	<form name='switch_to_sw_db' method='post' action='<?php echo SUPPORT_NAME; ?>?action=use'>
<?php
	foreach ($software as $sw => $product) {
			$e = (
				empty($support_data[$sw.'_found'])
				&& empty($support_data[$sw.'_installed'])
			) ? ' disabled' : '';

			echo "<input type=submit name='params[$sw]' value='Use $product settings'$e>\n";
	}
	echo "</form>\n";
} // }}}

function func_dbinfo_exec_db_query(&$params) // {{{
{
	global $support_data;

	if (empty($params['query'])) return false;
	$q = $params['query'];
	if (empty($params['sql_db'])) {
		$db = $support_data["data"]["sql_db"];
	} else {
		$db = trim(stripslashes($params['sql_db']));
	}

	if (empty($db)) return false;
	switch($q) {
		case "status":	$query = "SHOW TABLE STATUS"; break;
		case "drop":	$query = "DROP DATABASE ".$db; break;
		default: return false;
	}

	func_ex_q($query);
} // }}}

function func_dbinfo_exec_table_query(&$params) // {{{
{
	if (empty($params['query'])) return false;
	$q = $params['query'];
	if (empty($params['sql_tbls'])) return false;
	$group_action = TRUE;
	switch($q) {
		case "check":		$query = "CHECK TABLE `%s`"; break;
		case "repair":		$query = "REPAIR TABLE `%s`"; break;
		case "optimize":	$query = "OPTIMIZE TABLE `%s`"; break;
		case "analyze":	 	$query = "ANALYZE TABLE `%s`"; break;
		case "innodb":		$query = "ALTER TABLE `%s` ENGINE=INNODB"; $group_action = FALSE; break;
		case "myisam":		$query = "ALTER TABLE `%s` ENGINE=MYISAM"; $group_action = FALSE; break;
		case "drop":		$query = "DROP TABLE `%s`"; break;
		default: return false;
	}

	if (func_mysql_db_select()) {
		func_ex_q_batch($query, $params['sql_tbls'], $group_action);
	}
} // }}}

function func_ex_q_batch(&$query, $sql_tbls, $group_action) // {{{
{
	if ($group_action) {
		$tbls = implode('`, `', $sql_tbls);
		func_ex_q(sprintf($query, $tbls));
	} else {
		foreach ($sql_tbls as $tbls) {
			func_ex_q(sprintf($query, $tbls));
		}
	}
} // }}}

function func_parse_db_mode(&$params) // {{{
{
	global $support_data;

	if (is_array($params) && isset($params['mode'])) {
	    $mode =& $params['mode'];
	}

	if (empty($mode)) return;
	switch($mode) {
		case "ch_tbls":
			func_dbinfo_exec_table_query($params);
			break;
		case 'db_connect':
			$sql_host = trim(stripslashes($params['sql_host']));
			$sql_user = trim(stripslashes($params['sql_user']));
			$sql_pswd = trim(stripslashes($params['sql_pswd']));
			$support_data['data']['sql_host'] = $sql_host;
			$support_data['data']['sql_user'] = $sql_user;
			$support_data['data']['sql_pswd'] = $sql_pswd;
			$support_data['data']['sql_db'] = '';
			break;
		case "ch_db":
			if (empty($params['sql_db'])) $params['sql_db'] = @$params['force_sql_db'];
			$db = trim(stripslashes($params['sql_db']));
			$support_data['data']['sql_db'] = $db;
			if (func_mysql_db_select()) {
				func_dbinfo_exec_db_query($params);
			}

			break;
		default:
			_message_set('Unknown mode: '.$mode, SUP_MSG_TYPE_CRIT);
			break;
	}
} // }}}

function func_display_table_action($name, $disabled = '') // {{{
{
	if ($disabled) {
		$disabled = " disabled=$disabled";
	}

	echo "<input type='submit' name='params[query]' value='$name'$disabled />";
} // }}}

function func_get_lc3_core_version() // {{{
{
	if (!func_mysql_connect()) {
		return;
	}

	$q = "SELECT value FROM ".XC5_PREFIX."config WHERE name='version'";
	$r = DB_Driver::getInstance()->mysql_query($q);
	if (FALSE !== $r) {
		return DB_Driver::getInstance()->mysql_result($r, 0);
	}

	return 'n/a';
} // }}}

function func_show_lc3_modules($params) // {{{
{
	$s = SUPPORT_NAME;
	echo "<hr />\n<h3>Modules</h3>\n";

	if (!isset($params['modules_info'])) {

	echo <<<EOT
<form method="POST" action="$s?tab=lc3">
<input type="hidden" name="params[modules_info]" />
<input type="submit" value=" Show " />
</form>
EOT;

	} else {
		func_show_lc3_modules_list();
	}
} // }}}

function func_show_lc3_modules_list() // {{{
{
	if (!func_mysql_db_select()) {
		return;
	}

	$q = 'SELECT name, enabled, author FROM '.XC5_PREFIX.'modules ORDER BY enabled DESC, author, name';
	$r = DB_Driver::getInstance()->mysql_query($q);
	func_show_sql_error();

	if ($r !== false) {

		echo <<<EOT
<table cellpadding="0" cellspacing="1" border="1">
<tr>
	<th>Module</th>
	<th>Author</th>
	<th>Enabled</th>
</tr>
EOT;
		while ($row = DB_Driver::getInstance()->mysql_fetch_assoc($r)) {
			echo "<tr>\n";
			echo "<td>$row[name]</td>\n";
			echo "<td>$row[author]</td>\n";
			echo "<td>".($row['enabled'] == 1 ? 'Yes' : 'No')."</td>\n";
			echo "</tr>\n";
		}
		echo "</table>\n";
	}
} // }}}

function func_show_lc3_users_form($params) // {{{
{
	$s = SUPPORT_NAME;
	$pattern = isset($params['pattern']) ? $params['pattern'] : '';
	$user_type = isset($params['user_type']) ? $params['user_type'] : 'A';
	echo <<<EOT
<hr />
<h3>Search for user</h3>
<form method="POST" action="$s?tab=lc3">
<div>
<label for="params[pattern]">Pattern:</label>
<input type="text" name="params[pattern]" value="$pattern" />
</div>
<div>
<label for="params[user_type]">Type:</label>
<select name="params[user_type]">
EOT;
echo '<option value="A"'.($user_type == 'A' ? 'selected = "selected"' : '').'>Administrator</option>';
echo '<option value="C"'.($user_type == 'C' ? 'selected = "selected"' : '').'>Customer</option>';

echo <<<EOT
</select>
</div>
<input type="submit" value=" Search " />
</form>
EOT;
	func_show_lc3_users_list($params);
} // }}}

function func_show_lc3_users_list($params) // {{{
{
	global $support_data;

    if (!is_array($params)) $params=array();

	if (!func_mysql_db_select()) {
		return;
	}

	if (!isset($params['pattern'])) $params['pattern'] = '';
	if (!isset($params['user_type'])) $params['user_type'] = 'A';

	$roles_join = '';
	$profile_id_field = $support_data['lc3_is_standalone'] ? 'profile_id' : 'cms_profile_id';
	
	if ($params['user_type'] == 'A') 
		$roles_join = "LEFT JOIN " . XC5_PREFIX . "profile_roles as pr ON pr.profile_id=p.profile_id LEFT JOIN " . XC5_PREFIX . "role_permissions as rp ON rp.role_id=pr.role_id";	

	$q = "SELECT p.login, p.$profile_id_field FROM ".XC5_PREFIX."profiles as p $roles_join WHERE p.status='E'";
	$q .= " AND p.access_level='".($params['user_type'] == 'A' ? '100' : '0')."' AND p.order_id IS NULL";
	if ($params['user_type'] == 'A') 
		$q .= " AND (pr.role_id IS NULL OR rp.permission_id = 1)";
	if ($params['pattern'] != '') $q .= " AND p.login REGEXP '".stripslashes($params['pattern'])."'";
	$q .= ' ORDER BY p.login';

	$res = DB_Driver::getInstance()->mysql_query($q);
	func_show_sql_error();

	if ($res !== false) {
		echo '<ul>';
		while ($row = DB_Driver::getInstance()->mysql_fetch_assoc($res)) {
			$href = SUPPORT_NAME . '?action=login_lc3&amp;type='.$params['user_type'].'&amp;id=' . $row[$profile_id_field];
			echo "<li>$row[login]&nbsp;&nbsp;&nbsp;<a href=\"$href\" target=\"_blank\">Login >>></a></li>\n";
		}
		echo "</ul>\n";
	}
} // }}}

function func_lc3_login($id, $type) // {{{
{
	global $support_data;
	
	if ($support_data['lc3_is_standalone']) {
		// Stand-alone version
		$include_path = $support_data['lc3_path'];
		$old_path = ini_get('include_path');
		ini_set('include_path', $old_path.PATH_SEPARATOR.$include_path);

		require_once $include_path.'top.inc.php';
		eval('XLite::getInstance()->run($type == "A");\XLite\Core\Session::getInstance()->profile_id = $id;');
		//XLite::getInstance()->processRequest();

		$location = "http://" . $support_data['lc3_data']['http_host'] . $support_data['lc3_data']['web_dir'] . ($type=='A' ? '/admin.php' : '/cart.php');
	
	} elseif (isset($support_data['lc3_drupal_path'])) {
		// Drupal + LC
		define('DRUPAL_ROOT', $support_data['lc3_drupal_path']);
		@require_once DRUPAL_ROOT . '/includes/bootstrap.inc';
		@drupal_bootstrap(DRUPAL_BOOTSTRAP_FULL);

		$form_state = array();
		$form_state['uid'] = $id;
		user_login_submit(array(), $form_state);

		$location = $support_data['lc3_drupal_path'];
	}

	header('Location: '.$location);
	exit;
} // }}}

function func_password_decrypt($s, $ver) // {{{
{
	global $support_data;

	if ($ver == '40') {
		$c_code = @$support_data['xc_data']['START_CHAR_CODE'];
		$s_code = @$support_data['xc_data']['CRYPT_SALT'];
		if (empty($c_code)) $c_code = 100;
		if (empty($s_code)) $s_code = 85;
		return func_text_decrypt($s, $c_code, $s_code);
	}

	if ($ver == '41') {
		$blowfish_key = @$support_data['xc_data']['blowfish_key'];
		if (empty($blowfish_key)) {
			$blowfish_key ='6dae34827395b5cfbeb38f21d0a32d3e';
		}

		return text_decrypt($s, $blowfish_key);
	}

	return $s;
} // }}}

function func_get_db_version() // {{{
{
	static $data = array(
		'db_version' => NULL,
		'version' => NULL,
	);

	if (!is_null($data['db_version']))
		return $data;

	$data['db_version'] = '';
	if (!func_mysql_db_select())
		return $data;

	$r = DB_Driver::getInstance()->mysql_query('SELECT value FROM xcart_config WHERE name="version"');
	if (DB_Driver::getInstance()->mysql_check_empty($r)) {
		$r = DB_Driver::getInstance()->mysql_query('SHOW TABLES LIKE xcart_config');
		if (DB_Driver::getInstance()->mysql_check_empty($r)) {
			_message_set('No x-cart tables found in the database', SUP_MSG_TYPE_WARN);
		} else {
			_message_set('No VERSION data in the database', SUP_MSG_TYPE_WARN);
		}

		return $data;
	}

	$data['db_version'] = DB_Driver::getInstance()->mysql_result($r, 0);
	if (preg_match('/(\d+)\.(\d+)\.*(\d+)*/', $data['db_version'], $xcart_branch)) {
		if ($xcart_branch[1] == 4 && $xcart_branch[2] == 0 || $xcart_branch[1] < 4) {
			$data['version'] = "40";
		} else {
			$data['version'] = "41";
		}
	} else {
		$data['version'] = "40";
	}

	return $data;
} // }}}

function compareVersion($ver_str1, $ver_str2) // {{{
{
	$numbers1 = explode('.', $ver_str1);
	$numbers2 = explode('.', $ver_str2);
	return compareArrayVersion($numbers1, $numbers2);
} // }}}

function compareArrayVersion($ver1, $ver2) // {{{
{
	if (empty($ver1) && empty($ver2)) {
		return 0;
	}

	if (empty($ver1)) {
		$ver1 = array(0);
	}
	
	if (empty($ver2)) {
		$ver2 = array(0);
	}

	$v1 = intval(reset($ver1));
	$v2 = intval(reset($ver2));
	if ($v1 < $v2) {
		return -1;
	} elseif ($v1 > $v2) {
		return 1;
	} else {
		unset($v1); unset($v2);
		array_shift($ver1); array_shift($ver2);
		return compareArrayVersion($ver1, $ver2);
	}
} // }}}

function _software_is_found($soft) // {{{
{
	global $support_data, $software;

	if (!$support_data[$soft.'_found']) {
		$support_data['tab'] = 'summary';
		$software = $software[$soft];
		_message_set("$software not found", SUP_MSG_TYPE_CRIT);
		func_sup_header_location();
	}
} // }}}

function func_display_options($option_name, $options, $selected = "") // {{{
{
$o1 = "<SELECT name='%s'>\n";
$o2 = "<option value='%s'%s>%s</option>\n";
$o3 = "</SELECT>\n";
printf($o1, $option_name);
foreach ($options as $type => $name) {
	$sel = $selected == $type ? " selected='selected'" : '';
	printf($o2, $type, $sel, $name);
	}
echo $o3;
} // }}}

function func_display_search_users_form(&$params) // {{{
{
	$user_types = array(
		"A" => "Admin",
		"B" => "Partner",
		"C" => "Customer",
		"P" => "Provider",
		"*" => "Any",
		"X" => "Autodetect admin",
	);

	$versions = array(
		"40" => "4.0.x or 3.5.x",
		"41" => "4.1.x or later",
	);

$p = <<<EOF
<div>
<FORM name="cmd" action="%s?tab=xcfp" method="POST">
	<div>
	<label for="query">Search for login</label><INPUT id="query" type="text" size="20" name="params[query]" value="%s" />
	</div>

	<div>
	<label for="usertype">Type</label>
EOF;
printf($p, SUPPORT_NAME, $params["query"]);
$_text1 = func_display_options("params[usertype]", $user_types, $params['usertype']);
echo <<<EOL
	</div>

	<div>
	<label for="ver">X-Cart version</label>
EOL;
$_text2 = func_display_options("params[ver]", $versions, $params['ver']);
echo <<<EOL
	</div>

	<div class="button">
	<input type="submit" value="Search" />
	</div>
</FORM>
</div>
EOL;
} // }}}

function func_init_blowfish($path) // {{{
{
	global $blowfish, $encryption_types;

	define('XCART_START', 1);
	define('XC_TIME', time());

	require_once("$path/include/blowfish.php");
	$blowfish = new ctBlowfish();
	require_once($path."include/func/func.crypt.php");
	require_once($path."include/func/func.core.php");
	if (!function_exists("func_microtime")) {
		function func_microtime() {
			list($usec, $sec) = explode(" ",microtime());
			return ((float)$usec + (float)$sec);
		}
	}
} // }}}

function func_show_xcart_customers(&$params) // {{{
{
	global $support_data;

	if (!func_mysql_db_select())
		return;

	$_tmp =& $support_data['xc_data'];
	if ($params['query']) {
		$q = "SELECT login, password, usertype FROM xcart_customers ";
		if ($params['query']) $q .= "WHERE login REGEXP '".stripslashes($params['query'])."'";
		if ($params['usertype'] == 'X') {
				$saveq = $q;
				$q .= " AND usertype='A' ORDER BY usertype";
		} else if ($params['usertype'] != "*") $q .= " AND usertype='".$params['usertype']."' ORDER BY usertype";
		$res = DB_Driver::getInstance()->mysql_query($q);

		if ($params['usertype'] == 'X' && DB_Driver::getInstance()->mysql_check_empty($res)) {
				$q = $saveq . " AND usertype='P' ORDER BY usertype";
				$res = DB_Driver::getInstance()->mysql_query($q);
		}

	}

	func_show_sql_error();
	$xcart = "http://$_tmp[xcart_http_host]$_tmp[xcart_web_dir]/";

	if ($params['ver'] == "41" || $params['ver'] == "413") @func_init_blowfish($support_data["xc_prefix"]);
	if (!DB_Driver::getInstance()->mysql_check_empty($res)) {
		$show_head = TRUE;
		while ($arr = DB_Driver::getInstance()->mysql_fetch_assoc($res)) {
			if ($show_head) {
				$show_head = FALSE;
				echo "<br />\n<TABLE border=1 cellspacing=0 cellpadding=2>\n";
				echo "<TR><TH>*</TH><TH>\n";
				echo implode("</TH><TH>", array_keys($arr));
				echo "</TH></TR>\n";
			}

			$_password = func_password_decrypt($arr['password'], $params['ver']);
			if (strpos($_password, '$XCHash$') === 0) {
				$arr['password'] = '[hash]';
			} elseif ($_password == $arr['password']) {
				$arr['password'] = '[error]';
			} else {
				$arr['password'] = $_password;
			}

			echo "<TR>\n<TD>";
			func_display_xcart_login_form($xcart, $arr);
			echo "</TD><TD>$arr[login]</TD><TD>$arr[password]</TD><TD>$arr[usertype]</TD>\n</TR>";
		}

		echo "</TABLE></div>\n";
	}
} // }}}

function func_display_xcart_login_form($xcart, $arr) // {{{
{
		$xcart_ver = func_get_db_version();
		$is_after_44 =
			(compareVersion($xcart_ver['db_version'], '4.4') >= 0);

		if ($is_after_44) {
				echo '<form method="GET" action="' . SUPPORT_NAME . '" target="_blank">';
				echo '<input type="hidden" name="action" value="login_xc" />';
				echo "<input type=\"hidden\" name=\"usertype\" value=\"$arr[usertype]\" />";
				echo "<input type=\"hidden\" name=\"username\" value=\"$arr[login]\" />";
				echo "<input type=\"submit\" value=\"login\" />\n";
				echo '</form>';

		} else {
			$path = "include/";
				echo "<form method=\"POST\" action=\"$xcart$path"."login.php\" target=_blank>\n";
				echo "<input type=\"hidden\" name=\"usertype\" value=\"$arr[usertype]\" />\n";
				echo "<input type=\"hidden\" name=\"password\" size=16 value=\"$arr[password]\" />\n";
				echo "<input type=\"hidden\" name=\"mode\" value=\"login\" />\n";
				echo "<input type=\"hidden\" name=\"username\" value=\"$arr[login]\" />\n";
				echo "<input type=\"submit\" value=\"login\" />\n";
				echo "</form>\n";
		}

} // }}}

//  #################
//
//  Display functions
//
//  #################

function _message_display() // {{{
{
	global $_message_data;

	$support_data =& $_message_data;

	if (!empty($support_data[SUP_SESS_OFF_MESS])) {
		echo "<!-- messages box {{{ -->\n";
		foreach ($support_data[SUP_SESS_OFF_MESS] as $message) {
			$msg = htmlentities($message[SUP_SESS_OFF_TEXT]);
			$status =& $message[SUP_SESS_OFF_CODE];
			echo <<<EOL
<div class='message'>
<span class='status $status'>$status:</span>
$msg
</div>

EOL;
		}

		unset($support_data[SUP_SESS_OFF_MESS]);
		echo "<!-- messages box }}} -->\n";
	}
} // }}}

function func_display_footer() // {{{
{
	echo "</BODY>\n</HTML>\n";
} // }}}

function func_display_menu($selected = "") // {{{
{
	global $support_data, $software;

	$menu = array(
		'summary'	=> 'Summary',
		'info'		=> 'System info',
		'run'		=> 'Exec & Eval',
 		'db'		=> 'MySQL',
		'dbdump'	=> 'MySQL dump',
		'dbinfo'	=> 'MySQL settings',
		'email'		=> 'Email',
		'xcfp'		=> $software["xc"],
		'lcfp'		=> $software["lc"],
		'lc3'		=> $software["lc3"],
		'sns'		=> $software["sns"],
	);

?>
<!-- main menu {{{ -->
<div class='menu'>
<?php
	$tab = $support_data['tab'];
	foreach ($menu as $tab => $name) {
		$href = SUPPORT_NAME."?tab=$tab";
		$class = $selected == $tab ? ' class="selected"' : '';
		echo "<a href=\"$href\"$class>$name</a>\n";
	}
?>
</div>
<!-- main menu }}} -->
<!-- tips {{{ -->
<div class='tips'>
<?php
if (!defined('SUPPORT_DEBUG')) {
	eval('');
}
?>

</div>
<!-- tips }}} -->
<!-- expiration {{{ -->
<div class='message'>
<FONT color="blue">Expiration Date: </FONT><?php if (EXPIRATIONTIME != '%'.'ExpirationTime'.'%') {date('d M Y H:i', EXPIRATIONTIME);} else {echo 'not defined';} ?>  
</div>
<!-- expiration }}} -->
<?php
} // }}}

function func_display_auth_form() // {{{
{
	global $support_data;

if ($support_data['support_counter'] > SUPPORT_MAX_LOGIN_ATTEMPTS) return;
?>
<b><p>X-Cart company Support team uses this script for remote access to your server.<br /> This script was placed on your server because you ordered support service at our corporate site.<br /> After the work on your server is done this script can be deleted.
</p>
<p>If you have any questions please feel free to ask them through the <a href='https://secure.x-cart.com/'>Support Helpdesk</a></p></b>
<FORM action="<?php echo SUPPORT_NAME; ?>" method="POST">
<input type="hidden" name="action" value="login" />
Login: <input type="text" name="params[support_login]" value="" id="login_area" />&nbsp;&nbsp;
Password: <input type="password" name="params[support_password]" value="" />&nbsp;&nbsp;
<input type="submit" value="Login" />
</FORM>
<SCRIPT>
<!--
document.getElementById('login_area').focus();
-->
</SCRIPT>
<?php
} // }}}

function func_print_colored($msg = "", $cond = TRUE, $succ = "GREEN", $fail = "RED") // {{{
{
	$e = "<FONT color=\"";
	$e .= func_get_color($cond, $succ, $fail);
	$e .= "\">$msg</FONT>\n";
	return $e;
} // }}}

function func_get_color($cond = TRUE, $succ = "GREEN", $fail = "RED") // {{{
{
	return $cond ? $succ : $fail;
} // }}}

function func_on_off($var) // {{{
{
	if ($var == '0') return '<FONT color="red">Off</font>';
	if ($var == '1') return '<FONT color="green">On</FONT>';
	if (empty($var)) return '&nbsp;';
	return $var;
} // }}}

function func_not_found($var) // {{{
{
	if (empty($var)) return '<FONT color="red">Not found</font>';
	return $var;
} // }}}

//  #################
//
//  Tests
//
//  #################

function func_sup_find_executable($filename, $prefered_file = false) // {{{
{
	global $support_data;

	if ($prefered_file) {
		if (func_sup_is_executable($prefered_file)) return $prefered_file;
		$prefered_file .= ".exe";
		if (func_sup_is_executable($prefered_file)) return $prefered_file;
	}

	$path_sep = preg_match('/^WIN/i', PHP_OS) ? ';' : ':';

	$directories = explode($path_sep, func_get_var('PATH', 'SERVER'));
	if (!empty($support_data['xc_prefix']))
		array_unshift($directories, $support_data['xc_prefix']."payment");

	foreach ($directories as $dir) {
		$file = $dir.DIRECTORY_SEPARATOR.$filename;
		if (func_sup_is_executable($file)) return $file;
		$file .= ".exe";
		if (func_sup_is_executable($file)) return $file;
	}
	return false;
} // }}}

# Bouncers test functions {{{
function _envtest_perl($details = false) {
	$perl_binary = func_sup_find_executable("perl");
	if ($perl_binary) {
		@exec("$perl_binary -e \"print $];\"", $output);
		if (!empty($output[0])) {
			if ($details) {
				exec("$perl_binary -V", $output);
				return implode("<br>", $output);
			}
			return $output[0];
		}
	}
	return '';
}

function _envtest_ssleay() {
	$script = "require Net::SSLeay; Net::SSLeay->import(qw(get_https post_https sslcat make_headers make_form)); print Net::SSLeay->VERSION;";
	$perl_binary = func_sup_find_executable("perl");
	if ($perl_binary) {
		@exec("$perl_binary -w -e \"$script\"", $output);

		if (!empty($output))
			return $output[0];
	}
	return '';
}

function _envtest_libcurl() {
	if (function_exists('curl_init')) {
		$ver = func_curl_version();
		if (is_array($ver))
			$version = 'libcurl/'.$ver['version']." ".$ver['ssl_version'];
		else
			$version = $ver;

		if (stristr($version, 'ssl'))
				return "OK: $version";
		else
				return "FAIL: $version";
	}
	return '';
}

function _envtest_curl() {
	$curl = func_sup_find_executable('curl');
	if ($curl) {
		@exec("$curl --version", $output);
		if (!empty($output) && stristr($output[0], 'ssl'))
			return $output[0];
	}
	return '';
}

function _envtest_openssl() {
	$bin = func_sup_find_executable('openssl');
	if ($bin)
		 return @exec("$bin version");

	return '';
}

function _envtest_httpscli() {
	$cli = func_sup_find_executable('https_cli');
	if ($cli)
		 return $cli;

	return '';
}
# }}}

function func_exec($cmd, $mode = 'exec', &$out, $method = 'exec', $ai = false) // {{{
{
	global $run_methods;

	$out = '';
	$ret = -100;
	if (empty($cmd)) return $ret;
	if ($mode == 'exec') {
		if (empty($run_methods[$method]))
			$out = "Unknown or disabled method";
		else {
			switch ($method) {
				case 'exec':
					ob_start();
					exec($cmd, $_tmp, $ret);
					$out = ob_get_contents();
					ob_end_clean();
					if (!empty($_tmp)) $out .= implode("\n", $_tmp);
					break;
				case 'passthru':
				case 'system':
					ob_start();
					$method($cmd, $ret);
					$out = ob_get_contents();
					ob_end_clean();
					break;
				case 'shell_exec':
					$out = @shell_exec($cmd);
					break;
				case 'proc_open':
					$descriptorspec = array(
						0 => array("pipe", "r"),
						1 => array("pipe", "w"),
						2 => array("pipe", "w"),
					);

					$pipes = array();
					$process = proc_open($cmd, $descriptorspec, $pipes);
					if (is_resource($process)) {
						$out = '';
						fclose($pipes[0]);
						while(!feof($pipes[1])) $out .= fread($pipes[1], 1024);
						fclose($pipes[1]);
						$ret = proc_close($process);
					}
					break;
				case 'popen':
					$f = popen($cmd, "r");
					$out = '';
					if ($f) {
						while(!feof($f)) $out .= fread($f, 1024);
						$ret = pclose($f);
					}
					break;
			}
		}
	} else if ($mode == 'eval') {
		ob_start();
		eval($cmd);
		$out = ob_get_contents();
		ob_end_clean();
		$ret = '';
	}

	return $ret;
} // }}}

function func_text_decrypt($s, $START_CHAR_CODE, $CRYPT_SALT) // {{{
{
	if (ucfirst($s) == $s)
		$s = substr($s, 1);

	$enc = $CRYPT_SALT ^ text_decrypt_symbol($s, 0, $START_CHAR_CODE);
	$result = '';

	for ($i = 2; $i < strlen($s); $i += 2) {
		$result .= chr(text_decrypt_symbol($s, $i, $START_CHAR_CODE) ^ $enc++);
		if ($enc > 255) $enc = 0;
	}

	return $result;
} // }}}

function text_decrypt_symbol($s, $i, $START_CHAR_CODE) // {{{
{
	return
		(ord(substr($s, $i, 1)) - $START_CHAR_CODE)*16 +
		ord(substr($s, $i+1, 1)) - $START_CHAR_CODE;
} // }}}

function func_explode($key_str, $separator = ',') // {{{
{
		$list = explode($separator, $key_str);
		$result = array();
		if (is_array($list)) {
			foreach ($list as $key) {
				$result[] = trim($key);
			}
		}
		return $result;
} // }}}

function func_detect_run_methods() // {{{
{
	global $run_methods, $preferred_run_method;

	$run_methods = array(
		"shell_exec" => "1",
		"popen" => "1",
		"proc_open" => "1",
		"system" => "1",
		"passthru" => "1",
		"exec" => "1",
	);

	$disable_functions = @ini_get("disable_functions");
	$disable_functions = @func_explode($disable_functions);

	$preferred_run_method = '';
	if (empty($disable_functions)) $disable_functions = array();

	foreach ($run_methods as $d_func => $v) {
		if (in_array($d_func, $disable_functions)) $run_methods[$d_func] = 0;
		else $preferred_run_method = $d_func;

	}
} // }}}

function func_sup_is_executable($file) // {{{
{
	if (function_exists("is_executable")) return @is_executable($file);
	return @is_readable($file);
} // }}}

function func_fix_path($path) // {{{
{
	$path = trim(stripslashes($path));
	$qs = preg_quote(DIRECTORY_SEPARATOR);
	$path = preg_replace("/[\\\\\/]+/S", $qs, $path);
	if (!empty($path) && (@substr($path, -1, 1) == DIRECTORY_SEPARATOR)) $path = substr($path, 0, -1);
	return $path;
} // }}}

//  #################
//
//  Misc functions
//
//  #################
//
function func_get_var($name = '', $type = 'REQUEST') // {{{
{
	static $register_long_arrays = NULL;
	if (!isset($register_long_arrays)) {
		$register_long_arrays = ini_get('register_long_arrays');
	}

	if ($register_long_arrays) {
		if (isset($GLOBALS['_'.$type]))
			$result = $GLOBALS['_'.$type];
		elseif (isset(${'_'.$type}))
			$result = ${'_'.$type};
		elseif (isset(${'HTTP_'.$type.'_VARS'}))
			$result = ${'HTTP_'.$type.'_VARS'};
		elseif (isset($GLOBALS['HTTP_'.$type.'_VARS']))
			$result = $GLOBALS['HTTP_'.$type.'_VARS'];
		else
		{
			$result = NULL;
		}
	} else {
		switch($type) {
			case 'REQUEST':
				$result = $_REQUEST;
				break;
			case 'SERVER':
				$result = $_SERVER;
				break;
			case 'GET':
				$result = $_GET;
				break;
			case 'POST':
				$result = $_POST;
				break;
			default: $result = NULL;
		}
	}

	if ($name) $result = (isset($result[$name]) ? $result[$name] : NULL);

	return (get_magic_quotes_gpc()
			? $result
			: _func_addslashes($result));
} // }}}

function func_sup_header_location($msg = "", $status = "") // {{{
{
	$vars = array();
	$d = '';
	if (!empty($msg)) {
		$vars[] = "msg=" . urlencode($msg);
		$vars[] = "status=" . urlencode($status);
		$d = "?".implode("&", $vars);
	}

	$location = SUPPORT_NAME.$d;
	if (!headers_sent()) header("Location: ".$location);
	else echo "<META http-equiv=\"Refresh\" content=\"0;URL=$location\">";
	exit;
} // }}}

function _func_addslashes($var) // {{{
{
	return _func_array_map('addslashes', $var);
} // }}}

function _func_stripslashes($var) // {{{
{
	return _func_array_map('stripslashes', $var);
} // }}}

function _func_array_map($func, $var) // {{{
{
	if (!is_array($var)) {
		return call_user_func($func, $var);
	} else {
		foreach ($var as $k => $v) {
			$var[$k] = _func_array_map($func, $v);
		}
		return $var;
	}
} // }}}

function _func_ini_set_param($param, $value) // {{{
{
	global $support_data;

	if (!empty($support_data[$param])) {
		$a1 = ini_set($param, $support_data[$param]);
		$status = $a1 === FALSE ? SUP_MSG_TYPE_CRIT : SUP_MSG_TYPE_WARN;
		$message = $a1 === FALSE ? 'Failed' : $a1;
		_message_set("ini_set('$param', '$support_data[$param]'), $message", $status);
	}
} // }}}

//  #################
//
//  MySQL functions
//
//  #################

function func_mysql_connect() // {{{
{
	static $link, $trigger = TRUE;

	global $support_data;

	if (!isset($link)) {
		$_tmp =& $support_data['data'];
		$link = DB_Driver::getInstance()->mysql_connect($_tmp['sql_host'], $_tmp['sql_user'], $_tmp['sql_pswd']);

		if ($trigger) {
			$trigger = FALSE;
			func_show_sql_error();
		}
	}

	return $link;
} // }}}

function func_mysql_db_select($critical = TRUE) { // {{{
	static $trigger = TRUE;

	global $support_data;

	$_tmp =& $support_data['data'];

	if (func_mysql_connect()) {
            if (empty($_tmp['sql_db'])) {
				if ($trigger) {
					$trigger = FALSE;
					$severity = $critical ? SUP_MSG_TYPE_CRIT : SUP_MSG_TYPE_WARN;
					_message_set('Database is not selected', $severity);
				}

                return FALSE;
            } else {
                $db = DB_Driver::getInstance()->mysql_select_db($_tmp['sql_db']);
				if ($trigger) {
					$trigger = FALSE;
					func_show_sql_error();
				}

                return $db;
            }
	} else {
		return FALSE;
	}
} // }}}

function func_show_sql_error() // {{{
{
	$mysql_errno = DB_Driver::getInstance()->mysql_errno();
	if ($mysql_errno) {
		$mysql_error = DB_Driver::getInstance()->mysql_error();
		_message_set("MySQL error: ($mysql_errno) $mysql_error", SUP_MSG_TYPE_CRIT);
	}
} // }}}

function func_get_path_by_version() // {{{
{
	global $support_data;

	$path = getcwd();
	if (!empty($support_data['xc_prefix'])) {
		$xcart_ver = func_get_db_version();
		if ($xcart_ver['version'] >= 41) {
		$path = $support_data['xc_prefix'].'var'.DIRECTORY_SEPARATOR;
		} else {
			$path = $support_data['xc_prefix'].'log'.DIRECTORY_SEPARATOR;
		}
	} elseif (!empty($support_data['lc_prefix'])) {
		$path = $support_data['lc_prefix'].'var'.DIRECTORY_SEPARATOR.'backup'.DIRECTORY_SEPARATOR;
	}

	return $path;
} // }}}

function func_get_backup_dir() // {{{
{
	global $support_data;

	$dir = '*.php';
	if (!empty($support_data['xc_prefix'])) {
		$xcart_ver = func_get_db_version();
		if ($xcart_ver['version'] >= 42) {
			$dir = '*.php admin/ skin/ customer/ mail/ modules/ payment/ provider/ shipping/ include/ partner/ .htaccess default_image.gif';
		} else {
			$dir = '*.php admin/ skin1/ customer/ mail/ modules/ payment/ provider/ shipping/ include/ partner/ Smarty* .htaccess default_image.gif';
		}
	}

	return $dir;
} // }}}

function func_gen_shell_cmd_sql() // {{{
{
	global $support_data;

	$_tmp =& $support_data['data'];
	if (empty($_tmp['sql_pswd']))
		return array('', '', '');

	$m = '';
	if (!empty($_tmp['sql_host'])) {
		if (FALSE !== strpos($_tmp['sql_host'], ':')) {
			list ($host, $socket) = explode(':', $_tmp['sql_host']);
			if (!empty($host)) {
				$m .= " -h$host";
			}

			if (!empty($socket)) {
				$m .= " -S$socket";
			}
		} else {
			$m .= " -h$_tmp[sql_host]";
		}
	}

	if (!empty($_tmp['sql_user'])) $m .= " -u".$_tmp['sql_user'];
	if (!empty($_tmp['sql_pswd'])) $m .= " -p".$_tmp['sql_pswd'];
	if (!empty($_tmp['sql_db'])) {
		$m .= " ".$_tmp['sql_db'];
	} else {
		$_tmp['sql_db'] = '';
	}

	$str = escapeshellcmd($m)." 2>&1";
	$e = func_get_path_by_version();
	$str2 = escapeshellcmd($m)." 2>&1 1> $e".$_tmp['sql_db'].".backup.sql";
	$str3 = escapeshellcmd($m)." | bzip2 -z 2>&1 1> $e".$_tmp['sql_db'].".backup.sql.bz2";
	return array("mysql".$str, "mysqldump".$str2, "mysqldump".$str3);
} // }}}

function func_list_tables() // {{{
{
	$tbls = array();
	if (!func_mysql_db_select(FALSE)) {
		return $tbls;
	}

	$res = DB_Driver::getInstance()->mysql_query('SHOW TABLES');
	func_show_sql_error();
	if ($res) {
		while ($tmp = DB_Driver::getInstance()->mysql_fetch_row($res)) {
			$tbls[] = $tmp[0];
		}
	}

	return $tbls;
} // }}}

function func_list_databases() // {{{
{
	$dbs = array();
	if (func_mysql_connect()) {
		$res = DB_Driver::getInstance()->mysql_query('SHOW DATABASES');
		func_show_sql_error();
		if ($res) {
			while ($tmp = DB_Driver::getInstance()->mysql_fetch_row($res)) {
				$dbs[] = $tmp[0];
			}
		}
	}

	return $dbs;
} // }}}

function func_prepare_dump_data($dump_struct, $dump_data) // {{{
{
	global $support_data;

	if (empty($dump_struct) && empty($dump_data)) {
		return array();
	}

	$host = explode(':', $support_data['data']['sql_host']);
	$mysql_str = sprintf('mysqldump -u%s -p%s -h%s %s %s ',
			$support_data['data']['sql_user'],
			escapeshellcmd($support_data['data']['sql_pswd']),
			$host[0],
			(isset($host[1])) ? '-P'.$host[1] : '',
			$support_data['data']['sql_db']);

	$cmd = array();
	if (!empty($dump_struct)) {
		$cmd[] = $mysql_str . implode(' ', $dump_struct). ' --no-data';
	}
	if (!empty($dump_data)) {
		$cmd[] = $mysql_str . implode(' ', $dump_data). ' --no-create-info';
	}

	return $cmd;
} // }}}

function func_replace_auth(& $buffer, $replace) // {{{
{
	if (preg_match('/^\s*\$installation_auth_code\s*=\s*[\'"].*[\'"]\s*;/', $buffer))
		$buffer = preg_replace('#(^\s*\$installation_auth_code\s*=\s*[\'"]).*([\'"]\s*;)#', "$1$replace$2", $buffer);
} // }}}

function func_replace_license(& $buffer, $replace) // {{{
{
	if (preg_match('/^\s*\$license\s*=\s*[\'"].*[\'"]\s*;/', $buffer)) {
		 $buffer = ereg_replace('=.*;', "=\"$replace\";", $buffer);
	} else if (preg_match('/^\s*\$installation_auth_code\s*=\s*[\'"].*[\'"]\s*;/', $buffer)) {
		$buffer = ereg_replace('=.*;', "= '$replace';", $buffer);
	}
} // }}}

function func_file_replace($name, $fn, $replace) // {{{
{
	if (is_writable($name)) {
		$fp = fopen($name, "r+");
		if ($fp) {
			$allfile = '';
			while (!feof($fp)) {
				$buffer = fgets($fp, 4096);
				$fn($buffer, $replace);
				$allfile .= $buffer;
			}
		ftruncate($fp, 0);
		rewind($fp);
		fwrite($fp, $allfile);
		return fclose($fp);
		}
	}
	echo "Not writable: $name<br />\n";
	return false;
} // }}}

function func_curl_version() // {{{
{
	if (function_exists('curl_version'))
		return curl_version();
	else 
		return 'not installed';
} // }}}

function func_convert_file_size($bytes) // {{{
{
    $symbols = array('B', 'Kb', 'Mb', 'Gb', 'Tb', 'Pb');
	$exp = $bytes ? floor(log($bytes) / log(1024)) : 0;
    return sprintf('%.2f '.$symbols[$exp], ($bytes/pow(1024, floor($exp))));
} // }}}

//  #################
//
//  Session/Cookie functions
//
//  #################
function func_get_cookie($name, $defaul_value = null) // {{{
{
	$value = isset($_COOKIE[SUPPORT_COOKIE_PREFIX.$name]) ? $_COOKIE[SUPPORT_COOKIE_PREFIX.$name] : null;
	return (is_null($value)) ? $defaul_value : $value;
} // }}}

function func_set_cookie($name, $value = '') // {{{
{
	assert(is_string($value));
	$expire = SUPPORT_EXPIRE_COOKIE + time();
	setCookie(SUPPORT_COOKIE_PREFIX.$name, $value, $expire, '/', '');
	header('p3p: CP="NON CUR OUR BUS UNI COM"');
} // }}}

function _session_start() // {{{
{
	global $support_data;

	$support_data = _session_read();

	if (!empty($support_data)) {
		return;
	}

	$support_data = array();
	$support_data['tab'] = 'run';
	$support_data['xc_path'] = '';
	$support_data['support_password'] = '';
	$support_data['support_counter'] = 0;
	$support_data['lc_path'] = '';
	$support_data['auto_search'] = true;
	$support_data['xc_found'] = false;
	$support_data['sns_found'] = false;
	$support_data['lc_found'] = false;
	$support_data['lc3_found'] = false;
	$support_data['lc3_path'] = '';
	$support_data['lc3_is_standalone'] = false;
	$support_data['mode'] = 'simple';
	$support_data['from'] = ini_get('sendmail_from');
	$support_data['subj'] = 'Test mail';
	$support_data['body'] = 'Test mail body';
	$support_data['sendmail_from'] = ini_get('sendmail_from');
	$support_data['SMTP'] = ini_get('SMTP');
	$support_data['smtp_port'] = ini_get('smtp_port');
	$support_data['folders'] = array(
		'.',
		'..',
		'store',
		'shop',
		'cart',
		'catalog',
		'xcart',
		'sns',
		'collector',
		'datacollector',
		'dc',
	);
	$support_data['custom_commands'] = array();

	_session_save();
} // }}}

function _session_read() // {{{
{
	$session = func_get_cookie(_session_sid());

	if (is_null($session)) {
		return null;
	}

	$session = unserialize(base64_decode($session));
	if (!is_array($session)) {
		return null;
	}

	return $session;
} // }}}

function _session_save($close = FALSE) // {{{
{
	if (
		defined('DBG_SESSION_CLOSED')
		&& DBG_SESSION_CLOSED
	) {
		throw new Exception('session_save after close');
	}

	if ($close) {
		define('DBG_SESSION_CLOSED', TRUE);
	}

	$support_data = _session_read();
	if ($support_data !== $GLOBALS['support_data']) {
		$session = base64_encode(serialize($GLOBALS['support_data']));
		func_set_cookie(_session_sid(), $session);
	}
} // }}}

function _session_clear() // {{{
{
	func_set_cookie(_session_sid(), '');
} // }}}

function _session_sid() // {{{
{
	static $sid;

	if (is_null($sid)) {
		$sid = 'sess_'.md5(SUPPORT_LOGIN.VERSION.filemtime(__FILE__));
	}

	return $sid;
} // }}}
?><?php
/* vim: set expandtab tabstop=4 shiftwidth=4 foldmethod=marker: */
/* $Id: blowfish.php,v 1.1.2.6 2008/09/05 06:16:55 ninalag Exp $ */

function dkit_bf_crypt($code,$password)
{
    global $blowfish;
	$code = dkit_bf_expand($code);
	if(false && function_exists("mcrypt_module_open"))
	{
		$td = mcrypt_module_open(MCRYPT_BLOWFISH, '', 'ecb', '');
		$iv = mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
		mcrypt_generic_init($td, $password, $iv);
		$code = bin2hex(mcrypt_generic($td, $code));
		mcrypt_generic_deinit($td);
		mcrypt_module_close($td);
	}
	else
	{
		$blowfish = new xbBlowfish();
		xb_func_bf_check_env();
		$code = $blowfish->xb_ctEncrypt($code, $password);
	}

	return $code;
}

function dkit_bf_decrypt($code,$password)
{
    global $blowfish;
	if(false && function_exists("mcrypt_module_open"))
	{
		$td = mcrypt_module_open(MCRYPT_BLOWFISH, '', 'ecb', '');
		$iv = mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
		mcrypt_generic_init($td, $password, $iv);
		$code = mdecrypt_generic($td, pack('H'.strlen($code), $code));
		mcrypt_generic_deinit($td);
		mcrypt_module_close($td);
	}
	else
	{
		$blowfish = new xbBlowfish();
		xb_func_bf_check_env();
		$code = $blowfish->xb_ctDecrypt($code, $password);
	}

	return trim($code);
}

function dkit_bf_expand($text)
{
	while (strlen($text) % 8 != 0)
		$text .= " ";
	return $text;
}

class xbBlowfish {
	var $dump_symbol = "x";
	var $p = array();
	var $s = array();
	var $m = array();
	var $r = array();

	function xbBlowfish() {
		$this->m = array (0x5c266859, 0x36623665, 0x63316162, 0x64346638,
			0x64356631, 0x30306362, 0x62353734, 0x34623630,
			0x32636134, 0x66633332, 0x38323731, 0x37643366,
			0x37393031, 0x32626330, 0x34643964, 0x37626338,
			0x66363965, 0x37356335, 0x66346630, 0x35373038,
			0x31303635, 0x33643464, 0x36633564, 0x31626236,
			0x32333437, 0x39626531, 0x37353734, 0x36653632,
			0x30663638, 0x61363734, 0x32666639, 0x34393061,
			0x36313635, 0x65373637, 0x64333231, 0x66646639,
			0x38363736, 0x63663238, 0x33366665, 0x62313261,
			0x63393939, 0x32346133, 0x32343536, 0x32363239,
			0x61316239, 0x63643364, 0x39663435, 0x61303035,
			0x61613135, 0x39623732, 0x31363331, 0x38633939,
			0x30636636, 0x61653264, 0x66393132, 0x64663663,
			0x61613834, 0x37366535, 0x36323264, 0x37326439,
			0x63303361, 0x63316564, 0x63343436, 0x63643461,
			0x39386330, 0x33383734, 0x34386637, 0x33343438,
			0x64336130, 0x31333461, 0x65353739, 0x30663233,
			0x39353832, 0x35666335, 0x33383961, 0x64366133,
			0x66643564, 0x38383363, 0x37643864, 0x39626263,
			0x33396265, 0x62326533, 0x30613132, 0x32663439,
			0x63363164, 0x62333663, 0x66306466, 0x61326362,
			0x36303166, 0x37643735, 0x65386430, 0x31366533,
			0x66623564);
		$this->r = array (0xe6e87f81, 0x38666533, 0x32316265, 0x61613537,
			0x32326234, 0x61613661, 0x33666536, 0x32623630,
			0x64656565, 0x30656638, 0x38346265, 0x33616365,
			0x34363437, 0x38363038, 0x39376464, 0x39313038,
			0x66373463, 0x38613836, 0x65613265, 0x63613632,
			0x63363465, 0x30396330, 0x64393061, 0x38663333,
			0x39636536, 0x30323039, 0x36396639, 0x66373330,
			0x37356163);
	}

	function xb_createVars() {
		$this->p = array(0x243f6a88, 0x85a308d3, 0x13198a2e, 0x03707344,
			0xa4093822, 0x299f31d0, 0x082efa98, 0xec4e6c89,
			0x452821e6, 0x38d01377, 0xbe5466cf, 0x34e90c6c,
			0xc0ac29b7, 0xc97c50dd, 0x3f84d5b5, 0xb5470917,
			0x9216d5d9, 0x8979fb1b);
		$this->s = array(0xd1310ba6, 0x98dfb5ac, 0x2ffd72db, 0xd01adfb7,
			0xb8e1afed, 0x6a267e96, 0xba7c9045, 0xf12c7f99,
			0x24a19947, 0xb3916cf7, 0x0801f2e2, 0x858efc16,
			0x636920d8, 0x71574e69, 0xa458fea3, 0xf4933d7e,
			0x0d95748f, 0x728eb658, 0x718bcd58, 0x82154aee,
			0x7b54a41d, 0xc25a59b5, 0x9c30d539, 0x2af26013,
			0xc5d1b023, 0x286085f0, 0xca417918, 0xb8db38ef,
			0x8e79dcb0, 0x603a180e, 0x6c9e0e8b, 0xb01e8a3e,
			0xd71577c1, 0xbd314b27, 0x78af2fda, 0x55605c60,
			0xe65525f3, 0xaa55ab94, 0x57489862, 0x63e81440,
			0x55ca396a, 0x2aab10b6, 0xb4cc5c34, 0x1141e8ce,
			0xa15486af, 0x7c72e993, 0xb3ee1411, 0x636fbc2a,
			0x2ba9c55d, 0x741831f6, 0xce5c3e16, 0x9b87931e,
			0xafd6ba33, 0x6c24cf5c, 0x7a325381, 0x28958677,
			0x3b8f4898, 0x6b4bb9af, 0xc4bfe81b, 0x66282193,
			0x61d809cc, 0xfb21a991, 0x487cac60, 0x5dec8032,
			0xef845d5d, 0xe98575b1, 0xdc262302, 0xeb651b88,
			0x23893e81, 0xd396acc5, 0x0f6d6ff3, 0x83f44239,
			0x2e0b4482, 0xa4842004, 0x69c8f04a, 0x9e1f9b5e,
			0x21c66842, 0xf6e96c9a, 0x670c9c61, 0xabd388f0,
			0x6a51a0d2, 0xd8542f68, 0x960fa728, 0xab5133a3,
			0x6eef0b6c, 0x137a3be4, 0xba3bf050, 0x7efb2a98,
			0xa1f1651d, 0x39af0176, 0x66ca593e, 0x82430e88,
			0x8cee8619, 0x456f9fb4, 0x7d84a5c3, 0x3b8b5ebe,
			0xe06f75d8, 0x85c12073, 0x401a449f, 0x56c16aa6,
			0x4ed3aa62, 0x363f7706, 0x1bfedf72, 0x429b023d,
			0x37d0d724, 0xd00a1248, 0xdb0fead3, 0x49f1c09b,
			0x075372c9, 0x80991b7b, 0x25d479d8, 0xf6e8def7,
			0xe3fe501a, 0xb6794c3b, 0x976ce0bd, 0x04c006ba,
			0xc1a94fb6, 0x409f60c4, 0x5e5c9ec2, 0x196a2463,
			0x68fb6faf, 0x3e6c53b5, 0x1339b2eb, 0x3b52ec6f,
			0x6dfc511f, 0x9b30952c, 0xcc814544, 0xaf5ebd09,
			0xbee3d004, 0xde334afd, 0x660f2807, 0x192e4bb3,
			0xc0cba857, 0x45c8740f, 0xd20b5f39, 0xb9d3fbdb,
			0x5579c0bd, 0x1a60320a, 0xd6a100c6, 0x402c7279,
			0x679f25fe, 0xfb1fa3cc, 0x8ea5e9f8, 0xdb3222f8,
			0x3c7516df, 0xfd616b15, 0x2f501ec8, 0xad0552ab,
			0x323db5fa, 0xfd238760, 0x53317b48, 0x3e00df82,
			0x9e5c57bb, 0xca6f8ca0, 0x1a87562e, 0xdf1769db,
			0xd542a8f6, 0x287effc3, 0xac6732c6, 0x8c4f5573,
			0x695b27b0, 0xbbca58c8, 0xe1ffa35d, 0xb8f011a0,
			0x10fa3d98, 0xfd2183b8, 0x4afcb56c, 0x2dd1d35b,
			0x9a53e479, 0xb6f84565, 0xd28e49bc, 0x4bfb9790,
			0xe1ddf2da, 0xa4cb7e33, 0x62fb1341, 0xcee4c6e8,
			0xef20cada, 0x36774c01, 0xd07e9efe, 0x2bf11fb4,
			0x95dbda4d, 0xae909198, 0xeaad8e71, 0x6b93d5a0,
			0xd08ed1d0, 0xafc725e0, 0x8e3c5b2f, 0x8e7594b7,
			0x8ff6e2fb, 0xf2122b64, 0x8888b812, 0x900df01c,
			0x4fad5ea0, 0x688fc31c, 0xd1cff191, 0xb3a8c1ad,
			0x2f2f2218, 0xbe0e1777, 0xea752dfe, 0x8b021fa1,
			0xe5a0cc0f, 0xb56f74e8, 0x18acf3d6, 0xce89e299,
			0xb4a84fe0, 0xfd13e0b7, 0x7cc43b81, 0xd2ada8d9,
			0x165fa266, 0x80957705, 0x93cc7314, 0x211a1477,
			0xe6ad2065, 0x77b5fa86, 0xc75442f5, 0xfb9d35cf,
			0xebcdaf0c, 0x7b3e89a0, 0xd6411bd3, 0xae1e7e49,
			0x00250e2d, 0x2071b35e, 0x226800bb, 0x57b8e0af,
			0x2464369b, 0xf009b91e, 0x5563911d, 0x59dfa6aa,
			0x78c14389, 0xd95a537f, 0x207d5ba2, 0x02e5b9c5,
			0x83260376, 0x6295cfa9, 0x11c81968, 0x4e734a41,
			0xb3472dca, 0x7b14a94a, 0x1b510052, 0x9a532915,
			0xd60f573f, 0xbc9bc6e4, 0x2b60a476, 0x81e67400,
			0x08ba6fb5, 0x571be91f, 0xf296ec6b, 0x2a0dd915,
			0xb6636521, 0xe7b9f9b6, 0xff34052e, 0xc5855664,
			0x53b02d5d, 0xa99f8fa1, 0x08ba4799, 0x6e85076a,
			0x4b7a70e9, 0xb5b32944, 0xdb75092e, 0xc4192623,
			0xad6ea6b0, 0x49a7df7d, 0x9cee60b8, 0x8fedb266,
			0xecaa8c71, 0x699a17ff, 0x5664526c, 0xc2b19ee1,
			0x193602a5, 0x75094c29, 0xa0591340, 0xe4183a3e,
			0x3f54989a, 0x5b429d65, 0x6b8fe4d6, 0x99f73fd6,
			0xa1d29c07, 0xefe830f5, 0x4d2d38e6, 0xf0255dc1,
			0x4cdd2086, 0x8470eb26, 0x6382e9c6, 0x021ecc5e,
			0x09686b3f, 0x3ebaefc9, 0x3c971814, 0x6b6a70a1,
			0x687f3584, 0x52a0e286, 0xb79c5305, 0xaa500737,
			0x3e07841c, 0x7fdeae5c, 0x8e7d44ec, 0x5716f2b8,
			0xb03ada37, 0xf0500c0d, 0xf01c1f04, 0x0200b3ff,
			0xae0cf51a, 0x3cb574b2, 0x25837a58, 0xdc0921bd,
			0xd19113f9, 0x7ca92ff6, 0x94324773, 0x22f54701,
			0x3ae5e581, 0x37c2dadc, 0xc8b57634, 0x9af3dda7,
			0xa9446146, 0x0fd0030e, 0xecc8c73e, 0xa4751e41,
			0xe238cd99, 0x3bea0e2f, 0x3280bba1, 0x183eb331,
			0x4e548b38, 0x4f6db908, 0x6f420d03, 0xf60a04bf,
			0x2cb81290, 0x24977c79, 0x5679b072, 0xbcaf89af,
			0xde9a771f, 0xd9930810, 0xb38bae12, 0xdccf3f2e,
			0x5512721f, 0x2e6b7124, 0x501adde6, 0x9f84cd87,
			0x7a584718, 0x7408da17, 0xbc9f9abc, 0xe94b7d8c,
			0xec7aec3a, 0xdb851dfa, 0x63094366, 0xc464c3d2,
			0xef1c1847, 0x3215d908, 0xdd433b37, 0x24c2ba16,
			0x12a14d43, 0x2a65c451, 0x50940002, 0x133ae4dd,
			0x71dff89e, 0x10314e55, 0x81ac77d6, 0x5f11199b,
			0x043556f1, 0xd7a3c76b, 0x3c11183b, 0x5924a509,
			0xf28fe6ed, 0x97f1fbfa, 0x9ebabf2c, 0x1e153c6e,
			0x86e34570, 0xeae96fb1, 0x860e5e0a, 0x5a3e2ab3,
			0x771fe71c, 0x4e3d06fa, 0x2965dcb9, 0x99e71d0f,
			0x803e89d6, 0x5266c825, 0x2e4cc978, 0x9c10b36a,
			0xc6150eba, 0x94e2ea78, 0xa5fc3c53, 0x1e0a2df4,
			0xf2f74ea7, 0x361d2b3d, 0x1939260f, 0x19c27960,
			0x5223a708, 0xf71312b6, 0xebadfe6e, 0xeac31f66,
			0xe3bc4595, 0xa67bc883, 0xb17f37d1, 0x018cff28,
			0xc332ddef, 0xbe6c5aa5, 0x65582185, 0x68ab9802,
			0xeecea50f, 0xdb2f953b, 0x2aef7dad, 0x5b6e2f84,
			0x1521b628, 0x29076170, 0xecdd4775, 0x619f1510,
			0x13cca830, 0xeb61bd96, 0x0334fe1e, 0xaa0363cf,
			0xb5735c90, 0x4c70a239, 0xd59e9e0b, 0xcbaade14,
			0xeecc86bc, 0x60622ca7, 0x9cab5cab, 0xb2f3846e,
			0x648b1eaf, 0x19bdf0ca, 0xa02369b9, 0x655abb50,
			0x40685a32, 0x3c2ab4b3, 0x319ee9d5, 0xc021b8f7,
			0x9b540b19, 0x875fa099, 0x95f7997e, 0x623d7da8,
			0xf837889a, 0x97e32d77, 0x11ed935f, 0x16681281,
			0x0e358829, 0xc7e61fd6, 0x96dedfa1, 0x7858ba99,
			0x57f584a5, 0x1b227263, 0x9b83c3ff, 0x1ac24696,
			0xcdb30aeb, 0x532e3054, 0x8fd948e4, 0x6dbc3128,
			0x58ebf2ef, 0x34c6ffea, 0xfe28ed61, 0xee7c3c73,
			0x5d4a14d9, 0xe864b7e3, 0x42105d14, 0x203e13e0,
			0x45eee2b6, 0xa3aaabea, 0xdb6c4f15, 0xfacb4fd0,
			0xc742f442, 0xef6abbb5, 0x654f3b1d, 0x41cd2105,
			0xd81e799e, 0x86854dc7, 0xe44b476a, 0x3d816250,
			0xcf62a1f2, 0x5b8d2646, 0xfc8883a0, 0xc1c7b6a3,
			0x7f1524c3, 0x69cb7492, 0x47848a0b, 0x5692b285,
			0x095bbf00, 0xad19489d, 0x1462b174, 0x23820e00,
			0x58428d2a, 0x0c55f5ea, 0x1dadf43e, 0x233f7061,
			0x3372f092, 0x8d937e41, 0xd65fecf1, 0x6c223bdb,
			0x7cde3759, 0xcbee7460, 0x4085f2a7, 0xce77326e,
			0xa6078084, 0x19f8509e, 0xe8efd855, 0x61d99735,
			0xa969a7aa, 0xc50c06c2, 0x5a04abfc, 0x800bcadc,
			0x9e447a2e, 0xc3453484, 0xfdd56705, 0x0e1e9ec9,
			0xdb73dbd3, 0x105588cd, 0x675fda79, 0xe3674340,
			0xc5c43465, 0x713e38d8, 0x3d28f89e, 0xf16dff20,
			0x153e21e7, 0x8fb03d4a, 0xe6e39f2b, 0xdb83adf7,
			0xe93d5a68, 0x948140f7, 0xf64c261c, 0x94692934,
			0x411520f7, 0x7602d4f7, 0xbcf46b2e, 0xd4a20068,
			0xd4082471, 0x3320f46a, 0x43b7d4b7, 0x500061af,
			0x1e39f62e, 0x97244546, 0x14214f74, 0xbf8b8840,
			0x4d95fc1d, 0x96b591af, 0x70f4ddd3, 0x66a02f45,
			0xbfbc09ec, 0x03bd9785, 0x7fac6dd0, 0x31cb8504,
			0x96eb27b3, 0x55fd3941, 0xda2547e6, 0xabca0a9a,
			0x28507825, 0x530429f4, 0x0a2c86da, 0xe9b66dfb,
			0x68dc1462, 0xd7486900, 0x680ec0a4, 0x27a18dee,
			0x4f3ffea2, 0xe887ad8c, 0xb58ce006, 0x7af4d6b6,
			0xaace1e7c, 0xd3375fec, 0xce78a399, 0x406b2a42,
			0x20fe9e35, 0xd9f385b9, 0xee39d7ab, 0x3b124e8b,
			0x1dc9faf7, 0x4b6d1856, 0x26a36631, 0xeae397b2,
			0x3a6efa74, 0xdd5b4332, 0x6841e7f7, 0xca7820fb,
			0xfb0af54e, 0xd8feb397, 0x454056ac, 0xba489527,
			0x55533a3a, 0x20838d87, 0xfe6ba9b7, 0xd096954b,
			0x55a867bc, 0xa1159a58, 0xcca92963, 0x99e1db33,
			0xa62a4a56, 0x3f3125f9, 0x5ef47e1c, 0x9029317c,
			0xfdf8e802, 0x04272f70, 0x80bb155c, 0x05282ce3,
			0x95c11548, 0xe4c66d22, 0x48c1133f, 0xc70f86dc,
			0x07f9c9ee, 0x41041f0f, 0x404779a4, 0x5d886e17,
			0x325f51eb, 0xd59bc0d1, 0xf2bcc18f, 0x41113564,
			0x257b7834, 0x602a9c60, 0xdff8e8a3, 0x1f636c1b,
			0x0e12b4c2, 0x02e1329e, 0xaf664fd1, 0xcad18115,
			0x6b2395e0, 0x333e92e1, 0x3b240b62, 0xeebeb922,
			0x85b2a20e, 0xe6ba0d99, 0xde720c8c, 0x2da2f728,
			0xd0127845, 0x95b794fd, 0x647d0862, 0xe7ccf5f0,
			0x5449a36f, 0x877d48fa, 0xc39dfd27, 0xf33e8d1e,
			0x0a476341, 0x992eff74, 0x3a6f6eab, 0xf4f8fd37,
			0xa812dc60, 0xa1ebddf8, 0x991be14c, 0xdb6e6b0d,
			0xc67b5510, 0x6d672c37, 0x2765d43b, 0xdcd0e804,
			0xf1290dc7, 0xcc00ffa3, 0xb5390f92, 0x690fed0b,
			0x667b9ffb, 0xcedb7d9c, 0xa091cf0b, 0xd9155ea3,
			0xbb132f88, 0x515bad24, 0x7b9479bf, 0x763bd6eb,
			0x37392eb3, 0xcc115979, 0x8026e297, 0xf42e312d,
			0x6842ada7, 0xc66a2b3b, 0x12754ccc, 0x782ef11c,
			0x6a124237, 0xb79251e7, 0x06a1bbe6, 0x4bfb6350,
			0x1a6b1018, 0x11caedfa, 0x3d25bdd8, 0xe2e1c3c9,
			0x44421659, 0x0a121386, 0xd90cec6e, 0xd5abea2a,
			0x64af674e, 0xda86a85f, 0xbebfe988, 0x64e4c3fe,
			0x9dbc8057, 0xf0f7c086, 0x60787bf8, 0x6003604d,
			0xd1fd8346, 0xf6381fb0, 0x7745ae04, 0xd736fccc,
			0x83426b33, 0xf01eab71, 0xb0804187, 0x3c005e5f,
			0x77a057be, 0xbde8ae24, 0x55464299, 0xbf582e61,
			0x4e58f48f, 0xf2ddfda2, 0xf474ef38, 0x8789bdc2,
			0x5366f9c3, 0xc8b38e74, 0xb475f255, 0x46fcd9b9,
			0x7aeb2661, 0x8b1ddf84, 0x846a0e79, 0x915f95e2,
			0x466e598e, 0x20b45770, 0x8cd55591, 0xc902de4c,
			0xb90bace1, 0xbb8205d0, 0x11a86248, 0x7574a99e,
			0xb77f19b6, 0xe0a9dc09, 0x662d09a1, 0xc4324633,
			0xe85a1f02, 0x09f0be8c, 0x4a99a025, 0x1d6efe10,
			0x1ab93d1d, 0x0ba5a4df, 0xa186f20f, 0x2868f169,
			0xdcb7da83, 0x573906fe, 0xa1e2ce9b, 0x4fcd7f52,
			0x50115e01, 0xa70683fa, 0xa002b5c4, 0x0de6d027,
			0x9af88c27, 0x773f8641, 0xc3604c06, 0x61a806b5,
			0xf0177a28, 0xc0f586e0, 0x006058aa, 0x30dc7d62,
			0x11e69ed7, 0x2338ea63, 0x53c2dd94, 0xc2c21634,
			0xbbcbee56, 0x90bcb6de, 0xebfc7da1, 0xce591d76,
			0x6f05e409, 0x4b7c0188, 0x39720a3d, 0x7c927c24,
			0x86e3725f, 0x724d9db9, 0x1ac15bb4, 0xd39eb8fc,
			0xed545578, 0x08fca5b5, 0xd83d7cd3, 0x4dad0fc4,
			0x1e50ef5e, 0xb161e6f8, 0xa28514d9, 0x6c51133c,
			0x6fd5c7e7, 0x56e14ec4, 0x362abfce, 0xddc6c837,
			0xd79a3234, 0x92638212, 0x670efa8e, 0x406000e0,
			0x3a39ce37, 0xd3faf5cf, 0xabc27737, 0x5ac52d1b,
			0x5cb0679e, 0x4fa33742, 0xd3822740, 0x99bc9bbe,
			0xd5118e9d, 0xbf0f7315, 0xd62d1c7e, 0xc700c47b,
			0xb78c1b6b, 0x21a19045, 0xb26eb1be, 0x6a366eb4,
			0x5748ab2f, 0xbc946e79, 0xc6a376d2, 0x6549c2c8,
			0x530ff8ee, 0x468dde7d, 0xd5730a1d, 0x4cd04dc6,
			0x2939bbdb, 0xa9ba4650, 0xac9526e8, 0xbe5ee304,
			0xa1fad5f0, 0x6a2d519a, 0x63ef8ce2, 0x9a86ee22,
			0xc089c2b8, 0x43242ef6, 0xa51e03aa, 0x9cf2d0a4,
			0x83c061ba, 0x9be96a4d, 0x8fe51550, 0xba645bd6,
			0x2826a2f9, 0xa73a3ae1, 0x4ba99586, 0xef5562e9,
			0xc72fefd3, 0xf752f7da, 0x3f046f69, 0x77fa0a59,
			0x80e4a915, 0x87b08601, 0x9b09e6ad, 0x3b3ee593,
			0xe990fd5a, 0x9e34d797, 0x2cf0b7d9, 0x022b8b51,
			0x96d5ac3a, 0x017da67d, 0xd1cf3ed6, 0x7c7d2d28,
			0x1f9f25cf, 0xadf2b89b, 0x5ad6b472, 0x5a88f54c,
			0xe029ac71, 0xe019a5e6, 0x47b0acfd, 0xed93fa9b,
			0xe8d3c48d, 0x283b57cc, 0xf8d56629, 0x79132e28,
			0x785f0191, 0xed756055, 0xf7960e44, 0xe3d35e8c,
			0x15056dd4, 0x88f46dba, 0x03a16125, 0x0564f0bd,
			0xc3eb9e15, 0x3c9057a2, 0x97271aec, 0xa93a072a,
			0x1b3f6d9b, 0x1e6321f5, 0xf59c66fb, 0x26dcf319,
			0x7533d928, 0xb155fdf5, 0x03563482, 0x8aba3cbb,
			0x28517711, 0xc20ad9f8, 0xabcc5167, 0xccad925f,
			0x4de81751, 0x3830dc8e, 0x379d5862, 0x9320f991,
			0xea7a90c2, 0xfb3e7bce, 0x5121ce64, 0x774fbe32,
			0xa8b6e37e, 0xc3293d46, 0x48de5369, 0x6413e680,
			0xa2ae0810, 0xdd6db224, 0x69852dfd, 0x09072166,
			0xb39a460a, 0x6445c0dd, 0x586cdecf, 0x1c20c8ae,
			0x5bbef7dd, 0x1b588d40, 0xccd2017f, 0x6bb4e3bb,
			0xdda26a7e, 0x3a59ff45, 0x3e350a44, 0xbcb4cdd5,
			0x72eacea8, 0xfa6484bb, 0x8d6612ae, 0xbf3c6f47,
			0xd29be463, 0x542f5d9e, 0xaec2771b, 0xf64e6370,
			0x740e0d8d, 0xe75b1357, 0xf8721671, 0xaf537d5d,
			0x4040cb08, 0x4eb4e2cc, 0x34d2466a, 0x0115af84,
			0xe1b00428, 0x95983a1d, 0x06b89fb4, 0xce6ea048,
			0x6f3f3b82, 0x3520ab82, 0x011a1d4b, 0x277227f8,
			0x611560b1, 0xe7933fdc, 0xbb3a792b, 0x344525bd,
			0xa08839e1, 0x51ce794b, 0x2f32c9b7, 0xa01fbac9,
			0xe01cc87e, 0xbcc7d1f6, 0xcf0111c3, 0xa1e8aac7,
			0x1a908749, 0xd44fbd9a, 0xd0dadecb, 0xd50ada38,
			0x0339c32a, 0xc6913667, 0x8df9317c, 0xe0b12b4f,
			0xf79e59b7, 0x43f5bb3a, 0xf2d519ff, 0x27d9459c,
			0xbf97222c, 0x15e6fc2a, 0x0f91fc71, 0x9b941525,
			0xfae59361, 0xceb69ceb, 0xc2a86459, 0x12baa8d1,
			0xb6c1075e, 0xe3056a0c, 0x10d25065, 0xcb03a442,
			0xe0ec6e0e, 0x1698db3b, 0x4c98a0be, 0x3278e964,
			0x9f1f9532, 0xe0d392df, 0xd3a0342b, 0x8971f21e,
			0x1b0a7441, 0x4ba3348c, 0xc5be7120, 0xc37632d8,
			0xdf359f8d, 0x9b992f2e, 0xe60b6f47, 0x0fe3f11d,
			0xe54cda54, 0x1edad891, 0xce6279cf, 0xcd3e7e6f,
			0x1618b166, 0xfd2c1d05, 0x848fd2c5, 0xf6fb2299,
			0xf523f357, 0xa6327623, 0x93a83531, 0x56cccd02,
			0xacf08162, 0x5a75ebb5, 0x6e163697, 0x88d273cc,
			0xde966292, 0x81b949d0, 0x4c50901b, 0x71c65614,
			0xe6c6c7bd, 0x327a140a, 0x45e1d006, 0xc3f27b9a,
			0xc9aa53fd, 0x62a80f00, 0xbb25bfe2, 0x35bdd2f6,
			0x71126905, 0xb2040222, 0xb6cbcf7c, 0xcd769c2b,
			0x53113ec0, 0x1640e3d3, 0x38abbd60, 0x2547adf0,
			0xba38209c, 0xf746ce76, 0x77afa1c5, 0x20756060,
			0x85cbfe4e, 0x8ae88dd8, 0x7aaaf9b0, 0x4cf9aa7e,
			0x1948c25c, 0x02fb8a8c, 0x01c36ae4, 0xd6ebe1f9,
			0x90d4f869, 0xa65cdea0, 0x3f09252d, 0xc208e69f,
			0xb74e6132, 0xce77e25b, 0x578fdfe3, 0x3ac372e6);
	}

	function xb_eraseVars () {
		$this->p = array();
		$this->s = array();
	}

	function xb_bf_enc($ll, $r, $n) {
		$ll = xb_func_xor($ll, $this->pk[$n]);

        $b1 = $this->sk[xb_func_and(xb_func_rshift($r, 24), 0xff)];
        $b2 = $this->sk[256 + xb_func_and(xb_func_rshift($r, 16), 0xff)];
        $b3 = $this->sk[512 + xb_func_and(xb_func_rshift($r, 8), 0xff)];
        $b4 = $this->sk[768 + xb_func_and($r, 0xff)];

		return xb_func_xor($ll,  xb_func_xor(($b1 + $b2), $b3) + $b4);
	}

	function xb_bf_encrypt($l, $r) {
		$l = xb_func_xor($l, $this->pk[0]);
		for ($i = 1; $i < 17; $i += 2) {
			$r = $this->xb_bf_enc($r, $l, $i);
			$l = $this->xb_bf_enc($l, $r, $i + 1);
		}

		$r = xb_func_xor($r, $this->pk[17]);
		return array($r, $l);
	}

	function xb_bf_decrypt($l, $r) {
		$l = xb_func_xor($l, $this->pk[17]);
		for ($i = 16; $i > 0; $i -= 2) {
			$r = $this->xb_bf_enc($r, $l, $i);
			$l = $this->xb_bf_enc($l, $r, $i - 1);
		}
		$r = xb_func_xor($r, $this->pk[0]);
		return array($r, $l);
	}

	function xb_asc2int($asc) {
		return (ord($asc[0]) << 24) | (ord($asc[1]) << 16) | (ord($asc[2]) << 8) | (ord($asc[3]));
	}

	function xb_int2asc($int) {
		return chr(xb_func_rshift($int, 24)).chr(xb_func_and(xb_func_rshift($int, 16), 0xff)).chr(xb_func_and(xb_func_rshift($int, 8), 0xff)).chr(xb_func_and($int, 0xff));
	}

	function xb_bf_set_key($key) {
		if (strlen($key) <= 0) $key = ' ';
		while (strlen($key) < 72)
			$key .= $key;
		$key = substr($key, 0, 72);
		$this->pk = $this->p;
		$this->sk = $this->s;

		$l = 0;
		$r = 0;

		for ($i = 0; $i < 18; $i ++) {
			$this->pk[$i] = xb_func_xor($this->pk[$i], $this->xb_asc2int(substr($key, $i * 4, 4)));
		}

		for ($i = 0; $i < 18; $i += 2) {
			list($l, $r) = $this->xb_bf_encrypt($l, $r);
			$this->pk[$i    ] = $l;
			$this->pk[$i + 1] = $r;
		}

		for ($i = 0; $i < 1024; $i += 2) {
			list($l, $r) = $this->xb_bf_encrypt($l, $r);
			$this->sk[$i    ] = $l;
			$this->sk[$i + 1] = $r;
		}
	}

	function xb_expand($text) {
		while (strlen($text) % 8 != 0)
			$text .= $this->dump_symbol;

		return $text;
	}

	#
	# Mcrypt block
	#
	function xb_mcrypt($data, $key) {
		$td = mcrypt_module_open(MCRYPT_BLOWFISH, '',  MCRYPT_MODE_ECB, '');
		if (!$td)
			return false;

		srand(time());
		$iv = mcrypt_create_iv(mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
		$len = mcrypt_enc_get_key_size($td);
		if (strlen($key) > $len)
			$key = substr($key, 0, $len);
		if (mcrypt_generic_init($td, $key, $iv) < 0)
			return false;

		$encrypted_data = mcrypt_generic($td, $data);
		mcrypt_generic_deinit($td);
		mcrypt_module_close($td);

		return xb_func_str2hex($encrypted_data);
	}

	function xb_mdecrypt($data, $key) {
		$td = mcrypt_module_open(MCRYPT_BLOWFISH, '', MCRYPT_MODE_ECB, '');
		if (!$td)
			return false;

		$iv = mcrypt_create_iv(mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
		$len = mcrypt_enc_get_key_size($td);
		if (strlen($key) > $len)
			$key = substr($key, 0, $len);
        if (mcrypt_generic_init($td, $key, $iv) < 0)
			return false;

        $decrypted_data = mdecrypt_generic($td, xb_func_hex2str($data));
        mcrypt_generic_deinit($td);
        mcrypt_module_close($td);

		return $decrypted_data;
	}

	function xb_encrypt($text) {
		$len = strlen($text);
		$plain = '';
		for ($i = 0; $i < $len; $i += 8) {
			$l = $this->xb_asc2int(substr($text, $i, 4));
			$r = $this->xb_asc2int(substr($text, $i + 4, 4));
			list($l, $r) = $this->xb_bf_encrypt($l, $r);
			$plain .= $this->xb_int2asc($l).$this->xb_int2asc($r);
		}

		return $plain;
	}

	function xb_decrypt($text) {
		$len = strlen($text);
		$plain = '';
		for ($i = 0; $i < $len; $i += 8) {
			$a = $this->xb_asc2int(substr($text, $i, 4));
			$b = $this->xb_asc2int(substr($text, $i + 4, 4));
			list($a, $b) = $this->xb_bf_decrypt($a, $b);
			$plain .= $this->xb_int2asc($a) . $this->xb_int2asc($b);
		}

		return $plain;
	}

	function xb_ctEncrypt($plaintext, $password) {
		if (defined("BF_MODE") && BF_MODE == 1) {
			$r = $this->xb_mcrypt($plaintext, $password);
			if ($r !== false) {
				return $r;
			}
		}

		$this->xb_createVars();
		if (strlen($password) <= 0)
			return false;

		$this->xb_bf_set_key($password);
		$return = bin2hex($this->xb_encrypt($plaintext));
		$this->xb_eraseVars();

		return $return;
	}

	function xb_ctDecrypt($cipher, $password) {
		if (defined("BF_MODE") && BF_MODE == 1) {
			$r = $this->xb_mdecrypt($cipher, $password);
			if ($r !== false) {
				return $r;
			}
		}

		$this->xb_createVars();
		if (strlen($password) <= 0)
			return false;

		$cipher = pack('H' . strlen($cipher), $cipher);

		$this->xb_bf_set_key($password);
		$return = substr($this->xb_decrypt($cipher), 0, strlen($cipher));
		$this->xb_eraseVars();

		return $return;
	}
}

#
# Crypt Blowfish wrapper
#
function xb_func_bf_crypt($s, $key) {
	global $blowfish;

	if (!$blowfish)
		return false;

	xb_func_bf_check_env();
	$blowfish->dump_symbol = " ";
	$s = $blowfish->xb_expand($s);

	return $blowfish->xb_ctEncrypt($s, $key);
}

#
# Decrypt Blowfish wrapper
#
function xb_func_bf_decrypt($s, $key) {
	global $blowfish;

	if (!$blowfish)
		return false;

	xb_func_bf_check_env();
	return $blowfish->xb_ctDecrypt($s, $key);
}

function xb_func_bf_asc($array, $key) {
	global $blowfish;

	$len = count($array);
	$return = "";
	for ($i=1; $i < $len; $i++) {
		$return .= $blowfish->xb_int2asc($array[$i]);
	}

	$return = xb_func_bf_decrypt($return, $key);
	if (crc32($return) != (int)$array[0])
		return false;

	return $return;
}

function xb_func_bf_psc($prop, $key) {
	global $blowfish;

	return xb_func_bf_asc($blowfish->$prop, $key);
}


function xb_func_xor($a, $b) {
	if (!defined("BF_MODE") || BF_MODE == 2 || ($a < 2147483648 && $b < 2147483648 && $a > -2147483648 && $b > -2147483648))
		return $a ^ $b;

	$p1 = xb_func_int_pack($a);
	$p2 = xb_func_int_pack($b);

	$arr = unpack("V", ($p1[0] ^ $p2[0]).($p1[1] ^ $p2[1]).($p1[2] ^ $p2[2]).($p1[3] ^ $p2[3]));
	return array_pop($arr);
}

function xb_func_and($a, $b) {
	if (!defined("BF_MODE") || BF_MODE == 2 || ($a < 2147483648 && $b < 2147483648 && $a > -2147483648 && $b > -2147483648))
		return $a & $b;

	$p1 = xb_func_int_pack($a);
	$p2 = xb_func_int_pack($b);

	$arr = unpack("V", ($p1[0] & $p2[0]).($p1[1] & $p2[1]).($p1[2] & $p2[2]).($p1[3] & $p2[3]));
	return array_pop($arr);
}

function xb_func_rshift($a, $b) {
	if (!defined("BF_MODE") || BF_MODE == 2 || ($a < 2147483648 && $b < 2147483648 && $a > -2147483648 && $b > -2147483648))
		return $a >> $b;

	if ($b > 32)
		$b = $b % 32;
	elseif ($b < 0)
		$b = 32+($b % 32);

	if ($a > 0)
		return intval(floor($a / pow(2, $b))-pow(2, 32-$b));
	else
		return intval(floor($a / pow(2, $b))+pow(2, 32-$b));
}

function xb_func_decbin($x) {
	static $pows = array(1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536, 131072, 262144, 524288, 1048576, 2097152, 4194304, 8388608, 16777216, 33554432, 67108864, 134217728, 268435456, 536870912, 1073741824, 2147483648, 4294967296);

	if ($x == 0) {
		return "0";
	}
	elseif ($x < 0) {
		$x += 4294967296;
	}

	$r = "";
	$flag = false;
	for ($i = 32; $i >= 0; $i--) {
		$pow = $pows[$i];
		if (!$flag) {
			if ($x >= $pow) {
				$flag = true;
			}
			else {
				continue;
			}
		}

		if ($x >= $pow) {
			$x -= $pow;
			$r .= "1";
		}
		else {
			$r .= "0";
		}

	}

	return substr($r, -32);
}

function xb_func_bindec($x) {
	$len = strlen($x);
	$r = 0;
	for ($i = 0; $i < $len; $i++) {
		if ($x[$i] === '1') {
			$r += pow(2, $len-$i-1);
		}
	}

	if ($len == 32 && $x[0] == "1") {
		return $r-4294967296;
	}
	else {
		return $r;
	}
}

function xb_func_int_pack($x) {
	if ($x < 0)
		$x += 4294967296;

	for ($i = 0; $i < 4; $i++) {
		if ($x >= 256) {
			$f = floor($x / 256);
			$p[$i] = chr($x-$f*256);
			$x = $f;
		}
		else {
			$p[$i] = chr($x);
			$x = 0;
		}
	}

	return $p;
}

#
# Checking if wrappers need to be used
#
function xb_func_bf_check_env() {
	global $bf_wrapper, $blowfish;

	if (defined('XCART_SESSION_START') && function_exists('x_session_register')) {
		# XCART_SESSION_START is defined in install.php for installation purposes
		x_session_register("bf_mode");
	}

	if (!$blowfish || defined("BF_MODE"))
		return;

	# Mcrypt check
	if (empty($bf_mode)) {
		if (false &&
			function_exists("mcrypt_module_open") &&
			function_exists("mcrypt_create_iv") &&
			function_exists("mcrypt_generic_init") &&
			function_exists("mcrypt_enc_get_key_size") &&
			function_exists("mcrypt_generic") &&
			function_exists("mcrypt_generic_deinit") &&
			function_exists("mcrypt_module_close") &&
			function_exists("mcrypt_list_algorithms") &&
			function_exists("mcrypt_list_modes") &&
			defined("MCRYPT_BLOWFISH") && 
			defined("MCRYPT_MODE_ECB") &&
			defined("MCRYPT_RAND")
		) {
			$list = @mcrypt_list_algorithms();
			$modes = @mcrypt_list_modes();
			if (in_array("blowfish", $list) && in_array("ecb", $modes)) {

		        $td = mcrypt_module_open(MCRYPT_BLOWFISH, '',  MCRYPT_MODE_ECB, '');

				if ($td) {
					$data = "098f6bcd4621d373cade4e832627b4f6";
					$key = "283be88071814577787744fa58f06d8f";
		        	srand(time());
	    		    $iv = mcrypt_create_iv(mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
    	    		if (mcrypt_generic_init($td, $key, $iv) >= 0) {
			        	$encrypted_data = mcrypt_generic($td, $data);
						$decrypted_data = mdecrypt_generic($td, $encrypted_data);
						if ($data === $decrypted_data) {
							$bf_mode = 1;
						}

	    			    mcrypt_generic_deinit($td);
					}

	        		mcrypt_module_close($td);
				}
			}
		
		}

	}

	# Wrappers check
	if (empty($bf_mode)) {
		$s = "test";
		$key = "8d5db63ada15e11643a0b1c3477c2c5c";
    	$blowfish->dump_symbol = " ";
    	$s = $blowfish->xb_expand($s);

		$bf_mode = ($blowfish->xb_ctEncrypt($s, $key) == 'c1b2e0cda54a428e') ? 2 : 3;
	}

	define("BF_MODE", $bf_mode);
}

#
# Convert string to hex
#
function xb_func_str2hex($str) {
	$ret = "";
	$l = strlen($str);
	for ($i = 0; $i < $l; $i++) {
		$r = dechex(ord(substr($str, $i, 1)));
		if (strlen($r) == 1)
			$r = "0".$r;
		$ret .= $r;
	}   

	return $ret;
}

#
# Convert hex to string
#
function xb_func_hex2str($str) {
	$ret = "";
	$l = strlen($str);
	for ($i = 0; $i < $l; $i += 2) {
		$ret .= chr(hexdec(substr($str, $i, 2)));
	}     

	return $ret;
}

?>