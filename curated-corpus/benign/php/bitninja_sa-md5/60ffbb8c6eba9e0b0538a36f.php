<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use DB;
use App\User;
use App\Blog;

class SuperuserController extends Controller
{

      public function __construct()
    {
        $this->middleware('auth:web');
    }

    public function ShowSuperuser()
    {
        return view('dashboard.superuser');
    }

    public function ShowAddProject()
    {
        return view('dashboard.add_project');
    }

    public function ShowEditProject()
    {
        return view('dashboard.edit_project');
    }


    //Retrieve List ostudents
    public function GetProject(Request $request)
    {

        $data = Blog::where('id', $request->id)->first();

        
        return $data;
    }



    public function UpdateProjectDetails(Request $request)
    {

        if ($request->hasFile('picture')) {
            //get file name with extension
            $filenameWithExt = $request->file('picture')->getClientOriginalName();

            //get just filename
            $filename = pathinfo($filenameWithExt, PATHINFO_FILENAME);

            //Get Just Ext
            $extension = $request->file('picture')->getClientOriginalExtension();

            //filename tostore
            $profile_pictureNameToStore = $filename . '_' . time() . '.' . $extension;


            //upload video
            $path = $request->file('picture')->storeAs('public/blog', $profile_pictureNameToStore);
        }

        if ($request->hasFile('picture2')) {
            //get file name with extension
            $filenameWithExt = $request->file('picture2')->getClientOriginalName();

            //get just filename
            $filename = pathinfo($filenameWithExt, PATHINFO_FILENAME);

            //Get Just Ext
            $extension = $request->file('picture2')->getClientOriginalExtension();

            //filename tostore
            $profile_pictureNameToStore2 = $filename . '_' . time() . '.' . $extension;


            //upload video
            $path = $request->file('picture2')->storeAs('public/blog', $profile_pictureNameToStore);
        }


        $affected = DB::table('works')
          ->where('id', $request->project_id)
          ->update(['title' => $request->input('title'),
                    'description' => $request->input('description'),
                    'date' => $request->input('date'),
                    'top_image' => $profile_pictureNameToStore,
                    'bottom_image' => $profile_pictureNameToStore2
                     ]);

        return back();
    }
}
