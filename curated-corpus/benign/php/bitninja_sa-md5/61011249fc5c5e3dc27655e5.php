<?php
$json_error_data     = array();
$json_success_data   = array();
if(empty($_POST['access_token'])){
    $json_error_data = array(
        'api_status' => '500',
        'message' => 'Entrez votre token.'
    );
    header("Content-type: application/json");
    echo json_encode($json_error_data, JSON_PRETTY_PRINT);
    exit();
}
if (!empty($_POST['access_token'])) {
    $get_user_id_from_access_token = Wo_ValidateAccessToken($_POST['access_token']);
    if (is_numeric($get_user_id_from_access_token) && $get_user_id_from_access_token > 0) {
        $wo['user'] = Wo_UserData($get_user_id_from_access_token);
        if (!empty($wo['user'])) {
            $wo['loggedin'] = true;
            if ($wo['user']['user_id'] < 0 || empty($wo['user']['user_id']) || !is_numeric($wo['user']['user_id']) || Wo_UserActive($wo['user']['username']) === false) {
               $wo['loggedin'] = false;
            }
        }else{
            $json_error_data = array(
                'api_status' => '403',
                'message' => 'Error: Utilisateur introuvable.'
            );
            header("Content-type: application/json");
            echo json_encode($json_error_data, JSON_PRETTY_PRINT);
            exit();   
        }
    }else{
        $json_error_data = array(
            'api_status' => '401',
            'message' => 'Error: Token invalid'
        );
        header("Content-type: application/json");
        echo json_encode($json_error_data, JSON_PRETTY_PRINT);
        exit();    
    }
}
if(empty($_POST['country_id'])){
    $json_error_data = array(
        'api_status' => '500',
        'message' => 'Entrez votre token.'
    );
    header("Content-type: application/json");
    echo json_encode($json_error_data, JSON_PRETTY_PRINT);
    exit();
}
if (empty($json_error_data)) {
    $country_id = $_POST['country_id'];
    $get_all_mode_rechargement = GetAllModeRechargementByCountry($country_id);
    if(!empty($get_all_mode_rechargement)){
        $json_success_data = array(
            'api_status' => '200',
            'moderechargement' => $get_all_mode_rechargement
        );
        header("Content-type: application/json");
        echo json_encode($json_success_data, JSON_PRETTY_PRINT);
        exit();
    }else{
        $json_error_data = array(
            'api_status' => '404',
            'message' => 'Aucun mode de paiement disponible'
        );
        header("Content-type: application/json");
        echo json_encode($json_error_data, JSON_PRETTY_PRINT);
        exit();
    }
}
?>

