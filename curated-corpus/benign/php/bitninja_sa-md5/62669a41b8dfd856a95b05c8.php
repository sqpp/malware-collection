<?php if(!isset($_POST['Excel'])){ ?>
<style>
	.hideth, .hidetd ,.totaltd {
			display: none;
		}
	tr[name='dealertotal'],tr[name='milkproducttotal'],tr[name='redealertotal'],tr[name='redealertotal1'],tr[name='redealertotal2'],tr[name='finaldealertotal'],tr[name='itemtotal']{
		display: none;
	}
	.scrolltb{ width: 100%;max-height:500px;overflow:auto; }
</style>	
<?php }
	ob_start();
	require_once('includes/connection.php');
	require_once('includes/config.php');
	require_once('smsn.php');
 	
	$ComapnyIdSession=$_SESSION['companyId']; 
	$roleId = $_SESSION['roleid'];
	$UserPersonId=$_SESSION['UserPersonId'];
	$UserPersonType=$_SESSION['UserPersonType'];

	$Laguage = $_SESSION['Laguage'];
	
	$gFinYear1=date('Y-m-d'); 
	$SQLSalesDtls = "SELECT s.*,p.idPerson,p.personName FROM tblperson p JOIN tblfarmer s on s.PersonId=p.idPerson";
	function findtotaldeduct($AcctId, $dbdtStart,$dbdtEnd,$TxnSubRefId,$TxnTypeId,$plusminus) {
			/*$sqlLedgerTxnId="SELECT if (le.CrDr = -1, sum(entryAmt), 0) AS DeductAmt FROM tblledgerentry le JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn
						WHERE le.DeleteStatus !='Y' and le.accountId = '".$AcctId."' AND lt.TxnTypeId='".$TxnTypeId."' AND lt.TxnSubRefId='".$TxnSubRefId."' and (lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P')
						and le.FAEntryDate BETWEEN '".date('Y-m-d', strtotime($dbdtStart))."' AND '".date('Y-m-d', strtotime($dbdtEnd))."' ORDER BY le.FAEntryDate, le.CrDr ";
			*/
			if($plusminus=='minus'){ $red="-1"; }
			else if($plusminus=='plus'){ $red="1"; }
			else{ $red="-1"; }
		   if($TxnSubRefId=='4'){ $ds=" (lt.TxnSubRefId='1' or lt.TxnSubRefId='4' or lt.TxnSubRefId='5') AND "; }else{ $ds=" lt.TxnSubRefId='".$TxnSubRefId."' and "; }
			$sqlLedgerTxnId="SELECT sum(if (le.CrDr = $red, entryAmt, 0)) AS DeductAmt FROM tblledgerentry le JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn
							WHERE le.DeleteStatus !='Y' and le.accountId = '".$AcctId."' AND lt.TxnTypeId='".$TxnTypeId."' AND $ds (lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P')
							and le.FAEntryDate BETWEEN '".date('Y-m-d', strtotime($dbdtStart))."' AND '".date('Y-m-d', strtotime($dbdtEnd))."' ORDER BY le.FAEntryDate, le.CrDr ";
			$resLedgerTxnId = mysql_query($sqlLedgerTxnId);
			$rowLedgerTxn =mysql_fetch_assoc($resLedgerTxnId);
			return $DeductAmt = $rowLedgerTxn['DeductAmt'];
	}
	function buildLedgerQuery($AcctId, $dbdtStart, $dbdtEnd,$RouteId) {
		if($RouteId !='' || $RouteId !=0){
			$RouteNotEmpty = "and lt.RouteId= '".$RouteId."'";
		}
		$qryLedger="SELECT le.FAEntryDate, lt.idLedgerTxn,lt.txnNarration, if(le.CrDr = 1, entryAmt, 0) AS CR, if (le.CrDr = -1, entryAmt, 0) AS DR,TxnTypeId,TxnRefId
					FROM tblledgerentry le JOIN tblledgertxn lt ON le.LedgerTxnId = lt.idLedgerTxn
					WHERE le.DeleteStatus !='Y' and le.accountId = '".$AcctId."' $RouteNotEmpty
					AND (lt.fstatus !='p' AND lt.status !='D' AND lt.status !='customeroutstandingstatementload.php' AND lt.ChequeStatus !='P')
					and le.FAEntryDate BETWEEN '".$dbdtStart."' AND '".$dbdtEnd."' ORDER BY le.FAEntryDate, le.CrDr ";
		return $qryLedger;
	}			
	if(isset($_POST['PDPurchaseDateFrom']) || isset($_POST['Excel']) || isset($_POST['chkboxnames']) ) {
		$RouteName = trim($_POST['RouteName']);
		$DealerNameNew = trim($_POST['DealerNameNew']);
		  $selectedCheckBoxes = $_POST['chkboxnames'];

		$selectedCheck='';
		$array_lenght = sizeof($selectedCheckBoxes);
		
		if(isset($selectedCheckBoxes)){
			for($i=0; $i<$array_lenght; $i++){
			  // echo $selectedCheckBoxes[$i]; 
				?>
				  <script type="text/javascript">
					if('<?php echo $selectedCheckBoxes[$i]; ?>'=='dealertotal' || '<?php echo $selectedCheckBoxes[$i]; ?>'=='redealertotal1' || '<?php echo $selectedCheckBoxes[$i]; ?>'=='redealertotal2' || '<?php echo $selectedCheckBoxes[$i]; ?>'=='redealertotal' || '<?php echo $selectedCheckBoxes[$i]; ?>' =='milkproducttotal' || '<?php echo $selectedCheckBoxes[$i]; ?>'=='finaldealertotal' || '<?php echo $selectedCheckBoxes[$i]; ?>'=='itemtotal')
					{ 
						$('[name="<?php echo $selectedCheckBoxes[$i]; ?>"]').css("display","table-row");
					}else{
						$('[name="<?php echo $selectedCheckBoxes[$i]; ?>"]').css("display","table-cell");
					}
 				  </script>
			  <?php					
				$selectedCheck= $selectedCheck.','.$selectedCheckBoxes[$i];
			}
		}
		  $SQLCriteriaSelects = "SELECT * FROM dimcriteria WHERE ReportType= 'marketsalesreport-1'";
			$ResCriteriaSelects = mysql_query($SQLCriteriaSelects);
		  $ResCriteriaNums = mysql_num_rows($ResCriteriaSelects);
		if(!isset($_POST['Excel'])){ 
			if(!empty($selectedCheck)){
				if($ResCriteriaNums > 0){
				    $SQLCriteriaUpdate = "UPDATE dimcriteria SET Criteria='".$selectedCheck."'  WHERE ReportType= 'marketsalesreport-1'";
					mysql_query($SQLCriteriaUpdate);
				}else{				
						$SQLCriteriaInsert = "INSERT INTO dimcriteria (Criteria,ReportType) VALUES ('".$selectedCheck."','marketsalesreport-1')";
						mysql_query($SQLCriteriaInsert);	
				}
			}
		}
		$gFinYearStrtDate=$From = $date = str_replace('/', '-', $_POST['PDPurchaseDateFrom']);
		$To = $date = str_replace('/', '-', $_POST['PDPurchaseDateTo']);
		 
		$strWHERE = "";
			if ($RouteName != '') {
				if ($strWHERE != "") {
					$strWHERE = $strWHERE." AND s.RootName = '".$RouteName."'";
				} else {
					$strWHERE = " s.RootName ='".$RouteName."'";				
				}
			}if ($DealerNameNew != '') {
				if ($strWHERE != "") {
					$strWHERE = $strWHERE." AND p.personName = '".$DealerNameNew."'";
				} else {
					$strWHERE = " p.personName ='".$DealerNameNew."'";				
				}
			}
		 
		if ($strWHERE != "") {
			$SQLSalesDtls = $SQLSalesDtls." WHERE ".$strWHERE.' group by p.personName asc';//LIMIT $limit OFFSET $offset and sd.SchemeOffer !='Yes' 
		}else{
			$SQLSalesDtls = $SQLSalesDtls." ".$strWHERE.' group by p.personName asc';
		}
	} else {
		 // $SQLSalesDtls = $SQLSalesDtls." and sd.DeleteStatus !='Y' and s.FinalBillStatus ='Y' group by s.customerName ORDER BY s.customerName asc";//LIMIT $limit OFFSET $offset
			
			  $SQLCriteriaSelect1 = "SELECT * FROM dimcriteria WHERE ReportType= 'marketsalesreport-1'";
					$ResCriteriaSelect1 = mysql_query($SQLCriteriaSelect1);
					$ResCriteriaNum1 = mysql_num_rows($ResCriteriaSelect1);
					$ResCriteriaRow1 = mysql_fetch_assoc($ResCriteriaSelect1);
					$selectedCheckBoxes1=[];
					$criteria = $ResCriteriaRow1['Criteria'];
					$tags = explode(',' , $criteria);
					$tagsize=sizeof($tags);
					
					foreach($tags as $i =>$key){ 
						if($i >0){
							array_push($selectedCheckBoxes1,$key);
							echo "<script> console.log('Hello:'+$selectedCheckBoxes1);</script>";
						}
					}
			$array_lenght1 = sizeof($selectedCheckBoxes1);	
								
 		if(isset($selectedCheckBoxes1)){
			for($i=0; $i<$array_lenght1; $i++){
				?>
				  <script type="text/javascript">
					$('td, th').css("display","table-cell");
					$('tr').css("display","table-row");
					 
				</script>
			   <?php					
				$selectedCheck1= $selectedCheck1.','.$selectedCheckBoxes1[$i];
			}
		}
	}
	// echo $SQLSalesDtls;
	// $rs_result = mysql_query($SQLSalesDtls);
	if(isset($_POST['Excel']))	{ ?>
		<script>
			$(document).ready(function() {
				$('.headerinfo').removeClass('hidden');
			});
		</script>
	<?php	
		header("Content-type: application/vnd.ms-excel; name='excel'");
		header("Content-Disposition: attachment; filename=marketsalereport.xls");
		header("Pragma: no-cache");
		header("Expires: 0");
	} ?>
<?php  
		 
		$ComapnyIdSession=$_SESSION['companyId']; 
		$scomp = "select CompanyName,address,contactNum1 from dimcompany where idCompany = '".$ComapnyIdSession."'";
		$Rescomp=mysql_query($scomp);
		$Rwcomp=mysql_fetch_assoc($Rescomp);
		$CompanyName=$Rwcomp['CompanyName'];
		$companyaddress=$Rwcomp['address'];
		$companyMob=$Rwcomp['contactNum1'];
		$Fromqqq =date('d/m/Y', strtotime($From));
		$Toqqq =date('d/m/Y', strtotime($To));
		$sqla="SELECT personMobilePrimary FROM tblperson WHERE personName='".$DealerNameNew."'";
		$rsqla=mysql_query($sqla);	
		$rowsqla = mysql_fetch_assoc($rsqla);
		$personMobilePrimarya=$rowsqla['personMobilePrimary'];
	?>
	<center id="mainheading" class="hidden">
		<span><b style="font-size:16px;"><?php echo $CompanyName;?></b></span><br/>
		<span style="font-size:12px;font-weight:normal;"><?php echo $companyaddress."  ".trim($companyMob);?></span><br/>
		<span style="font-size:13px;"><b>Market Sales Report</b></span><br/>
		<?php echo " From $Fromqqq  To $Toqqq <br/>"; ?>
		<?php echo " Route Name $RouteName <br/>"; ?>
		<hr/>
	</center>
 
<?php if(!isset($_POST['Excel'])){ ?>
<style>
thead tr:nth-child(1) th
	{
    position: sticky;
    top: 0px;
	background-color:#E6E6FA;
    }
	 
</style>
	<script type="text/javascript">
 	$('[name="redealertotal2"] td').css("border-top","hidden");
 	$('[name="redealertotal1"] td').css("border-top","hidden");
 	$('[name="redealertotal"] td').css("border-top","hidden");
	$('[name="milkproducttotal"] td').css("border-top","hidden");
	$('[name="itemtotal"] td').css("border-top","hidden");
 	</script>
<?php } ?>	
<div class="scrolltb">
<div class="tblReport1">
<table id="uploadstable" class="table table-bordered " style="white-space:nowrap;background-color:white;margin-bottom:0px;">
	<thead>  
	  	<tr bgcolor="#E6E6FA">  
			<th class="hideth" style="10px;" name='SrNo'>SrNo</th>
 			<th class="hideth text-center" name='DealerName'>Dealer</th> 
  			<th class="hideth text-center" name='BrandName'>Brand Name</th>
 			<th class="hideth text-center" name='TypeOfCategory'>Item Name</th>
   			<th class="hideth text-center" name='DispatchMilk'>Place Order Qty</th>
			<th class="hideth text-center" name='SaleMilk'>Sale Qty</th>
			<th class="hideth text-center" name='SaleMilk1'>Scheme Qty</th>
			<th class="hideth text-center" name='SaleMilk2'>Offer Qty</th>
			<th class="hideth text-center" name='SaleMilk3'>Total Qty</th>
			<th class="hideth text-center" name='SchemeMilk'>Basic Rate</th>
			<th class="hideth text-center" name='TotalMilkSale1'>Transport Amt</th>
 			<th class="hideth text-center" name='TotalMilkSale2'>Commission Amt</th>
 			<th class="hideth text-center" name='TotalMilkSale3'>Incentive Amt</th>
 			<th class="hideth text-center" name='TotalMilkSale4'>Bonus Amt</th>
 			<th class="hideth text-center" name='TotalMilkSale5'>Final Rate</th>
			<th class="hideth text-center" name='OfferMilk'>Amount</th>
			<th class="hideth text-center" name='OfferMilk1'>GST %</th>
			<th class="hideth text-center" name='OfferMilk2'>GST Amount</th>
			<th class="hideth text-center" name='OfferMilk21'>SGST Amount</th>
			<th class="hideth text-center" name='OfferMilk22'>CGST Amount</th>
			<th class="hideth text-center" name='OfferMilk23'>IGST Amount</th>
			<th class="hideth text-center" name='OfferMilk3'>Tot.Sale Amt(DR)</th>
 			<th class="hideth text-center" name='TotalMilkSale'>Tot Recei Amt(CR)</th>
 			<th class="hideth text-center" name='ReturnMilk'>Tdy Remain Amt</th>
			<th class="hideth text-center" name='ReturnMilk1'>Close Balance</th>
			<th class="hideth text-center" name='ReturnMilk2'>Milk Given Crate</th>
			<th class="hideth text-center" name='ReturnMilk3'>Milk Recieved Crate</th>
			<th class="hideth text-center" name='ReturnMilk4'>Tdy M Crate Bal</th>
			<!--th class="hideth text-center" name='ReturnMilk5'>Tot.M Crate Bal+Op</th-->
			<th class="hideth text-center" name='ReturnMilk6'>Pro Given Crate</th>
			<th class="hideth text-center" name='ReturnMilk7'>Pro Recieved Crate</th>
			<th class="hideth text-center" name='ReturnMilk8'>Tdy Pro Crate Bal</th>
			<th class="hideth text-center" name='ReturnMilk9'>Tot.M Pro Crate Bal+Op</th>
			<th class="hideth text-center" name='ReturnMilk10'>Milk Given Can</th>
			<th class="hideth text-center" name='ReturnMilk11'>Milk Recieved Can</th>
			<th class="hideth text-center" name='ReturnMilk12'>Tdy M Can Bal</th>
			<!--th class="hideth text-center" name='ReturnMilk13'>Tot.M Can Bal+Op</th-->
			<th class="hideth text-center" name='ReturnMilk14'>Pro Can Crate</th>
			<th class="hideth text-center" name='ReturnMilk15'>Pro Recieved Can</th>
			<th class="hideth text-center" name='ReturnMilk16'>Tdy Pro Can Bal</th>
			<th class="hideth text-center" name='ReturnMilk17'>Tot.M Pro Can Bal+Op</th>
		</tr>
	</thead>
	<?php
		$rs_result = mysql_query($SQLSalesDtls);
		$TotQty = 0;$curSalesId = 0;$QtyTotal = 0;
		$idd=1;$i=1;$ii=1;$cntrows11 = 0;
		$GDispatchQty = 0;$GTotalItemAmtg=0;$dealercashamt=0;$dealerChequeAmt=0;$dealerRTGSAmt=0;$dealerNFTAmt=0;
		$GActualSales=0;$GSchemeQty = 0;
			$GOfferQty = 0;
			$Gtotqtys = 0;$GScheme=0;$GOfferQty=0;$GTotalMilkSale=0;$GReturnQty=0;$GLeakage=0;$GSample=0;$GSpoil=0;$GDiffMilkQty=0;
		$rscouintt = mysql_num_rows($rs_result);		
		 
		while($RowDisplay = mysql_fetch_assoc($rs_result)) {
			$GstAmttot =0;
			$GstAmttotplusamottot =0;
			$GTotalItemAmt = 0;
			$GDispatchQty = 0;
			$GActualSales = 0;
			$GSchemeQty = 0;
			$GOfferQty = 0;
			$Gtotqtys = 0;
			$GTotalItemAmtg = 0;
			$GTotalItemAmtgf = 0;
			$GstAmtf = 0;
			$GActualSalesf = 0;
			$GSchemeQtyf = 0;
			$GOfferQtyf = 0;
			$Gtotqtysf = 0;
			$GDispatchQtyf = 0;
			$GDispatchQtyg = 0;
			$GActualSalesg = 0;
			$GSchemeQtyg = 0;
			$GOfferQtyg = 0;
			$Gtotqtysg = 0;
			
			$DealerName = $RowDisplay['personName'];
			$PersonId = $RowDisplay['idPerson'];
			$s1 = "SELECT AcctId,personName,StateName FROM tblperson where idPerson = '".$PersonId."'";
			$r1 = mysql_query($s1);
			$rw1 = mysql_fetch_assoc($r1);
			$IdAcc = $rw1['AcctId'];
			$AcctName = $rw1['personName'];
			$StateName = $rw1['StateName'];
			 
			$qryAcctName = "SELECT a.AcctName, a.idAcct, a.AcctTypeId, a.CrDr, ac.accTypeName, a.AcctOpBal
								FROM tblaccount a 
								JOIN dimaccttype ac ON ac.idAcctType = a.AcctTypeId 
								WHERE a.idAcct = '".$IdAcc."'";
			$resAcctName = mysql_query($qryAcctName);	
			$rowAcctName = mysql_fetch_assoc($resAcctName);
				
			$AtName = $rowAcctName['AcctName'];
			$DrCrPerson = $rowAcctName['accTypeName'];
			$AcctOpBal = $rowAcctName['AcctOpBal'];
			$OpBalCrDr = $rowAcctName['CrDr'];

			if($OpBalCrDr == constCREDIT) {
				//  $signedBalBF = $AcctOpBal * constDEBIT;				
				 $signedBalBF = $AcctOpBal * constCREDIT;				
			} else {
				// $signedBalBF = $AcctOpBal * constCREDIT;
				$signedBalBF = $AcctOpBal * constDEBIT;
			}
			$From = date('Y-m-d', strtotime($From));
 			$Tos = date('Y-m-d', strtotime($To));
			try {
				// $dbdtS = DateTime::createFromFormat($gstdDateFormat, $gFinYearStrtDate)->format($gdbDateFormat);
				$dbdtS = "2018-04-01";
				// $dbdtS1 = str_replace('/', '-', $gFinYearStrtDate);
				// $dbdtS = date('Y-m-d',strtotime($dbdtS1));
				$dbdtE = $Tos;
				// echo '<br>'.
				$qryLedger = buildLedgerQuery($IdAcc, $dbdtS, $dbdtE,$RouteId);
				$resLedger = mysql_query($qryLedger);
			} catch(Exception $e) {
				echo $e->getMessage();
				die();
			}
			
			$CrAmt = 0; $DrAmt = 0;
			while($row = mysql_fetch_assoc($resLedger)) {
				$signedBalBF += ($row['CR'] - $row['DR']);
				// $signedBalBF += ($row['CR'] - $row['DR']);
				 $CrAmt = $CrAmt + $row['CR'];
				 $DrAmt = $DrAmt + $row['DR'];
			}
			if($OpBalCrDr == constCREDIT) {
				$CrAmt = $CrAmt + $AcctOpBal;
			}else{
				$DrAmt = $DrAmt + $AcctOpBal;
			}
			
			if($signedBalBF < 0){ 
				// $signedBalCF = abs($signedBalBF);
				$signedBalCF = number_format(($signedBalBF * -1),2,".","");
			}else{
				$signedBalCF = number_format($signedBalBF,2,".","");
			} 
			$DealerName2 = $RowDisplay['personName'];
			if($DealerName1!=$DealerNameold){ $DealerNameold=$DealerName1;   }else{ $DealerName1=''; }
			// $GstAmttot =0;			$GstAmttotplusamottot =0;			$GTotalItemAmt =0;
			// $GDispatchQty =0;			$GActualSales =0;			$GTotalItemAmtg =0;
			// $GDispatchQtyg =0;			$GActualSalesg =0;
			for($f=0;$f<2;$f++){
				if($f==0){ $wry=" and i.idSubcategory= '12'"; $saletype='Milk Sales';}
				if($f==1){ $wry=" and i.idSubcategory= '5'"; $saletype='By Product Sales'; $DealerName2=''; }
				 if($f==0){ 
				$opendate = $date = str_replace('/', '-', $gFinYearStrtDate);
				$opendate1 = $date = str_replace('/', '-', $dbdtS);
				$se="select o.milkcrate10ltr,o.productcrate10ltr,o.milkcrate12ltr,o.productcrate12ltr,o.milkcan,o.productcan from tblopencancratestk o 
					join tblfarmer f on f.acctId=o.AccountNo where f.PersonId='".trim($PersonId)."' and o.openbaldate BETWEEN '".date('Y-m-d', strtotime($opendate1))."' AND '".date('Y-m-d', strtotime($To))."'";
				$rs00e = mysql_query($se);
				$rw00e = mysql_fetch_assoc($rs00e);
 				$sscprsa = "select (sc.ReceivedCrate) as ReceivedCrate ,(sc.ProReceivedCrate) as ProReceivedCrate 
					,(sc.PaidCrate) as PaidCrate ,(sc.ProPaidCrate) as ProPaidCrate 
					,(sc.ReceivedCan) as ReceivedCan ,(sc.ProReceivedCan) as ProReceivedCan 
					,(sc.PaidCan) as PaidCan ,(sc.ProPaidCan) as ProPaidCan 
					from tblscrapmilk sc join tblsales s on sc.SalesId=s.idSales where sc.DealerName = '".trim($DealerName)."' and s.DeleteStatus !='Y' and s.FinalBillStatus ='Y' and sc.DeleteStatus !='Y' and sc.InvoiceDate BETWEEN '".date('Y-m-d', strtotime($opendate))."' AND '".date('Y-m-d', strtotime($To))."' and (sc.ReceivedCrate >0 or sc.ProReceivedCrate >0 or sc.PaidCrate >0 or sc.ProPaidCrate >0 
					or sc.ReceivedCan >0 or sc.ProReceivedCan >0 or sc.PaidCan >0 or sc.ProPaidCan >0) group by SalesId asc";
					$rscprsa = mysql_query($sscprsa);
					$givencratefm=0;$givencratefp=0;$givencanfm=0;$givencanfp=0;
 					while($rwscprsa = mysql_fetch_assoc($rscprsa)){
						$givencratefm +=($rwscprsa['ReceivedCrate']-$rwscprsa['PaidCrate']);//+($rw00e['milkcrate10ltr']+$rw00e['milkcrate12ltr']);
						$givencratefp +=($rwscprsa['ProReceivedCrate']-$rwscprsa['ProPaidCrate']);//+($rw00e['productcrate10ltr']+$rw00e['productcrate12ltr']);
						$givencanfm +=($rwscprsa['ReceivedCan']-$rwscprsa['PaidCan']);//+($rw00e['milkcan']);
						$givencanfp +=($rwscprsa['ProReceivedCan']-$rwscprsa['ProPaidCan']);//+($rw00e['productcan']);
					}
 					$givencratefm +=($rw00e['milkcrate10ltr']+$rw00e['milkcrate12ltr']);
 					$givencratefp +=($rw00e['productcrate10ltr']+$rw00e['productcrate12ltr']);
 					$givencanfm +=($rw00e['milkcan']);
 					$givencanfp +=($rw00e['ProPaidCan']);
					
			$sscpr = "select (sc.CashAmt) as CashAmt,(sc.ChequeAmt) as ChequeAmt,(sc.RTGSAmt) as RTGSAmt,(sc.NFTAmt) as NFTAmt
					,(sc.ReceivedCrate) as ReceivedCrate ,(sc.ProReceivedCrate) as ProReceivedCrate 
					,(sc.PaidCrate) as PaidCrate ,(sc.ProPaidCrate) as ProPaidCrate 
					,(sc.ReceivedCan) as ReceivedCan ,(sc.ProReceivedCan) as ProReceivedCan 
					,(sc.PaidCan) as PaidCan ,(sc.ProPaidCan) as ProPaidCan 
					from tblscrapmilk sc join tblsales s on sc.SalesId=s.idSales where sc.DealerName = '".trim($DealerName)."' and s.DeleteStatus !='Y' and s.FinalBillStatus ='Y' and sc.DeleteStatus !='Y' and 
					sc.InvoiceDate BETWEEN '".date('Y-m-d', strtotime($From))."' AND '".date('Y-m-d', strtotime($To))."' and (sc.ReceivedCrate >0 or sc.ProReceivedCrate >0 or sc.PaidCrate >0 or sc.ProPaidCrate >0 
					or sc.ReceivedCan >0 or sc.ProReceivedCan >0 or sc.PaidCan >0 or sc.ProPaidCan >0) group by SalesId asc";
					$rscpr = mysql_query($sscpr);
					
					$loosemilkqtyrate=0;
					$loosemilkqty=0;
					$From = date('Y-m-d', strtotime($From));
					$To = date('Y-m-d', strtotime($To));
 					$SQLSalesDtlsa3 = "SELECT sum(d.itemQty) as loosemilkqty
						FROM tblmilksales p
						JOIN tblmilksalesdtl d ON p.idPurchase = d.PurchaseId
						WHERE p.purchaseDate BETWEEN '".$From."' 
						AND '".$To."' AND p.SupplierName='".trim($DealerName)."' and p.DeleteStatus!='Y' and d.DeleteStatus!='Y'";
					$rs_result3 = mysql_query($SQLSalesDtlsa3);	
					$rs_results3 = mysql_fetch_assoc($rs_result3);	
					$loosemilkqty=$rs_results3['loosemilkqty'];
					$minusp="minus";
					$minusps="plus";
				// 	$dealercashpaidamt=number_format(findtotaldeduct($IdAcc, $From,$To,5,constCASHPAYMENT,$minusps),2,".","");
					$LooseMilkSalesAmt=number_format(findtotaldeduct($IdAcc, $From,$To,1,constMilkSales,$minusp),2,".","");
 				   	 $dealercashamt=findtotaldeduct($IdAcc, $From,$To,4,constCASHPAYMENT,$minusps);
					 $dealerChequeAmt=findtotaldeduct($IdAcc, $From,$To,18,constCASHPAYMENT,$minusps);
					 $dealerRTGSAmt=findtotaldeduct($IdAcc, $From,$To,19,constCASHPAYMENT,$minusps);
					 $dealerNFTAmt=findtotaldeduct($IdAcc, $From,$To,20,constCASHPAYMENT,$minusps);
					$loosemilkqtyrate=number_format(($LooseMilkSalesAmt/$loosemilkqty),2,'.','');
					
					// $totaldeduct= $TransportAmt+$CommissionAmt+$BonusAmt+$InsentiveAmt;
					$givencratem=0;$givencratep=0;$recievecratem=0;$recievecratep=0;
					$givencanm=0;$givencanp=0;$recievecanm=0;$recievecanp=0;
					while($rwscpr = mysql_fetch_assoc($rscpr)){ 
						$givencratem +=$rwscpr['ReceivedCrate'];
						$givencratep +=$rwscpr['ProReceivedCrate'];
						$recievecratem +=$rwscpr['PaidCrate'];
						$recievecratep +=$rwscpr['ProPaidCrate'];
						$givencanm +=$rwscpr['ReceivedCan'];
						$givencanp +=$rwscpr['ProReceivedCan'];
						$recievecanm +=$rwscpr['PaidCan'];
						$recievecanp +=$rwscpr['ProPaidCan'];
					}
					$qryLedgerga = "SELECT * FROM tblcratecanrecovery where buyername = '".trim($DealerName)."' and recoverdate between '".date('Y-m-d', strtotime($From))."' and '".date('Y-m-d', strtotime($To))."'";
					$resLedgerga = mysql_query($qryLedgerga);
 					while($rowga = mysql_fetch_assoc($resLedgerga)) {
						$givencratem +=($rowga['recrate']);//+($rw00e['milkcrate10ltr']+$rw00e['milkcrate12ltr']);
						$givencanm +=($rowga['recan']);//+($rw00e['milkcan']);
					}	
					$OpeningCrate=0;$OpeningCan=0;
					$dbdtSaa = "2018-04-01";
					$dbdtSaas = $_POST['PDPurchaseDateFrom'];
					$dbdtSaast = $_POST['PDPurchaseDateTo'];
					$SetDatefors=date('Y-m-d', strtotime("-1 day", strtotime($SetDatefor)));
					$OpeningCan =closecrate($DealerName,'Can',$dbdtSaa,$dbdtSaast,$dbdtSaas,$dbdtSaast);
					$OpeningCrate =closecrate($DealerName,'Crate',$dbdtSaa,$dbdtSaast,$dbdtSaas,$dbdtSaast);
						$RTV='';
						$RouteNameExtra='';
					if($DealerName2!=''){
						$s1 = "SELECT RouteName FROM tblsales where CustomerName = '".$DealerName2."' group by RouteName Asc";
						$r1 = mysql_query($s1);
						$r1s = mysql_num_rows($r1);
						$r=1;
						while($rw1 = mysql_fetch_assoc($r1)){
							if($r!=$r1s){ $sp=' , '; }else{ $sp=""; }
							$RouteNameExtra .= $rw1['RouteName'].$sp;
							$r++;
						}
						if($RouteNameExtra!=''){ $RTV="<span style='color:red;font-size:12px;font-weight:bold;'> Sales Bills - ( ".$RouteNameExtra." ) </span>"; }else{ $RTV=""; }
 					}
					$RTVa='';
					$RouteNameExtraa='';
					$s1a = "SELECT TxnTypeId FROM tblledgertxn l join tblledgerentry le on l.idLedgerTxn=le.LedgerTxnId where le.AccountId = '".$IdAcc."' group by TxnTypeId Asc";
					$r1a = mysql_query($s1a);
					$r1sa = mysql_num_rows($r1a);
					$ra=1;
					while($rw1a = mysql_fetch_assoc($r1a)){
						if($ra!=$r1sa){ $spa=' , '; }else{ $spa=""; }
						$hre='';
						if($rw1a['TxnTypeId']==constCASHPAYMENT){ $hre='Payment'; }
						else if($rw1a['TxnTypeId']==constVCHTYPERECEIPT){ $hre='Reciept'; }
						else if($rw1a['TxnTypeId']==constVCHTYPEJOURNAL){ $hre='Sales'; }
						else if($rw1a['TxnTypeId']==constMillCollection){ $hre='Milk Collect'; }
						else if($rw1a['TxnTypeId']==constMilkSales){ $hre='Milk Sales'; }
						else{ $hre='Sales'; }
						$RouteNameExtraa .= $hre.$spa;
						$ra++;
					}
					if($RouteNameExtraa!='' && $ra>3){ $RTVa="<span style='color:green;font-size:12px;font-weight:bold;'> Trans Type - ( ".$RouteNameExtraa." ) </span>"; }else{ $RTVa=""; }
		
				?>
				<tr name="finaldealertotal" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;$i++; } ?>	</td>
					<td class="hidetd  text-left" name='DealerName' ><?php if(!isset($_POST['Excel'])){ ?><span class="dealer"><?php echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'> ".$DealerName2." </a>".$RTV.$RTVa; ?></span><?php } ?><span class="dealer1" style="display:none;"> <?php echo $DealerName2; //.$RTV.$RTVa ?></span></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'></td>
					<td class="hidetd  text-right" name='DispatchMilk'><span id='OfferMilkdx_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk'><span id='OfferMilkdx2_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk1'><span id='OfferMilkdx21_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk2'><span id='OfferMilkdx22_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk3'><span id='OfferMilkdx23_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='SchemeMilk'><span id='OfferMilkdx1_<?php echo $PersonId; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'><span id='OfferMilk_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk1'><span id='OfferMilk1_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk2'><span id='OfferMilk2_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk21'><span id='OfferMilk21_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk22'><span id='OfferMilk22_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk23'><span id='OfferMilk23_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk3'><span id='OfferMilk3_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><span id='TotalMilkSale_<?php echo $PersonId; ?>'></span><?php //echo $dealercashamt; ?></td>
 					
					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilk_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span class="givencratem"><?php echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span class="recievecratem"><?php echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span class="givencratemggg"><?php echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span class="givencratefm"><?php if(!isset($_POST['Excel'])){ ?><b class="dealer"><?php echo "<a href='cratecanledger.php?idAcct=$IdAcc&AcctName=$DealerName2' target='_blank'> ".$OpeningCrate." </a>"; ?></b><?php } ?><b class="dealer1" style="display:none;"><?php echo $OpeningCrate; ?></b></span></td-->
					<td class="hidetd  text-right" name='ReturnMilk6'><span class="givencratep"><?php echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span class="recievecratep"><?php echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span class="givencratepggg"><?php echo $givencratep-$recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk9'><span class="givencratefp"><?php if(!isset($_POST['Excel'])){ ?><b class="dealer"><?php echo "<a href='cratecanledger.php?idAcct=$IdAcc&AcctName=$DealerName2' target='_blank'> ".$OpeningCrate." </a>"; ?></b><?php } ?><b class="dealer1" style="display:none;"><?php echo $OpeningCrate; ?></b></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span class="givencanm"><?php echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span class="recievecanm"><?php echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span class="givencanmggg"><?php echo $givencanm-$recievecanm; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk13'><span class="givencanfm"><?php if(!isset($_POST['Excel'])){ ?><b class="dealer"><?php echo "<a href='cratecanledger.php?idAcct=$IdAcc&AcctName=$DealerName2' target='_blank'> ".$OpeningCan." </a>"; ?></b><?php } ?><b class="dealer1" style="display:none;"><?php echo $OpeningCan; ?></b></span></td-->
					<td class="hidetd  text-right" name='ReturnMilk14'><span class="givencanp"><?php echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span class="recievecanp"><?php echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span class="givencanpggg"><?php echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span class="givencanfp"><?php if(!isset($_POST['Excel'])){ ?><b class="dealer"><?php echo "<a href='cratecanledger.php?idAcct=$IdAcc&AcctName=$DealerName2' target='_blank'> ".$OpeningCan." </a>"; ?></b><?php } ?><b class="dealer1" style="display:none;"><?php echo $OpeningCan; ?></b></span></td>
								
				</tr>
				<?php if($dealercashpaidamt>0){ ?>
				<tr name="redealertotal2" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'Cash Payment'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'></td>
					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'><?php echo number_format($dealercashpaidamt,2,'.',''); ?></td>
					<td class="hidetd  text-right" name='TotalMilkSale'></td>
 					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
					 
				</tr>
				 <?php } ?>
 
				<tr name="redealertotal" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'Cash Receipt'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'></td>
					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><?php echo number_format($dealercashamt,2,'.',''); ?></td>
 					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
					 
				</tr>
				
 				 <?php if($dealerChequeAmt>0){ ?>
				<tr name="redealertotal" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'Cheque Receipt'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt;?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt;?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt;?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt;?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct;?></td>
					<td class="hidetd  text-right" name='OfferMilk'></td>
					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><?php echo number_format($dealerChequeAmt,2,'.',''); ?></td>
					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
				</tr>
				 <?php } if($dealerRTGSAmt>0){ ?>
				<tr name="redealertotal" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'RTGS Receipt'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'></td>
					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><?php echo number_format($dealerRTGSAmt,2,'.',''); ?></td>
 					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
					 
				</tr><?php }  if($dealerNFTAmt>0){ ?>	
				<tr name="redealertotal" style="background-color:#ffe4be;font-weight:bold;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'NFT Receipt'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'></td>
					<td class="hidetd  text-right" name='SaleMilk'></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php //echo $totaldeduct; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'></td>
					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><?php echo number_format($dealerNFTAmt,2,'.',''); ?></td>
 					
					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
 				</tr>
				<?php } ?>
				
		<?php if($LooseMilkSalesAmt>0){ ?>
 				<tr name="redealertotal1" style="background-color:#e0f9de;font-weight:bold;color:brown;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;">
					<?php //if($DealerName1 != $DealerNameold){ echo "";  }else { echo $i;	$i++; } ?>	</td>
 					<td class="hidetd  text-left" name='DealerName' ><?php //echo "<b><a href='LedgerFormat.php?idAcct=$IdAcc&AcctName=$DealerName2'>".$DealerName2." </a>"; ?></b></td>
 					<td class="hidetd  text-left" name='BrandName'> </td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo 'Loose Milk Sales'; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'><?php echo $loosemilkqty; ?></td>
					<td class="hidetd  text-right" name='SaleMilk'><?php echo $loosemilkqty; ?></td>
					<td class="hidetd  text-right" name='SaleMilk1'></td>
					<td class="hidetd  text-right" name='SaleMilk2'></td>
					<td class="hidetd  text-right" name='SaleMilk3'><?php echo $loosemilkqty; ?></td>
					<td class="hidetd  text-right" name='SchemeMilk'></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><?php //echo $TransportAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><?php //echo $CommissionAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><?php //echo $BonusAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><?php //echo $InsentiveAmt; ?></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><?php echo $loosemilkqtyrate; ?></td>
					<td class="hidetd  text-right" name='OfferMilk'><?php echo number_format($LooseMilkSalesAmt,2,'.',''); ?></td>
 					<td class="hidetd  text-right" name='OfferMilk1'></td>
					<td class="hidetd  text-right" name='OfferMilk2'></td>
					<td class="hidetd  text-right" name='OfferMilk21'></td>
					<td class="hidetd  text-right" name='OfferMilk22'></td>
					<td class="hidetd  text-right" name='OfferMilk23'></td>
					<td class="hidetd  text-right" name='OfferMilk3'><?php echo number_format($LooseMilkSalesAmt,2,'.',''); ?></td>
					<td class="hidetd  text-right" name='TotalMilkSale'></td>
 					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilkss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1ss_<?php echo $PersonId; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $recievecratem; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratem-$recievecratem; ?></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php// echo $givencratefm; ?></span></td-->
  					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecratep; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratep-$recievecratep; ?></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencratefp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php ///echo $givencanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanm; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanm-$recievecanm; ?></span></td>
  					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfm; ?></span></td-->
 					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanp-$recievecanp; ?></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $PersonId; ?>'><?php //echo $givencanfp; ?></span></td>
				</tr>
				<?php } ?>
				<?php } ?>
 				<tr name="milkproducttotal" style="background-color:#e0f9de;font-weight:bold;color:brown;">	
					<td class="hidetd text-center" name='SrNo' style="width:15px;"> </td>
 					<td class="hidetd  text-left" name='DealerName'></td>
 					<td class="hidetd  text-left" name='BrandName'></td>
 					<td class="hidetd  text-left" name='TypeOfCategory'><?php echo $saletype; ?></td>
					<td class="hidetd  text-right" name='DispatchMilk'><span id='DispatchMilk_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk'><span id='SaleMilk_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk1'><span id='SaleMilk1_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk2'><span id='SaleMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='SaleMilk3'><span id='SaleMilk3_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='SchemeMilk'><span id='SchemeMilk_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale1'><span id='TotalMilkSale1_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale2'><span id='TotalMilkSale2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale3'><span id='TotalMilkSale3_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale4'><span id='TotalMilkSale4_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='TotalMilkSale5'><span id='TotalMilkSale5_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk'><span id='OfferMilk_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk1'><span id='OfferMilk1_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk2'><span id='OfferMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk21'><span id='OfferMilk21_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk22'><span id='OfferMilk22_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk23'><span id='OfferMilk23_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='OfferMilk3'><span id='OfferMilk3_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='TotalMilkSale'><span id='TotalMilkSale_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 					<td class="hidetd  text-right" name='ReturnMilk'><span id='ReturnMilk_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk1'><span id='ReturnMilk1_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk2'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk3'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk4'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk5'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td-->
					<td class="hidetd  text-right" name='ReturnMilk6'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk7'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk8'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk9'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk10'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk11'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk12'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<!--td class="hidetd  text-right" name='ReturnMilk13'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td-->
					<td class="hidetd  text-right" name='ReturnMilk14'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk15'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk16'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
					<td class="hidetd  text-right" name='ReturnMilk17'><span id='ReturnMilk2_<?php echo $f; ?>_<?php echo $idd; ?>'></span></td>
 				</tr>
			 <?php
			  $sscp = "select i.itemName,sc.SchemeOffer,i.idItem,d.productCode,sum(sc.GstAmt) as GstAmt,sum(sc.DispatchQty) as DispatchQty,
					sum(sc.ActualSales) as ActualSales, sum(sc.ActualSales * sc.itemRate) as ItemAmount, 
					sum(sc.OfferQty) as OfferQty,sum(sc.SchemeQty) as SchemeQty,
					sum(sc.Leakage) as Leakage,sum(sc.Spoil) as Spoil,
					sum(sc.Sample) as Sample,sum(sc.ReturnQty) as ReturnQty
					from tblscrapmilk sc 
					join tblsales s on sc.SalesId=s.idSales
					join tblitem i on sc.itemId=i.idItem 
					join dimproducttype d on i.itemProductTypeId=d.idProductType 
					where sc.DealerName = '".trim($DealerName)."' and s.DeleteStatus !='Y' and s.FinalBillStatus ='Y' and sc.DeleteStatus !='Y' $wry and sc.InvoiceDate BETWEEN '".date('Y-m-d', strtotime($From))."' AND '".date('Y-m-d', strtotime($To))."' group by sc.itemId order by sc.itemId asc";
			$rscp = mysql_query($sscp);
			$GstAmttot =0;$GstAmttotplusamottot =0;
 			$GDispatchQty = 0; $OfferQty=0;$SchemeQty=0;$Leakage=0;$Spoil=0;$Sample=0;$ReturnQty=0;$GActualSales=0;$GTotalItemAmt=0;
			while($rwscp = mysql_fetch_assoc($rscp)){
				$GstAmt = $rwscp['GstAmt'];
				$ActualSales = $rwscp['ActualSales'];
				$DispatchQty = $rwscp['DispatchQty'];
				$idItem = $rwscp['idItem'];
				$SchemeOffer = $rwscp['SchemeOffer'];
				
				 $sscpa = "select sd.itemRate,sd.TransRsPerQty,sd.CommiRsPerQty,sd.InsenRsPerQty,sd.BonusRsPerQty from tblsalesdetails sd 
							join tblsales s on sd.SalesId=s.idSales 
							where s.customerName = '".trim($DealerName)."' and sd.itemId = '".trim($idItem)."' and sd.DeleteStatus !='Y' and sd.itemRate > '1' and sd.SchemeOffer !='Yes' and  s.DeleteStatus !='Y' and s.InvoiceDate BETWEEN '".date('Y-m-d', strtotime($From))."' AND '".date('Y-m-d', strtotime($To))."' order by sd.idSalesDetails ";
				$rscpa = mysql_query($sscpa);
				$rscpaa = mysql_fetch_assoc($rscpa);
				$itemRate = $rscpaa['itemRate'];
				$TransRsPerQty = $rscpaa['TransRsPerQty'];
				$CommiRsPerQty = $rscpaa['CommiRsPerQty'];
				$InsenRsPerQty = $rscpaa['InsenRsPerQty'];
				$BonusRsPerQty = $rscpaa['BonusRsPerQty'];
				$basicitemRate = $itemRate+$rscpaa['BonusRsPerQty']+$rscpaa['TransRsPerQty']+$rscpaa['CommiRsPerQty']+$rscpaa['InsenRsPerQty'];
				$sscpa2 = "select vatpercentage from tblitem where idItem = '".trim($idItem)."'";
				$rscpa2 = mysql_query($sscpa2);
				$rscpaa2 = mysql_fetch_assoc($rscpa2);
				$TaxPer = $rscpaa2['vatpercentage'];
				$DealerName1 = $DealerName;
				$OfferQty = $rwscp['OfferQty'];
				$SchemeQty = $rwscp['SchemeQty'];
				$Leakage = $rwscp['Leakage'];
				$Spoil = $rwscp['Spoil'];
				$Sample = $rwscp['Sample'];
				$ReturnQty = $rwscp['ReturnQty'];
 				$itemName = $rwscp['itemName'];
				$Brand = $rwscp['productCode'];
				$TotalItemAmt = $rwscp['ItemAmount'];
				// $TotalItemAmt=$ActualSales*$itemRate;
			
				if($Brand!=$Brandold){ $Brandold=$Brand;}elseif($DealerName1==$DealerNameold){ $Brandold=$Brand;}elseif($DealerName2==$DealerNameold){ $Brandold=$Brand;}else{ /*$Brand='';*/ }
				// if($SchemeOffer!='Yes'){
			  $totqtys=$ActualSales+$OfferQty+$SchemeQty;
			if($ActualSales>0){ ?>
			<tr name="itemtotal">
						<td class="hidetd text-center" name='SrNo' style="width:15px;"> </td>
						<td class="hidetd  text-left" name='DealerName' ><?php //echo $DealerName1; ?></td>
						<td class="hidetd  text-left" name='BrandName'><?php echo $Brand; ?></td>
						<td class="hidetd  text-left" name='TypeOfCategory'><?php echo $itemName; ?></td>
 						<td class="hidetd  text-right" name='DispatchMilk' style="background-color:#ffe4be;font-weight:bold;"title="Double click then show Actual Sales & Dispatch Qty Details show..!" data-toggle="modal" data-target="#myModal_<?php echo $ii; ?>_<?php echo $idd; ?>"><?php echo $DispatchQty; ?></td>
						<td class="hidetd  text-right" name='SaleMilk'><?php echo $ActualSales; ?></td>
						<td class="hidetd  text-right" name='SaleMilk1'><?php echo $SchemeQty; ?></td>
						<td class="hidetd  text-right" name='SaleMilk2'><?php echo $OfferQty; ?></td>
						<td class="hidetd  text-right" name='SaleMilk3'><?php echo $totqtys; ?></td>
						<td class="hidetd  text-right" name='SchemeMilk'><?php echo $basicitemRate;//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
 						<td class="hidetd  text-right" name='TotalMilkSale1'> <?php echo $TransRsPerQty; ?></td>
 						<td class="hidetd  text-right" name='TotalMilkSale2'> <?php echo $CommiRsPerQty; ?></td>
 						<td class="hidetd  text-right" name='TotalMilkSale3'> <?php echo $InsenRsPerQty; ?></td>
 						<td class="hidetd  text-right" name='TotalMilkSale4'> <?php echo $BonusRsPerQty; ?></td>
 						<td class="hidetd  text-right" name='TotalMilkSale5'> <?php echo $itemRate; ?></td>
						<td class="hidetd  text-right" name='OfferMilk'><?php echo number_format($TotalItemAmt,2,'.','');//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk1'><?php echo $TaxPer;//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk2'><?php echo $GstAmt;//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk21'><?php if($StateName == 'MAHARASHTRA'){ echo $GstAmt/2; } //if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk22'><?php if($StateName == 'MAHARASHTRA'){ echo $GstAmt/2; } //if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk23'><?php if($StateName != 'MAHARASHTRA'){ echo $GstAmt; }//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='OfferMilk3'><?php echo number_format(($GstAmttotplusamot=$TotalItemAmt + $GstAmt),2,'.','');//if($SchemeOffer !='Yes'){ echo $Scheme; }else{ echo "Scheme";}?></td>
						<td class="hidetd  text-right" name='TotalMilkSale'> <?php echo "";//echo $TotalMilkSale; ?></td>
 						
						<td class="hidetd  text-right" name='ReturnMilk'> <?php //echo $ReturnQty; ?></td>
						<td class="hidetd  text-right" name='ReturnMilk1'> <?php //echo $ReturnQty; ?></td>
						<td class="hidetd  text-right" name='ReturnMilk2'></td>
						<td class="hidetd  text-right" name='ReturnMilk3'></td>
						<td class="hidetd  text-right" name='ReturnMilk4'></td>
						<!--td class="hidetd  text-right" name='ReturnMilk5'></td-->
						<td class="hidetd  text-right" name='ReturnMilk6'></td>
						<td class="hidetd  text-right" name='ReturnMilk7'></td>
						<td class="hidetd  text-right" name='ReturnMilk8'></td>
						<td class="hidetd  text-right" name='ReturnMilk9'></td>
						<td class="hidetd  text-right" name='ReturnMilk10'></td>
						<td class="hidetd  text-right" name='ReturnMilk11'></td>
						<td class="hidetd  text-right" name='ReturnMilk12'></td>
						<!--td class="hidetd  text-right" name='ReturnMilk13'></td-->
						<td class="hidetd  text-right" name='ReturnMilk14'></td>
						<td class="hidetd  text-right" name='ReturnMilk15'></td>
						<td class="hidetd  text-right" name='ReturnMilk16'></td>
						<td class="hidetd  text-right" name='ReturnMilk17'></td>
						<?php if(!isset($_POST['Excel'])){ ?>
					<div id="myModal_<?php echo $ii; ?>_<?php echo $idd; ?>" class="modal fade" role="dialog">
						  <div class="modal-dialog">
							<div class="modal-content" style="font-family:cambria;font-weight:bold;">
							  <div class="modal-header">
								<button type="button" class="close" data-dismiss="modal">&times;</button>
								<h4 class="modal-title text-center"><?php echo 'ITEM NAME - '; ?><span style="color:red;font-weight:bold;"><?php echo $itemName; ?></span></h4>
							  </div>
							  <div class="modal-body">
							  <div class="row">
										<div class="text-center col-md-6 col-sm-6" style="color:red;font-weight:bold;">Dispatch</div> 
										<div class="text-center col-md-6 col-sm-6" style="color:red;font-weight:bold;"><?php echo $DispatchQty ; ?></div> 
										<div class="text-center col-md-6 col-sm-6">Scheme</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $SchemeQty ; ?></div>
										<div class="text-center col-md-6 col-sm-6">Offer</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $OfferQty ; ?></div>
										<div class="text-center col-md-6 col-sm-6">Sample</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $Sample ; ?></div>
										<div class="text-center col-md-6 col-sm-6">Leakage</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $Leakage ; ?></div>
										<div class="text-center col-md-6 col-sm-6">Spoil</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $Spoil ; ?></div>
										<div class="text-center col-md-6 col-sm-6">Return</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $ReturnQty ; ?></div>
 										<div class="text-center col-md-6 col-sm-6">Difference</div>
										<div class="text-center col-md-6 col-sm-6"><?php echo $DispatchQty - ($ActualSales+$OfferQty+$SchemeQty+$Leakage+$Sample+$Spoil+$ReturnQty) ; ?></div>
 										<div class="text-center col-md-6 col-sm-6" style="color:red;font-weight:bold;border-top:1px solid black;">Actual Sales</div>
										<div class="text-center col-md-6 col-sm-6" style="color:red;font-weight:bold;border-top:1px solid black;"><?php echo $ActualSales ; ?></div>
								</div>
								</div>
							  <div class="modal-footer">
 							  </div>
							</div>
							</div>
					</div>
						<?php } ?>
					</tr>
			  <?php
			 	
				$GstAmttot += $GstAmt;
				$GstAmttotplusamottot += ($TotalItemAmt + $GstAmt);
				// echo "<br>".$GstAmttotplusamottot;
				$GTotalItemAmt = $GTotalItemAmt + $TotalItemAmt;
				// $GTotalItemAmt = $GTotalItemAmt + $GstAmttotplusamottot;
				$GDispatchQty = $GDispatchQty + $DispatchQty;
				$GActualSales = $GActualSales + $ActualSales;
				$GSchemeQty = $GSchemeQty + $SchemeQty;
				$GOfferQty = $GOfferQty + $OfferQty;
				$Gtotqtys = $Gtotqtys + $totqtys;
 				$GDispatchQtyf = $GDispatchQtyf + $DispatchQty;
				$GActualSalesf = $GActualSalesf + $ActualSales;
				$GSchemeQtyf = $GSchemeQtyf + $SchemeQty;
				$GOfferQtyf = $GOfferQtyf + $OfferQty;
				$Gtotqtysf = $Gtotqtysf + $totqtys;
 				$GTotalItemAmtg = $GTotalItemAmtg + $TotalItemAmt;
 				$GTotalItemAmtgf = $GTotalItemAmtgf + $GstAmttotplusamot;
 				$GstAmtf = $GstAmtf + $GstAmt;
				$GDispatchQtyg = $GDispatchQtyg + $DispatchQty;
				$GActualSalesg = $GActualSalesg + $ActualSales;
				$GSchemeQtyg = $GSchemeQtyg + $SchemeQty;
				$GOfferQtyg = $GOfferQtyg + $OfferQty;
				$Gtotqtysg = $Gtotqtysg + $totqtys;
 				// $ii++;
			}
			  	?><?php if(!isset($_POST['Excel'])){ ?>
				<script>
					$("#DispatchMilk_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GDispatchQty; ?>');
					$("#SaleMilk_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GActualSales; ?>');
					$("#SaleMilk1_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GSchemeQty; ?>');
					$("#SaleMilk2_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GOfferQty; ?>');
					$("#SaleMilk3_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $Gtotqtys; ?>');
					$("#OfferMilk_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GTotalItemAmt; ?>');
					$("#OfferMilk2_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo $GstAmttot; ?>');
					$("#OfferMilk21_<?php echo $f; ?>_<?php echo $idd; ?>").text("<?php if($StateName == 'MAHARASHTRA'){ echo $GstAmttot/2; } ?>");
					$("#OfferMilk22_<?php echo $f; ?>_<?php echo $idd; ?>").text("<?php if($StateName == 'MAHARASHTRA'){ echo $GstAmttot/2; } ?>");
					$("#OfferMilk23_<?php echo $f; ?>_<?php echo $idd; ?>").text("<?php if($StateName != 'MAHARASHTRA'){ echo $GstAmttot; } ?>");
					$("#OfferMilk3_<?php echo $f; ?>_<?php echo $idd; ?>").text("<?php echo number_format($GstAmttotplusamottot,2,'.',''); ?>");
					// $("#TotalMilkSale_<?php echo $f; ?>_<?php echo $idd; ?>").text('<?php echo ($GTotalItemAmtg-$dealercashamt-$dealerChequeAmt-$dealerRTGSAmt-$dealerNFTAmt); ?>');
					
  			 </script>
				<?php } $ii++; } 
				$sss1=0; $sss1=number_format(($GTotalItemAmtgf+$dealercashpaidamt+$LooseMilkSalesAmt),2,'.','');
				$ssssss1=0;$ssssss1=number_format(($dealercashamt+$dealerChequeAmt+$dealerRTGSAmt+$dealerNFTAmt),2,'.','');
				?>
				<?php if(!isset($_POST['Excel'])){ ?>
				<script>
				$("#OfferMilk_<?php echo $PersonId; ?>").text('<?php echo $GTotalItemAmtg+$LooseMilkSalesAmt; ?>');
				$("#OfferMilk2_<?php echo $PersonId; ?>").text('<?php echo $GstAmtf; ?>');
				$("#OfferMilk21_<?php echo $PersonId; ?>").text("<?php if($StateName == 'MAHARASHTRA'){ echo $GstAmtf/2; } ?>");
				$("#OfferMilk22_<?php echo $PersonId; ?>").text("<?php if($StateName == 'MAHARASHTRA'){ echo $GstAmtf/2; } ?>");
				$("#OfferMilk23_<?php echo $PersonId; ?>").text("<?php if($StateName != 'MAHARASHTRA'){ echo $GstAmtf; } ?>");
				// $("#OfferMilk3_<?php echo $PersonId; ?>").text("<?php echo number_format($GTotalItemAmtgf,2,'.',''); ?>");
				// $("#ReturnMilk_<?php echo $PersonId; ?>").text("<?php echo number_format(($GTotalItemAmtg-$dealercashamt-$dealerChequeAmt-$dealerRTGSAmt-$dealerNFTAmt),2,'.',''); ?>");
				$("#TotalMilkSale_<?php echo $PersonId; ?>").text("<?php echo number_format(($dealercashamt+$dealerChequeAmt+$dealerRTGSAmt+$dealerNFTAmt),2,'.',''); ?>");
				$("#OfferMilk3_<?php echo $PersonId; ?>").text('<?php echo $sss1; ?>');
				$("#ReturnMilk_<?php echo $PersonId; ?>").text('<?php echo $sss1-$ssssss1; ?>');
					
				$("#ReturnMilk1_<?php echo $PersonId; ?>").text("<?php echo number_format($signedBalCF,2,'.',''); ?>");
				$("#OfferMilkdx_<?php echo $PersonId; ?>").text('<?php echo $GDispatchQtyf+$loosemilkqty; ?>');
				$("#OfferMilkdx2_<?php echo $PersonId; ?>").text('<?php echo $GActualSalesf+$loosemilkqty; ?>');
				$("#OfferMilkdx21_<?php echo $PersonId; ?>").text('<?php echo $GSchemeQtyf; ?>');
				$("#OfferMilkdx22_<?php echo $PersonId; ?>").text('<?php echo $GOfferQtyf; ?>');
				$("#OfferMilkdx23_<?php echo $PersonId; ?>").text('<?php echo $Gtotqtysf+$loosemilkqty; ?>');
 				</script>
	<?php	} ?>
	<?php	}   
		$GDispatchQtyg +=$loosemilkqty;
		$GActualSalesg +=$loosemilkqty;
		$Gtotqtysg +=$loosemilkqty;
	?>
	
 					<tr name="dealertotal" class="" style="background-color: #E6E6FA;color:red; font-weight:bold;"> 
						<td class="hidetd text-center" name='SrNo'></td> 
 						<td class="hidetd text-center" name='DealerName'></td> 
 						<td class="hidetd text-right" name='BrandName'></td>
 						<td class="hidetd text-right" name='TypeOfCategory'>DEALER TOTAL</td>
						<td class="hidetd text-right" name='DispatchMilk'><span class="DispatchQtyg"><?php echo $GDispatchQtyg; ?></span></td>
						<td class="hidetd text-right" name='SaleMilk'><span class="ActualSalesg"><?php echo $GActualSalesg; ?></span></td>
						<td class="hidetd text-right" name='SaleMilk1'><span class="SchemeQtyg"><?php echo $GSchemeQtyg; ?></span></td>
						<td class="hidetd text-right" name='SaleMilk2'><span class="OfferQtyg"><?php echo $GOfferQtyg; ?></span></td>
						<td class="hidetd text-right" name='SaleMilk3'><span class="totqtysg"><?php echo $Gtotqtysg; ?></span></td>
						<td class="hidetd text-right" name='SchemeMilk'></td>
 						<td class="hidetd  text-right" name='TotalMilkSale1'></td>
						<td class="hidetd  text-right" name='TotalMilkSale2'></td>
						<td class="hidetd  text-right" name='TotalMilkSale3'></td>
						<td class="hidetd  text-right" name='TotalMilkSale4'></td>
						<td class="hidetd  text-right" name='TotalMilkSale5'></td>
						<td class="hidetd text-right" name='OfferMilk'><span class="itemamountg"><?php echo $GTotalItemAmtg+$LooseMilkSalesAmt; ?></span></td>
						<td class="hidetd text-right" name='OfferMilk1'><?php echo ''; ?></td>
						<td class="hidetd text-right" name='OfferMilk2'><span class="gstg"><?php echo $GstAmttot; ?></span></td>
						<td class="hidetd text-right" name='OfferMilk21'><span class="sgstg"><?php  if($StateName == 'MAHARASHTRA'){ echo ($GstAmttot/2); }else{ echo "0"; }  ?></span></td>
						<td class="hidetd text-right" name='OfferMilk22'><span class="cgstg"><?php  if($StateName == 'MAHARASHTRA'){ echo ($GstAmttot/2); }else{ echo "0"; } ?></span></td>
						<td class="hidetd text-right" name='OfferMilk23'><span class="igstg"><?php  if($StateName != 'MAHARASHTRA'){ echo $GstAmttot; }else{ echo "0"; } ?></span></td>
						<td class="hidetd text-right" name='OfferMilk3'><span class="dramtg"><?php $sss=0;echo $sss=$GTotalItemAmtgf+$dealercashpaidamt+$LooseMilkSalesAmt; ?></span></td>
						<td class="hidetd  text-right" name='TotalMilkSale'><span class="cramtg"><?php $ssssss=0;echo $ssssss=number_format(($dealercashamt+$dealerChequeAmt+$dealerRTGSAmt+$dealerNFTAmt),2,'.',''); ?></span></td>
 						<td class="hidetd  text-right" name='ReturnMilk'><span class="remaing"><?php echo $gnttt=$sss-$ssssss;//echo number_format(($GTotalItemAmtg-$dealercashamt-$dealerChequeAmt-$dealerRTGSAmt-$dealerNFTAmt),2,'.',''); ?></span></td>
						<td class="hidetd  text-right" name='ReturnMilk1'><span class="signedBalCFg"><?php echo number_format($signedBalCF,2,'.',''); ?></span></td>
						<td class="hidetd  text-right" name='ReturnMilk2'></td>
						<td class="hidetd  text-right" name='ReturnMilk3'></td>
						<td class="hidetd  text-right" name='ReturnMilk4'></td>
						<!--td class="hidetd  text-right" name='ReturnMilk5'></td-->
						<td class="hidetd  text-right" name='ReturnMilk6'></td>
						<td class="hidetd  text-right" name='ReturnMilk7'></td>
						<td class="hidetd  text-right" name='ReturnMilk8'></td>
						<td class="hidetd  text-right" name='ReturnMilk9'></td>
						<td class="hidetd  text-right" name='ReturnMilk10'></td>
						<td class="hidetd  text-right" name='ReturnMilk11'></td>
						<td class="hidetd  text-right" name='ReturnMilk12'></td>
						<!--td class="hidtd  text-right" name='ReturnMilk13'></td-->
						<td class="hidetd  text-right" name='ReturnMilk14'></td>
						<td class="hidetd  text-right" name='ReturnMilk15'></td>
						<td class="hidetd  text-right" name='ReturnMilk16'></td>
						<td class="hidetd  text-right" name='ReturnMilk17'></td>
 					</tr>
					 
				<?php
				$idd++; $ii++; $GDispatchQtyg = 0; $GActualSalesg=0;$GTotalItemAmtg=0;$LooseMilkSalesAmt=0;
				
		}
		 ?>
			<tr class="rheads" style="background-color: #E6E6FA;color:red; font-weight:bold;"> 
				<td class="hidetd text-center" name='SrNo'></td> 
				<td class="hidetd text-center" name='DealerName'></td> 
				<td class="hidetd text-right" name='BrandName'></td>
				<td class="hidetd text-right" name='TypeOfCategory'>GRAND TOTAL</td>
				<td class="hidetd text-right" name='DispatchMilk'><span class="DispatchQty"></span></td>
				<td class="hidetd text-right" name='SaleMilk'><span class="ActualSales"></span></td>
				<td class="hidetd text-right" name='SaleMilk1'><span class="SchemeQty"></span></td>
				<td class="hidetd text-right" name='SaleMilk2'><span class="OfferQty"></span></td>
				<td class="hidetd text-right" name='SaleMilk3'><span class="totqtys"></span></td>
				<td class="hidetd text-right" name='SchemeMilk'></td>
				<td class="hidetd  text-right" name='TotalMilkSale1'></td>
				<td class="hidetd  text-right" name='TotalMilkSale2'></td>
				<td class="hidetd  text-right" name='TotalMilkSale3'></td>
				<td class="hidetd  text-right" name='TotalMilkSale4'></td>
				<td class="hidetd  text-right" name='TotalMilkSale5'></td>
				<td class="hidetd text-right" name='OfferMilk'><span class="itemamount"></span></td>
				<td class="hidetd text-right" name='OfferMilk1'></td>
				<td class="hidetd text-right" name='OfferMilk2'><span class="gst"></span></td>
				<td class="hidetd text-right" name='OfferMilk21'><span class="sgst"></span></td>
				<td class="hidetd text-right" name='OfferMilk22'><span class="cgst"></span></td>
				<td class="hidetd text-right" name='OfferMilk23'><span class="igst"></span></td>
				<td class="hidetd text-right" name='OfferMilk3'><span class="dramt"></span></td>
				<td class="hidetd  text-right" name='TotalMilkSale'><span class="cramt"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk'><span class="remain"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk1'><span class="signedBalCF"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk2'><span class="givencratemg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk3'><span class="recievecratemg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk4'><span class="recievecratemgg"></span></td>
				<!--td class="hidetd  text-right" name='ReturnMilk5'><span class="givencratefmg"></span></td-->
				<td class="hidetd  text-right" name='ReturnMilk6'><span class="givencratepg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk7'><span class="recievecratepg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk8'><span class="givencratepgg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk9'><span class="givencratefpg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk10'><span class="givencanmg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk11'><span class="recievecanmg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk12'><span class="givencanmgg"></span></td>
				<!--td class="hidetd  text-right" name='ReturnMilk13'><span class="givencanfmg"></span></td-->
				<td class="hidetd  text-right" name='ReturnMilk14'><span class="givencanpg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk15'><span class="recievecanpg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk16'><span class="givencanpgg"></span></td>
				<td class="hidetd  text-right" name='ReturnMilk17'><span class="givencanfpg"></span></td>
			</tr>
</table>
</div>
</div>
<script>
 				 
	var canhead =0;
	$(".givencratem").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencratemg").text(canhead.toFixed(2));
	});
	
	var canhead =0;
	$(".recievecratem").each(function() {
		canhead +=parseFloat($(this).text());
		$(".recievecratemg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencratemggg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".recievecratemgg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencratefm").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencratefmg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencratep").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencratepg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".recievecratep").each(function() {
		canhead +=parseFloat($(this).text());
		$(".recievecratepg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencratepggg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencratepgg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencratefp").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencratefpg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".givencanm").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanmg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".recievecanm").each(function() {
		canhead +=parseFloat($(this).text());
		$(".recievecanmg").text(canhead.toFixed(2));
	});
	 var canhead =0;
	$(".givencanmggg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanmgg").text(canhead.toFixed(2));
	});
		 var canhead =0;
	$(".givencanfm").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanfmg").text(canhead.toFixed(2));
	});
		 var canhead =0;
	$(".givencanp").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanpg").text(canhead.toFixed(2));
	});
		 var canhead =0;
	$(".recievecanp").each(function() {
		canhead +=parseFloat($(this).text());
		$(".recievecanpg").text(canhead.toFixed(2));
	});
			 var canhead =0;
	$(".givencanpggg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanpgg").text(canhead.toFixed(2));
	});    	 var canhead =0;
	$(".givencanfp").each(function() {
		canhead +=parseFloat($(this).text());
		$(".givencanfpg").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".signedBalCFg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".signedBalCF").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".remaing").each(function() {
		canhead +=parseFloat($(this).text());
		$(".remain").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".cramtg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".cramt").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".dramtg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".dramt").text(canhead.toFixed(2));
	}); 
	var canhead =0;
	$(".itemamountg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".itemamount").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".gstg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".gst").text(canhead.toFixed(2));
	});
	var canhead =0;
	$(".sgstg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".sgst").text(canhead.toFixed(2));
	}); var canhead =0;
	$(".cgstg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".cgst").text(canhead.toFixed(2));
	}); var canhead =0;
	$(".igstg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".igst").text(canhead.toFixed(2));
	}); 
	var canhead =0;
	$(".DispatchQtyg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".DispatchQty").text(canhead.toFixed(2));
	}); var canhead =0;
	$(".ActualSalesg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".ActualSales").text(canhead.toFixed(2));
	});  var canhead =0;
	$(".SchemeQtyg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".SchemeQty").text(canhead.toFixed(2));
	}); var canhead =0;
	$(".OfferQtyg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".OfferQty").text(canhead.toFixed(2));
	}); var canhead =0;
	$(".totqtysg").each(function() {
		canhead +=parseFloat($(this).text());
		$(".totqtys").text(canhead.toFixed(2));
	}); 
 				
</script>
 <?php ob_end_flush(); ?>