<?php
session_start();

include "dashboard/lib/setup.php";

// if(isset($_SESSION['booking']) && (isset($_SESSION['user_id'])))
if(isset($_SESSION['user_id']))
{

    vali_redirect("user/dashboard.php");

}

if(isset($_SESSION['cid']))
{ 

    vali_redirect("dashboard/dashboard.php");
    // echo "<script>
    //         window.location.href='dashboard.php';
    //     </script>";
}

else if(!isset($_SESSION['cid']) || !isset($_SESSION['user_id']))
{
    	
    $sql = "SELECT * FROM company WHERE id IS NOT NULL";
    db_select($sql);
    if (db_rowcount() > 0) {
        func_setSelectVar();
    }
    func_setReqVar();


    $sql = "SELECT 
        company_name,
        website_name,
        registration_no,
        address AS company_address,
        phone_no AS company_phone_no,
        image AS company_image,
        email AS company_email
        FROM company WHERE id IS NOT NULL";
    
    db_select($sql);
    
    if (db_rowcount() > 0) {
        func_setSelectVar();
    }
    ?>



<!DOCTYPE html>
<html lang="en">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <link rel="apple-touch-icon" sizes="76x76" href="dashboard/assets/img/<?php echo $company_image; ?>" />
    <link rel="icon" type="image/png" href="dashboard/assets/img/<?php echo $company_image; ?>">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title><?php echo $website_name; ?></title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />-->
    <!-- CSS Files -->
    <link href="dashboard/assets/css/core/bootstrap.min.css" rel="stylesheet" />
    <link href="dashboard/assets/css/core/now-ui-kit.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />
    <!-- CSS Files -->
    <link href="dashboard/assets/css/core/bootstrap.min.css" rel="stylesheet" />
    <link href="dashboard/assets/css/core/now-ui-kit.css" rel="stylesheet" />
</head>

<body class="login-page sidebar-collapse">
    <div class="page-header" filter-color="primary">
        <div class="page-header-image" style="background-image:url(dashboard/assets/img/login.jpg)"></div>
        <div class="container">
            <div class="col-md-4 content-center">
                <div class="card card-login card-plain">
                    <?php 
                    if (isset($btnSubmit)) {


                    	if(isset($_POST['checkbox1'])){
                    
                    		$checkAddDriver = $_POST['checkbox1'];
                    		// $priceAddDriver = db_get(0, 3);
                    
                    	}
                    	 
                    
                    	if(isset($_POST['checkbox2'])){
                    
                    		$checkCdw = $_POST['checkbox2'];
                    		// $priceCdw = $cust_subtotal*((db_get(1, 3))/100);
                    
                    	} 
                    
                    	if(isset($_POST['checkbox3'])){
                    
                    		$checkStickerP = $_POST['checkbox3'];
                    		
                    
                    	} 
                    
                    	if(isset($_POST['checkbox4'])){
                    
                    		$checkTouchnGo = $_POST['checkbox4'];
                    
                    	} 
                    
                    	if(isset($_POST['checkbox5'])){
                    
                    		$checkDriver = $_POST['checkbox5'];
                    
                    	} 
                    
                    	if(isset($_POST['checkbox6'])){
                    
                    		$checkCharger = $_POST['checkbox6'];
                    
                    	} 
                    
                    	if(isset($_POST['checkbox7'])){
                    
                    		$checkSmartTag = $_POST['checkbox7'];
                    
                    	} 
                    
                    	if(isset($_POST['checkbox8'])){
                    
                    		$checkChildSeat = $_POST['checkbox8'];
                    		// $priceChildSeat = $day * 5;
                    
                    	} 
                    
                    	if(isset($_POST['checkboxPickup'])){
                    
                    		$checkPickupDelivery = $_POST['checkboxPickup'];
                    
                    		// start edit
                    
                    		if(!empty($_POST['pickupLocation'])){
                    
                    			$inputPickup = $_POST['pickupLocation'];
                    			$inputReturn = $_POST['pickupLocation'];
                    
                    		} 
                    
                    		if(!empty($_POST['returnLocation'])){
                    
                    			$inputReturn = $_POST['returnLocation'];
                    
                    		} 
                    	} 
                    	
                    // 	echo "booking: ".$_POST['booking'];
                    	
                    	$nric_no = $_SESSION['nric_no'];
                        $booking = $_POST['booking'];
                    	$cust_class_id = $_SESSION['cust_class_id'];
                    	$cust_pickup_date = $_SESSION['cust_search_pickup_date'];
                    	$cust_pickup_time = $_SESSION['cust_search_pickup_time'];
                    	$cust_return_date = $_SESSION['cust_search_return_date'];
                    	$cust_return_time = $_SESSION['cust_search_return_time'];
                    	$cust_search_pickup_location = $_SESSION['cust_search_pickup_location'];
                    	$cust_search_return_location = $_SESSION['cust_search_return_location'];
                    	$cust_subtotal = $_SESSION['cust_subtotal'];
                    	$cust_day = $_SESSION['cust_day'];
                    	$cust_status = $_SESSION['cust_status'];
                    	$checkAddDriver = $_SESSION['checkAddDriver'];
                    	$checkCdw = $_SESSION['checkCdw'];
                    	$checkStickerP = $_SESSION['checkStickerP'];
                    	$checkTouchnGo = $_SESSION['checkTouchnGo'];
                    	$checkDriver = $_SESSION['checkDriver'];
                    	$checkCharger = $_SESSION['checkCharger'];
                    	$checkSmartTag = $_SESSION['checkSmartTag'];
                    	$checkChildSeat = $_SESSION['checkChildSeat'];
                    	$checkPickupDelivery = $_SESSION['checkPickupDelivery'];
                    	$inputPickup = $_SESSION['inputPickup'];
                    	$inputReturn = $_SESSION['inputReturn'];
                    	
                    
                    } 
                    else if($_SESSION['signin'] == "true"){ ?>
                        
                        <script>    
                            window.onload = function() {
                              var i, x, tablinks;
                              x = document.getElementsByClassName("city");
                              for (i = 0; i < x.length; i++) {
                                x[i].style.display = "none";
                              }
                              tablinks = document.getElementsByClassName("tablink");
                              for (i = 0; i < x.length; i++) {
                                tablinks[i].className = tablinks[i].className.replace(" w3-border-red", "");
                              }
                              document.getElementById('signin').style.display = "block";
                              evt.currentTarget.firstElementChild.className += " w3-border-red";
                            }
                        </script>
                        <?php
                    }
                    ?>
                    
                    <div class="header header-primary text-center">
                            MYEZGO TRAVEL & TOURS
                        </div>
                        <br>
                        <div class="content">
                            <h2>Have you registered through our website?</h2>
                            <div class="w3-row">
                                <a href="javascript:void(0)" onclick="openCity(event, 'signin');">
                                    <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding btn btn-primary">I did!</div>
                                </a>
                                <a href="javascript:void(0)" onclick="openCity(event, 'signup');">
                                    <div class="w3-third tablink w3-bottombar w3-hover-light-grey w3-padding btn btn-default">Nah, not yet</div>
                                </a>
                            </div>
                            <form class="form" method="post" action="validate_customer.php">
                                <div id="signin" class="w3-container city" style="display:none">
                                    <br>
                                    <div class="content">
                                        <div class="input-group form-group-no-border input-lg">
                                            <span class="input-group-addon">
                                                <i class="fa fa-user"></i>
                                            </span>
                                            <input type="text" class="form-control" placeholder="ID No." name="nric_no" value="" required>
                                        </div>
                                        <div class="input-group form-group-no-border input-lg">
                                            <span class="input-group-addon">
                                                <i class="fa fa-unlock"></i>
                                            </span>
                                            <input type="password" placeholder="Password" name="password" id="password" class="form-control" required>
                                            <span class="input-group-addon">
                                                <i id="togglePassword" class="bi bi-eye-slash"></i>
                                            </span>
                                        </div>
                                        <script>
                                            const togglePassword = document.querySelector('#togglePassword');
                                            const password = document.querySelector('#password');
                                            
                                            togglePassword.addEventListener('click', function (e) {
                                                // toggle the type attribute
                                                const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
                                                password.setAttribute('type', type);
                                                // toggle the eye slash icon
                                                this.classList.toggle('bi-eye-slash');
                                                this.classList.toggle('bi-eye');
                                            });
                                        </script>
                                        <div class="">
                                            <a href="">Forgot Password? (Test)</a>
                                        </div>
                                        <input type="submit" name="btn_signin" class="btn btn-primary btn-round btn-lg" value="Sign In">
                                        <input type="hidden" name="booking" value="<?php echo $_POST['booking']; ?>">
                                    	<input type="hidden" name="cust_class_id" value="<?php echo $_POST['cust_class_id']; ?>">
                                    	<input type="hidden" name="cust_search_pickup_date" value="<?php echo $_POST['cust_search_pickup_date']; ?>">
                                    	<input type="hidden" name="cust_search_pickup_time" value="<?php echo $_POST['cust_search_pickup_time']; ?>">
                                    	<input type="hidden" name="cust_search_return_date" value="<?php echo $_POST['cust_search_return_date']; ?>">
                                    	<input type="hidden" name="cust_search_return_time" value="<?php echo $_POST['cust_search_return_time']; ?>">
                                    	<input type="hidden" name="cust_search_pickup_location" value="<?php echo $_POST['cust_search_pickup_location']; ?>">
                                    	<input type="hidden" name="cust_search_return_location" value="<?php echo $_POST['cust_search_return_location']; ?>">
                                    	<input type="hidden" name="cust_subtotal" value="<?php echo $_POST['cust_subtotal']; ?>">
                                    	<input type="hidden" name="cust_day" value="<?php echo $_POST['cust_day']; ?>">
                                    	<input type="hidden" name="cust_status" value="<?php echo $_POST['cust_status']; ?>">
                                    	<input type="hidden" name="checkAddDriver" value="<?php echo $_POST['checkAddDriver']; ?>">
                                    	<input type="hidden" name="checkCdw" value="<?php echo $_POST['checkCdw']; ?>">
                                    	<input type="hidden" name="checkStickerP" value="<?php echo $_POST['checkStickerP']; ?>">
                                    	<input type="hidden" name="checkTouchnGo" value="<?php echo $_POST['checkTouchnGo']; ?>">
                                    	<input type="hidden" name="checkDriver" value="<?php echo $_POST['checkDriver']; ?>">
                                    	<input type="hidden" name="checkCharger" value="<?php echo $_POST['checkCharger']; ?>">
                                    	<input type="hidden" name="checkSmartTag" value="<?php echo $_POST['checkSmartTag']; ?>">
                                    	<input type="hidden" name="checkChildSeat" value="<?php echo $_POST['checkChildSeat']; ?>">
                                    	<input type="hidden" name="checkPickupDelivery" value="<?php echo $_POST['checkPickupDelivery']; ?>">
                                    	<input type="hidden" name="inputPickup" value="<?php echo $_POST['inputPickup']; ?>">
                                    	<input type="hidden" name="inputReturn" value="<?php echo $_POST['inputReturn']; ?>">
                                        <br>
                                        <br>
                                    </div>
                                </div>
                            </form>
                            <form class="form" method="post" action="validate_customer.php">
                                <style type="text/css">
                                    #message {
                                      display:block;
                                      background: transparent;
                                      color: #000;
                                      position: relative;
                                      padding: 1px;
                                      margin-top: 10px;
                                    }
                                    
                                    #message p {
                                      padding: 1px 35px;
                                      font-size: 14px;
                                    }
                                    
                                    /* Add a green text color and a checkmark when the requirements are right */
                                    .valid {
                                      color: green;
                                    }
                                    
                                    .valid:before {
                                      position: relative;
                                      left: -35px;
                                      content: "✔";
                                    }
                                    
                                    /* Add a red text color and an "x" when the requirements are wrong */
                                    .invalid {
                                      color: red;
                                    }
                                    
                                    .invalid:before {
                                      position: relative;
                                      left: -35px;
                                      content: "✖";
                                    }
                                </style>
                                <script language="JavaScript" type="text/javascript">
                            	    var check = function() {
                        
                                        var idno = document.getElementById("nric_no");
                                        var vidno = document.getElementById("verify_nric_no");
                                        
                                        if (idno.value == "" && vidno.value == "") {
                                            
                                            document.getElementById("btn_signup").disabled = true;
                                            document.getElementById('match').classList.remove("valid");
                                            document.getElementById('match').classList.add("invalid");
                                        } else if (idno.value == vidno.value) {
                                            document.getElementById("btn_signup").disabled = false;
                                            document.getElementById('match').classList.remove("invalid");
                                            document.getElementById('match').classList.add("valid");
                                        } else {
                                            document.getElementById("btn_signup").disabled = true;
                                            document.getElementById('match').classList.remove("valid");
                                            document.getElementById('match').classList.add("invalid");
                                        }
                                        
                                        var nosymbol = /^[0-9a-zA-Z]+$/; 
                                        if(idno.value.match(nosymbol)) {  
                                            symbol.classList.remove("invalid");
                                            symbol.classList.add("valid");
                                        } else {
                                            symbol.classList.remove("valid");
                                            symbol.classList.add("invalid");
                                            document.getElementById("btn_signup").disabled = true;
                                        }
                            	    }
                                        
                                    var check2 = function() {
                                        document.getElementById("message").style.display = "block";
                                    }
                                    
                                    // When the user clicks outside of the password field, hide the message box
                                    // var check3 = function() {
                                    //     document.getElementById("message").style.display = "none";
                                    // }
                            	</script>
                                <div id="signup" class="w3-container city" style="display:none">
                                    <br>
                                    <div class="content">
                                        <div class="input-group form-group-no-border input-lg">
                                            <span class="input-group-addon">
                                                <i class="fa fa-user-circle"></i>
                                            </span>
                                            <select class="form-control custom-select" style="height: 50px;" name="nric_type" required>
                                                <option value='' style="background-color: grey;"> --- Please select ID Type --- </option>
                                                <option value='ic_new' style="background-color: grey;">New IC Number</option>
                                                <option value='ic_old' style="background-color: grey;">Old IC Number</option>
                                                <option value='ic_army' style="background-color: grey;">Army ID</option>
                                                <option value='ic_police' style="background-color: grey;">Police ID</option>
                                                <option value='passport' style="background-color: grey;">Passport</option>
                                            </select>
                                        </div>
                                        <div class="input-group form-group-no-border input-lg">
                                            <span class="input-group-addon">
                                                <i class="fa fa-info-circle"></i>
                                            </span>
                                            <input type="text" placeholder="ID No." name="nric_no" id="nric_no" onkeyup="check();" onfocus="check2();" class="form-control" required>
                                        </div>
                                        <div class="input-group form-group-no-border input-lg">
                                            <span class="input-group-addon">
                                                <i class="fa fa-check-circle"></i>
                                            </span>
                                            <input type="text" placeholder="Verify ID No." name="verify_nric_no" id="verify_nric_no" onkeyup="check();" onfocus="check2();" class="form-control" required>
                                        </div>
                                        <!--<div class="input-group form-group-no-border">-->
                                        <!--    <center><i><small>*Please do not include any symbol before submitting.</small></i></center>-->
                                        <!--</div>-->
                                        <div id="message">
                                            <p id="symbol" class="invalid">No symbol <b>allowed</b></p>
                                            <p id="match" class="invalid">Matching <b>characters</b></p>
                                        </div>
                                        <button type="submit" name="btn_signup" id="btn_signup" class="btn btn-primary btn-round btn-lg" disabled>Sign Up</button>
                                        <input type="hidden" name="booking" value="<?php echo $booking; ?>">
                                    	<input type="hidden" name="cust_class_id" value="<?php echo $cust_class_id; ?>">
                                    	<input type="hidden" name="cust_search_pickup_date" value="<?php echo $cust_search_pickup_date; ?>">
                                    	<input type="hidden" name="cust_search_pickup_time" value="<?php echo $cust_search_pickup_time; ?>">
                                    	<input type="hidden" name="cust_search_return_date" value="<?php echo $cust_search_return_date; ?>">
                                    	<input type="hidden" name="cust_search_return_time" value="<?php echo $cust_search_return_time; ?>">
                                    	<input type="hidden" name="cust_search_pickup_location" value="<?php echo $cust_search_pickup_location; ?>">
                                    	<input type="hidden" name="cust_search_return_location" value="<?php echo $cust_search_return_location; ?>">
                                    	<input type="hidden" name="cust_subtotal" value="<?php echo $cust_subtotal; ?>">
                                    	<input type="hidden" name="cust_day" value="<?php echo $cust_day; ?>">
                                    	<input type="hidden" name="cust_status" value="<?php echo $cust_status; ?>">
                                    	<input type="hidden" name="checkAddDriver" value="<?php echo $checkAddDriver; ?>">
                                    	<input type="hidden" name="checkCdw" value="<?php echo $checkCdw; ?>">
                                    	<input type="hidden" name="checkStickerP" value="<?php echo $checkStickerP; ?>">
                                    	<input type="hidden" name="checkTouchnGo" value="<?php echo $checkTouchnGo; ?>">
                                    	<input type="hidden" name="checkDriver" value="<?php echo $checkDriver; ?>">
                                    	<input type="hidden" name="checkCharger" value="<?php echo $checkCharger; ?>">
                                    	<input type="hidden" name="checkSmartTag" value="<?php echo $checkSmartTag; ?>">
                                    	<input type="hidden" name="checkChildSeat" value="<?php echo $checkChildSeat; ?>">
                                    	<input type="hidden" name="checkPickupDelivery" value="<?php echo $checkPickupDelivery; ?>">
                                    	<input type="hidden" name="inputPickup" value="<?php echo $inputPickup; ?>">
                                    	<input type="hidden" name="inputReturn" value="<?php echo $inputReturn; ?>">
                                        <br>
                                        <br>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <script>
                        function openCity(evt, cityName) {
                          var i, x, tablinks;
                          x = document.getElementsByClassName("city");
                          for (i = 0; i < x.length; i++) {
                            x[i].style.display = "none";
                          }
                          tablinks = document.getElementsByClassName("tablink");
                          for (i = 0; i < x.length; i++) {
                            tablinks[i].className = tablinks[i].className.replace(" w3-border-red", "");
                          }
                          document.getElementById(cityName).style.display = "block";
                          evt.currentTarget.firstElementChild.className += " w3-border-red";
                        }
                        </script> 
                </div>
            </div>
        </div>
        <footer class="footer">
            <div class="container">
                <nav>
                    <ul>
                        <li>
                            <a href="../new">
                            <?php echo $company_name; ?>
                            </a>
                        </li>
                        <li>
                            <a href="about_us.php">
                                About Us
                            </a>
                        </li>
                    </ul>
                </nav>
                <div class="copyright">
                    innovated by <abbr title="Muhammad Amir Nashrullah">acoyy</abbr>&nbsp;
                    &copy; &nbsp;
                    <script>
                        document.write(new Date().getFullYear())
                    </script>
                </div>
            </div>
        </footer>
    </div>
</body>
<!--   Core JS Files   -->
<script src="dashboard/assets/js/core/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="dashboard/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="dashboard/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="dashboard/assets/js/plugins/bootstrap-switch.js"></script>
<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
<script src="dashboard/assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
<!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
<script src="dashboard/assets/js/plugins/bootstrap-datepicker.js" type="text/javascript"></script>
<!-- Control Center for Now Ui Kit: parallax effects, scripts for the example pages etc -->
<script src="dashboard/assets/js/now-ui-kit.js?v=1.1.0" type="text/javascript"></script>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


</html>
<?php
}
?>