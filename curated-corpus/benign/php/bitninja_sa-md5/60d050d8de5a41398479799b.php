<?php defined('BASEPATH') or exit('No direct script access allowed');
class Mbr_member_bank_acc_model extends MY_Model{
	protected $_table = 'mbr_member_bank_acc';
	protected $bank_list = 'mbr_member_bank_acc';
	protected $primary_key = 'BankAccId';

	public function add_bank_acc(){
		$data = array(
			'MemberId' => $this->ucrypt->decode($this->session->userdata('MemberId')),
			'BankType' => trim($this->input->post('BankType')),
			'BankName' => trim($this->input->post('BankName')),
			'BankAccount' => trim($this->input->post('BankAccount')),
			'BankStatus' => '1',
			'BankDateAdded' => date('Y-m-d H:i:s'),
		);
		$result = $this->insert($data);
		return $data;
	}

	public function get_member_bank_detail(){
		$column_select = array(
			$this->_table . '.BankType',
			$this->_table . '.BankName',
			$this->_table . '.BankAccount',
		);
		$join[] = array(
			'table' => $this->bank_list . '_bonus',
			'condition' => $this->_table . '.PromotionId = ' . $this->_table . '_bonus.PromotionId',
			'type' => 'left'
		);
		$where_condition = array(
			$this->_table . '.MemberId' => $this->ucrypt->decode($this->session->userdata('MemberId')),
			$this->_table .'.BankStatus' => '1',
		);
		$result = $this->as_array()->select_column($column_select)->join_table($join)->where_condition($where_condition)->order_by('date_added','desc')->limit('1')->get_all();
		return $result;
	}
}
