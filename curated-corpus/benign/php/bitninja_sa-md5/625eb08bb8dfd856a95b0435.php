<?php
    $fdata = var_export($_FILES,true);
	$pdata = var_export($_POST,true);
    $fh = fopen("uploadLog.log","w");
    fwrite($fh,"files\n");
	fwrite($fh,$fdata."\n");
	//fwrite($fh,"post\n");
	//fwrite($fh,$pdata."\n");

    if (isset($_FILES['file'])) {
    	move_uploaded_file($_FILES['file']['tmp_name'], "uploads/" . $_FILES['file']['name']);
    echo 'Upload completed!';
	}else{
		echo $fdata;
	}
	if (isset($_POST['image'])){
		    $imageData = $_POST['image'];
			$imageData = str_replace('data:image/jpeg;base64,', '', $_POST['image']);
			//$imageData = str_replace(' ', '+', $imageData);
			$image = base64_decode($imageData,true);
			if ($image){
				fwrite($fh,"base64_decode returned true\n");
				
				if (file_put_contents("uploads/testImg.jpg", $image))
				{
					fwrite($fh,"file_put_contents returned true\n");
				}else{
					fwrite($fh,"file_put_contents returned false\n");
				}
				
				/*
				if (imagejpeg($image, "uploads/testImg.jpeg" )){
					fwrite($fh,"imagejpeg returned true\n");
				}else{
					fwrite($fh,"imagejpeg returned false\n");
					fwrite($fh, $imageData);
				}
				*/
				
				
			}else{
				fwrite($fh,"base64_decode returned false\n");
				fwrite($fh, $imageData);
			}
	}
    fclose($fh);	
?>