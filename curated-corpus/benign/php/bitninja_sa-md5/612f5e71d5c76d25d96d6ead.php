<?php include('header.php');

?>
<style>
    
    .form-control
    {
            height: 50px;
            margin-left:2%;
            width:95%;
    }
    label
    {
        margin-left:2%;
    }
</style>






			<!-- start page content -->
			<div class="page-content-wrapper">
				<div class="page-content">
					<div class="page-bar">
						<div class="page-title-breadcrumb">
							<div class=" pull-left">
								<div class="page-title">Add slider image</div>
							</div>
							<ol class="breadcrumb page-breadcrumb pull-right">
								<li><i class="fa fa-home"></i>&nbsp;<a class="parent-item"
										href="dashboard.php">Home</a>&nbsp;<i class="fa fa-angle-right"></i>
								</li>
								<li class="active">Add slider image</li>
							</ol>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">
							<div class="card card-box">
								<div class="card-head">
									<header><meta http-equiv="Content-Type" content="text/html; charset=utf-8">Add Slider Image</header>
									<div class="tools">
										<a class="fa fa-repeat btn-color box-refresh" href="javascript:;"></a>
										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>
										<a class="t-close btn-color fa fa-times" href="javascript:;"></a>
									</div>
								</div>
<form action="" method="post" enctype="multipart/form-data">
    
    <div class="form-group">
    <label style=""> Select Image : (size-1920*917)</label>
    <input type="file" class="form-control lg"  name="files[]" placeholder="Select image">
    
  </div>
  <div class="form-group">
    <label >Main Caption</label>
    <input type="text" class="form-control" name="main_content" id="txtEditor" placeholder="Enter Main caption">
  </div>
 <div class="form-group">
    <label >Sub Caption</label>
    <input type="text" class="form-control" name="sub_content" id="txtEditor" placeholder="Enter Sub caption">
  </div>
  <input type="submit" class="btn btn-primary" name="submit" style="height:40px !important;margin-left:2%;" value="Submit">
</form>
<?php
 include("db.php");

 if(isset($_POST['submit'])) 
 {
   

$main_content= $_POST['main_content'];
$sub_content = $_POST['sub_content'];

	if(isset($_FILES['files'])){
		//This function reads the extension of the file. It is used to determine if the file  is an image by checking the extension.
 function getExtension($str) {
         $i = strrpos($str,".");
         if (!$i) { return ""; }
         $l = strlen($str) - $i;
         $ext = substr($str,$i+1,$l);
         return $ext;
 }
//$fn = $_POST['fn'];
    $errors= array();
	foreach($_FILES['files']['tmp_name'] as $key => $tmp_name ){
		$file_name = $key.$_FILES['files']['name'][$key];
		$file_size =$_FILES['files']['size'][$key];
		$file_tmp =$_FILES['files']['tmp_name'][$key];
		$file_type=$_FILES['files']['type'][$key];	
		if($file_size > 2222097152){
			$errors[]='File size must be less than 2 MB';
			
        }	
			//get the extension of the file in a lower case format
  		 $extension = getExtension($file_name);
 		$extension = strtolower($extension);
 	//if it is not a known extension, we will suppose it is an error and will not  upload the file,  
	//otherwise we will do more tests
 if (($extension != "jpg") && ($extension != "jpeg") && ($extension != "png") && ($extension != "PNG") && ($extension != "JPEG") && ($extension != "PNG") && ($extension != "jfif") && ($extension != "JFIF")) 
 		{
		//print error message
 			
 		 $errors=1;
 		}
		
		else
		{
        $desired_dir="images";
        if(empty($errors)==true){
            if(is_dir($desired_dir)==false){
                mkdir("$desired_dir", 0755);		// Create directory if it does not exist
            }
            if(is_dir("$desired_dir/".$file_name)==false){
                move_uploaded_file($file_tmp,"images/".$file_name);
            }else{									//rename the file if another one exist
                $new_dir="images/".$file_name.time();
                 rename($file_tmp,$new_dir) ;				
            }
            
        }
        
        $path="product/".$file_name;
        
	echo 	$query="insert into slider(image,main_content,sub_content) values('$file_name','$main_content','$sub_content');";
if (!mysqli_query($con,$query)) 
{
  echo "Error Inserting Data";
  }	
		
		else{
                //print_r($errors);
        }
        
 
        
    }
	}
	if(!$errors){
		echo "<script language='javascript'>
{
  alert('Uploaded successfully');	
   window.location.href = 'add_slider_image.php';
}
</script>";
	}
	else
	{
	echo "<script language='javascript'>
{
  alert(' Choose only image files.');	
    window.location.href = 'add_slider_image.php';
}
</script>";
	}
}


}

//If no errors registred, print the success message
 
	 

  ?>

<br>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- end page content -->
			
		</div>
		<!-- end page container -->
		<!-- start footer -->
		<?php include('footer.php');?>
		<!-- end footer -->
	</div>
	<!-- start js include path -->
	<script src="assets/plugins/jquery/jquery.min.js"></script>
	<script src="assets/plugins/popper/popper.min.js"></script>
	<script src="assets/plugins/jquery-blockui/jquery.blockui.min.js"></script>
	<script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<!-- bootstrap -->
	<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
	<!-- Common js-->
	<script src="assets/js/app.js"></script>
	<script src="assets/js/layout.js"></script>
	<script src="assets/js/theme-color.js"></script>
	<!-- data tables -->
	<script src="assets/plugins/datatables/jquery.dataTables.min.js"></script>
	<script src="assets/plugins/datatables/plugins/bootstrap/dataTables.bootstrap4.min.js"></script>
	<script src="assets/js/pages/table/table_data.js"></script>
	<!-- Material -->
	<script src="assets/plugins/material/material.min.js"></script>
	<!-- animation -->
	<script src="assets/js/pages/ui/animations.js"></script>
	<!-- end js include path -->
</body>

<!-- Mirrored from radixtouch.in/templates/admin/hotel/source/view_booking.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Jan 2020 11:00:06 GMT -->
</html>