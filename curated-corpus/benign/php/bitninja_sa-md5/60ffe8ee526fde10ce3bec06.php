<?
/* Product: FAQ Manager Pro 3.0
 * Version type: Professional
 * File: install.php
 * Developer: Victor Tymchinsky <tym2003@mail.ru>
 */

ob_start();
session_start();
function version_check ($ist = "", $soll = "", $err_msg = "") {
    if (empty($ist) OR empty($soll)) {
        return FALSE;
        }
    $ist = explode(".", $ist);
    $soll = explode(".", $soll);
    for ($i = 0; $i < count($soll); $i++) {
        if ($ist[$i] <  $soll[$i]) {
            return FALSE;
            }
        if ($ist[$i] == $soll[$i]) {
            continue;
            }
        if ($ist[$i] >= $soll[$i]) {
            return TRUE;
            }
        }
    return TRUE;
    }

function mysql_check($version) {
    return version_check (mysql_get_client_info(), $version);
    }

function php_check($version) {
    return version_check (phpversion(), $version);
    }

function uninstall() {
	global $uninst, $conn_id;
	while ($each_query = each($uninst)) {
		$result = mysql_query($each_query[1]);
		}
	}

if (!isset($_GET['step'])) $_GET['step'] = "1";

/* destination vars */
$error_global = false;
$error_msg = false;

/* check install script */
if (!session_is_registered("step")) {
  if (file_exists("../inc/data.php") && file_exists("../inc/config.php")) {
    $error_global = true;
  }
}

/* top image file */
if (!$error_global) {
  $image_file = "step";
} else {
  $image_file = "congratulations";
}

/* include files */

$system['name'] = "FAQ Manager Pro 3.0";

$step_title = false;
if ($_GET['step'] == 1 && !$error_global) $step_title = "Step 1: MySQL database settings";
if ($_GET['step'] == 2 && !$error_global) $step_title = "Step 2: Administrator and personal settings";
if ($_GET['step'] == 3 && !$error_global) $step_title = "Step 3: Search settings";

$vars_border_style = array("none","dotted","dashed","solid","double","grove","ringe","inset","outset");
$vars_font_family = array("Arial","Tahoma","Verdana","Times New Romans","Courier");
$vars_font_style = array("normal","italic");
$vars_font_weight = array("normal","bold");
$vars_text_decoration = array("none","underline","overline","line-through","blink");

?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title><? echo $system['name']." :: Installation"; if ($step_title) echo " :: ".$step_title; ?></title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../template/style.css" rel="stylesheet" type="text/css">
</head><body>
<table width="778"  border="0" align="center" cellpadding="5" cellspacing="10">
<tr><td style="border:1px solid #C0C0C0; background-color:#FFFFFF;">

<table width="100%" align="center" border="1" cellspacing="0" id="table1" cellpadding="0" bordercolorlight="#F1F1EF" bordercolordark="#F1F1EF">
		<tr>
			<td bgcolor="#FFFFFF" bordercolor="#C0C0C0" >
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td height="30" background="../admin/img/bg-header.gif"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr> 
                <td><img src="../admin/img/header-adminzone.gif" width="150" height="30"></td>
                <td width="115" align="right"><img src="../admin/img/cdcover-top.gif" width="115" height="30"></td>
              </tr>
            </table></td>
        </tr>
        <tr> 
          <td height="110" align="right" class="header"><img src="../admin/img/cdcover-back.gif"><table width="100%" height="105" border="0" cellpadding="0" cellspacing="0" bgcolor="#F2F2F2">
              <tr> 
                <td width="209" valign="top">
				<img border="0" src="../admin/img/logotype.gif" width="203" height="105" alt="Active FAQ 3.0"></td>
                <td align="right" class="header"><img src="../admin/img/cdcover.gif" width="288" height="105"></td>
              </tr>
            </table></td>
        </tr>
      </table></td>
	  </table>

</td></tr>

<tr><td style="border:1px solid #C0C0C0; background-color:#FFFFFF;">

<table width="100%"  border="0" cellspacing="0" cellpadding="0">
<tr><td bgcolor="#51679A"><img src="../admin/img/pixel.gif" alt="" width="100%" height="5"></td></tr>
<tr><td bgcolor="#183579"><img src="../admin/img/<? echo $image_file; ?>.gif" alt="<? echo $image_file; ?>"></td></tr>
<tr><td><!-- content --><?
if (!$error_global) {
  if ($_GET['step'] == 1) {
    $step_complite = false;
    if (isset($_POST['submit'])) {
      $connect_db = @mysql_connect($_POST['db_host'], $_POST['db_login'], $_POST['db_passwd']);
      $select_db = @mysql_select_db($_POST['db_name'], $connect_db);
      if (!$connect_db) $error_msg = "Error: can't connect to MySQL database";
      elseif (!$select_db) $error_msg = "Error: can't connect to selected database";
    
      if (!$error_msg) $step_complite = 1;
    } else {
      $_POST = array("db_host"=>"localhost","db_login"=>"root","db_passwd"=>"","db_name"=>"");
    }
    if ($step_complite) {
      session_register("step");
      $_SESSION['step'] = 1;
      
      /* set chmod to folders */
      chmod("../inc",0777);
      chmod("../attachments",0777);
	  chmod("../xml",0777);
      
      $fp = @fopen("../inc/data.php","w+");
      $db_content = '<?'."\n\$mysql_server = \"{$_POST['db_host']}\";\n\$mysql_user = \"{$_POST['db_login']}\";\n\$mysql_passwort = \"{$_POST['db_passwd']}\";\n\$mysql_db = \"{$_POST['db_name']}\";\n\$sqltblpre  = \"{$_POST['db_prefix']}\";\n".'?>';
      if ($fp) {
        fwrite($fp, $db_content);
        fclose();
        chmod("../inc/data.php",0777);
      } else {
        $error_msg = "Error: can't save changes to file inc/data.php";
      }
      if (!$error_msg) {
        header("Location: {$_SERVER['PHP_SELF']}?step=2");
        exit;
      }
    } ?><!-- step1 -->
<form action="<? echo $_SERVER['PHP_SELF']; ?>?step=1" method="post" name="step1" id="step1">
<table width="100%"  border="0" cellspacing="5" cellpadding="0">
<tr><td width="10%">&nbsp;</td>
<td><table width="100%"  border="0" cellpadding="5" cellspacing="0">
<tr><td width="30%" class="underline">DB host : </td>
<td class="underline"><input class="field" name="db_host" type="text" id="db_host" value="<?=$_POST['db_host']?>"></td></tr>
<tr><td class="underline">DB user : </td>
<td class="underline"><input class="field" name="db_login" type="text" id="db_login" value="<?=$_POST['db_login']?>"></td></tr>
<tr><td class="underline">DB password : </td>
<td class="underline"><input class="field" name="db_passwd" type="text" id="db_passwd" value="<?=$_POST['db_passwd']?>"></td></tr>
<tr><td class="underline">DB name : </td>
<td class="underline"><input class="field" name="db_name" type="text" id="db_name" value="<?=$_POST['db_name']?>"></td></tr>
<tr><td>Table prefix : </td>
<td><input class="field" name="db_prefix" type="text" id="db_prefix" value="<?=$_POST['db_prefix']?>"></td></tr></table></td></tr>
<tr><td class="topline">&nbsp;</td>
<td>&nbsp;</td></tr><?
    if ($error_msg) {
      ?><tr><td colspan="2" class="commentBox"><span class="required">*</span> <span class="comment"><? echo $error_msg; ?></span></td></tr><?
    }
    ?><tr align="center"><td colspan="2"><input name="submit" type="submit" class="button" id="submit" value=" :: Next step :: "></td></tr></table>
</form><!-- /step1 --><?
  } if ($_GET['step'] == 2) {
    if (!session_is_registered("step") || !file_exists("../inc/data.php")) {
      header("Location: {$_SERVER['PHP_SELF']}?step=1");
      exit;
    }
    
    $step_complite = false;
    if (isset($_POST['submit'])) {
     // if (!$_POST['username']) $error_msg = "Please fill Login field correctly";
      if (!$_POST['password'] || $_POST['password'] != $_POST['retype_passwd']) $error_msg = "Incorrect password or password confirmation";
      if (!$_POST['email']) $error_msg = "Incorrect email address";
      
      if (!$error_msg) {
        include ("../inc/data.php");
        /* connect to db */
        @$db_connect = mysql_connect($mysql_server,$mysql_user, $mysql_passwort);
        @$db_select = mysql_select_db($mysql_db,$db_connect);
        
		/* Tabellenstruktur für das Logging im Adminbereich */
	$query["logs"] = "CREATE TABLE ".$sqltblpre."faqadminlog (
	id int(11) NOT NULL auto_increment,
	time int(11) NOT NULL,
	user int(11) NOT NULL,
	text text NOT NULL,
	ip text NOT NULL,
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqadminlog";
	
	/* Tabellenstruktur für die Sessions im Adminbereich */
	$query['sessions'] = "CREATE TABLE ".$sqltblpre."faqadminsessions (
	uin varchar(50) BINARY NOT NULL,
	user tinytext NOT NULL,
	pass varchar(64) BINARY NOT NULL,
	ip text NOT NULL,
	time int(11) NOT NULL)";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqadminsessions";
	
	
	/* Tabellenstruktur für die Kommentare */
	$query['comments'] = "CREATE TABLE ".$sqltblpre."faqcomments (
	id_comment int(11) NOT NULL auto_increment,
	id int(11) NOT NULL,
	user varchar(255) NOT NULL,
	email varchar(255) NOT NULL,
	comment text NOT NULL,
	datum int(15) NOT NULL,
	helped text NOT NULL,
	PRIMARY KEY (id_comment))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqcomments";
	
	/* Tabellenstruktur für die offenen Fragen */
	$query['pending questions'] = "CREATE TABLE ".$sqltblpre."faqfragen (
	id int(11) unsigned NOT NULL auto_increment,
	ask_username varchar(100) NOT NULL,
	ask_usermail varchar(100) NOT NULL,
	ask_rubrik varchar(100) NOT NULL,
	ask_content text NOT NULL,
	ask_date varchar(20) NOT NULL,
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqfragen";
	
	
	/* Tabellenstruktur für die Rubriken der FAQ */
	$query['category'] = "CREATE TABLE ".$sqltblpre."faqrubrik (
	id int(11) unsigned NOT NULL auto_increment,
	rubrik text NOT NULL,
	titel char(255) NOT NULL,
	datum char(20) NOT NULL,
	secure enum('y','n') NOT NULL default 'n',
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqrubrik";
	
	/* Tabellenstruktur für die Votings der Artikel */
	$query['voting'] = "CREATE TABLE ".$sqltblpre."faqvoting (
	id int(11) unsigned NOT NULL auto_increment,
	artikel int(11) unsigned NOT NULL,
	vote int(11) unsigned NOT NULL,
	user int(11) unsigned NOT NULL,
	datum varchar(20) NOT NULL default '',
	ip varchar(15) NOT NULL default '',
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqvoting";
	
	/* Tabellenstruktur für die Rechtevergabe im Adminbereich */
	$query['administrator rights'] = "CREATE TABLE ".$sqltblpre."faqrights (
	id int(11) NOT NULL auto_increment,
	short text NOT NULL,
	name text NOT NULL,
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqrights";
	
	/* Tabellenstruktur für die User-Sessions */
	$query[] = "CREATE TABLE ".$sqltblpre."faqsessions (
	sid int(11) NOT NULL auto_increment,
	ip text NOT NULL,
	time int(11) NOT NULL,
	PRIMARY KEY sid (sid))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqsessions";
	
	/* Tabellenstruktur für die Artikeldaten */
	$query['data'] = "CREATE TABLE ".$sqltblpre."faqdata (
	id int(11) NOT NULL auto_increment,
	lang varchar(5) default NULL,
	active char(3) NOT NULL,
	rubrik text NOT NULL,
	keywords text NOT NULL,
	thema text NOT NULL,
	content text NOT NULL,
	author varchar(255) NOT NULL,
	email varchar(255) NOT NULL,
	comment enum('y','n') NOT NULL default 'y',
	datum varchar(15) NOT NULL,
	FULLTEXT (keywords,thema,content),
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqdata";
	
	/* Tabellenstruktur für die Visits der einzelnen Artikel */
	$query['visits'] = "CREATE TABLE ".$sqltblpre."faqvisits (
	id int(11) NOT NULL auto_increment,
	lang varchar(5) default NULL,
	visits int(11) NOT NULL,
	last_visit int(15) NOT NULL,
	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faqvisits";
	
	/* Tabellenstruktur für die User im Adminbereich */
	$query['administrators'] = "CREATE TABLE ".$sqltblpre."faquser (
	id int(2) NOT NULL auto_increment,
	name text NOT NULL,
	pass varchar(64) BINARY NOT NULL,
	realname varchar(255) NOT NULL default '',
	email varchar(255) NOT NULL default '',
	rights text NOT NULL,
	phone varchar(100) default NULL,
    gender enum('male','female') default NULL,

	PRIMARY KEY (id))";
	$uninst[] = "DROP TABLE  IF EXISTS ".$sqltblpre."faquser";
	
	/* Tabelleninhalte für die Rechtevergabe und die Statistik */
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (1, 'Administrators', 'Administrators')";
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (2, 'Settings', 'Settings')";
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (3, 'Design', 'Design')";
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (4, 'Statistics', 'Statistics')";
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (5, 'Questions', 'Questions')";
	$query[] = "INSERT INTO ".$sqltblpre."faqrights (id, short, name) VALUES (6, 'Categories', 'Categories')";
	
	$query['insert'] = "INSERT INTO ".$sqltblpre."faquser (id, name, pass, realname, email, phone, gender, rights) VALUES (1, 'admin', '".$_POST['password']."', '".$_POST['fullname']."', '".$_POST['email']."','".$_POST['phone']."','".$_POST['gender']."', '1111111')";
	
	
	uninstall();
	while (list($key, $value) = each($query)) {
		$result = @mysql_query($value);
		if ($key=='insert') $status_admin = ($result) ? "<span class=true>true</span>":"<span class=false>false</span>";
		if ((strlen($key)>2) && $key!='insert'){
		  $status = ($result) ? "<span class=true>true</span>":"<span class=false>false</span>";
		  $install_report.="Create table for ".$key." ... ".$status."<br>";}
		}

        $_SESSION['step'] = 2;
        $step_complite = true;
      } else {
        $prop = array("password"=>$_POST['password'],"email"=>$_POST['email'],"fullname"=>$_POST['fullname'],"gender"=>$_POST['gender'],"phone"=>$_POST['phone']);
      }
    } else {
      $prop = array("password"=>"","email"=>"","fullname"=>"","gender"=>"","phone"=>"");
    }
    if (!$step_complite) {
      ?><form action="<? echo $_SERVER['PHP_SELF']; ?>?step=2" method="post" name="frm_prop" id="frm_prop" onSubmit="return check_form('frm_prop');">
<script language="javascript" type="text/javascript"><!--
function check_form (form_name) {
        form = document.forms[form_name];
        tmp = form.elements['password'];
        if (tmp.value.length == 0 || tmp.value.search (/^\s*$/) != -1) {
                alert ('Incorrect password or password confirmation');
                tmp.focus ();
                return false;
        }
        tmp1 = form.elements['retype_passwd'];
        if (tmp1.value.length == 0) {
                alert ('Incorrect password or password confirmation');
                tmp1.focus ();
                return false;
        }
        if ( tmp1.value != tmp.value ) {
                alert ('Incorrect password or password confirmation');
                tmp.focus ();
                return false;
        }
        tmp = form.elements['email'];
        if ( (tmp.value.length == 0) || (tmp.value.search(/^[0-9a-z]([-_.]?[0-9a-z])*@[0-9a-z]([-.]?[0-9a-z])*\.[a-z]{2,3}$/) == -1 )){
                alert ('Incorrect email address');
                tmp.focus ();
                return false;
        }
        tmp = form.elements['fullname'];
        if (tmp.value.length == 0) {
                alert ('Full Name is empty');
                tmp.focus();
                return false;
        }
        return true;
} //--></script>
<table width="100%" border="0" cellspacing="5" cellpadding="0">
<tr><td width="10%">&nbsp;</td>
<td><table width="100%"  border="0" align="center" cellpadding="4" cellspacing="0" bgcolor="#FFFFFF">
<tr><td width="40%" class="underline">Login<span class="required">*</span> :</td>
<td class="underline">admin</td></tr>
<tr><td class="underline">Password<span class="required">*</span> :</td>
<td class="underline"><input class="field" name="password" type="password" id="password" style="width:60%;" value="<? echo $prop['password']; ?>" maxlength="16"></td></tr>
<tr><td class="underline">Password again<span class="required">*</span> :</td>
<td class="underline"><input class="field" name="retype_passwd" type="password" id="retype_passwd" style="width:60%;" value="<? echo $prop['password']; ?>" maxlength="16"></td></tr>
<tr><td class="underline">Email<span class="required">*</span> :</td>
<td class="underline"><input class="field" name="email" type="text" id="email" style="width:100%;" value="<? echo $prop['email']; ?>" maxlength="255"></td></tr>
<tr><td class="underline">Full Name<span class="required">*</span> :</td>
<td class="underline"><input class="field" name="fullname" type="text" id="fullname" style="width:100%;" value="<? echo $prop['fullname']; ?>"></td></tr>
<tr><td class="underline">Gender<span class="required">*</span> :</td>
<td class="underline"><input name="gender" type="radio" value="male" id="gender_male"<? if($prop['gender']!="female") echo " checked";?>>
<label for="gender_male">Male</label>
<input name="gender" type="radio" value="female" id="gender_female"<? if($prop['gender']=="female") echo " checked";?>>
<label for="gender_female">Female</label></td></tr>
<tr><td class="underline">Phone :</td>
<td class="underline"><input class="field" name="phone" type="text" id="phone" style="width:60%;" value="<? echo $prop['phone']; ?>" maxlength="255"></td></tr></table></td></tr>
<tr><td class="topline">&nbsp;</td>
<td>&nbsp;</td></tr>
<tr><td colspan="2" class="commentBox"><span class="required">*</span> <span class="comment">Required fields</span></td></tr>
<tr align="center"><td colspan="2"><input name="submit" type="submit" class="button" id="submit" value=" :: Next step :: "></td></tr></table>
</form><?
    } else {
      ?><table width="100%"  border="0" cellspacing="5" cellpadding="0">
<tr><td><p><?=$install_report?>
Insert root administrator [admin] ... <? echo $status_admin; ?> ;</p>
<p><a class="strong" href="<? echo $_SERVER['PHP_SELF']; ?>?step=3">Next step</a></p></td></tr></table><?
    }
  } elseif ($_GET['step'] == 3) {
    
    if (isset($_POST['submit'])) {
  
  if (file_exists("../inc/config.php")) unlink("../inc/config.php");
  $fp = @fopen("../inc/config.php", "w+");
  $arrVar = $_REQUEST["edit"];
    if (isset($fp)) {
	    fputs($fp, "<?php \n# Created ".date("d.m.Y H:i:s")."\n\n");
	    foreach ($arrVar as $key => $value) {
			    $avar = str_replace ("\"", "", $value);
		        fputs($fp, "$".$key." = \"".htmlspecialchars(trim(stripslashes($avar)))."\";\n\n");
		    }
	    fputs($fp, "?>");
	    fclose($fp);
		chmod("../inc/config.php",0777);
		}
		else {
        $config =  $_REQUEST["edit"];
        $error_msg = "Error: can't save changes to file inc/config.php";
      }
	  
      if (!$error_msg) {
        header("Location: {$_SERVER['PHP_SELF']}?step=4");
        exit;
      }
    } else {
      $folder = substr($_SERVER['PHP_SELF'],1,(strlen($_SERVER['PHP_SELF']) - 13));
	  $host_name = "http://".$_SERVER['HTTP_HOST']."/".substr($_SERVER['PHP_SELF'],1,(strlen($_SERVER['PHP_SELF']) - 20));
      $edit = array( 'host_name' => $host_name
          , 'install_date' => date("d.m.Y")
          , 'top_latest'  => 5
		  , 'top_viwed'  => 5
		  , 'attmax'  => 1000000
		  , 'show_ratings'  => true
		  , 'disatt'  => true
		  , 'show_views'  => true
		  , 'ipcheck'  => true
		  , 'send2friend_text'  => ''
		  , 'bannedIP'  => ''
          );
    }
    ?><table width="100%"  border="0" cellspacing="5" cellpadding="0">

<form action="<?php print $_SERVER["PHP_SELF"]?>?step=3" method="post" name="frm_set" >
<input type="hidden" name="action" value="editconfig">
<input type="hidden" name="edit[install_date]" value="<? echo $edit['install_date']; ?>">
<tr><td >&nbsp;</td>
<td><table width="100%" border="0" cellpadding="4" cellspacing="0">
<tr><td class="thead" height="30" colspan="4">Settings :</td></tr>
<tr>
<td width="30%" class="underline">Full path : </td>
<td class="underline" colspan="3"><input class="field" name="edit[host_name]" type="text"  value="<? echo $edit['host_name']; ?>" size="30"></td>
</tr>
<tr>
<td width="30%" class="underline">Show : </td>
<td class="underline" colspan="3"><input class="field" name="edit[top_latest]" type="text"  value="<? echo $edit['top_latest']; ?>" size="2" maxlength="2"> Latest Articles</td>
</tr>
<tr>
<td class="underline">Show :</td>
<td class="underline" colspan="3"><input class="field" name="edit[top_viwed]" type="text" value="<? echo $edit['top_viwed']; ?>" size="2" maxlength="2"> Top Articles</td>
</tr>
<tr>
<td class="underline">Attachment Max Size :</td>
<td class="underline" colspan="3"><input class="field" name="edit[attmax]" type="text" size="5"  value="<? echo $edit['attmax']; ?>"> Bytes</td>
</tr>
<tr>
<td class="underline">Show Rating : </td>
<td class="underline"><input class="field" name="edit[show_ratings]" type="Checkbox" <?=($edit['show_ratings']=='true')? 'checked':''?>  value="true"></td>
<td class="underline" align="right">Show Attachments :</td>
<td class="underline"><input class="field" name="edit[disatt]" type="checkbox" <?=($edit['disatt']=='true')? 'checked':''?>   value="true"></td>
</tr>
<tr>
<td class="underline">Show Views : </td>
<td class="underline"><input class="field"  name="edit[show_views]" <?=($edit['show_views']=='true')? 'checked':''?> type="Checkbox"  value="true"></td>
<td class="underline" align="right">Track IP addresses :</td>
<td class="underline"><input class="field" name="edit[ipcheck]" <?=($edit['ipcheck']=='true')? 'checked':''?> type="checkbox"   value="true"></td>
</tr>

<tr>
<td class="underline" valign="top">Tell a friend description text :</td>
<td class="underline" colspan="3"><textarea class="field" name="edit[send2friend_text]" cols="50" rows="6"><? echo $edit['send2friend_text']; ?></textarea></td>
</tr>

<tr>
<td class="underline" valign="top">Banned IP addresses (1 IP per line):</td>
<td class="underline" colspan="3"><textarea class="field" name="edit[bannedIP]" cols="50" rows="6"><? echo $edit['bannedIP']; ?></textarea></td>
</tr>
</table>

<table border="0" style="border-collapse: collapse" width="100%" id="table2" cellpadding="0">
<tr><td class="topline">&nbsp;</td>
<td>&nbsp;</td></tr>
<tr><td colspan="2" class="commentBox"><span class="required">*</span> <span class="comment">Please fill all fields very carefully</span></td></tr>
<tr align="center">
<td colspan="2"><input name="submit" type="submit" class="button" id="submit" value=" :: Save :: "></td></tr></table>
</form><?
  } elseif ($_GET['step'] == "4") {
    session_unregister("step");
    unset($_SESSION['step']);
    session_unset();
    header("Location: {$_SERVER['PHP_SELF']}?step=5");
    exit();
  }
} else {
  ?><table width="100%"  border="0" cellspacing="5" cellpadding="0">
<tr><td width="10%" class="topline">&nbsp;</td>
<td>&nbsp;</td></tr>
<tr><td colspan="2" class="commentBox"><span class="required">*</span> <span class="comment">Installation completed. System ready to work!</span><? if ($_GET['step'] == 5) echo "<p align=center><a href=\"../admin/\" class=strong>Administrator zone</a>"; ?></td></tr></table><?
}
?><!-- /content --></td></tr></table></td></tr></table>
<p align="center">&nbsp;Copyright © 2004 FAQ Manager Pro 3.0 . All Rights Reserved. Nullified by [GTT]</p>
</body></html><? ob_end_flush(); ?>
