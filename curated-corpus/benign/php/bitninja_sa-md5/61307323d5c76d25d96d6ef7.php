<?php
	defined( '_VALID_MOS' ) or die( 'Direct Access to this location is not allowed.' );
	$d = dir($skConfig_absolute_path . '/mods');
	if ($d)
	{
		while (false !== ($entry = $d->read())) {
			if ($entry != "." && $entry != ".." && $entry != "main")
			{
				$view = true;
				$finfo = explode('|',file_get_contents($skConfig_absolute_path . '/mods/'.$entry.'/mod_info.txt'));
				$finfo[-1] = $entry;
				$ftc[$finfo[2]] = $finfo;
			}
		}
		ksort($ftc);
		foreach ($ftc as $key=>$finfo)
		{
				$entry = $finfo[-1];
				if ($finfo[0] == "*") $view = true;
				else {
					if ($finfo[0] != $my->usertype) $view = false;
				}
				
				if ($view)
				{
					$link = "index2.php?option=".$_REQUEST['option']."&page=".$entry;
					$image = $mosConfig_live_site.'/administrator/images/kreativ_document.png';
					if (file_exists($skConfig_absolute_path . '/mods/'.$entry.'/icon.png')) $image = $skConfig_live_site . '/mods/'.$entry.'/icon.png';
					$text = $finfo[1];
					sk_html::writePanelIcon( $image, $link, $text );
				}
		}
	}
?>
