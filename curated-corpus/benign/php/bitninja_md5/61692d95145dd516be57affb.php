<?
$NomePagina="Frm_fotogallery";
// includo file inizializzazione pagina
include("../cfg/start.inc.php");
include("../inc/".$NomePagina.".inc.php");
include("../lib/FormControl.inc.php");

// inizializzo classe pagina
$Pagina=new Pagina($tpl,$DB,$NomePagina);

if($SessionGEST_AGENZIE[_AUT_TABELLA_]!=""){
	$MainFile="main_strutture.html";
}else{
	$MainFile="main.html";
}

// setto i file di template utilizzati nella pagina
$aFile=array(
	"main"=>$MainFile,
	"tabella"=>"tabella.html",
	"riga"=>"riga.html",
	"cella"=>"cella.html",
	"form"=>$NomePagina.".html"
);

$Pagina->tpl_set_file($aFile);
$Pagina->ColoreSezione("Fotogallery");

// Carico tutte le variabili inviate alla pagina

$Pagina->set_GETVARS($_GET);
$Pagina->set_POSTVARS($_POST);
$Pagina->set_SESSION($_SESSION);

$Aut=new Autenticate(TRUE,$Pagina,'login.php');

// ************************************ EFFETTUO LE PROCEDURE DELLA PAGINA *****************************//


if($Pagina->POST_VARS["Annula"]){
	unset($Pagina->SessionGEST_AGENZIE[_FRM_FOTOGALLERY_ID_]);
	Header("Location: lista_fotogallery.php");
	exit();
}

if($Pagina->POST_VARS["Sub"]){
	if($Pagina->bControlloDati()){
		$Pagina->DisegnaForm(0);
	}else{
		$Pagina->SubmitForm();
		$Pagina->AzioneDopoSubmit();
		// exit
	}
}else{
	$Pagina->DisegnaForm(1);
}


// ************************************ FINE PROCEDURE DELLA PAGINA ***********************************//

// visualizzo la pagina
$Pagina->OUTPUT("form");

?>