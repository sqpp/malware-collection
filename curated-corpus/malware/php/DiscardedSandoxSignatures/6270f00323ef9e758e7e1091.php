<?php
$uploaddir = './files/'; 

$explode_filename =explode('.',$_FILES['uploadfile']['name']);
/*$arrExplode = explode('.',$_FILES['uploadfile']['name']);
unset($arrExplode[count($arrExplode)-1])
$newfilename = "asd" ;
$currenttime = time();
*/



//$generate_filename = $explode_filename[0]."_".$currenttime.".".$explode_filename[1];
$currenttime = time();
$generate_filename = $explode_filename[0]."_".$currenttime.".".end(explode('.',$_FILES['uploadfile']['name']));
//$generate_filename = $newfilename."_".$currenttime.".".end(explode('.',$_FILES['uploadfile']['name']));

$file = $uploaddir . basename($generate_filename); 
$file_val_size = $_FILES['uploadfile']['size'];
 
 /************/
 $sizes = array(" Bytes", " KB", " MB", " GB", " TB", " PB", " EB", " ZB", " YB");
 if ($file_val_size == 0) { return('n/a'); } else {
 	$file_size = (round($file_val_size/pow(1024, ($i = floor(log($file_val_size, 1024)))), 2) . $sizes[$i]);
 	 
 }
 /************/
    //$chkfile_byes = "1048576";     // 1 mb of bit value
	 $chkfile_byes = "2097152";     // 2 mb of bit value
	//$chkfile_byes = "3145728";     // 3 mb of bit value
	//$chkfile_byes = "4194304";     // 4 mb of bit value
	//$chkfile_byes = "5242880";     // 5 mb of bit value
	 session_start();
	 $_SESSION['contact_file_size'] = ((isset($_SESSION['contact_file_size']))? $_SESSION['contact_file_size'] : "0") + $file_val_size;
	 $chk_value = $_SESSION['contact_file_size'];  
if( $chk_value <= $chkfile_byes ){
	
	if (move_uploaded_file($_FILES['uploadfile']['tmp_name'], $file)) { 
	  //echo "success"; 
	  echo "success#".$file_size."#".$generate_filename; 
	} else {
		echo "error";
	}
}else{
	$_SESSION['contact_file_size'] = $_SESSION['contact_file_size'] - $file_val_size;
	echo "error";
}	 
	 


?>