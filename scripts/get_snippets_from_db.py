import pymongo
import base64

myclient = pymongo.MongoClient("10.11.12.3", 27017)
mydb = myclient["bn-am-signature"]
mycol = mydb["malware-signatures"]
found = mycol.find({"type": "sa-snippet"}, {"signature": 1})
for x in found:
    content = base64.b64decode(x['signature'])
    try:
        actual_content = content.decode('ascii')
    except:
        print("Cannot decode")
    f = open("../snippets/"+str(x['_id'])+".php", "a")
    f.write(actual_content)
    f.close()