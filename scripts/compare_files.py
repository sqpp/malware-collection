import os
import os.path
import sys

def recursive_compare(dir1, dir2, info):
  items1 = os.scandir(dir1)
  for item in items1:
    if str(item.name) == '.' or str(item.name) == '..': 
        continue
    path1 = str(dir1.name) + '/' + str(item.name)
    path2 = dir2 + '/' + str(item.name)
    if os.path.isfile(path1):
        if os.path.isfile(path2) == False:
            info['deleted'] += 1
            if info['deleted'] % 50 == 0: 
                print("d")
        if os.path.isfile(path2) and (os.path.getsize(path1) != os.path.getsize(path2)):
            info['changed'] += 1
            if info['changed'] % 50 == 0: 
                print("c")
        elif os.path.isfile(path2) and os.path.getsize(path1) == os.path.getsize(path2):
            info['unchanged'] += path2+"\n"
        info['count'] += 1
        if info['count'] % 50 == 0: 
            print(".")
        if os.path.isdir(path1):
            recursive_compare(path1, path2, info)



info = {}
info['count'] = 0
info['changed'] = 0
info['deleted'] = 0
info['unchanged'] = ''

dir = sys.argv[1]
items = os.scandir('../curated-malwares')

for item in items:
    if item.name == "." or item.name == "..":
        continue
    if os.path.isdir(item):
        recursive_compare(item, dir+"/"+str(item.name), info)


print(info)
